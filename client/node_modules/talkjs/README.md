# TalkJS JavaScript SDK

This package lets you include TalkJS JS SDK snippet as an npm package. Please note this package is for the client-side SDK and is intended for browser environments.

**What is TalkJS?**

TalkJS lets you add user-to-user chat to your marketplace, collaboration tool, or social platform. For more information, visit [talkjs.com](https://talkjs.com/?ref=jssdk-npm-readme).

![Screenshots of TalkJS running on various devices](https://talkjs.com/images/devices_home.jpg)

Don't hesitate to [let us know](https://talkjs.com/?chat) if you have any questions about TalkJS.

## Getting Started

Use one of the following ways to import the library:

ES6 / TypeScript:

```js
import Talk from "talkjs";
```

CommonJS:

```js
const Talk = require("talkjs");
```

Then, follow the guide on our [documentation](https://talkjs.com/docs/?ref=jssdk-npm-readme) to start using TalkJS in your projects.

## Goals

This NPM package has two goals:

- Make it easier to inject the TalkJS snippet for developers who use front-end build chains such as Webpack or Parcel
- Provide TypeScript type definitions for the entire SDK, for an easier development experience in editors such as Atom and VS Code. Some editors (eg VS Code) will even use these for autocomplete if your application is not written in TypeScript but just in plain old JavaScript:

![Visual Studio Code autocomplete screenshot](https://talkjs.com/images/autocomplete.png)

Note that even if you use this package, the core TalkJS library is loaded on-the-fly from our CDN. It simply injects a small code snippet which does that asynchronously, without delaying the rest of your application.

### Usage from Node.js

This package is currently _frontend only_. You can load this package in Node.js, but cannot run use it. If you use a framework that runs the same code on Node.js and in the browser (eg Next.js), then make sure you only call TalkJS functions inside the browser. See [our Next.js example](https://github.com/talkjs/talkjs-examples/tree/master/react/next.js/) for more info.

## On forward compatibility

We take API compatibility extremely seriously. We spend a lot of effort to ensure that customer code that used to work, keeps working, even when we iterate on the SDK design. We may at times deprecate methods or fields, but we will not remove them. If something that used to work stops working, then that's a bug. Please [report it](https://talkjs.com/?chat) and we'll fix it asap.

### A note for TypeScript users

We do not consider a change in the type definitions a breaking change that warrants a major version release.

None of this will ever affect you unless you manually update the NPM package using a command like `npm install --save talkjs@latest` at a later time. And even then, nothing will break at runtime because we provide full forward compatibility of the JavaScript API.

In other words, we code like the following should always keep working and compiling, even if you update this package:

```ts
import Talk from "talkjs";
const session = new Talk.Session(..);
const inbox = session.createInbox(..);
```

But code like the following might cause compile errors when you update the package to a later version, because we may rename the `Talk.Inbox` type:

```ts
import Talk from "talkjs";
function createInbox(): Talk.Inbox { // <-- this line is the culprit
    const session = new Talk.Session(..);
    return session.createInbox(..);
}
```

Similarly, we may at any time remove deprecated methods, fields, classes and interfaces from the TypeScript definitions (but not from the JavaScript SDK).

## Changelog

Note: These are only the changes that have an effect on the JS level. TalkJS gets many improvements and fixes all the time. Consider subscribing to [our changelog](https://changelog.talkjs.com) if you want to stay updated.

### 0.15.2

- The way to attach event handlers has changed. Methods like `on("focus", handler)` to register events on the [Chatbox](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Chatbox/#Chatbox__on), [Popup](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Popup/#Popup__on) or [Inbox](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Inbox/#Inbox__on) are now deprecated. Instead, we recommend that you use the equivalent methods like  [`onFocus`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Chatbox/#Chatbox__onFocus) instead. The same thing goes for event handlers on [Session](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session) and [Unreads](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session#Unreads) objects.
- Similarly the `off` method to remove event listeners has been deprecated too. New event handler methods return a [Subscription](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces/#Subscription) object, which has an `unsubscribe()` method to stop listening for events.
- Add [onCustomMessageAction](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Chatbox/#Chatbox__onCustomMessageAction) event

### 0.15.1

- Add [captureKeyboardEvents](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session/#ChatboxOptions__captureKeyboardEvents) option
- Add [on("keyup")](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Chatbox/#Chatbox__on__keyup__) event
- Add [MessageField.getText](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces/#MessageField__typeText) and [MessageField.typeText](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces/#MessageField__typeText) methods.

### 0.15.0

- Add [Guest access](https://talkjs.com/docs/Reference/Concepts/Guests/) that enables hundreds of users in the chat at the same time.

### 0.14.5

- Add a [messageField.autofocus](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces.html#MessageFieldOptions.autofocus) which lets you disable automatically focusing the message field.

### 0.14.4

- Added [`theme`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#ChatboxOptions.theme) option to [createInbox, createChatbox and createPopup](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createChatbox) which lets you override which [Custom Theme](https://talkjs.com/resources/announcing-themesv2/) is shown.
- Added [`session.on("desktopNotificationClicked")`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.on__desktopNotificationClicked__) which lets you handle user clicks on browser notifications.

### 0.14.3

- Added the [inbox.on("selectConversation")](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Inbox.html#Inbox.on__selectConversation__) event, which triggers _before_ a user switches to a different conversation.
- Enabled passing `undefined` and `null` as paremeters to [inbox.select, chatbox.select, popup.select](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Inbox.html#Inbox.select) and to [session.createInbox, session.createChatbox, session.createPopup](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createInbox).

### 0.14.2

- Fixed [getPopups, getInboxes and getChatboxes](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.getInboxes) types.

### 0.14.1

- Added methods to get UIs, namely [getPopups, getInboxes and getChatboxes](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.getInboxes).

### 0.14.0

- Added the ability to search within a conversation - available on the Premium plan and above.
- Changed the default for the popup's 'launcher' option to default to 'always' instead of 'close-only'.
- Changed the default for the popup's 'keepOpen' option to default to 'false' instead of 'true'.

### 0.13.1

- Add option to show/hide the mobile back button for the Inbox UI.

### 0.13.0

- Add support for [real-time message translation](https://talkjs.com/docs/Features/Customizations/Real-Time_Message_Translation.html#page_Obtaining-and-configuring-a-Google-API-key).

### 0.12.0

- Simplify "no chats" inbox layout; take background and borders from theme `.panel` setting.

### 0.11.0

- Add [MessageField.setVisible](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces.html#MessageField.setVisible) method and a [messageField.visible](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#InboxOptions.messageField) setting to [`createInbox`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createInbox) and friends.

### 0.10.3

- Add [Message Field settings](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#InboxOptions.messageField) to [`createInbox`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.createInbox) and friends.

### 0.10.2

- Make the SDK compatible with typescript 2.3 and older browsers.

### 0.10.1

- Fix circular type reference.

### 0.10.0

- Fix bug that would not let TypeScript users do `import Talk from "talkjs"` in some situations. Note that before this change, in _some_ setups you could actually do `import * as Talk` to get around this. That stops working now.

### 0.9.1

- Added [`Session#destroy`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#Session.destroy) that destroys the current connection to the TalkJS server.

### 0.9.0

- Removed exception when `talkjs` is required or imported in non-browser environments (eg Node.js). _Using_ the package outside the browser still throws an exception, but just importing it doesn't anymore.

### 0.8.1

- Exposed `Talk.Error`.
- Added [`MessageFilter`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#InboxOptions.messageFilter).
- Added missing `custom` field to the `Message` interface.
- Added the ability to override message contents and custom field via the JSSDK.

### 0.8.0

- Added explicit support for ESNext modules, to make this package work with eg Rollup.
- Typings now expose the `custom` field on the `Message` interface
- Fixed TypeScript exports: types were exported as separate named exports, even though the TalkJS SDK actually default-exports a single Talk object. To update existing an TypeScript codebase to use the new types, change all occurrences of `import * as Talk from "talkjs"` to `import Talk from "talkjs"`. If you use CommonJS (`require`) then no changes are needed.

### 0.7.0

- Add [conversation welcome messages](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/ConversationBuilder.html#ConversationBuilder.welcomeMessages), which are rendered similar to system messages
- Add [`chatBox.messageField.setText(...)`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Other_interfaces.html#MessageField.setText)
- Rename `User.configuration` to [`User.role`](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/User.html#User.role) (with full backward compatibility, i.e. `configuration` is now a deprecated alias for `role`.

### 0.6.1

- Add support for [Inbox feed filters](https://talkjs.com/docs/Reference/JavaScript_Chat_SDK/Session.html#InboxOptions.feedFilter).

### 0.6.0

- Converted some classes to interfaces (eg `Inbox` is now an interface).
- Exported all interfaces that the SDK exposes. For example, `Session.getOrCreateConversation` returns a `ConversationBuilder` interface, which you can now use in TypeScript code like `function updateConversation(conversation: Talk.ConversationBuilder) {..}`.

### 0.5.0

- Exported core interfaces in the TypeScript type definitions: Chatbox, Conversation, ConversationBuilder, Inbox, Popup.
- Began tracking a changelog :-)

## Examples

You can check out usage examples for this package and TalkJS in general, check out our [examples repository](https://github.com/talkjs/talkjs-examples/).
