{"ast":null,"code":"/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.3 (2022-02-09)\n */\n(function () {\n  'use strict';\n\n  var typeOf$1 = function (x) {\n    if (x === null) {\n      return 'null';\n    }\n\n    if (x === undefined) {\n      return 'undefined';\n    }\n\n    var t = typeof x;\n\n    if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    }\n\n    if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    }\n\n    return t;\n  };\n\n  var isEquatableType = function (x) {\n    return ['undefined', 'boolean', 'number', 'string', 'function', 'xml', 'null'].indexOf(x) !== -1;\n  };\n\n  var sort$1 = function (xs, compareFn) {\n    var clone = Array.prototype.slice.call(xs);\n    return clone.sort(compareFn);\n  };\n\n  var contramap = function (eqa, f) {\n    return eq$2(function (x, y) {\n      return eqa.eq(f(x), f(y));\n    });\n  };\n\n  var eq$2 = function (f) {\n    return {\n      eq: f\n    };\n  };\n\n  var tripleEq = eq$2(function (x, y) {\n    return x === y;\n  });\n  var eqString = tripleEq;\n\n  var eqArray = function (eqa) {\n    return eq$2(function (x, y) {\n      if (x.length !== y.length) {\n        return false;\n      }\n\n      var len = x.length;\n\n      for (var i = 0; i < len; i++) {\n        if (!eqa.eq(x[i], y[i])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqSortedArray = function (eqa, compareFn) {\n    return contramap(eqArray(eqa), function (xs) {\n      return sort$1(xs, compareFn);\n    });\n  };\n\n  var eqRecord = function (eqa) {\n    return eq$2(function (x, y) {\n      var kx = Object.keys(x);\n      var ky = Object.keys(y);\n\n      if (!eqSortedArray(eqString).eq(kx, ky)) {\n        return false;\n      }\n\n      var len = kx.length;\n\n      for (var i = 0; i < len; i++) {\n        var q = kx[i];\n\n        if (!eqa.eq(x[q], y[q])) {\n          return false;\n        }\n      }\n\n      return true;\n    });\n  };\n\n  var eqAny = eq$2(function (x, y) {\n    if (x === y) {\n      return true;\n    }\n\n    var tx = typeOf$1(x);\n    var ty = typeOf$1(y);\n\n    if (tx !== ty) {\n      return false;\n    }\n\n    if (isEquatableType(tx)) {\n      return x === y;\n    } else if (tx === 'array') {\n      return eqArray(eqAny).eq(x, y);\n    } else if (tx === 'object') {\n      return eqRecord(eqAny).eq(x, y);\n    }\n\n    return false;\n  });\n\n  var typeOf = function (x) {\n    var t = typeof x;\n\n    if (x === null) {\n      return 'null';\n    } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n      return 'array';\n    } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n      return 'string';\n    } else {\n      return t;\n    }\n  };\n\n  var isType$1 = function (type) {\n    return function (value) {\n      return typeOf(value) === type;\n    };\n  };\n\n  var isSimpleType = function (type) {\n    return function (value) {\n      return typeof value === type;\n    };\n  };\n\n  var eq$1 = function (t) {\n    return function (a) {\n      return t === a;\n    };\n  };\n\n  var isString$1 = isType$1('string');\n  var isObject = isType$1('object');\n  var isArray$1 = isType$1('array');\n  var isNull = eq$1(null);\n  var isBoolean = isSimpleType('boolean');\n  var isUndefined = eq$1(undefined);\n\n  var isNullable = function (a) {\n    return a === null || a === undefined;\n  };\n\n  var isNonNullable = function (a) {\n    return !isNullable(a);\n  };\n\n  var isFunction = isSimpleType('function');\n  var isNumber = isSimpleType('number');\n\n  var noop = function () {};\n\n  var compose = function (fa, fb) {\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      return fa(fb.apply(null, args));\n    };\n  };\n\n  var compose1 = function (fbc, fab) {\n    return function (a) {\n      return fbc(fab(a));\n    };\n  };\n\n  var constant = function (value) {\n    return function () {\n      return value;\n    };\n  };\n\n  var identity = function (x) {\n    return x;\n  };\n\n  var tripleEquals = function (a, b) {\n    return a === b;\n  };\n\n  function curry(fn) {\n    var initialArgs = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      initialArgs[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      var restArgs = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        restArgs[_i] = arguments[_i];\n      }\n\n      var all = initialArgs.concat(restArgs);\n      return fn.apply(null, all);\n    };\n  }\n\n  var not = function (f) {\n    return function (t) {\n      return !f(t);\n    };\n  };\n\n  var die = function (msg) {\n    return function () {\n      throw new Error(msg);\n    };\n  };\n\n  var apply = function (f) {\n    return f();\n  };\n\n  var call = function (f) {\n    f();\n  };\n\n  var never = constant(false);\n  var always = constant(true);\n\n  var none = function () {\n    return NONE;\n  };\n\n  var NONE = function () {\n    var call = function (thunk) {\n      return thunk();\n    };\n\n    var id = identity;\n    var me = {\n      fold: function (n, _s) {\n        return n();\n      },\n      isSome: never,\n      isNone: always,\n      getOr: id,\n      getOrThunk: call,\n      getOrDie: function (msg) {\n        throw new Error(msg || 'error: getOrDie called on none.');\n      },\n      getOrNull: constant(null),\n      getOrUndefined: constant(undefined),\n      or: id,\n      orThunk: call,\n      map: none,\n      each: noop,\n      bind: none,\n      exists: never,\n      forall: always,\n      filter: function () {\n        return none();\n      },\n      toArray: function () {\n        return [];\n      },\n      toString: constant('none()')\n    };\n    return me;\n  }();\n\n  var some = function (a) {\n    var constant_a = constant(a);\n\n    var self = function () {\n      return me;\n    };\n\n    var bind = function (f) {\n      return f(a);\n    };\n\n    var me = {\n      fold: function (n, s) {\n        return s(a);\n      },\n      isSome: always,\n      isNone: never,\n      getOr: constant_a,\n      getOrThunk: constant_a,\n      getOrDie: constant_a,\n      getOrNull: constant_a,\n      getOrUndefined: constant_a,\n      or: self,\n      orThunk: self,\n      map: function (f) {\n        return some(f(a));\n      },\n      each: function (f) {\n        f(a);\n      },\n      bind: bind,\n      exists: bind,\n      forall: bind,\n      filter: function (f) {\n        return f(a) ? me : NONE;\n      },\n      toArray: function () {\n        return [a];\n      },\n      toString: function () {\n        return 'some(' + a + ')';\n      }\n    };\n    return me;\n  };\n\n  var from$1 = function (value) {\n    return value === null || value === undefined ? NONE : some(value);\n  };\n\n  var Optional = {\n    some: some,\n    none: none,\n    from: from$1\n  };\n  var nativeSlice = Array.prototype.slice;\n  var nativeIndexOf = Array.prototype.indexOf;\n  var nativePush = Array.prototype.push;\n\n  var rawIndexOf = function (ts, t) {\n    return nativeIndexOf.call(ts, t);\n  };\n\n  var indexOf$2 = function (xs, x) {\n    var r = rawIndexOf(xs, x);\n    return r === -1 ? Optional.none() : Optional.some(r);\n  };\n\n  var contains$3 = function (xs, x) {\n    return rawIndexOf(xs, x) > -1;\n  };\n\n  var exists = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var map$3 = function (xs, f) {\n    var len = xs.length;\n    var r = new Array(len);\n\n    for (var i = 0; i < len; i++) {\n      var x = xs[i];\n      r[i] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var each$k = function (xs, f) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var eachr = function (xs, f) {\n    for (var i = xs.length - 1; i >= 0; i--) {\n      var x = xs[i];\n      f(x, i);\n    }\n  };\n\n  var partition = function (xs, pred) {\n    var pass = [];\n    var fail = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      var arr = pred(x, i) ? pass : fail;\n      arr.push(x);\n    }\n\n    return {\n      pass: pass,\n      fail: fail\n    };\n  };\n\n  var filter$4 = function (xs, pred) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        r.push(x);\n      }\n    }\n\n    return r;\n  };\n\n  var foldr = function (xs, f, acc) {\n    eachr(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var foldl = function (xs, f, acc) {\n    each$k(xs, function (x, i) {\n      acc = f(acc, x, i);\n    });\n    return acc;\n  };\n\n  var findUntil$1 = function (xs, pred, until) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(x);\n      } else if (until(x, i)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var find$3 = function (xs, pred) {\n    return findUntil$1(xs, pred, never);\n  };\n\n  var findIndex$2 = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n\n      if (pred(x, i)) {\n        return Optional.some(i);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var flatten = function (xs) {\n    var r = [];\n\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      if (!isArray$1(xs[i])) {\n        throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n      }\n\n      nativePush.apply(r, xs[i]);\n    }\n\n    return r;\n  };\n\n  var bind = function (xs, f) {\n    return flatten(map$3(xs, f));\n  };\n\n  var forall = function (xs, pred) {\n    for (var i = 0, len = xs.length; i < len; ++i) {\n      var x = xs[i];\n\n      if (pred(x, i) !== true) {\n        return false;\n      }\n    }\n\n    return true;\n  };\n\n  var reverse = function (xs) {\n    var r = nativeSlice.call(xs, 0);\n    r.reverse();\n    return r;\n  };\n\n  var difference = function (a1, a2) {\n    return filter$4(a1, function (x) {\n      return !contains$3(a2, x);\n    });\n  };\n\n  var mapToObject = function (xs, f) {\n    var r = {};\n\n    for (var i = 0, len = xs.length; i < len; i++) {\n      var x = xs[i];\n      r[String(x)] = f(x, i);\n    }\n\n    return r;\n  };\n\n  var sort = function (xs, comparator) {\n    var copy = nativeSlice.call(xs, 0);\n    copy.sort(comparator);\n    return copy;\n  };\n\n  var get$a = function (xs, i) {\n    return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n  };\n\n  var head = function (xs) {\n    return get$a(xs, 0);\n  };\n\n  var last$2 = function (xs) {\n    return get$a(xs, xs.length - 1);\n  };\n\n  var from = isFunction(Array.from) ? Array.from : function (x) {\n    return nativeSlice.call(x);\n  };\n\n  var findMap = function (arr, f) {\n    for (var i = 0; i < arr.length; i++) {\n      var r = f(arr[i], i);\n\n      if (r.isSome()) {\n        return r;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var keys = Object.keys;\n  var hasOwnProperty$1 = Object.hasOwnProperty;\n\n  var each$j = function (obj, f) {\n    var props = keys(obj);\n\n    for (var k = 0, len = props.length; k < len; k++) {\n      var i = props[k];\n      var x = obj[i];\n      f(x, i);\n    }\n  };\n\n  var map$2 = function (obj, f) {\n    return tupleMap(obj, function (x, i) {\n      return {\n        k: i,\n        v: f(x, i)\n      };\n    });\n  };\n\n  var tupleMap = function (obj, f) {\n    var r = {};\n    each$j(obj, function (x, i) {\n      var tuple = f(x, i);\n      r[tuple.k] = tuple.v;\n    });\n    return r;\n  };\n\n  var objAcc = function (r) {\n    return function (x, i) {\n      r[i] = x;\n    };\n  };\n\n  var internalFilter = function (obj, pred, onTrue, onFalse) {\n    var r = {};\n    each$j(obj, function (x, i) {\n      (pred(x, i) ? onTrue : onFalse)(x, i);\n    });\n    return r;\n  };\n\n  var bifilter = function (obj, pred) {\n    var t = {};\n    var f = {};\n    internalFilter(obj, pred, objAcc(t), objAcc(f));\n    return {\n      t: t,\n      f: f\n    };\n  };\n\n  var filter$3 = function (obj, pred) {\n    var t = {};\n    internalFilter(obj, pred, objAcc(t), noop);\n    return t;\n  };\n\n  var mapToArray = function (obj, f) {\n    var r = [];\n    each$j(obj, function (value, name) {\n      r.push(f(value, name));\n    });\n    return r;\n  };\n\n  var values = function (obj) {\n    return mapToArray(obj, identity);\n  };\n\n  var get$9 = function (obj, key) {\n    return has$2(obj, key) ? Optional.from(obj[key]) : Optional.none();\n  };\n\n  var has$2 = function (obj, key) {\n    return hasOwnProperty$1.call(obj, key);\n  };\n\n  var hasNonNullableKey = function (obj, key) {\n    return has$2(obj, key) && obj[key] !== undefined && obj[key] !== null;\n  };\n\n  var equal$1 = function (a1, a2, eq) {\n    if (eq === void 0) {\n      eq = eqAny;\n    }\n\n    return eqRecord(eq).eq(a1, a2);\n  };\n\n  var isArray = Array.isArray;\n\n  var toArray$1 = function (obj) {\n    if (!isArray(obj)) {\n      var array = [];\n\n      for (var i = 0, l = obj.length; i < l; i++) {\n        array[i] = obj[i];\n      }\n\n      return array;\n    } else {\n      return obj;\n    }\n  };\n\n  var each$i = function (o, cb, s) {\n    var n, l;\n\n    if (!o) {\n      return false;\n    }\n\n    s = s || o;\n\n    if (o.length !== undefined) {\n      for (n = 0, l = o.length; n < l; n++) {\n        if (cb.call(s, o[n], n, o) === false) {\n          return false;\n        }\n      }\n    } else {\n      for (n in o) {\n        if (has$2(o, n)) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var map$1 = function (array, callback) {\n    var out = [];\n    each$i(array, function (item, index) {\n      out.push(callback(item, index, array));\n    });\n    return out;\n  };\n\n  var filter$2 = function (a, f) {\n    var o = [];\n    each$i(a, function (v, index) {\n      if (!f || f(v, index, a)) {\n        o.push(v);\n      }\n    });\n    return o;\n  };\n\n  var indexOf$1 = function (a, v) {\n    if (a) {\n      for (var i = 0, l = a.length; i < l; i++) {\n        if (a[i] === v) {\n          return i;\n        }\n      }\n    }\n\n    return -1;\n  };\n\n  var reduce = function (collection, iteratee, accumulator, thisArg) {\n    var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n\n    for (var i = 0; i < collection.length; i++) {\n      acc = iteratee.call(thisArg, acc, collection[i], i);\n    }\n\n    return acc;\n  };\n\n  var findIndex$1 = function (array, predicate, thisArg) {\n    var i, l;\n\n    for (i = 0, l = array.length; i < l; i++) {\n      if (predicate.call(thisArg, array[i], i, array)) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var last$1 = function (collection) {\n    return collection[collection.length - 1];\n  };\n\n  var __assign = function () {\n    __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n\n      return t;\n    };\n\n    return __assign.apply(this, arguments);\n  };\n\n  function __rest(s, e) {\n    var t = {};\n\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n\n    if (s != null && typeof Object.getOwnPropertySymbols === 'function') for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n      if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n    }\n    return t;\n  }\n\n  function __spreadArray(to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n        if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n        ar[i] = from[i];\n      }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n  }\n\n  var cached = function (f) {\n    var called = false;\n    var r;\n    return function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!called) {\n        called = true;\n        r = f.apply(null, args);\n      }\n\n      return r;\n    };\n  };\n\n  var DeviceType = function (os, browser, userAgent, mediaMatch) {\n    var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n    var isiPhone = os.isiOS() && !isiPad;\n    var isMobile = os.isiOS() || os.isAndroid();\n    var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n    var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n    var isPhone = isiPhone || isMobile && !isTablet;\n    var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n    var isDesktop = !isPhone && !isTablet && !iOSwebview;\n    return {\n      isiPad: constant(isiPad),\n      isiPhone: constant(isiPhone),\n      isTablet: constant(isTablet),\n      isPhone: constant(isPhone),\n      isTouch: constant(isTouch),\n      isAndroid: os.isAndroid,\n      isiOS: os.isiOS,\n      isWebView: constant(iOSwebview),\n      isDesktop: constant(isDesktop)\n    };\n  };\n\n  var firstMatch = function (regexes, s) {\n    for (var i = 0; i < regexes.length; i++) {\n      var x = regexes[i];\n\n      if (x.test(s)) {\n        return x;\n      }\n    }\n\n    return undefined;\n  };\n\n  var find$2 = function (regexes, agent) {\n    var r = firstMatch(regexes, agent);\n\n    if (!r) {\n      return {\n        major: 0,\n        minor: 0\n      };\n    }\n\n    var group = function (i) {\n      return Number(agent.replace(r, '$' + i));\n    };\n\n    return nu$4(group(1), group(2));\n  };\n\n  var detect$3 = function (versionRegexes, agent) {\n    var cleanedAgent = String(agent).toLowerCase();\n\n    if (versionRegexes.length === 0) {\n      return unknown$2();\n    }\n\n    return find$2(versionRegexes, cleanedAgent);\n  };\n\n  var unknown$2 = function () {\n    return nu$4(0, 0);\n  };\n\n  var nu$4 = function (major, minor) {\n    return {\n      major: major,\n      minor: minor\n    };\n  };\n\n  var Version = {\n    nu: nu$4,\n    detect: detect$3,\n    unknown: unknown$2\n  };\n\n  var detectBrowser$1 = function (browsers, userAgentData) {\n    return findMap(userAgentData.brands, function (uaBrand) {\n      var lcBrand = uaBrand.brand.toLowerCase();\n      return find$3(browsers, function (browser) {\n        var _a;\n\n        return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n      }).map(function (info) {\n        return {\n          current: info.name,\n          version: Version.nu(parseInt(uaBrand.version, 10), 0)\n        };\n      });\n    });\n  };\n\n  var detect$2 = function (candidates, userAgent) {\n    var agent = String(userAgent).toLowerCase();\n    return find$3(candidates, function (candidate) {\n      return candidate.search(agent);\n    });\n  };\n\n  var detectBrowser = function (browsers, userAgent) {\n    return detect$2(browsers, userAgent).map(function (browser) {\n      var version = Version.detect(browser.versionRegexes, userAgent);\n      return {\n        current: browser.name,\n        version: version\n      };\n    });\n  };\n\n  var detectOs = function (oses, userAgent) {\n    return detect$2(oses, userAgent).map(function (os) {\n      var version = Version.detect(os.versionRegexes, userAgent);\n      return {\n        current: os.name,\n        version: version\n      };\n    });\n  };\n\n  var removeFromStart = function (str, numChars) {\n    return str.substring(numChars);\n  };\n\n  var checkRange = function (str, substr, start) {\n    return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n  };\n\n  var removeLeading = function (str, prefix) {\n    return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n  };\n\n  var contains$2 = function (str, substr) {\n    return str.indexOf(substr) !== -1;\n  };\n\n  var startsWith = function (str, prefix) {\n    return checkRange(str, prefix, 0);\n  };\n\n  var blank = function (r) {\n    return function (s) {\n      return s.replace(r, '');\n    };\n  };\n\n  var trim$4 = blank(/^\\s+|\\s+$/g);\n  var lTrim = blank(/^\\s+/g);\n  var rTrim = blank(/\\s+$/g);\n\n  var isNotEmpty = function (s) {\n    return s.length > 0;\n  };\n\n  var isEmpty$3 = function (s) {\n    return !isNotEmpty(s);\n  };\n\n  var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n\n  var checkContains = function (target) {\n    return function (uastring) {\n      return contains$2(uastring, target);\n    };\n  };\n\n  var browsers = [{\n    name: 'Edge',\n    versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n    search: function (uastring) {\n      return contains$2(uastring, 'edge/') && contains$2(uastring, 'chrome') && contains$2(uastring, 'safari') && contains$2(uastring, 'applewebkit');\n    }\n  }, {\n    name: 'Chrome',\n    brand: 'Chromium',\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/, normalVersionRegex],\n    search: function (uastring) {\n      return contains$2(uastring, 'chrome') && !contains$2(uastring, 'chromeframe');\n    }\n  }, {\n    name: 'IE',\n    versionRegexes: [/.*?msie\\ ?([0-9]+)\\.([0-9]+).*/, /.*?rv:([0-9]+)\\.([0-9]+).*/],\n    search: function (uastring) {\n      return contains$2(uastring, 'msie') || contains$2(uastring, 'trident');\n    }\n  }, {\n    name: 'Opera',\n    versionRegexes: [normalVersionRegex, /.*?opera\\/([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('opera')\n  }, {\n    name: 'Firefox',\n    versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n    search: checkContains('firefox')\n  }, {\n    name: 'Safari',\n    versionRegexes: [normalVersionRegex, /.*?cpu os ([0-9]+)_([0-9]+).*/],\n    search: function (uastring) {\n      return (contains$2(uastring, 'safari') || contains$2(uastring, 'mobile/')) && contains$2(uastring, 'applewebkit');\n    }\n  }];\n  var oses = [{\n    name: 'Windows',\n    search: checkContains('win'),\n    versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'iOS',\n    search: function (uastring) {\n      return contains$2(uastring, 'iphone') || contains$2(uastring, 'ipad');\n    },\n    versionRegexes: [/.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/, /.*cpu os ([0-9]+)_([0-9]+).*/, /.*cpu iphone os ([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Android',\n    search: checkContains('android'),\n    versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n  }, {\n    name: 'OSX',\n    search: checkContains('mac os x'),\n    versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n  }, {\n    name: 'Linux',\n    search: checkContains('linux'),\n    versionRegexes: []\n  }, {\n    name: 'Solaris',\n    search: checkContains('sunos'),\n    versionRegexes: []\n  }, {\n    name: 'FreeBSD',\n    search: checkContains('freebsd'),\n    versionRegexes: []\n  }, {\n    name: 'ChromeOS',\n    search: checkContains('cros'),\n    versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n  }];\n  var PlatformInfo = {\n    browsers: constant(browsers),\n    oses: constant(oses)\n  };\n  var edge = 'Edge';\n  var chrome = 'Chrome';\n  var ie$1 = 'IE';\n  var opera = 'Opera';\n  var firefox = 'Firefox';\n  var safari = 'Safari';\n\n  var unknown$1 = function () {\n    return nu$3({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$3 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isBrowser = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isEdge: isBrowser(edge),\n      isChrome: isBrowser(chrome),\n      isIE: isBrowser(ie$1),\n      isOpera: isBrowser(opera),\n      isFirefox: isBrowser(firefox),\n      isSafari: isBrowser(safari)\n    };\n  };\n\n  var Browser = {\n    unknown: unknown$1,\n    nu: nu$3,\n    edge: constant(edge),\n    chrome: constant(chrome),\n    ie: constant(ie$1),\n    opera: constant(opera),\n    firefox: constant(firefox),\n    safari: constant(safari)\n  };\n  var windows = 'Windows';\n  var ios = 'iOS';\n  var android = 'Android';\n  var linux = 'Linux';\n  var osx = 'OSX';\n  var solaris = 'Solaris';\n  var freebsd = 'FreeBSD';\n  var chromeos = 'ChromeOS';\n\n  var unknown = function () {\n    return nu$2({\n      current: undefined,\n      version: Version.unknown()\n    });\n  };\n\n  var nu$2 = function (info) {\n    var current = info.current;\n    var version = info.version;\n\n    var isOS = function (name) {\n      return function () {\n        return current === name;\n      };\n    };\n\n    return {\n      current: current,\n      version: version,\n      isWindows: isOS(windows),\n      isiOS: isOS(ios),\n      isAndroid: isOS(android),\n      isOSX: isOS(osx),\n      isLinux: isOS(linux),\n      isSolaris: isOS(solaris),\n      isFreeBSD: isOS(freebsd),\n      isChromeOS: isOS(chromeos)\n    };\n  };\n\n  var OperatingSystem = {\n    unknown: unknown,\n    nu: nu$2,\n    windows: constant(windows),\n    ios: constant(ios),\n    android: constant(android),\n    linux: constant(linux),\n    osx: constant(osx),\n    solaris: constant(solaris),\n    freebsd: constant(freebsd),\n    chromeos: constant(chromeos)\n  };\n\n  var detect$1 = function (userAgent, userAgentDataOpt, mediaMatch) {\n    var browsers = PlatformInfo.browsers();\n    var oses = PlatformInfo.oses();\n    var browser = userAgentDataOpt.bind(function (userAgentData) {\n      return detectBrowser$1(browsers, userAgentData);\n    }).orThunk(function () {\n      return detectBrowser(browsers, userAgent);\n    }).fold(Browser.unknown, Browser.nu);\n    var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n    var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n    return {\n      browser: browser,\n      os: os,\n      deviceType: deviceType\n    };\n  };\n\n  var PlatformDetection = {\n    detect: detect$1\n  };\n\n  var mediaMatch = function (query) {\n    return window.matchMedia(query).matches;\n  };\n\n  var platform$2 = cached(function () {\n    return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n  });\n\n  var detect = function () {\n    return platform$2();\n  };\n\n  var userAgent = navigator.userAgent;\n  var platform$1 = detect();\n  var browser$4 = platform$1.browser;\n  var os = platform$1.os;\n  var deviceType = platform$1.deviceType;\n  var webkit = /WebKit/.test(userAgent) && !browser$4.isEdge();\n  var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n  var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n  var Env = {\n    opera: browser$4.isOpera(),\n    webkit: webkit,\n    ie: browser$4.isIE() || browser$4.isEdge() ? browser$4.version.major : false,\n    gecko: browser$4.isFirefox(),\n    mac: os.isOSX() || os.isiOS(),\n    iOS: deviceType.isiPad() || deviceType.isiPhone(),\n    android: os.isAndroid(),\n    contentEditable: true,\n    transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n    caretAfter: true,\n    range: window.getSelection && 'Range' in window,\n    documentMode: browser$4.isIE() ? document.documentMode || 7 : 10,\n    fileApi: fileApi,\n    ceFalse: true,\n    cacheSuffix: null,\n    container: null,\n    experimentalShadowDom: false,\n    canHaveCSP: !browser$4.isIE(),\n    desktop: deviceType.isDesktop(),\n    windowsPhone: windowsPhone,\n    browser: {\n      current: browser$4.current,\n      version: browser$4.version,\n      isChrome: browser$4.isChrome,\n      isEdge: browser$4.isEdge,\n      isFirefox: browser$4.isFirefox,\n      isIE: browser$4.isIE,\n      isOpera: browser$4.isOpera,\n      isSafari: browser$4.isSafari\n    },\n    os: {\n      current: os.current,\n      version: os.version,\n      isAndroid: os.isAndroid,\n      isChromeOS: os.isChromeOS,\n      isFreeBSD: os.isFreeBSD,\n      isiOS: os.isiOS,\n      isLinux: os.isLinux,\n      isOSX: os.isOSX,\n      isSolaris: os.isSolaris,\n      isWindows: os.isWindows\n    },\n    deviceType: {\n      isDesktop: deviceType.isDesktop,\n      isiPad: deviceType.isiPad,\n      isiPhone: deviceType.isiPhone,\n      isPhone: deviceType.isPhone,\n      isTablet: deviceType.isTablet,\n      isTouch: deviceType.isTouch,\n      isWebView: deviceType.isWebView\n    }\n  };\n  var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n\n  var trim$3 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n  };\n\n  var is$3 = function (obj, type) {\n    if (!type) {\n      return obj !== undefined;\n    }\n\n    if (type === 'array' && isArray(obj)) {\n      return true;\n    }\n\n    return typeof obj === type;\n  };\n\n  var makeMap$4 = function (items, delim, map) {\n    var i;\n    items = items || [];\n    delim = delim || ',';\n\n    if (typeof items === 'string') {\n      items = items.split(delim);\n    }\n\n    map = map || {};\n    i = items.length;\n\n    while (i--) {\n      map[items[i]] = {};\n    }\n\n    return map;\n  };\n\n  var hasOwnProperty = has$2;\n\n  var create$9 = function (s, p, root) {\n    var self = this;\n    var sp,\n        scn,\n        c,\n        de = 0;\n    s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n    var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n    var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n\n    if (ns[cn]) {\n      return;\n    }\n\n    if (s[2] === 'static') {\n      ns[cn] = p;\n\n      if (this.onCreate) {\n        this.onCreate(s[2], s[3], ns[cn]);\n      }\n\n      return;\n    }\n\n    if (!p[cn]) {\n      p[cn] = function () {};\n\n      de = 1;\n    }\n\n    ns[cn] = p[cn];\n    self.extend(ns[cn].prototype, p);\n\n    if (s[5]) {\n      sp = self.resolve(s[5]).prototype;\n      scn = s[5].match(/\\.(\\w+)$/i)[1];\n      c = ns[cn];\n\n      if (de) {\n        ns[cn] = function () {\n          return sp[scn].apply(this, arguments);\n        };\n      } else {\n        ns[cn] = function () {\n          this.parent = sp[scn];\n          return c.apply(this, arguments);\n        };\n      }\n\n      ns[cn].prototype[cn] = ns[cn];\n      self.each(sp, function (f, n) {\n        ns[cn].prototype[n] = sp[n];\n      });\n      self.each(p, function (f, n) {\n        if (sp[n]) {\n          ns[cn].prototype[n] = function () {\n            this.parent = sp[n];\n            return f.apply(this, arguments);\n          };\n        } else {\n          if (n !== cn) {\n            ns[cn].prototype[n] = f;\n          }\n        }\n      });\n    }\n\n    self.each(p.static, function (f, n) {\n      ns[cn][n] = f;\n    });\n  };\n\n  var extend$6 = function (obj) {\n    var exts = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      exts[_i - 1] = arguments[_i];\n    }\n\n    for (var i = 0; i < exts.length; i++) {\n      var ext = exts[i];\n\n      for (var name_1 in ext) {\n        if (has$2(ext, name_1)) {\n          var value = ext[name_1];\n\n          if (value !== undefined) {\n            obj[name_1] = value;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var walk$3 = function (o, f, n, s) {\n    s = s || this;\n\n    if (o) {\n      if (n) {\n        o = o[n];\n      }\n\n      each$i(o, function (o, i) {\n        if (f.call(s, o, i, n) === false) {\n          return false;\n        }\n\n        walk$3(o, f, n, s);\n      });\n    }\n  };\n\n  var createNS = function (n, o) {\n    var i, v;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0; i < n.length; i++) {\n      v = n[i];\n\n      if (!o[v]) {\n        o[v] = {};\n      }\n\n      o = o[v];\n    }\n\n    return o;\n  };\n\n  var resolve$3 = function (n, o) {\n    var i, l;\n    o = o || window;\n    n = n.split('.');\n\n    for (i = 0, l = n.length; i < l; i++) {\n      o = o[n[i]];\n\n      if (!o) {\n        break;\n      }\n    }\n\n    return o;\n  };\n\n  var explode$4 = function (s, d) {\n    if (!s || is$3(s, 'array')) {\n      return s;\n    }\n\n    return map$1(s.split(d || ','), trim$3);\n  };\n\n  var _addCacheSuffix = function (url) {\n    var cacheSuffix = Env.cacheSuffix;\n\n    if (cacheSuffix) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n    }\n\n    return url;\n  };\n\n  var Tools = {\n    trim: trim$3,\n    isArray: isArray,\n    is: is$3,\n    toArray: toArray$1,\n    makeMap: makeMap$4,\n    each: each$i,\n    map: map$1,\n    grep: filter$2,\n    inArray: indexOf$1,\n    hasOwn: hasOwnProperty,\n    extend: extend$6,\n    create: create$9,\n    walk: walk$3,\n    createNS: createNS,\n    resolve: resolve$3,\n    explode: explode$4,\n    _addCacheSuffix: _addCacheSuffix\n  };\n\n  var fromHtml$1 = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n\n    if (!div.hasChildNodes() || div.childNodes.length > 1) {\n      console.error('HTML does not have a single root node', html);\n      throw new Error('HTML must have a single root node');\n    }\n\n    return fromDom$2(div.childNodes[0]);\n  };\n\n  var fromTag = function (tag, scope) {\n    var doc = scope || document;\n    var node = doc.createElement(tag);\n    return fromDom$2(node);\n  };\n\n  var fromText = function (text, scope) {\n    var doc = scope || document;\n    var node = doc.createTextNode(text);\n    return fromDom$2(node);\n  };\n\n  var fromDom$2 = function (node) {\n    if (node === null || node === undefined) {\n      throw new Error('Node cannot be null or undefined');\n    }\n\n    return {\n      dom: node\n    };\n  };\n\n  var fromPoint$1 = function (docElm, x, y) {\n    return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom$2);\n  };\n\n  var SugarElement = {\n    fromHtml: fromHtml$1,\n    fromTag: fromTag,\n    fromText: fromText,\n    fromDom: fromDom$2,\n    fromPoint: fromPoint$1\n  };\n\n  var toArray = function (target, f) {\n    var r = [];\n\n    var recurse = function (e) {\n      r.push(e);\n      return f(e);\n    };\n\n    var cur = f(target);\n\n    do {\n      cur = cur.bind(recurse);\n    } while (cur.isSome());\n\n    return r;\n  };\n\n  var compareDocumentPosition = function (a, b, match) {\n    return (a.compareDocumentPosition(b) & match) !== 0;\n  };\n\n  var documentPositionContainedBy = function (a, b) {\n    return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n  };\n\n  var COMMENT = 8;\n  var DOCUMENT = 9;\n  var DOCUMENT_FRAGMENT = 11;\n  var ELEMENT = 1;\n  var TEXT = 3;\n\n  var is$2 = function (element, selector) {\n    var dom = element.dom;\n\n    if (dom.nodeType !== ELEMENT) {\n      return false;\n    } else {\n      var elem = dom;\n\n      if (elem.matches !== undefined) {\n        return elem.matches(selector);\n      } else if (elem.msMatchesSelector !== undefined) {\n        return elem.msMatchesSelector(selector);\n      } else if (elem.webkitMatchesSelector !== undefined) {\n        return elem.webkitMatchesSelector(selector);\n      } else if (elem.mozMatchesSelector !== undefined) {\n        return elem.mozMatchesSelector(selector);\n      } else {\n        throw new Error('Browser lacks native selectors');\n      }\n    }\n  };\n\n  var bypassSelector = function (dom) {\n    return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n  };\n\n  var all = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? [] : map$3(base.querySelectorAll(selector), SugarElement.fromDom);\n  };\n\n  var one = function (selector, scope) {\n    var base = scope === undefined ? document : scope.dom;\n    return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n  };\n\n  var eq = function (e1, e2) {\n    return e1.dom === e2.dom;\n  };\n\n  var regularContains = function (e1, e2) {\n    var d1 = e1.dom;\n    var d2 = e2.dom;\n    return d1 === d2 ? false : d1.contains(d2);\n  };\n\n  var ieContains = function (e1, e2) {\n    return documentPositionContainedBy(e1.dom, e2.dom);\n  };\n\n  var contains$1 = function (e1, e2) {\n    return detect().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n  };\n\n  typeof window !== 'undefined' ? window : Function('return this;')();\n\n  var name = function (element) {\n    var r = element.dom.nodeName;\n    return r.toLowerCase();\n  };\n\n  var type = function (element) {\n    return element.dom.nodeType;\n  };\n\n  var isType = function (t) {\n    return function (element) {\n      return type(element) === t;\n    };\n  };\n\n  var isComment$1 = function (element) {\n    return type(element) === COMMENT || name(element) === '#comment';\n  };\n\n  var isElement$6 = isType(ELEMENT);\n  var isText$8 = isType(TEXT);\n  var isDocument$2 = isType(DOCUMENT);\n  var isDocumentFragment$1 = isType(DOCUMENT_FRAGMENT);\n\n  var isTag = function (tag) {\n    return function (e) {\n      return isElement$6(e) && name(e) === tag;\n    };\n  };\n\n  var owner$1 = function (element) {\n    return SugarElement.fromDom(element.dom.ownerDocument);\n  };\n\n  var documentOrOwner = function (dos) {\n    return isDocument$2(dos) ? dos : owner$1(dos);\n  };\n\n  var documentElement = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n  };\n\n  var defaultView = function (element) {\n    return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n  };\n\n  var parent = function (element) {\n    return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n  };\n\n  var parents$1 = function (element, isRoot) {\n    var stop = isFunction(isRoot) ? isRoot : never;\n    var dom = element.dom;\n    var ret = [];\n\n    while (dom.parentNode !== null && dom.parentNode !== undefined) {\n      var rawParent = dom.parentNode;\n      var p = SugarElement.fromDom(rawParent);\n      ret.push(p);\n\n      if (stop(p) === true) {\n        break;\n      } else {\n        dom = rawParent;\n      }\n    }\n\n    return ret;\n  };\n\n  var siblings = function (element) {\n    var filterSelf = function (elements) {\n      return filter$4(elements, function (x) {\n        return !eq(element, x);\n      });\n    };\n\n    return parent(element).map(children).map(filterSelf).getOr([]);\n  };\n\n  var prevSibling = function (element) {\n    return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n  };\n\n  var nextSibling = function (element) {\n    return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n  };\n\n  var prevSiblings = function (element) {\n    return reverse(toArray(element, prevSibling));\n  };\n\n  var nextSiblings = function (element) {\n    return toArray(element, nextSibling);\n  };\n\n  var children = function (element) {\n    return map$3(element.dom.childNodes, SugarElement.fromDom);\n  };\n\n  var child$1 = function (element, index) {\n    var cs = element.dom.childNodes;\n    return Optional.from(cs[index]).map(SugarElement.fromDom);\n  };\n\n  var firstChild = function (element) {\n    return child$1(element, 0);\n  };\n\n  var lastChild = function (element) {\n    return child$1(element, element.dom.childNodes.length - 1);\n  };\n\n  var childNodesCount = function (element) {\n    return element.dom.childNodes.length;\n  };\n\n  var getHead = function (doc) {\n    var b = doc.dom.head;\n\n    if (b === null || b === undefined) {\n      throw new Error('Head is not available yet');\n    }\n\n    return SugarElement.fromDom(b);\n  };\n\n  var isShadowRoot = function (dos) {\n    return isDocumentFragment$1(dos) && isNonNullable(dos.dom.host);\n  };\n\n  var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n  var isSupported$1 = constant(supported);\n  var getRootNode = supported ? function (e) {\n    return SugarElement.fromDom(e.dom.getRootNode());\n  } : documentOrOwner;\n\n  var getStyleContainer = function (dos) {\n    return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n  };\n\n  var getShadowRoot = function (e) {\n    var r = getRootNode(e);\n    return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n  };\n\n  var getShadowHost = function (e) {\n    return SugarElement.fromDom(e.dom.host);\n  };\n\n  var getOriginalEventTarget = function (event) {\n    if (isSupported$1() && isNonNullable(event.target)) {\n      var el = SugarElement.fromDom(event.target);\n\n      if (isElement$6(el) && isOpenShadowHost(el)) {\n        if (event.composed && event.composedPath) {\n          var composedPath = event.composedPath();\n\n          if (composedPath) {\n            return head(composedPath);\n          }\n        }\n      }\n    }\n\n    return Optional.from(event.target);\n  };\n\n  var isOpenShadowHost = function (element) {\n    return isNonNullable(element.dom.shadowRoot);\n  };\n\n  var before$4 = function (marker, element) {\n    var parent$1 = parent(marker);\n    parent$1.each(function (v) {\n      v.dom.insertBefore(element.dom, marker.dom);\n    });\n  };\n\n  var after$3 = function (marker, element) {\n    var sibling = nextSibling(marker);\n    sibling.fold(function () {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        append$1(v, element);\n      });\n    }, function (v) {\n      before$4(v, element);\n    });\n  };\n\n  var prepend = function (parent, element) {\n    var firstChild$1 = firstChild(parent);\n    firstChild$1.fold(function () {\n      append$1(parent, element);\n    }, function (v) {\n      parent.dom.insertBefore(element.dom, v.dom);\n    });\n  };\n\n  var append$1 = function (parent, element) {\n    parent.dom.appendChild(element.dom);\n  };\n\n  var wrap$3 = function (element, wrapper) {\n    before$4(element, wrapper);\n    append$1(wrapper, element);\n  };\n\n  var before$3 = function (marker, elements) {\n    each$k(elements, function (x) {\n      before$4(marker, x);\n    });\n  };\n\n  var append = function (parent, elements) {\n    each$k(elements, function (x) {\n      append$1(parent, x);\n    });\n  };\n\n  var empty = function (element) {\n    element.dom.textContent = '';\n    each$k(children(element), function (rogue) {\n      remove$7(rogue);\n    });\n  };\n\n  var remove$7 = function (element) {\n    var dom = element.dom;\n\n    if (dom.parentNode !== null) {\n      dom.parentNode.removeChild(dom);\n    }\n  };\n\n  var unwrap = function (wrapper) {\n    var children$1 = children(wrapper);\n\n    if (children$1.length > 0) {\n      before$3(wrapper, children$1);\n    }\n\n    remove$7(wrapper);\n  };\n\n  var inBody = function (element) {\n    var dom = isText$8(element) ? element.dom.parentNode : element.dom;\n\n    if (dom === undefined || dom === null || dom.ownerDocument === null) {\n      return false;\n    }\n\n    var doc = dom.ownerDocument;\n    return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n      return doc.body.contains(dom);\n    }, compose1(inBody, getShadowHost));\n  };\n\n  var r = function (left, top) {\n    var translate = function (x, y) {\n      return r(left + x, top + y);\n    };\n\n    return {\n      left: left,\n      top: top,\n      translate: translate\n    };\n  };\n\n  var SugarPosition = r;\n\n  var boxPosition = function (dom) {\n    var box = dom.getBoundingClientRect();\n    return SugarPosition(box.left, box.top);\n  };\n\n  var firstDefinedOrZero = function (a, b) {\n    if (a !== undefined) {\n      return a;\n    } else {\n      return b !== undefined ? b : 0;\n    }\n  };\n\n  var absolute = function (element) {\n    var doc = element.dom.ownerDocument;\n    var body = doc.body;\n    var win = doc.defaultView;\n    var html = doc.documentElement;\n\n    if (body === element.dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n    var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n    var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n    var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n    return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n  };\n\n  var viewport = function (element) {\n    var dom = element.dom;\n    var doc = dom.ownerDocument;\n    var body = doc.body;\n\n    if (body === dom) {\n      return SugarPosition(body.offsetLeft, body.offsetTop);\n    }\n\n    if (!inBody(element)) {\n      return SugarPosition(0, 0);\n    }\n\n    return boxPosition(dom);\n  };\n\n  var get$8 = function (_DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n    var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n    return SugarPosition(x, y);\n  };\n\n  var to = function (x, y, _DOC) {\n    var doc = _DOC !== undefined ? _DOC.dom : document;\n    var win = doc.defaultView;\n\n    if (win) {\n      win.scrollTo(x, y);\n    }\n  };\n\n  var intoView = function (element, alignToTop) {\n    var isSafari = detect().browser.isSafari();\n\n    if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n      element.dom.scrollIntoViewIfNeeded(false);\n    } else {\n      element.dom.scrollIntoView(alignToTop);\n    }\n  };\n\n  var get$7 = function (_win) {\n    var win = _win === undefined ? window : _win;\n\n    if (detect().browser.isFirefox()) {\n      return Optional.none();\n    } else {\n      return Optional.from(win['visualViewport']);\n    }\n  };\n\n  var bounds = function (x, y, width, height) {\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height,\n      right: x + width,\n      bottom: y + height\n    };\n  };\n\n  var getBounds = function (_win) {\n    var win = _win === undefined ? window : _win;\n    var doc = win.document;\n    var scroll = get$8(SugarElement.fromDom(doc));\n    return get$7(win).fold(function () {\n      var html = win.document.documentElement;\n      var width = html.clientWidth;\n      var height = html.clientHeight;\n      return bounds(scroll.left, scroll.top, width, height);\n    }, function (visualViewport) {\n      return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n    });\n  };\n\n  var isNodeType = function (type) {\n    return function (node) {\n      return !!node && node.nodeType === type;\n    };\n  };\n\n  var isRestrictedNode = function (node) {\n    return !!node && !Object.getPrototypeOf(node);\n  };\n\n  var isElement$5 = isNodeType(1);\n\n  var matchNodeNames = function (names) {\n    var lowercasedNames = names.map(function (s) {\n      return s.toLowerCase();\n    });\n    return function (node) {\n      if (node && node.nodeName) {\n        var nodeName = node.nodeName.toLowerCase();\n        return contains$3(lowercasedNames, nodeName);\n      }\n\n      return false;\n    };\n  };\n\n  var matchStyleValues = function (name, values) {\n    var items = values.toLowerCase().split(' ');\n    return function (node) {\n      if (isElement$5(node)) {\n        for (var i = 0; i < items.length; i++) {\n          var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n          var cssValue = computed ? computed.getPropertyValue(name) : null;\n\n          if (cssValue === items[i]) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var hasAttribute = function (attrName) {\n    return function (node) {\n      return isElement$5(node) && node.hasAttribute(attrName);\n    };\n  };\n\n  var hasAttributeValue = function (attrName, attrValue) {\n    return function (node) {\n      return isElement$5(node) && node.getAttribute(attrName) === attrValue;\n    };\n  };\n\n  var isBogus$2 = function (node) {\n    return isElement$5(node) && node.hasAttribute('data-mce-bogus');\n  };\n\n  var isBogusAll$1 = function (node) {\n    return isElement$5(node) && node.getAttribute('data-mce-bogus') === 'all';\n  };\n\n  var isTable$3 = function (node) {\n    return isElement$5(node) && node.tagName === 'TABLE';\n  };\n\n  var hasContentEditableState = function (value) {\n    return function (node) {\n      if (isElement$5(node)) {\n        if (node.contentEditable === value) {\n          return true;\n        }\n\n        if (node.getAttribute('data-mce-contenteditable') === value) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var isTextareaOrInput = matchNodeNames(['textarea', 'input']);\n  var isText$7 = isNodeType(3);\n  var isComment = isNodeType(8);\n  var isDocument$1 = isNodeType(9);\n  var isDocumentFragment = isNodeType(11);\n  var isBr$5 = matchNodeNames(['br']);\n  var isImg = matchNodeNames(['img']);\n  var isContentEditableTrue$4 = hasContentEditableState('true');\n  var isContentEditableFalse$b = hasContentEditableState('false');\n  var isTableCell$5 = matchNodeNames(['td', 'th']);\n  var isMedia$2 = matchNodeNames(['video', 'audio', 'object', 'embed']);\n\n  var is$1 = function (lhs, rhs, comparator) {\n    if (comparator === void 0) {\n      comparator = tripleEquals;\n    }\n\n    return lhs.exists(function (left) {\n      return comparator(left, rhs);\n    });\n  };\n\n  var cat = function (arr) {\n    var r = [];\n\n    var push = function (x) {\n      r.push(x);\n    };\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i].each(push);\n    }\n\n    return r;\n  };\n\n  var lift2 = function (oa, ob, f) {\n    return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n  };\n\n  var lift3 = function (oa, ob, oc, f) {\n    return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n  };\n\n  var someIf = function (b, a) {\n    return b ? Optional.some(a) : Optional.none();\n  };\n\n  var isSupported = function (dom) {\n    return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n  };\n\n  var rawSet = function (dom, key, value) {\n    if (isString$1(value) || isBoolean(value) || isNumber(value)) {\n      dom.setAttribute(key, value + '');\n    } else {\n      console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n      throw new Error('Attribute value was not simple');\n    }\n  };\n\n  var set$1 = function (element, key, value) {\n    rawSet(element.dom, key, value);\n  };\n\n  var setAll$1 = function (element, attrs) {\n    var dom = element.dom;\n    each$j(attrs, function (v, k) {\n      rawSet(dom, k, v);\n    });\n  };\n\n  var get$6 = function (element, key) {\n    var v = element.dom.getAttribute(key);\n    return v === null ? undefined : v;\n  };\n\n  var getOpt = function (element, key) {\n    return Optional.from(get$6(element, key));\n  };\n\n  var has$1 = function (element, key) {\n    var dom = element.dom;\n    return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n  };\n\n  var remove$6 = function (element, key) {\n    element.dom.removeAttribute(key);\n  };\n\n  var clone$3 = function (element) {\n    return foldl(element.dom.attributes, function (acc, attr) {\n      acc[attr.name] = attr.value;\n      return acc;\n    }, {});\n  };\n\n  var internalSet = function (dom, property, value) {\n    if (!isString$1(value)) {\n      console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n      throw new Error('CSS value must be a string: ' + value);\n    }\n\n    if (isSupported(dom)) {\n      dom.style.setProperty(property, value);\n    }\n  };\n\n  var setAll = function (element, css) {\n    var dom = element.dom;\n    each$j(css, function (v, k) {\n      internalSet(dom, k, v);\n    });\n  };\n\n  var get$5 = function (element, property) {\n    var dom = element.dom;\n    var styles = window.getComputedStyle(dom);\n    var r = styles.getPropertyValue(property);\n    return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n  };\n\n  var getUnsafeProperty = function (dom, property) {\n    return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n  };\n\n  var getRaw = function (element, property) {\n    var dom = element.dom;\n    var raw = getUnsafeProperty(dom, property);\n    return Optional.from(raw).filter(function (r) {\n      return r.length > 0;\n    });\n  };\n\n  var getAllRaw = function (element) {\n    var css = {};\n    var dom = element.dom;\n\n    if (isSupported(dom)) {\n      for (var i = 0; i < dom.style.length; i++) {\n        var ruleName = dom.style.item(i);\n        css[ruleName] = dom.style[ruleName];\n      }\n    }\n\n    return css;\n  };\n\n  var reflow = function (e) {\n    return e.dom.offsetWidth;\n  };\n\n  var browser$3 = detect().browser;\n\n  var firstElement = function (nodes) {\n    return find$3(nodes, isElement$6);\n  };\n\n  var getTableCaptionDeltaY = function (elm) {\n    if (browser$3.isFirefox() && name(elm) === 'table') {\n      return firstElement(children(elm)).filter(function (elm) {\n        return name(elm) === 'caption';\n      }).bind(function (caption) {\n        return firstElement(nextSiblings(caption)).map(function (body) {\n          var bodyTop = body.dom.offsetTop;\n          var captionTop = caption.dom.offsetTop;\n          var captionHeight = caption.dom.offsetHeight;\n          return bodyTop <= captionTop ? -captionHeight : 0;\n        });\n      }).getOr(0);\n    } else {\n      return 0;\n    }\n  };\n\n  var hasChild = function (elm, child) {\n    return elm.children && contains$3(elm.children, child);\n  };\n\n  var getPos = function (body, elm, rootElm) {\n    var x = 0,\n        y = 0;\n    var doc = body.ownerDocument;\n    rootElm = rootElm ? rootElm : body;\n\n    if (elm) {\n      if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n        var pos = elm.getBoundingClientRect();\n        x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n        y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n        return {\n          x: x,\n          y: y\n        };\n      }\n\n      var offsetParent = elm;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        var castOffsetParent = offsetParent;\n        x += castOffsetParent.offsetLeft || 0;\n        y += castOffsetParent.offsetTop || 0;\n        offsetParent = castOffsetParent.offsetParent;\n      }\n\n      offsetParent = elm.parentNode;\n\n      while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n        x -= offsetParent.scrollLeft || 0;\n        y -= offsetParent.scrollTop || 0;\n        offsetParent = offsetParent.parentNode;\n      }\n\n      y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n    }\n\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var exports$1 = {},\n      module$1 = {\n    exports: exports$1\n  };\n\n  (function (define, exports, module, require) {\n    (function (global, factory) {\n      typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.EphoxContactWrapper = factory());\n    })(this, function () {\n      var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n      var promise = {\n        exports: {}\n      };\n\n      (function (module) {\n        (function (root) {\n          var setTimeoutFunc = setTimeout;\n\n          function noop() {}\n\n          function bind(fn, thisArg) {\n            return function () {\n              fn.apply(thisArg, arguments);\n            };\n          }\n\n          function Promise(fn) {\n            if (typeof this !== 'object') throw new TypeError('Promises must be constructed via new');\n            if (typeof fn !== 'function') throw new TypeError('not a function');\n            this._state = 0;\n            this._handled = false;\n            this._value = undefined;\n            this._deferreds = [];\n            doResolve(fn, this);\n          }\n\n          function handle(self, deferred) {\n            while (self._state === 3) {\n              self = self._value;\n            }\n\n            if (self._state === 0) {\n              self._deferreds.push(deferred);\n\n              return;\n            }\n\n            self._handled = true;\n\n            Promise._immediateFn(function () {\n              var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n\n              if (cb === null) {\n                (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                return;\n              }\n\n              var ret;\n\n              try {\n                ret = cb(self._value);\n              } catch (e) {\n                reject(deferred.promise, e);\n                return;\n              }\n\n              resolve(deferred.promise, ret);\n            });\n          }\n\n          function resolve(self, newValue) {\n            try {\n              if (newValue === self) throw new TypeError('A promise cannot be resolved with itself.');\n\n              if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                var then = newValue.then;\n\n                if (newValue instanceof Promise) {\n                  self._state = 3;\n                  self._value = newValue;\n                  finale(self);\n                  return;\n                } else if (typeof then === 'function') {\n                  doResolve(bind(then, newValue), self);\n                  return;\n                }\n              }\n\n              self._state = 1;\n              self._value = newValue;\n              finale(self);\n            } catch (e) {\n              reject(self, e);\n            }\n          }\n\n          function reject(self, newValue) {\n            self._state = 2;\n            self._value = newValue;\n            finale(self);\n          }\n\n          function finale(self) {\n            if (self._state === 2 && self._deferreds.length === 0) {\n              Promise._immediateFn(function () {\n                if (!self._handled) {\n                  Promise._unhandledRejectionFn(self._value);\n                }\n              });\n            }\n\n            for (var i = 0, len = self._deferreds.length; i < len; i++) {\n              handle(self, self._deferreds[i]);\n            }\n\n            self._deferreds = null;\n          }\n\n          function Handler(onFulfilled, onRejected, promise) {\n            this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n            this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n            this.promise = promise;\n          }\n\n          function doResolve(fn, self) {\n            var done = false;\n\n            try {\n              fn(function (value) {\n                if (done) return;\n                done = true;\n                resolve(self, value);\n              }, function (reason) {\n                if (done) return;\n                done = true;\n                reject(self, reason);\n              });\n            } catch (ex) {\n              if (done) return;\n              done = true;\n              reject(self, ex);\n            }\n          }\n\n          Promise.prototype['catch'] = function (onRejected) {\n            return this.then(null, onRejected);\n          };\n\n          Promise.prototype.then = function (onFulfilled, onRejected) {\n            var prom = new this.constructor(noop);\n            handle(this, new Handler(onFulfilled, onRejected, prom));\n            return prom;\n          };\n\n          Promise.all = function (arr) {\n            var args = Array.prototype.slice.call(arr);\n            return new Promise(function (resolve, reject) {\n              if (args.length === 0) return resolve([]);\n              var remaining = args.length;\n\n              function res(i, val) {\n                try {\n                  if (val && (typeof val === 'object' || typeof val === 'function')) {\n                    var then = val.then;\n\n                    if (typeof then === 'function') {\n                      then.call(val, function (val) {\n                        res(i, val);\n                      }, reject);\n                      return;\n                    }\n                  }\n\n                  args[i] = val;\n\n                  if (--remaining === 0) {\n                    resolve(args);\n                  }\n                } catch (ex) {\n                  reject(ex);\n                }\n              }\n\n              for (var i = 0; i < args.length; i++) {\n                res(i, args[i]);\n              }\n            });\n          };\n\n          Promise.resolve = function (value) {\n            if (value && typeof value === 'object' && value.constructor === Promise) {\n              return value;\n            }\n\n            return new Promise(function (resolve) {\n              resolve(value);\n            });\n          };\n\n          Promise.reject = function (value) {\n            return new Promise(function (resolve, reject) {\n              reject(value);\n            });\n          };\n\n          Promise.race = function (values) {\n            return new Promise(function (resolve, reject) {\n              for (var i = 0, len = values.length; i < len; i++) {\n                values[i].then(resolve, reject);\n              }\n            });\n          };\n\n          Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n            setImmediate(fn);\n          } : function (fn) {\n            setTimeoutFunc(fn, 0);\n          };\n\n          Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n            if (typeof console !== 'undefined' && console) {\n              console.warn('Possible Unhandled Promise Rejection:', err);\n            }\n          };\n\n          Promise._setImmediateFn = function _setImmediateFn(fn) {\n            Promise._immediateFn = fn;\n          };\n\n          Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n            Promise._unhandledRejectionFn = fn;\n          };\n\n          if (module.exports) {\n            module.exports = Promise;\n          } else if (!root.Promise) {\n            root.Promise = Promise;\n          }\n        })(commonjsGlobal);\n      })(promise);\n\n      var promisePolyfill = promise.exports;\n\n      var Global = function () {\n        if (typeof window !== 'undefined') {\n          return window;\n        } else {\n          return Function('return this;')();\n        }\n      }();\n\n      var promisePolyfill_1 = {\n        boltExport: Global.Promise || promisePolyfill\n      };\n      return promisePolyfill_1;\n    });\n  })(undefined, exports$1, module$1);\n\n  var Promise$1 = module$1.exports.boltExport;\n\n  var nu$1 = function (baseFn) {\n    var data = Optional.none();\n    var callbacks = [];\n\n    var map = function (f) {\n      return nu$1(function (nCallback) {\n        get(function (data) {\n          nCallback(f(data));\n        });\n      });\n    };\n\n    var get = function (nCallback) {\n      if (isReady()) {\n        call(nCallback);\n      } else {\n        callbacks.push(nCallback);\n      }\n    };\n\n    var set = function (x) {\n      if (!isReady()) {\n        data = Optional.some(x);\n        run(callbacks);\n        callbacks = [];\n      }\n    };\n\n    var isReady = function () {\n      return data.isSome();\n    };\n\n    var run = function (cbs) {\n      each$k(cbs, call);\n    };\n\n    var call = function (cb) {\n      data.each(function (x) {\n        setTimeout(function () {\n          cb(x);\n        }, 0);\n      });\n    };\n\n    baseFn(set);\n    return {\n      get: get,\n      map: map,\n      isReady: isReady\n    };\n  };\n\n  var pure$1 = function (a) {\n    return nu$1(function (callback) {\n      callback(a);\n    });\n  };\n\n  var LazyValue = {\n    nu: nu$1,\n    pure: pure$1\n  };\n\n  var errorReporter = function (err) {\n    setTimeout(function () {\n      throw err;\n    }, 0);\n  };\n\n  var make = function (run) {\n    var get = function (callback) {\n      run().then(callback, errorReporter);\n    };\n\n    var map = function (fab) {\n      return make(function () {\n        return run().then(fab);\n      });\n    };\n\n    var bind = function (aFutureB) {\n      return make(function () {\n        return run().then(function (v) {\n          return aFutureB(v).toPromise();\n        });\n      });\n    };\n\n    var anonBind = function (futureB) {\n      return make(function () {\n        return run().then(function () {\n          return futureB.toPromise();\n        });\n      });\n    };\n\n    var toLazy = function () {\n      return LazyValue.nu(get);\n    };\n\n    var toCached = function () {\n      var cache = null;\n      return make(function () {\n        if (cache === null) {\n          cache = run();\n        }\n\n        return cache;\n      });\n    };\n\n    var toPromise = run;\n    return {\n      map: map,\n      bind: bind,\n      anonBind: anonBind,\n      toLazy: toLazy,\n      toCached: toCached,\n      toPromise: toPromise,\n      get: get\n    };\n  };\n\n  var nu = function (baseFn) {\n    return make(function () {\n      return new Promise$1(baseFn);\n    });\n  };\n\n  var pure = function (a) {\n    return make(function () {\n      return Promise$1.resolve(a);\n    });\n  };\n\n  var Future = {\n    nu: nu,\n    pure: pure\n  };\n\n  var par$1 = function (asyncValues, nu) {\n    return nu(function (callback) {\n      var r = [];\n      var count = 0;\n\n      var cb = function (i) {\n        return function (value) {\n          r[i] = value;\n          count++;\n\n          if (count >= asyncValues.length) {\n            callback(r);\n          }\n        };\n      };\n\n      if (asyncValues.length === 0) {\n        callback([]);\n      } else {\n        each$k(asyncValues, function (asyncValue, i) {\n          asyncValue.get(cb(i));\n        });\n      }\n    });\n  };\n\n  var par = function (futures) {\n    return par$1(futures, Future.nu);\n  };\n\n  var value$1 = function (o) {\n    var or = function (_opt) {\n      return value$1(o);\n    };\n\n    var orThunk = function (_f) {\n      return value$1(o);\n    };\n\n    var map = function (f) {\n      return value$1(f(o));\n    };\n\n    var mapError = function (_f) {\n      return value$1(o);\n    };\n\n    var each = function (f) {\n      f(o);\n    };\n\n    var bind = function (f) {\n      return f(o);\n    };\n\n    var fold = function (_, onValue) {\n      return onValue(o);\n    };\n\n    var exists = function (f) {\n      return f(o);\n    };\n\n    var forall = function (f) {\n      return f(o);\n    };\n\n    var toOptional = function () {\n      return Optional.some(o);\n    };\n\n    return {\n      isValue: always,\n      isError: never,\n      getOr: constant(o),\n      getOrThunk: constant(o),\n      getOrDie: constant(o),\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: each,\n      bind: bind,\n      exists: exists,\n      forall: forall,\n      toOptional: toOptional\n    };\n  };\n\n  var error = function (message) {\n    var getOrThunk = function (f) {\n      return f();\n    };\n\n    var getOrDie = function () {\n      return die(String(message))();\n    };\n\n    var or = identity;\n\n    var orThunk = function (f) {\n      return f();\n    };\n\n    var map = function (_f) {\n      return error(message);\n    };\n\n    var mapError = function (f) {\n      return error(f(message));\n    };\n\n    var bind = function (_f) {\n      return error(message);\n    };\n\n    var fold = function (onError, _) {\n      return onError(message);\n    };\n\n    return {\n      isValue: never,\n      isError: always,\n      getOr: identity,\n      getOrThunk: getOrThunk,\n      getOrDie: getOrDie,\n      or: or,\n      orThunk: orThunk,\n      fold: fold,\n      map: map,\n      mapError: mapError,\n      each: noop,\n      bind: bind,\n      exists: never,\n      forall: always,\n      toOptional: Optional.none\n    };\n  };\n\n  var fromOption = function (opt, err) {\n    return opt.fold(function () {\n      return error(err);\n    }, value$1);\n  };\n\n  var Result = {\n    value: value$1,\n    error: error,\n    fromOption: fromOption\n  };\n\n  var generate$1 = function (cases) {\n    if (!isArray$1(cases)) {\n      throw new Error('cases must be an array');\n    }\n\n    if (cases.length === 0) {\n      throw new Error('there must be at least one case');\n    }\n\n    var constructors = [];\n    var adt = {};\n    each$k(cases, function (acase, count) {\n      var keys$1 = keys(acase);\n\n      if (keys$1.length !== 1) {\n        throw new Error('one and only one name per case');\n      }\n\n      var key = keys$1[0];\n      var value = acase[key];\n\n      if (adt[key] !== undefined) {\n        throw new Error('duplicate key detected:' + key);\n      } else if (key === 'cata') {\n        throw new Error('cannot have a case named cata (sorry)');\n      } else if (!isArray$1(value)) {\n        throw new Error('case arguments must be an array');\n      }\n\n      constructors.push(key);\n\n      adt[key] = function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        var argLength = args.length;\n\n        if (argLength !== value.length) {\n          throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n        }\n\n        var match = function (branches) {\n          var branchKeys = keys(branches);\n\n          if (constructors.length !== branchKeys.length) {\n            throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n          }\n\n          var allReqd = forall(constructors, function (reqKey) {\n            return contains$3(branchKeys, reqKey);\n          });\n\n          if (!allReqd) {\n            throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n          }\n\n          return branches[key].apply(null, args);\n        };\n\n        return {\n          fold: function () {\n            var foldArgs = [];\n\n            for (var _i = 0; _i < arguments.length; _i++) {\n              foldArgs[_i] = arguments[_i];\n            }\n\n            if (foldArgs.length !== cases.length) {\n              throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n            }\n\n            var target = foldArgs[count];\n            return target.apply(null, args);\n          },\n          match: match,\n          log: function (label) {\n            console.log(label, {\n              constructors: constructors,\n              constructor: key,\n              params: args\n            });\n          }\n        };\n      };\n    });\n    return adt;\n  };\n\n  var Adt = {\n    generate: generate$1\n  };\n  Adt.generate([{\n    bothErrors: ['error1', 'error2']\n  }, {\n    firstError: ['error1', 'value2']\n  }, {\n    secondError: ['value1', 'error2']\n  }, {\n    bothValues: ['value1', 'value2']\n  }]);\n\n  var unite = function (result) {\n    return result.fold(identity, identity);\n  };\n\n  function ClosestOrAncestor(is, ancestor, scope, a, isRoot) {\n    if (is(scope, a)) {\n      return Optional.some(scope);\n    } else if (isFunction(isRoot) && isRoot(scope)) {\n      return Optional.none();\n    } else {\n      return ancestor(scope, a, isRoot);\n    }\n  }\n\n  var ancestor$3 = function (scope, predicate, isRoot) {\n    var element = scope.dom;\n    var stop = isFunction(isRoot) ? isRoot : never;\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n\n      if (predicate(el)) {\n        return Optional.some(el);\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$3 = function (scope, predicate, isRoot) {\n    var is = function (s, test) {\n      return test(s);\n    };\n\n    return ClosestOrAncestor(is, ancestor$3, scope, predicate, isRoot);\n  };\n\n  var sibling$2 = function (scope, predicate) {\n    var element = scope.dom;\n\n    if (!element.parentNode) {\n      return Optional.none();\n    }\n\n    return child(SugarElement.fromDom(element.parentNode), function (x) {\n      return !eq(scope, x) && predicate(x);\n    });\n  };\n\n  var child = function (scope, predicate) {\n    var pred = function (node) {\n      return predicate(SugarElement.fromDom(node));\n    };\n\n    var result = find$3(scope.dom.childNodes, pred);\n    return result.map(SugarElement.fromDom);\n  };\n\n  var ancestor$2 = function (scope, selector, isRoot) {\n    return ancestor$3(scope, function (e) {\n      return is$2(e, selector);\n    }, isRoot);\n  };\n\n  var descendant = function (scope, selector) {\n    return one(selector, scope);\n  };\n\n  var closest$2 = function (scope, selector, isRoot) {\n    var is = function (element, selector) {\n      return is$2(element, selector);\n    };\n\n    return ClosestOrAncestor(is, ancestor$2, scope, selector, isRoot);\n  };\n\n  var promiseObj = window.Promise ? window.Promise : Promise$1;\n  var requestAnimationFramePromise;\n\n  var requestAnimationFrame = function (callback, element) {\n    var requestAnimationFrameFunc = window.requestAnimationFrame;\n    var vendors = ['ms', 'moz', 'webkit'];\n\n    var featurefill = function (cb) {\n      window.setTimeout(cb, 0);\n    };\n\n    for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n      requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n    }\n\n    if (!requestAnimationFrameFunc) {\n      requestAnimationFrameFunc = featurefill;\n    }\n\n    requestAnimationFrameFunc(callback, element);\n  };\n\n  var wrappedSetTimeout = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 0;\n    }\n\n    return setTimeout(callback, time);\n  };\n\n  var wrappedSetInterval = function (callback, time) {\n    if (typeof time !== 'number') {\n      time = 1;\n    }\n\n    return setInterval(callback, time);\n  };\n\n  var wrappedClearTimeout = function (id) {\n    return clearTimeout(id);\n  };\n\n  var wrappedClearInterval = function (id) {\n    return clearInterval(id);\n  };\n\n  var debounce = function (callback, time) {\n    var timer;\n\n    var func = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      clearTimeout(timer);\n      timer = wrappedSetTimeout(function () {\n        callback.apply(this, args);\n      }, time);\n    };\n\n    func.stop = function () {\n      clearTimeout(timer);\n    };\n\n    return func;\n  };\n\n  var Delay = {\n    requestAnimationFrame: function (callback, element) {\n      if (requestAnimationFramePromise) {\n        requestAnimationFramePromise.then(callback);\n        return;\n      }\n\n      requestAnimationFramePromise = new promiseObj(function (resolve) {\n        if (!element) {\n          element = document.body;\n        }\n\n        requestAnimationFrame(resolve, element);\n      }).then(callback);\n    },\n    setTimeout: wrappedSetTimeout,\n    setInterval: wrappedSetInterval,\n    setEditorTimeout: function (editor, callback, time) {\n      return wrappedSetTimeout(function () {\n        if (!editor.removed) {\n          callback();\n        }\n      }, time);\n    },\n    setEditorInterval: function (editor, callback, time) {\n      var timer = wrappedSetInterval(function () {\n        if (!editor.removed) {\n          callback();\n        } else {\n          clearInterval(timer);\n        }\n      }, time);\n      return timer;\n    },\n    debounce: debounce,\n    throttle: debounce,\n    clearInterval: wrappedClearInterval,\n    clearTimeout: wrappedClearTimeout\n  };\n\n  var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var idCount = 0;\n    var loadedStates = {};\n    var edos = SugarElement.fromDom(documentOrShadowRoot);\n    var doc = documentOrOwner(edos);\n    var maxLoadTime = settings.maxLoadTime || 5000;\n\n    var _setReferrerPolicy = function (referrerPolicy) {\n      settings.referrerPolicy = referrerPolicy;\n    };\n\n    var addStyle = function (element) {\n      append$1(getStyleContainer(edos), element);\n    };\n\n    var removeStyle = function (id) {\n      var styleContainer = getStyleContainer(edos);\n      descendant(styleContainer, '#' + id).each(remove$7);\n    };\n\n    var getOrCreateState = function (url) {\n      return get$9(loadedStates, url).getOrThunk(function () {\n        return {\n          id: 'mce-u' + idCount++,\n          passed: [],\n          failed: [],\n          count: 0\n        };\n      });\n    };\n\n    var load = function (url, success, failure) {\n      var link;\n\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      var state = getOrCreateState(urlWithSuffix);\n      loadedStates[urlWithSuffix] = state;\n      state.count++;\n\n      var resolve = function (callbacks, status) {\n        var i = callbacks.length;\n\n        while (i--) {\n          callbacks[i]();\n        }\n\n        state.status = status;\n        state.passed = [];\n        state.failed = [];\n\n        if (link) {\n          link.onload = null;\n          link.onerror = null;\n          link = null;\n        }\n      };\n\n      var passed = function () {\n        return resolve(state.passed, 2);\n      };\n\n      var failed = function () {\n        return resolve(state.failed, 3);\n      };\n\n      var wait = function (testCallback, waitCallback) {\n        if (!testCallback()) {\n          if (Date.now() - startTime < maxLoadTime) {\n            Delay.setTimeout(waitCallback);\n          } else {\n            failed();\n          }\n        }\n      };\n\n      var waitForWebKitLinkLoaded = function () {\n        wait(function () {\n          var styleSheets = documentOrShadowRoot.styleSheets;\n          var i = styleSheets.length;\n\n          while (i--) {\n            var styleSheet = styleSheets[i];\n            var owner = styleSheet.ownerNode;\n\n            if (owner && owner.id === link.id) {\n              passed();\n              return true;\n            }\n          }\n\n          return false;\n        }, waitForWebKitLinkLoaded);\n      };\n\n      if (success) {\n        state.passed.push(success);\n      }\n\n      if (failure) {\n        state.failed.push(failure);\n      }\n\n      if (state.status === 1) {\n        return;\n      }\n\n      if (state.status === 2) {\n        passed();\n        return;\n      }\n\n      if (state.status === 3) {\n        failed();\n        return;\n      }\n\n      state.status = 1;\n      var linkElem = SugarElement.fromTag('link', doc.dom);\n      setAll$1(linkElem, {\n        rel: 'stylesheet',\n        type: 'text/css',\n        id: state.id\n      });\n      var startTime = Date.now();\n\n      if (settings.contentCssCors) {\n        set$1(linkElem, 'crossOrigin', 'anonymous');\n      }\n\n      if (settings.referrerPolicy) {\n        set$1(linkElem, 'referrerpolicy', settings.referrerPolicy);\n      }\n\n      link = linkElem.dom;\n      link.onload = waitForWebKitLinkLoaded;\n      link.onerror = failed;\n      addStyle(linkElem);\n      set$1(linkElem, 'href', urlWithSuffix);\n    };\n\n    var loadF = function (url) {\n      return Future.nu(function (resolve) {\n        load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n      });\n    };\n\n    var loadAll = function (urls, success, failure) {\n      par(map$3(urls, loadF)).get(function (result) {\n        var parts = partition(result, function (r) {\n          return r.isValue();\n        });\n\n        if (parts.fail.length > 0) {\n          failure(parts.fail.map(unite));\n        } else {\n          success(parts.pass.map(unite));\n        }\n      });\n    };\n\n    var unload = function (url) {\n      var urlWithSuffix = Tools._addCacheSuffix(url);\n\n      get$9(loadedStates, urlWithSuffix).each(function (state) {\n        var count = --state.count;\n\n        if (count === 0) {\n          delete loadedStates[urlWithSuffix];\n          removeStyle(state.id);\n        }\n      });\n    };\n\n    var unloadAll = function (urls) {\n      each$k(urls, function (url) {\n        unload(url);\n      });\n    };\n\n    return {\n      load: load,\n      loadAll: loadAll,\n      unload: unload,\n      unloadAll: unloadAll,\n      _setReferrerPolicy: _setReferrerPolicy\n    };\n  };\n\n  var create$8 = function () {\n    var map = new WeakMap();\n\n    var forElement = function (referenceElement, settings) {\n      var root = getRootNode(referenceElement);\n      var rootDom = root.dom;\n      return Optional.from(map.get(rootDom)).getOrThunk(function () {\n        var sl = StyleSheetLoader(rootDom, settings);\n        map.set(rootDom, sl);\n        return sl;\n      });\n    };\n\n    return {\n      forElement: forElement\n    };\n  };\n\n  var instance = create$8();\n\n  var DomTreeWalker = function () {\n    function DomTreeWalker(startNode, rootNode) {\n      this.node = startNode;\n      this.rootNode = rootNode;\n      this.current = this.current.bind(this);\n      this.next = this.next.bind(this);\n      this.prev = this.prev.bind(this);\n      this.prev2 = this.prev2.bind(this);\n    }\n\n    DomTreeWalker.prototype.current = function () {\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.next = function (shallow) {\n      this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev = function (shallow) {\n      this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.prev2 = function (shallow) {\n      this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n      return this.node;\n    };\n\n    DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n      var sibling, parent;\n\n      if (node) {\n        if (!shallow && node[startName]) {\n          return node[startName];\n        }\n\n        if (node !== this.rootNode) {\n          sibling = node[siblingName];\n\n          if (sibling) {\n            return sibling;\n          }\n\n          for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n            sibling = parent[siblingName];\n\n            if (sibling) {\n              return sibling;\n            }\n          }\n        }\n      }\n    };\n\n    DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n      var sibling, parent, child;\n\n      if (node) {\n        sibling = node[siblingName];\n\n        if (this.rootNode && sibling === this.rootNode) {\n          return;\n        }\n\n        if (sibling) {\n          if (!shallow) {\n            for (child = sibling[startName]; child; child = child[startName]) {\n              if (!child[startName]) {\n                return child;\n              }\n            }\n          }\n\n          return sibling;\n        }\n\n        parent = node.parentNode;\n\n        if (parent && parent !== this.rootNode) {\n          return parent;\n        }\n      }\n    };\n\n    return DomTreeWalker;\n  }();\n\n  var blocks = ['article', 'aside', 'details', 'div', 'dt', 'figcaption', 'footer', 'form', 'fieldset', 'header', 'hgroup', 'html', 'main', 'nav', 'section', 'summary', 'body', 'p', 'dl', 'multicol', 'dd', 'figure', 'address', 'center', 'blockquote', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'listing', 'xmp', 'pre', 'plaintext', 'menu', 'dir', 'ul', 'ol', 'li', 'hr', 'table', 'tbody', 'thead', 'tfoot', 'th', 'tr', 'td', 'caption'];\n  var tableCells = ['td', 'th'];\n  var tableSections = ['thead', 'tbody', 'tfoot'];\n  var textBlocks = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'p', 'div', 'address', 'pre', 'form', 'blockquote', 'center', 'dir', 'fieldset', 'header', 'footer', 'article', 'section', 'hgroup', 'aside', 'nav', 'figure'];\n  var headings = ['h1', 'h2', 'h3', 'h4', 'h5', 'h6'];\n  var listItems$1 = ['li', 'dd', 'dt'];\n  var lists = ['ul', 'ol', 'dl'];\n  var wsElements = ['pre', 'script', 'textarea', 'style'];\n\n  var lazyLookup = function (items) {\n    var lookup;\n    return function (node) {\n      lookup = lookup ? lookup : mapToObject(items, always);\n      return has$2(lookup, name(node));\n    };\n  };\n\n  var isHeading = lazyLookup(headings);\n  var isBlock$2 = lazyLookup(blocks);\n\n  var isTable$2 = function (node) {\n    return name(node) === 'table';\n  };\n\n  var isInline$1 = function (node) {\n    return isElement$6(node) && !isBlock$2(node);\n  };\n\n  var isBr$4 = function (node) {\n    return isElement$6(node) && name(node) === 'br';\n  };\n\n  var isTextBlock$2 = lazyLookup(textBlocks);\n  var isList = lazyLookup(lists);\n  var isListItem = lazyLookup(listItems$1);\n  var isTableSection = lazyLookup(tableSections);\n  var isTableCell$4 = lazyLookup(tableCells);\n  var isWsPreserveElement = lazyLookup(wsElements);\n\n  var ancestor$1 = function (scope, selector, isRoot) {\n    return ancestor$2(scope, selector, isRoot).isSome();\n  };\n\n  var zeroWidth = '\\uFEFF';\n  var nbsp = '\\xA0';\n\n  var isZwsp$1 = function (char) {\n    return char === zeroWidth;\n  };\n\n  var removeZwsp = function (s) {\n    return s.replace(/\\uFEFF/g, '');\n  };\n\n  var ZWSP$1 = zeroWidth;\n  var isZwsp = isZwsp$1;\n  var trim$2 = removeZwsp;\n  var isElement$4 = isElement$5;\n  var isText$6 = isText$7;\n\n  var isCaretContainerBlock$1 = function (node) {\n    if (isText$6(node)) {\n      node = node.parentNode;\n    }\n\n    return isElement$4(node) && node.hasAttribute('data-mce-caret');\n  };\n\n  var isCaretContainerInline = function (node) {\n    return isText$6(node) && isZwsp(node.data);\n  };\n\n  var isCaretContainer$2 = function (node) {\n    return isCaretContainerBlock$1(node) || isCaretContainerInline(node);\n  };\n\n  var hasContent = function (node) {\n    return node.firstChild !== node.lastChild || !isBr$5(node.firstChild);\n  };\n\n  var insertInline$1 = function (node, before) {\n    var doc = node.ownerDocument;\n    var textNode = doc.createTextNode(ZWSP$1);\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      var sibling = node.nextSibling;\n\n      if (isText$6(sibling)) {\n        if (isCaretContainer$2(sibling)) {\n          return sibling;\n        }\n\n        if (startsWithCaretContainer$1(sibling)) {\n          sibling.splitText(1);\n          return sibling;\n        }\n      }\n\n      if (node.nextSibling) {\n        parentNode.insertBefore(textNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(textNode);\n      }\n    } else {\n      var sibling = node.previousSibling;\n\n      if (isText$6(sibling)) {\n        if (isCaretContainer$2(sibling)) {\n          return sibling;\n        }\n\n        if (endsWithCaretContainer$1(sibling)) {\n          return sibling.splitText(sibling.data.length - 1);\n        }\n      }\n\n      parentNode.insertBefore(textNode, node);\n    }\n\n    return textNode;\n  };\n\n  var isBeforeInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$7(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset()) === ZWSP$1 || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n  };\n\n  var isAfterInline = function (pos) {\n    var container = pos.container();\n\n    if (!isText$7(container)) {\n      return false;\n    }\n\n    return container.data.charAt(pos.offset() - 1) === ZWSP$1 || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n  };\n\n  var createBogusBr = function () {\n    var br = document.createElement('br');\n    br.setAttribute('data-mce-bogus', '1');\n    return br;\n  };\n\n  var insertBlock$1 = function (blockName, node, before) {\n    var doc = node.ownerDocument;\n    var blockNode = doc.createElement(blockName);\n    blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n    blockNode.setAttribute('data-mce-bogus', 'all');\n    blockNode.appendChild(createBogusBr());\n    var parentNode = node.parentNode;\n\n    if (!before) {\n      if (node.nextSibling) {\n        parentNode.insertBefore(blockNode, node.nextSibling);\n      } else {\n        parentNode.appendChild(blockNode);\n      }\n    } else {\n      parentNode.insertBefore(blockNode, node);\n    }\n\n    return blockNode;\n  };\n\n  var startsWithCaretContainer$1 = function (node) {\n    return isText$6(node) && node.data[0] === ZWSP$1;\n  };\n\n  var endsWithCaretContainer$1 = function (node) {\n    return isText$6(node) && node.data[node.data.length - 1] === ZWSP$1;\n  };\n\n  var trimBogusBr = function (elm) {\n    var brs = elm.getElementsByTagName('br');\n    var lastBr = brs[brs.length - 1];\n\n    if (isBogus$2(lastBr)) {\n      lastBr.parentNode.removeChild(lastBr);\n    }\n  };\n\n  var showCaretContainerBlock = function (caretContainer) {\n    if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n      trimBogusBr(caretContainer);\n      caretContainer.removeAttribute('data-mce-caret');\n      caretContainer.removeAttribute('data-mce-bogus');\n      caretContainer.removeAttribute('style');\n      caretContainer.removeAttribute('_moz_abspos');\n      return caretContainer;\n    }\n\n    return null;\n  };\n\n  var isRangeInCaretContainerBlock = function (range) {\n    return isCaretContainerBlock$1(range.startContainer);\n  };\n\n  var isContentEditableTrue$3 = isContentEditableTrue$4;\n  var isContentEditableFalse$a = isContentEditableFalse$b;\n  var isBr$3 = isBr$5;\n  var isText$5 = isText$7;\n  var isInvalidTextElement = matchNodeNames(['script', 'style', 'textarea']);\n  var isAtomicInline = matchNodeNames(['img', 'input', 'textarea', 'hr', 'iframe', 'video', 'audio', 'object', 'embed']);\n  var isTable$1 = matchNodeNames(['table']);\n  var isCaretContainer$1 = isCaretContainer$2;\n\n  var isCaretCandidate$3 = function (node) {\n    if (isCaretContainer$1(node)) {\n      return false;\n    }\n\n    if (isText$5(node)) {\n      return !isInvalidTextElement(node.parentNode);\n    }\n\n    return isAtomicInline(node) || isBr$3(node) || isTable$1(node) || isNonUiContentEditableFalse(node);\n  };\n\n  var isUnselectable = function (node) {\n    return isElement$5(node) && node.getAttribute('unselectable') === 'true';\n  };\n\n  var isNonUiContentEditableFalse = function (node) {\n    return isUnselectable(node) === false && isContentEditableFalse$a(node);\n  };\n\n  var isInEditable = function (node, root) {\n    for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n      if (isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n\n      if (isContentEditableTrue$3(node)) {\n        return true;\n      }\n    }\n\n    return true;\n  };\n\n  var isAtomicContentEditableFalse = function (node) {\n    if (!isNonUiContentEditableFalse(node)) {\n      return false;\n    }\n\n    return foldl(from(node.getElementsByTagName('*')), function (result, elm) {\n      return result || isContentEditableTrue$3(elm);\n    }, false) !== true;\n  };\n\n  var isAtomic$1 = function (node) {\n    return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n  };\n\n  var isEditableCaretCandidate$1 = function (node, root) {\n    return isCaretCandidate$3(node) && isInEditable(node, root);\n  };\n\n  var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n\n  var isWhitespaceText = function (text) {\n    return whiteSpaceRegExp$1.test(text);\n  };\n\n  var hasWhitespacePreserveParent = function (node, rootNode) {\n    var rootElement = SugarElement.fromDom(rootNode);\n    var startNode = SugarElement.fromDom(node);\n    return ancestor$1(startNode, 'pre,code', curry(eq, rootElement));\n  };\n\n  var isWhitespace = function (node, rootNode) {\n    return isText$7(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n  };\n\n  var isNamedAnchor = function (node) {\n    return isElement$5(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n  };\n\n  var isContent$1 = function (node, rootNode) {\n    return isCaretCandidate$3(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n  };\n\n  var isBookmark = hasAttribute('data-mce-bookmark');\n  var isBogus$1 = hasAttribute('data-mce-bogus');\n  var isBogusAll = hasAttributeValue('data-mce-bogus', 'all');\n\n  var isEmptyNode = function (targetNode, skipBogus) {\n    var brCount = 0;\n\n    if (isContent$1(targetNode, targetNode)) {\n      return false;\n    } else {\n      var node = targetNode.firstChild;\n\n      if (!node) {\n        return true;\n      }\n\n      var walker = new DomTreeWalker(node, targetNode);\n\n      do {\n        if (skipBogus) {\n          if (isBogusAll(node)) {\n            node = walker.next(true);\n            continue;\n          }\n\n          if (isBogus$1(node)) {\n            node = walker.next();\n            continue;\n          }\n        }\n\n        if (isBr$5(node)) {\n          brCount++;\n          node = walker.next();\n          continue;\n        }\n\n        if (isContent$1(node, targetNode)) {\n          return false;\n        }\n\n        node = walker.next();\n      } while (node);\n\n      return brCount <= 1;\n    }\n  };\n\n  var isEmpty$2 = function (elm, skipBogus) {\n    if (skipBogus === void 0) {\n      skipBogus = true;\n    }\n\n    return isEmptyNode(elm.dom, skipBogus);\n  };\n\n  var isSpan = function (node) {\n    return node.nodeName.toLowerCase() === 'span';\n  };\n\n  var isInlineContent = function (node, root) {\n    return isNonNullable(node) && (isContent$1(node, root) || isInline$1(SugarElement.fromDom(node)));\n  };\n\n  var surroundedByInlineContent = function (node, root) {\n    var prev = new DomTreeWalker(node, root).prev(false);\n    var next = new DomTreeWalker(node, root).next(false);\n    var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n    var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n    return prevIsInline && nextIsInline;\n  };\n\n  var isBookmarkNode$2 = function (node) {\n    return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var isKeepTextNode = function (node, root) {\n    return isText$7(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n  };\n\n  var isKeepElement = function (node) {\n    return isElement$5(node) ? node.childNodes.length > 0 : false;\n  };\n\n  var isDocument = function (node) {\n    return isDocumentFragment(node) || isDocument$1(node);\n  };\n\n  var trimNode = function (dom, node, root) {\n    var rootNode = root || node;\n\n    if (isElement$5(node) && isBookmarkNode$2(node)) {\n      return node;\n    }\n\n    var children = node.childNodes;\n\n    for (var i = children.length - 1; i >= 0; i--) {\n      trimNode(dom, children[i], rootNode);\n    }\n\n    if (isElement$5(node)) {\n      var currentChildren = node.childNodes;\n\n      if (currentChildren.length === 1 && isBookmarkNode$2(currentChildren[0])) {\n        node.parentNode.insertBefore(currentChildren[0], node);\n      }\n    }\n\n    if (!isDocument(node) && !isContent$1(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n      dom.remove(node);\n    }\n\n    return node;\n  };\n\n  var makeMap$3 = Tools.makeMap;\n  var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n  var rawCharsRegExp = /[<>&\\\"\\']/g;\n  var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n  var asciiMap = {\n    128: '\\u20AC',\n    130: '\\u201A',\n    131: '\\u0192',\n    132: '\\u201E',\n    133: '\\u2026',\n    134: '\\u2020',\n    135: '\\u2021',\n    136: '\\u02c6',\n    137: '\\u2030',\n    138: '\\u0160',\n    139: '\\u2039',\n    140: '\\u0152',\n    142: '\\u017d',\n    145: '\\u2018',\n    146: '\\u2019',\n    147: '\\u201C',\n    148: '\\u201D',\n    149: '\\u2022',\n    150: '\\u2013',\n    151: '\\u2014',\n    152: '\\u02DC',\n    153: '\\u2122',\n    154: '\\u0161',\n    155: '\\u203A',\n    156: '\\u0153',\n    158: '\\u017e',\n    159: '\\u0178'\n  };\n  var baseEntities = {\n    '\"': '&quot;',\n    '\\'': '&#39;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '&': '&amp;',\n    '`': '&#96;'\n  };\n  var reverseEntities = {\n    '&lt;': '<',\n    '&gt;': '>',\n    '&amp;': '&',\n    '&quot;': '\"',\n    '&apos;': '\\''\n  };\n\n  var nativeDecode = function (text) {\n    var elm = SugarElement.fromTag('div').dom;\n    elm.innerHTML = text;\n    return elm.textContent || elm.innerText || text;\n  };\n\n  var buildEntitiesLookup = function (items, radix) {\n    var i, chr, entity;\n    var lookup = {};\n\n    if (items) {\n      items = items.split(',');\n      radix = radix || 10;\n\n      for (i = 0; i < items.length; i += 2) {\n        chr = String.fromCharCode(parseInt(items[i], radix));\n\n        if (!baseEntities[chr]) {\n          entity = '&' + items[i + 1] + ';';\n          lookup[chr] = entity;\n          lookup[entity] = chr;\n        }\n      }\n\n      return lookup;\n    }\n  };\n\n  var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n\n  var encodeRaw = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeAllRaw = function (text) {\n    return ('' + text).replace(rawCharsRegExp, function (chr) {\n      return baseEntities[chr] || chr;\n    });\n  };\n\n  var encodeNumeric = function (text, attr) {\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      if (chr.length > 1) {\n        return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n      }\n\n      return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n    });\n  };\n\n  var encodeNamed = function (text, attr, entities) {\n    entities = entities || namedEntities;\n    return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n      return baseEntities[chr] || entities[chr] || chr;\n    });\n  };\n\n  var getEncodeFunc = function (name, entities) {\n    var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n\n    var encodeNamedAndNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (baseEntities[chr] !== undefined) {\n          return baseEntities[chr];\n        }\n\n        if (entitiesMap[chr] !== undefined) {\n          return entitiesMap[chr];\n        }\n\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n\n        return '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n\n    var encodeCustomNamed = function (text, attr) {\n      return encodeNamed(text, attr, entitiesMap);\n    };\n\n    var nameMap = makeMap$3(name.replace(/\\+/g, ','));\n\n    if (nameMap.named && nameMap.numeric) {\n      return encodeNamedAndNumeric;\n    }\n\n    if (nameMap.named) {\n      if (entities) {\n        return encodeCustomNamed;\n      }\n\n      return encodeNamed;\n    }\n\n    if (nameMap.numeric) {\n      return encodeNumeric;\n    }\n\n    return encodeRaw;\n  };\n\n  var decode = function (text) {\n    return text.replace(entityRegExp, function (all, numeric) {\n      if (numeric) {\n        if (numeric.charAt(0).toLowerCase() === 'x') {\n          numeric = parseInt(numeric.substr(1), 16);\n        } else {\n          numeric = parseInt(numeric, 10);\n        }\n\n        if (numeric > 65535) {\n          numeric -= 65536;\n          return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n        }\n\n        return asciiMap[numeric] || String.fromCharCode(numeric);\n      }\n\n      return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n    });\n  };\n\n  var Entities = {\n    encodeRaw: encodeRaw,\n    encodeAllRaw: encodeAllRaw,\n    encodeNumeric: encodeNumeric,\n    encodeNamed: encodeNamed,\n    getEncodeFunc: getEncodeFunc,\n    decode: decode\n  };\n  var mapCache = {},\n      dummyObj = {};\n  var makeMap$2 = Tools.makeMap,\n      each$h = Tools.each,\n      extend$5 = Tools.extend,\n      explode$3 = Tools.explode,\n      inArray$2 = Tools.inArray;\n\n  var split$1 = function (items, delim) {\n    items = Tools.trim(items);\n    return items ? items.split(delim || ' ') : [];\n  };\n\n  var compileSchema = function (type) {\n    var schema = {};\n    var globalAttributes, blockContent;\n    var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n\n    var add = function (name, attributes, children) {\n      var ni, attributesOrder, element;\n\n      var arrayToMap = function (array, obj) {\n        var map = {};\n        var i, l;\n\n        for (i = 0, l = array.length; i < l; i++) {\n          map[array[i]] = obj || {};\n        }\n\n        return map;\n      };\n\n      children = children || [];\n      attributes = attributes || '';\n\n      if (typeof children === 'string') {\n        children = split$1(children);\n      }\n\n      var names = split$1(name);\n      ni = names.length;\n\n      while (ni--) {\n        attributesOrder = split$1([globalAttributes, attributes].join(' '));\n        element = {\n          attributes: arrayToMap(attributesOrder),\n          attributesOrder: attributesOrder,\n          children: arrayToMap(children, dummyObj)\n        };\n        schema[names[ni]] = element;\n      }\n    };\n\n    var addAttrs = function (name, attributes) {\n      var ni, schemaItem, i, l;\n      var names = split$1(name);\n      ni = names.length;\n      var attrs = split$1(attributes);\n\n      while (ni--) {\n        schemaItem = schema[names[ni]];\n\n        for (i = 0, l = attrs.length; i < l; i++) {\n          schemaItem.attributes[attrs[i]] = {};\n          schemaItem.attributesOrder.push(attrs[i]);\n        }\n      }\n    };\n\n    if (mapCache[type]) {\n      return mapCache[type];\n    }\n\n    globalAttributes = 'id accesskey class dir lang style tabindex title role';\n    blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n    phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n\n    if (type !== 'html4') {\n      globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n      blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n      phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n    }\n\n    if (type !== 'html5-strict') {\n      globalAttributes += ' xml:lang';\n      html4PhrasingContent = 'acronym applet basefont big font strike tt';\n      phrasingContent = [phrasingContent, html4PhrasingContent].join(' ');\n      each$h(split$1(html4PhrasingContent), function (name) {\n        add(name, '', phrasingContent);\n      });\n      html4BlockContent = 'center dir isindex noframes';\n      blockContent = [blockContent, html4BlockContent].join(' ');\n      flowContent = [blockContent, phrasingContent].join(' ');\n      each$h(split$1(html4BlockContent), function (name) {\n        add(name, '', flowContent);\n      });\n    }\n\n    flowContent = flowContent || [blockContent, phrasingContent].join(' ');\n    add('html', 'manifest', 'head body');\n    add('head', '', 'base command link meta noscript script style title');\n    add('title hr noscript br');\n    add('base', 'href target');\n    add('link', 'href rel media hreflang type sizes hreflang');\n    add('meta', 'name http-equiv content charset');\n    add('style', 'media type scoped');\n    add('script', 'src async defer type charset');\n    add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n    add('address dt dd div caption', '', flowContent);\n    add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n    add('blockquote', 'cite', flowContent);\n    add('ol', 'reversed start type', 'li');\n    add('ul', '', 'li');\n    add('li', 'value', flowContent);\n    add('dl', '', 'dt dd');\n    add('a', 'href target rel media hreflang type', phrasingContent);\n    add('q', 'cite', phrasingContent);\n    add('ins del', 'cite datetime', flowContent);\n    add('img', 'src sizes srcset alt usemap ismap width height');\n    add('iframe', 'src name width height', flowContent);\n    add('embed', 'src type width height');\n    add('object', 'data type typemustmatch name usemap form width height', [flowContent, 'param'].join(' '));\n    add('param', 'name value');\n    add('map', 'name', [flowContent, 'area'].join(' '));\n    add('area', 'alt coords shape href target rel media hreflang type');\n    add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n    add('colgroup', 'span', 'col');\n    add('col', 'span');\n    add('tbody thead tfoot', '', 'tr');\n    add('tr', '', 'td th');\n    add('td', 'colspan rowspan headers', flowContent);\n    add('th', 'colspan rowspan headers scope abbr', flowContent);\n    add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n    add('fieldset', 'disabled form name', [flowContent, 'legend'].join(' '));\n    add('label', 'form for', phrasingContent);\n    add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n    add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n    add('select', 'disabled form multiple name required size', 'option optgroup');\n    add('optgroup', 'disabled label', 'option');\n    add('option', 'disabled label selected value');\n    add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n    add('menu', 'type label', [flowContent, 'li'].join(' '));\n    add('noscript', '', flowContent);\n\n    if (type !== 'html4') {\n      add('wbr');\n      add('ruby', '', [phrasingContent, 'rt rp'].join(' '));\n      add('figcaption', '', flowContent);\n      add('mark rt rp summary bdi', '', phrasingContent);\n      add('canvas', 'width height', flowContent);\n      add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [flowContent, 'track source'].join(' '));\n      add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [flowContent, 'track source'].join(' '));\n      add('picture', '', 'img source');\n      add('source', 'src srcset type media sizes');\n      add('track', 'kind src srclang label default');\n      add('datalist', '', [phrasingContent, 'option'].join(' '));\n      add('article section nav aside main header footer', '', flowContent);\n      add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n      add('figure', '', [flowContent, 'figcaption'].join(' '));\n      add('time', 'datetime', phrasingContent);\n      add('dialog', 'open', flowContent);\n      add('command', 'type label icon disabled checked radiogroup command');\n      add('output', 'for form name', phrasingContent);\n      add('progress', 'value max', phrasingContent);\n      add('meter', 'value min max low high optimum', phrasingContent);\n      add('details', 'open', [flowContent, 'summary'].join(' '));\n      add('keygen', 'autofocus challenge disabled form keytype name');\n    }\n\n    if (type !== 'html5-strict') {\n      addAttrs('script', 'language xml:space');\n      addAttrs('style', 'xml:space');\n      addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n      addAttrs('embed', 'align name hspace vspace');\n      addAttrs('param', 'valuetype type');\n      addAttrs('a', 'charset name rev shape coords');\n      addAttrs('br', 'clear');\n      addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n      addAttrs('img', 'name longdesc align border hspace vspace');\n      addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n      addAttrs('font basefont', 'size color face');\n      addAttrs('input', 'usemap align');\n      addAttrs('select');\n      addAttrs('textarea');\n      addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n      addAttrs('ul', 'type compact');\n      addAttrs('li', 'type');\n      addAttrs('ol dl menu dir', 'compact');\n      addAttrs('pre', 'width xml:space');\n      addAttrs('hr', 'align noshade size width');\n      addAttrs('isindex', 'prompt');\n      addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n      addAttrs('col', 'width align char charoff valign');\n      addAttrs('colgroup', 'width align char charoff valign');\n      addAttrs('thead', 'align char charoff valign');\n      addAttrs('tr', 'align char charoff valign bgcolor');\n      addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n      addAttrs('form', 'accept');\n      addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n      addAttrs('tfoot', 'align char charoff valign');\n      addAttrs('tbody', 'align char charoff valign');\n      addAttrs('area', 'nohref');\n      addAttrs('body', 'background bgcolor text link vlink alink');\n    }\n\n    if (type !== 'html4') {\n      addAttrs('input button select textarea', 'autofocus');\n      addAttrs('input textarea', 'placeholder');\n      addAttrs('a', 'download');\n      addAttrs('link script img', 'crossorigin');\n      addAttrs('img', 'loading');\n      addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n    }\n\n    each$h(split$1('a form meter progress dfn'), function (name) {\n      if (schema[name]) {\n        delete schema[name].children[name];\n      }\n    });\n    delete schema.caption.children.table;\n    delete schema.script;\n    mapCache[type] = schema;\n    return schema;\n  };\n\n  var compileElementMap = function (value, mode) {\n    var styles;\n\n    if (value) {\n      styles = {};\n\n      if (typeof value === 'string') {\n        value = {\n          '*': value\n        };\n      }\n\n      each$h(value, function (value, key) {\n        styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$3(value, /[, ]/);\n      });\n    }\n\n    return styles;\n  };\n\n  var Schema = function (settings) {\n    var elements = {};\n    var children = {};\n    var patternElements = [];\n    var customElementsMap = {},\n        specialElements = {};\n\n    var createLookupTable = function (option, defaultValue, extendWith) {\n      var value = settings[option];\n\n      if (!value) {\n        value = mapCache[option];\n\n        if (!value) {\n          value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n          value = extend$5(value, extendWith);\n          mapCache[option] = value;\n        }\n      } else {\n        value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n      }\n\n      return value;\n    };\n\n    settings = settings || {};\n    var schemaItems = compileSchema(settings.schema);\n\n    if (settings.verify_html === false) {\n      settings.valid_elements = '*[*]';\n    }\n\n    var validStyles = compileElementMap(settings.valid_styles);\n    var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n    var validClasses = compileElementMap(settings.valid_classes, 'map');\n    var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n    var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n    var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n    var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n    var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n    var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n    var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n    var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n    var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n    var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n    each$h((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n      specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n    });\n\n    var patternToRegExp = function (str) {\n      return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n    };\n\n    var addValidElements = function (validElements) {\n      var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n      var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/,\n          attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/,\n          hasPatternsRegExp = /[*?+]/;\n\n      if (validElements) {\n        var validElementsArr = split$1(validElements, ',');\n\n        if (elements['@']) {\n          globalAttributes = elements['@'].attributes;\n          globalAttributesOrder = elements['@'].attributesOrder;\n        }\n\n        for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n          matches = elementRuleRegExp.exec(validElementsArr[ei]);\n\n          if (matches) {\n            prefix = matches[1];\n            elementName = matches[2];\n            outputName = matches[3];\n            attrData = matches[5];\n            attributes = {};\n            attributesOrder = [];\n            element = {\n              attributes: attributes,\n              attributesOrder: attributesOrder\n            };\n\n            if (prefix === '#') {\n              element.paddEmpty = true;\n            }\n\n            if (prefix === '-') {\n              element.removeEmpty = true;\n            }\n\n            if (matches[4] === '!') {\n              element.removeEmptyAttrs = true;\n            }\n\n            if (globalAttributes) {\n              each$j(globalAttributes, function (value, key) {\n                attributes[key] = value;\n              });\n              attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n            }\n\n            if (attrData) {\n              attrData = split$1(attrData, '|');\n\n              for (ai = 0, al = attrData.length; ai < al; ai++) {\n                matches = attrRuleRegExp.exec(attrData[ai]);\n\n                if (matches) {\n                  attr = {};\n                  attrType = matches[1];\n                  attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                  prefix = matches[3];\n                  value = matches[4];\n\n                  if (attrType === '!') {\n                    element.attributesRequired = element.attributesRequired || [];\n                    element.attributesRequired.push(attrName);\n                    attr.required = true;\n                  }\n\n                  if (attrType === '-') {\n                    delete attributes[attrName];\n                    attributesOrder.splice(inArray$2(attributesOrder, attrName), 1);\n                    continue;\n                  }\n\n                  if (prefix) {\n                    if (prefix === '=') {\n                      element.attributesDefault = element.attributesDefault || [];\n                      element.attributesDefault.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.defaultValue = value;\n                    }\n\n                    if (prefix === ':') {\n                      element.attributesForced = element.attributesForced || [];\n                      element.attributesForced.push({\n                        name: attrName,\n                        value: value\n                      });\n                      attr.forcedValue = value;\n                    }\n\n                    if (prefix === '<') {\n                      attr.validValues = makeMap$2(value, '?');\n                    }\n                  }\n\n                  if (hasPatternsRegExp.test(attrName)) {\n                    element.attributePatterns = element.attributePatterns || [];\n                    attr.pattern = patternToRegExp(attrName);\n                    element.attributePatterns.push(attr);\n                  } else {\n                    if (!attributes[attrName]) {\n                      attributesOrder.push(attrName);\n                    }\n\n                    attributes[attrName] = attr;\n                  }\n                }\n              }\n            }\n\n            if (!globalAttributes && elementName === '@') {\n              globalAttributes = attributes;\n              globalAttributesOrder = attributesOrder;\n            }\n\n            if (outputName) {\n              element.outputName = elementName;\n              elements[outputName] = element;\n            }\n\n            if (hasPatternsRegExp.test(elementName)) {\n              element.pattern = patternToRegExp(elementName);\n              patternElements.push(element);\n            } else {\n              elements[elementName] = element;\n            }\n          }\n        }\n      }\n    };\n\n    var setValidElements = function (validElements) {\n      elements = {};\n      patternElements = [];\n      addValidElements(validElements);\n      each$h(schemaItems, function (element, name) {\n        children[name] = element.children;\n      });\n    };\n\n    var addCustomElements = function (customElements) {\n      var customElementRegExp = /^(~)?(.+)$/;\n\n      if (customElements) {\n        mapCache.text_block_elements = mapCache.block_elements = null;\n        each$h(split$1(customElements, ','), function (rule) {\n          var matches = customElementRegExp.exec(rule),\n              inline = matches[1] === '~',\n              cloneName = inline ? 'span' : 'div',\n              name = matches[2];\n          children[name] = children[cloneName];\n          customElementsMap[name] = cloneName;\n\n          if (!inline) {\n            blockElementsMap[name.toUpperCase()] = {};\n            blockElementsMap[name] = {};\n          }\n\n          if (!elements[name]) {\n            var customRule = elements[cloneName];\n            customRule = extend$5({}, customRule);\n            delete customRule.removeEmptyAttrs;\n            delete customRule.removeEmpty;\n            elements[name] = customRule;\n          }\n\n          each$h(children, function (element, elmName) {\n            if (element[cloneName]) {\n              children[elmName] = element = extend$5({}, children[elmName]);\n              element[name] = element[cloneName];\n            }\n          });\n        });\n      }\n    };\n\n    var addValidChildren = function (validChildren) {\n      var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n      mapCache[settings.schema] = null;\n\n      if (validChildren) {\n        each$h(split$1(validChildren, ','), function (rule) {\n          var matches = childRuleRegExp.exec(rule);\n          var parent, prefix;\n\n          if (matches) {\n            prefix = matches[1];\n\n            if (prefix) {\n              parent = children[matches[2]];\n            } else {\n              parent = children[matches[2]] = {\n                '#comment': {}\n              };\n            }\n\n            parent = children[matches[2]];\n            each$h(split$1(matches[3], '|'), function (child) {\n              if (prefix === '-') {\n                delete parent[child];\n              } else {\n                parent[child] = {};\n              }\n            });\n          }\n        });\n      }\n    };\n\n    var getElementRule = function (name) {\n      var element = elements[name],\n          i;\n\n      if (element) {\n        return element;\n      }\n\n      i = patternElements.length;\n\n      while (i--) {\n        element = patternElements[i];\n\n        if (element.pattern.test(name)) {\n          return element;\n        }\n      }\n    };\n\n    if (!settings.valid_elements) {\n      each$h(schemaItems, function (element, name) {\n        elements[name] = {\n          attributes: element.attributes,\n          attributesOrder: element.attributesOrder\n        };\n        children[name] = element.children;\n      });\n\n      if (settings.schema !== 'html5') {\n        each$h(split$1('strong/b em/i'), function (item) {\n          var items = split$1(item, '/');\n          elements[items[1]].outputName = items[0];\n        });\n      }\n\n      each$h(split$1('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n        if (elements[name]) {\n          elements[name].removeEmpty = true;\n        }\n      });\n      each$h(split$1('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n        elements[name].paddEmpty = true;\n      });\n      each$h(split$1('span'), function (name) {\n        elements[name].removeEmptyAttrs = true;\n      });\n    } else {\n      setValidElements(settings.valid_elements);\n    }\n\n    addCustomElements(settings.custom_elements);\n    addValidChildren(settings.valid_children);\n    addValidElements(settings.extended_valid_elements);\n    addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n    each$h({\n      dd: 'dl',\n      dt: 'dl',\n      li: 'ul ol',\n      td: 'tr',\n      th: 'tr',\n      tr: 'tbody thead tfoot',\n      tbody: 'table',\n      thead: 'table',\n      tfoot: 'table',\n      legend: 'fieldset',\n      area: 'map',\n      param: 'video audio object'\n    }, function (parents, item) {\n      if (elements[item]) {\n        elements[item].parentsRequired = split$1(parents);\n      }\n    });\n\n    if (settings.invalid_elements) {\n      each$h(explode$3(settings.invalid_elements), function (item) {\n        if (elements[item]) {\n          delete elements[item];\n        }\n      });\n    }\n\n    if (!getElementRule('span')) {\n      addValidElements('span[!data-mce-type|*]');\n    }\n\n    var getValidStyles = constant(validStyles);\n    var getInvalidStyles = constant(invalidStyles);\n    var getValidClasses = constant(validClasses);\n    var getBoolAttrs = constant(boolAttrMap);\n    var getBlockElements = constant(blockElementsMap);\n    var getTextBlockElements = constant(textBlockElementsMap);\n    var getTextInlineElements = constant(textInlineElementsMap);\n    var getShortEndedElements = constant(shortEndedElementsMap);\n    var getSelfClosingElements = constant(selfClosingElementsMap);\n    var getNonEmptyElements = constant(nonEmptyElementsMap);\n    var getMoveCaretBeforeOnEnterElements = constant(moveCaretBeforeOnEnterElementsMap);\n    var getWhiteSpaceElements = constant(whiteSpaceElementsMap);\n    var getSpecialElements = constant(specialElements);\n\n    var isValidChild = function (name, child) {\n      var parent = children[name.toLowerCase()];\n      return !!(parent && parent[child.toLowerCase()]);\n    };\n\n    var isValid = function (name, attr) {\n      var attrPatterns, i;\n      var rule = getElementRule(name);\n\n      if (rule) {\n        if (attr) {\n          if (rule.attributes[attr]) {\n            return true;\n          }\n\n          attrPatterns = rule.attributePatterns;\n\n          if (attrPatterns) {\n            i = attrPatterns.length;\n\n            while (i--) {\n              if (attrPatterns[i].pattern.test(name)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var getCustomElements = constant(customElementsMap);\n    return {\n      children: children,\n      elements: elements,\n      getValidStyles: getValidStyles,\n      getValidClasses: getValidClasses,\n      getBlockElements: getBlockElements,\n      getInvalidStyles: getInvalidStyles,\n      getShortEndedElements: getShortEndedElements,\n      getTextBlockElements: getTextBlockElements,\n      getTextInlineElements: getTextInlineElements,\n      getBoolAttrs: getBoolAttrs,\n      getElementRule: getElementRule,\n      getSelfClosingElements: getSelfClosingElements,\n      getNonEmptyElements: getNonEmptyElements,\n      getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n      getWhiteSpaceElements: getWhiteSpaceElements,\n      getSpecialElements: getSpecialElements,\n      isValidChild: isValidChild,\n      isValid: isValid,\n      getCustomElements: getCustomElements,\n      addValidElements: addValidElements,\n      setValidElements: setValidElements,\n      addCustomElements: addCustomElements,\n      addValidChildren: addValidChildren\n    };\n  };\n\n  var toHex = function (match, r, g, b) {\n    var hex = function (val) {\n      val = parseInt(val, 10).toString(16);\n      return val.length > 1 ? val : '0' + val;\n    };\n\n    return '#' + hex(r) + hex(g) + hex(b);\n  };\n\n  var Styles = function (settings, schema) {\n    var _this = this;\n\n    var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n    var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n    var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n    var trimRightRegExp = /\\s+$/;\n    var i;\n    var encodingLookup = {};\n    var validStyles;\n    var invalidStyles;\n    var invisibleChar = zeroWidth;\n    settings = settings || {};\n\n    if (schema) {\n      validStyles = schema.getValidStyles();\n      invalidStyles = schema.getInvalidStyles();\n    }\n\n    var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n\n    for (i = 0; i < encodingItems.length; i++) {\n      encodingLookup[encodingItems[i]] = invisibleChar + i;\n      encodingLookup[invisibleChar + i] = encodingItems[i];\n    }\n\n    return {\n      toHex: function (color) {\n        return color.replace(rgbRegExp, toHex);\n      },\n      parse: function (css) {\n        var styles = {};\n        var matches, name, value, isEncoded;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope || _this;\n\n        var compress = function (prefix, suffix, noJoin) {\n          var top = styles[prefix + '-top' + suffix];\n\n          if (!top) {\n            return;\n          }\n\n          var right = styles[prefix + '-right' + suffix];\n\n          if (!right) {\n            return;\n          }\n\n          var bottom = styles[prefix + '-bottom' + suffix];\n\n          if (!bottom) {\n            return;\n          }\n\n          var left = styles[prefix + '-left' + suffix];\n\n          if (!left) {\n            return;\n          }\n\n          var box = [top, right, bottom, left];\n          i = box.length - 1;\n\n          while (i--) {\n            if (box[i] !== box[i + 1]) {\n              break;\n            }\n          }\n\n          if (i > -1 && noJoin) {\n            return;\n          }\n\n          styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n          delete styles[prefix + '-top' + suffix];\n          delete styles[prefix + '-right' + suffix];\n          delete styles[prefix + '-bottom' + suffix];\n          delete styles[prefix + '-left' + suffix];\n        };\n\n        var canCompress = function (key) {\n          var value = styles[key],\n              i;\n\n          if (!value) {\n            return;\n          }\n\n          value = value.split(' ');\n          i = value.length;\n\n          while (i--) {\n            if (value[i] !== value[0]) {\n              return false;\n            }\n          }\n\n          styles[key] = value[0];\n          return true;\n        };\n\n        var compress2 = function (target, a, b, c) {\n          if (!canCompress(a)) {\n            return;\n          }\n\n          if (!canCompress(b)) {\n            return;\n          }\n\n          if (!canCompress(c)) {\n            return;\n          }\n\n          styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n          delete styles[a];\n          delete styles[b];\n          delete styles[c];\n        };\n\n        var encode = function (str) {\n          isEncoded = true;\n          return encodingLookup[str];\n        };\n\n        var decode = function (str, keepSlashes) {\n          if (isEncoded) {\n            str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n              return encodingLookup[str];\n            });\n          }\n\n          if (!keepSlashes) {\n            str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n          }\n\n          return str;\n        };\n\n        var decodeSingleHexSequence = function (escSeq) {\n          return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n        };\n\n        var decodeHexSequences = function (value) {\n          return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n        };\n\n        var processUrl = function (match, url, url2, url3, str, str2) {\n          str = str || str2;\n\n          if (str) {\n            str = decode(str);\n            return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n          }\n\n          url = decode(url || url2 || url3);\n\n          if (!settings.allow_script_urls) {\n            var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n\n            if (/(java|vb)script:/i.test(scriptUrl)) {\n              return '';\n            }\n\n            if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n              return '';\n            }\n          }\n\n          if (urlConverter) {\n            url = urlConverter.call(urlConverterScope, url, 'style');\n          }\n\n          return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n        };\n\n        if (css) {\n          css = css.replace(/[\\u0000-\\u001F]/g, '');\n          css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n            return str.replace(/[;:]/g, encode);\n          });\n\n          while (matches = styleRegExp.exec(css)) {\n            styleRegExp.lastIndex = matches.index + matches[0].length;\n            name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n            value = matches[2].replace(trimRightRegExp, '');\n\n            if (name && value) {\n              name = decodeHexSequences(name);\n              value = decodeHexSequences(value);\n\n              if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                continue;\n              }\n\n              if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                continue;\n              }\n\n              if (name === 'font-weight' && value === '700') {\n                value = 'bold';\n              } else if (name === 'color' || name === 'background-color') {\n                value = value.toLowerCase();\n              }\n\n              value = value.replace(rgbRegExp, toHex);\n              value = value.replace(urlOrStrRegExp, processUrl);\n              styles[name] = isEncoded ? decode(value, true) : value;\n            }\n          }\n\n          compress('border', '', true);\n          compress('border', '-width');\n          compress('border', '-color');\n          compress('border', '-style');\n          compress('padding', '');\n          compress('margin', '');\n          compress2('border', 'border-width', 'border-style', 'border-color');\n\n          if (styles.border === 'medium none') {\n            delete styles.border;\n          }\n\n          if (styles['border-image'] === 'none') {\n            delete styles['border-image'];\n          }\n        }\n\n        return styles;\n      },\n      serialize: function (styles, elementName) {\n        var css = '';\n\n        var serializeStyles = function (name) {\n          var value;\n          var styleList = validStyles[name];\n\n          if (styleList) {\n            for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n              name = styleList[i_1];\n              value = styles[name];\n\n              if (value) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            }\n          }\n        };\n\n        var isValid = function (name, elementName) {\n          var styleMap = invalidStyles['*'];\n\n          if (styleMap && styleMap[name]) {\n            return false;\n          }\n\n          styleMap = invalidStyles[elementName];\n          return !(styleMap && styleMap[name]);\n        };\n\n        if (elementName && validStyles) {\n          serializeStyles('*');\n          serializeStyles(elementName);\n        } else {\n          each$j(styles, function (value, name) {\n            if (value && (!invalidStyles || isValid(name, elementName))) {\n              css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n            }\n          });\n        }\n\n        return css;\n      }\n    };\n  };\n\n  var deprecated = {\n    keyLocation: true,\n    layerX: true,\n    layerY: true,\n    returnValue: true,\n    webkitMovementX: true,\n    webkitMovementY: true,\n    keyIdentifier: true,\n    mozPressure: true\n  };\n\n  var isNativeEvent = function (event) {\n    return event instanceof Event || isFunction(event.initEvent);\n  };\n\n  var hasIsDefaultPrevented = function (event) {\n    return event.isDefaultPrevented === always || event.isDefaultPrevented === never;\n  };\n\n  var needsNormalizing = function (event) {\n    return isNullable(event.preventDefault) || isNativeEvent(event);\n  };\n\n  var clone$2 = function (originalEvent, data) {\n    var event = data !== null && data !== void 0 ? data : {};\n\n    for (var name_1 in originalEvent) {\n      if (!has$2(deprecated, name_1)) {\n        event[name_1] = originalEvent[name_1];\n      }\n    }\n\n    if (isNonNullable(event.composedPath)) {\n      event.composedPath = function () {\n        return originalEvent.composedPath();\n      };\n    }\n\n    return event;\n  };\n\n  var normalize$3 = function (type, originalEvent, fallbackTarget, data) {\n    var _a;\n\n    var event = clone$2(originalEvent, data);\n    event.type = type;\n\n    if (isNullable(event.target)) {\n      event.target = (_a = event.srcElement) !== null && _a !== void 0 ? _a : fallbackTarget;\n    }\n\n    if (needsNormalizing(originalEvent)) {\n      event.preventDefault = function () {\n        event.defaultPrevented = true;\n        event.isDefaultPrevented = always;\n\n        if (isFunction(originalEvent.preventDefault)) {\n          originalEvent.preventDefault();\n        } else if (isNativeEvent(originalEvent)) {\n          originalEvent.returnValue = false;\n        }\n      };\n\n      event.stopPropagation = function () {\n        event.cancelBubble = true;\n        event.isPropagationStopped = always;\n\n        if (isFunction(originalEvent.stopPropagation)) {\n          originalEvent.stopPropagation();\n        } else if (isNativeEvent(originalEvent)) {\n          originalEvent.cancelBubble = true;\n        }\n      };\n\n      event.stopImmediatePropagation = function () {\n        event.isImmediatePropagationStopped = always;\n        event.stopPropagation();\n      };\n\n      if (!hasIsDefaultPrevented(event)) {\n        event.isDefaultPrevented = event.defaultPrevented === true ? always : never;\n        event.isPropagationStopped = event.cancelBubble === true ? always : never;\n        event.isImmediatePropagationStopped = never;\n      }\n    }\n\n    return event;\n  };\n\n  var eventExpandoPrefix = 'mce-data-';\n  var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n\n  var addEvent = function (target, name, callback, capture) {\n    if (target.addEventListener) {\n      target.addEventListener(name, callback, capture || false);\n    } else if (target.attachEvent) {\n      target.attachEvent('on' + name, callback);\n    }\n  };\n\n  var removeEvent = function (target, name, callback, capture) {\n    if (target.removeEventListener) {\n      target.removeEventListener(name, callback, capture || false);\n    } else if (target.detachEvent) {\n      target.detachEvent('on' + name, callback);\n    }\n  };\n\n  var isMouseEvent = function (event) {\n    return isNonNullable(event) && mouseEventRe.test(event.type);\n  };\n\n  var fix = function (originalEvent, data) {\n    var event = normalize$3(originalEvent.type, originalEvent, document, data);\n\n    if (isMouseEvent(originalEvent) && isUndefined(originalEvent.pageX) && !isUndefined(originalEvent.clientX)) {\n      var eventDoc = event.target.ownerDocument || document;\n      var doc = eventDoc.documentElement;\n      var body = eventDoc.body;\n      var mouseEvent = event;\n      mouseEvent.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n      mouseEvent.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n    }\n\n    if (isUndefined(event.metaKey)) {\n      event.metaKey = false;\n    }\n\n    return event;\n  };\n\n  var bindOnReady = function (win, callback, eventUtils) {\n    var doc = win.document,\n        event = {\n      type: 'ready'\n    };\n\n    if (eventUtils.domLoaded) {\n      callback(event);\n      return;\n    }\n\n    var isDocReady = function () {\n      return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n    };\n\n    var readyHandler = function () {\n      removeEvent(win, 'DOMContentLoaded', readyHandler);\n      removeEvent(win, 'load', readyHandler);\n\n      if (!eventUtils.domLoaded) {\n        eventUtils.domLoaded = true;\n        callback(event);\n      }\n\n      win = null;\n    };\n\n    if (isDocReady()) {\n      readyHandler();\n    } else {\n      addEvent(win, 'DOMContentLoaded', readyHandler);\n    }\n\n    if (!eventUtils.domLoaded) {\n      addEvent(win, 'load', readyHandler);\n    }\n  };\n\n  var EventUtils = function () {\n    function EventUtils() {\n      this.domLoaded = false;\n      this.events = {};\n      this.count = 1;\n      this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n      this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n      this.hasFocusIn = 'onfocusin' in document.documentElement;\n      this.count = 1;\n    }\n\n    EventUtils.prototype.bind = function (target, names, callback, scope) {\n      var self = this;\n      var id, callbackList, i, name, fakeName, nativeHandler, capture;\n      var win = window;\n\n      var defaultNativeHandler = function (evt) {\n        self.executeHandlers(fix(evt || win.event), id);\n      };\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return;\n      }\n\n      if (!target[self.expando]) {\n        id = self.count++;\n        target[self.expando] = id;\n        self.events[id] = {};\n      } else {\n        id = target[self.expando];\n      }\n\n      scope = scope || target;\n      var namesList = names.split(' ');\n      i = namesList.length;\n\n      while (i--) {\n        name = namesList[i];\n        nativeHandler = defaultNativeHandler;\n        fakeName = capture = false;\n\n        if (name === 'DOMContentLoaded') {\n          name = 'ready';\n        }\n\n        if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n          callback.call(scope, fix({\n            type: name\n          }));\n          continue;\n        }\n\n        if (!self.hasMouseEnterLeave) {\n          fakeName = self.mouseEnterLeave[name];\n\n          if (fakeName) {\n            nativeHandler = function (evt) {\n              var current = evt.currentTarget;\n              var related = evt.relatedTarget;\n\n              if (related && current.contains) {\n                related = current.contains(related);\n              } else {\n                while (related && related !== current) {\n                  related = related.parentNode;\n                }\n              }\n\n              if (!related) {\n                evt = fix(evt || win.event);\n                evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                evt.target = current;\n                self.executeHandlers(evt, id);\n              }\n            };\n          }\n        }\n\n        if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n          capture = true;\n          fakeName = name === 'focusin' ? 'focus' : 'blur';\n\n          nativeHandler = function (evt) {\n            evt = fix(evt || win.event);\n            evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n            self.executeHandlers(evt, id);\n          };\n        }\n\n        callbackList = self.events[id][name];\n\n        if (!callbackList) {\n          self.events[id][name] = callbackList = [{\n            func: callback,\n            scope: scope\n          }];\n          callbackList.fakeName = fakeName;\n          callbackList.capture = capture;\n          callbackList.nativeHandler = nativeHandler;\n\n          if (name === 'ready') {\n            bindOnReady(target, nativeHandler, self);\n          } else {\n            addEvent(target, fakeName || name, nativeHandler, capture);\n          }\n        } else {\n          if (name === 'ready' && self.domLoaded) {\n            callback(fix({\n              type: name\n            }));\n          } else {\n            callbackList.push({\n              func: callback,\n              scope: scope\n            });\n          }\n        }\n      }\n\n      target = callbackList = null;\n      return callback;\n    };\n\n    EventUtils.prototype.unbind = function (target, names, callback) {\n      var callbackList, i, ci, name, eventMap;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var id = target[this.expando];\n\n      if (id) {\n        eventMap = this.events[id];\n\n        if (names) {\n          var namesList = names.split(' ');\n          i = namesList.length;\n\n          while (i--) {\n            name = namesList[i];\n            callbackList = eventMap[name];\n\n            if (callbackList) {\n              if (callback) {\n                ci = callbackList.length;\n\n                while (ci--) {\n                  if (callbackList[ci].func === callback) {\n                    var nativeHandler = callbackList.nativeHandler;\n                    var fakeName = callbackList.fakeName,\n                        capture = callbackList.capture;\n                    callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                    callbackList.nativeHandler = nativeHandler;\n                    callbackList.fakeName = fakeName;\n                    callbackList.capture = capture;\n                    eventMap[name] = callbackList;\n                  }\n                }\n              }\n\n              if (!callback || callbackList.length === 0) {\n                delete eventMap[name];\n                removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n              }\n            }\n          }\n        } else {\n          each$j(eventMap, function (callbackList, name) {\n            removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n          });\n          eventMap = {};\n        }\n\n        for (name in eventMap) {\n          if (has$2(eventMap, name)) {\n            return this;\n          }\n        }\n\n        delete this.events[id];\n\n        try {\n          delete target[this.expando];\n        } catch (ex) {\n          target[this.expando] = null;\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.fire = function (target, name, args) {\n      var id;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      var event = fix({\n        type: name,\n        target: target\n      }, args);\n\n      do {\n        id = target[this.expando];\n\n        if (id) {\n          this.executeHandlers(event, id);\n        }\n\n        target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n      } while (target && !event.isPropagationStopped());\n\n      return this;\n    };\n\n    EventUtils.prototype.clean = function (target) {\n      var i, children;\n\n      if (!target || target.nodeType === 3 || target.nodeType === 8) {\n        return this;\n      }\n\n      if (target[this.expando]) {\n        this.unbind(target);\n      }\n\n      if (!target.getElementsByTagName) {\n        target = target.document;\n      }\n\n      if (target && target.getElementsByTagName) {\n        this.unbind(target);\n        children = target.getElementsByTagName('*');\n        i = children.length;\n\n        while (i--) {\n          target = children[i];\n\n          if (target[this.expando]) {\n            this.unbind(target);\n          }\n        }\n      }\n\n      return this;\n    };\n\n    EventUtils.prototype.destroy = function () {\n      this.events = {};\n    };\n\n    EventUtils.prototype.cancel = function (e) {\n      if (e) {\n        e.preventDefault();\n        e.stopImmediatePropagation();\n      }\n\n      return false;\n    };\n\n    EventUtils.prototype.executeHandlers = function (evt, id) {\n      var container = this.events[id];\n      var callbackList = container && container[evt.type];\n\n      if (callbackList) {\n        for (var i = 0, l = callbackList.length; i < l; i++) {\n          var callback = callbackList[i];\n\n          if (callback && callback.func.call(callback.scope, evt) === false) {\n            evt.preventDefault();\n          }\n\n          if (evt.isImmediatePropagationStopped()) {\n            return;\n          }\n        }\n      }\n    };\n\n    EventUtils.Event = new EventUtils();\n    return EventUtils;\n  }();\n\n  var support,\n      Expr,\n      getText,\n      isXML,\n      tokenize,\n      compile,\n      select$1,\n      outermostContext,\n      sortInput,\n      hasDuplicate,\n      setDocument,\n      document$1,\n      docElem,\n      documentIsHTML,\n      rbuggyQSA,\n      rbuggyMatches,\n      matches,\n      contains,\n      expando = 'sizzle' + -new Date(),\n      preferredDoc = window.document,\n      dirruns = 0,\n      done = 0,\n      classCache = createCache(),\n      tokenCache = createCache(),\n      compilerCache = createCache(),\n      sortOrder = function (a, b) {\n    if (a === b) {\n      hasDuplicate = true;\n    }\n\n    return 0;\n  },\n      strundefined = typeof undefined,\n      MAX_NEGATIVE = 1 << 31,\n      hasOwn = {}.hasOwnProperty,\n      arr = [],\n      pop = arr.pop,\n      push_native = arr.push,\n      push$1 = arr.push,\n      slice$1 = arr.slice,\n      indexOf = arr.indexOf || function (elem) {\n    var i = 0,\n        len = this.length;\n\n    for (; i < len; i++) {\n      if (this[i] === elem) {\n        return i;\n      }\n    }\n\n    return -1;\n  },\n      booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped',\n      whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]',\n      identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+',\n      attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]',\n      pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)',\n      rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'),\n      rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'),\n      rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'),\n      rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'),\n      rpseudo = new RegExp(pseudos),\n      ridentifier = new RegExp('^' + identifier + '$'),\n      matchExpr = {\n    ID: new RegExp('^#(' + identifier + ')'),\n    CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n    TAG: new RegExp('^(' + identifier + '|[*])'),\n    ATTR: new RegExp('^' + attributes),\n    PSEUDO: new RegExp('^' + pseudos),\n    CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n    bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n    needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n  },\n      rinputs = /^(?:input|select|textarea|button)$/i,\n      rheader = /^h\\d$/i,\n      rnative = /^[^{]+\\{\\s*\\[native \\w/,\n      rquickExpr$1 = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/,\n      rsibling = /[+~]/,\n      rescape = /'|\\\\/g,\n      runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'),\n      funescape = function (_, escaped, escapedWhitespace) {\n    var high = '0x' + escaped - 65536;\n    return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n  };\n\n  try {\n    push$1.apply(arr = slice$1.call(preferredDoc.childNodes), preferredDoc.childNodes);\n    arr[preferredDoc.childNodes.length].nodeType;\n  } catch (e) {\n    push$1 = {\n      apply: arr.length ? function (target, els) {\n        push_native.apply(target, slice$1.call(els));\n      } : function (target, els) {\n        var j = target.length,\n            i = 0;\n\n        while (target[j++] = els[i++]) {}\n\n        target.length = j - 1;\n      }\n    };\n  }\n\n  var Sizzle = function (selector, context, results, seed) {\n    var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n\n    if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n      setDocument(context);\n    }\n\n    context = context || document$1;\n    results = results || [];\n\n    if (!selector || typeof selector !== 'string') {\n      return results;\n    }\n\n    if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n      return [];\n    }\n\n    if (documentIsHTML && !seed) {\n      if (match = rquickExpr$1.exec(selector)) {\n        if (m = match[1]) {\n          if (nodeType === 9) {\n            elem = context.getElementById(m);\n\n            if (elem && elem.parentNode) {\n              if (elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            } else {\n              return results;\n            }\n          } else {\n            if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains(context, elem) && elem.id === m) {\n              results.push(elem);\n              return results;\n            }\n          }\n        } else if (match[2]) {\n          push$1.apply(results, context.getElementsByTagName(selector));\n          return results;\n        } else if ((m = match[3]) && support.getElementsByClassName) {\n          push$1.apply(results, context.getElementsByClassName(m));\n          return results;\n        }\n      }\n\n      if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n        nid = old = expando;\n        newContext = context;\n        newSelector = nodeType === 9 && selector;\n\n        if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n          groups = tokenize(selector);\n\n          if (old = context.getAttribute('id')) {\n            nid = old.replace(rescape, '\\\\$&');\n          } else {\n            context.setAttribute('id', nid);\n          }\n\n          nid = '[id=\\'' + nid + '\\'] ';\n          i = groups.length;\n\n          while (i--) {\n            groups[i] = nid + toSelector(groups[i]);\n          }\n\n          newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n          newSelector = groups.join(',');\n        }\n\n        if (newSelector) {\n          try {\n            push$1.apply(results, newContext.querySelectorAll(newSelector));\n            return results;\n          } catch (qsaError) {} finally {\n            if (!old) {\n              context.removeAttribute('id');\n            }\n          }\n        }\n      }\n    }\n\n    return select$1(selector.replace(rtrim, '$1'), context, results, seed);\n  };\n\n  function createCache() {\n    var keys = [];\n\n    function cache(key, value) {\n      if (keys.push(key + ' ') > Expr.cacheLength) {\n        delete cache[keys.shift()];\n      }\n\n      return cache[key + ' '] = value;\n    }\n\n    return cache;\n  }\n\n  function markFunction(fn) {\n    fn[expando] = true;\n    return fn;\n  }\n\n  function siblingCheck(a, b) {\n    var cur = b && a,\n        diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n\n    if (diff) {\n      return diff;\n    }\n\n    if (cur) {\n      while (cur = cur.nextSibling) {\n        if (cur === b) {\n          return -1;\n        }\n      }\n    }\n\n    return a ? 1 : -1;\n  }\n\n  function createInputPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return name === 'input' && elem.type === type;\n    };\n  }\n\n  function createButtonPseudo(type) {\n    return function (elem) {\n      var name = elem.nodeName.toLowerCase();\n      return (name === 'input' || name === 'button') && elem.type === type;\n    };\n  }\n\n  function createPositionalPseudo(fn) {\n    return markFunction(function (argument) {\n      argument = +argument;\n      return markFunction(function (seed, matches) {\n        var j,\n            matchIndexes = fn([], seed.length, argument),\n            i = matchIndexes.length;\n\n        while (i--) {\n          if (seed[j = matchIndexes[i]]) {\n            seed[j] = !(matches[j] = seed[j]);\n          }\n        }\n      });\n    });\n  }\n\n  function testContext(context) {\n    return context && typeof context.getElementsByTagName !== strundefined && context;\n  }\n\n  support = Sizzle.support = {};\n\n  isXML = Sizzle.isXML = function (elem) {\n    var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n    return documentElement ? documentElement.nodeName !== 'HTML' : false;\n  };\n\n  setDocument = Sizzle.setDocument = function (node) {\n    var hasCompare,\n        doc = node ? node.ownerDocument || node : preferredDoc,\n        parent = doc.defaultView;\n\n    function getTop(win) {\n      try {\n        return win.top;\n      } catch (ex) {}\n\n      return null;\n    }\n\n    if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n      return document$1;\n    }\n\n    document$1 = doc;\n    docElem = doc.documentElement;\n    documentIsHTML = !isXML(doc);\n\n    if (parent && parent !== getTop(parent)) {\n      if (parent.addEventListener) {\n        parent.addEventListener('unload', function () {\n          setDocument();\n        }, false);\n      } else if (parent.attachEvent) {\n        parent.attachEvent('onunload', function () {\n          setDocument();\n        });\n      }\n    }\n\n    support.attributes = true;\n    support.getElementsByTagName = true;\n    support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n    support.getById = true;\n\n    Expr.find.ID = function (id, context) {\n      if (typeof context.getElementById !== strundefined && documentIsHTML) {\n        var m = context.getElementById(id);\n        return m && m.parentNode ? [m] : [];\n      }\n    };\n\n    Expr.filter.ID = function (id) {\n      var attrId = id.replace(runescape, funescape);\n      return function (elem) {\n        return elem.getAttribute('id') === attrId;\n      };\n    };\n\n    Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n      if (typeof context.getElementsByTagName !== strundefined) {\n        return context.getElementsByTagName(tag);\n      }\n    } : function (tag, context) {\n      var elem,\n          tmp = [],\n          i = 0,\n          results = context.getElementsByTagName(tag);\n\n      if (tag === '*') {\n        while (elem = results[i++]) {\n          if (elem.nodeType === 1) {\n            tmp.push(elem);\n          }\n        }\n\n        return tmp;\n      }\n\n      return results;\n    };\n\n    Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n      if (documentIsHTML) {\n        return context.getElementsByClassName(className);\n      }\n    };\n\n    rbuggyMatches = [];\n    rbuggyQSA = [];\n    support.disconnectedMatch = true;\n    rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n    rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n    hasCompare = rnative.test(docElem.compareDocumentPosition);\n    contains = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n      var adown = a.nodeType === 9 ? a.documentElement : a,\n          bup = b && b.parentNode;\n      return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n    } : function (a, b) {\n      if (b) {\n        while (b = b.parentNode) {\n          if (b === a) {\n            return true;\n          }\n        }\n      }\n\n      return false;\n    };\n    sortOrder = hasCompare ? function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n\n      if (compare) {\n        return compare;\n      }\n\n      compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n\n      if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n        if (a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a)) {\n          return -1;\n        }\n\n        if (b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b)) {\n          return 1;\n        }\n\n        return sortInput ? indexOf.call(sortInput, a) - indexOf.call(sortInput, b) : 0;\n      }\n\n      return compare & 4 ? -1 : 1;\n    } : function (a, b) {\n      if (a === b) {\n        hasDuplicate = true;\n        return 0;\n      }\n\n      var cur,\n          i = 0,\n          aup = a.parentNode,\n          bup = b.parentNode,\n          ap = [a],\n          bp = [b];\n\n      if (!aup || !bup) {\n        return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf.call(sortInput, a) - indexOf.call(sortInput, b) : 0;\n      } else if (aup === bup) {\n        return siblingCheck(a, b);\n      }\n\n      cur = a;\n\n      while (cur = cur.parentNode) {\n        ap.unshift(cur);\n      }\n\n      cur = b;\n\n      while (cur = cur.parentNode) {\n        bp.unshift(cur);\n      }\n\n      while (ap[i] === bp[i]) {\n        i++;\n      }\n\n      return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n    };\n    return doc;\n  };\n\n  Sizzle.matches = function (expr, elements) {\n    return Sizzle(expr, null, null, elements);\n  };\n\n  Sizzle.matchesSelector = function (elem, expr) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n\n    if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n      try {\n        var ret = matches.call(elem, expr);\n\n        if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n          return ret;\n        }\n      } catch (e) {}\n    }\n\n    return Sizzle(expr, document$1, null, [elem]).length > 0;\n  };\n\n  Sizzle.contains = function (context, elem) {\n    if ((context.ownerDocument || context) !== document$1) {\n      setDocument(context);\n    }\n\n    return contains(context, elem);\n  };\n\n  Sizzle.attr = function (elem, name) {\n    if ((elem.ownerDocument || elem) !== document$1) {\n      setDocument(elem);\n    }\n\n    var fn = Expr.attrHandle[name.toLowerCase()],\n        val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n    return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n  };\n\n  Sizzle.error = function (msg) {\n    throw new Error('Syntax error, unrecognized expression: ' + msg);\n  };\n\n  Sizzle.uniqueSort = function (results) {\n    var elem,\n        duplicates = [],\n        j = 0,\n        i = 0;\n    hasDuplicate = !support.detectDuplicates;\n    sortInput = !support.sortStable && results.slice(0);\n    results.sort(sortOrder);\n\n    if (hasDuplicate) {\n      while (elem = results[i++]) {\n        if (elem === results[i]) {\n          j = duplicates.push(i);\n        }\n      }\n\n      while (j--) {\n        results.splice(duplicates[j], 1);\n      }\n    }\n\n    sortInput = null;\n    return results;\n  };\n\n  getText = Sizzle.getText = function (elem) {\n    var node,\n        ret = '',\n        i = 0,\n        nodeType = elem.nodeType;\n\n    if (!nodeType) {\n      while (node = elem[i++]) {\n        ret += getText(node);\n      }\n    } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n      if (typeof elem.textContent === 'string') {\n        return elem.textContent;\n      } else {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          ret += getText(elem);\n        }\n      }\n    } else if (nodeType === 3 || nodeType === 4) {\n      return elem.nodeValue;\n    }\n\n    return ret;\n  };\n\n  Expr = Sizzle.selectors = {\n    cacheLength: 50,\n    createPseudo: markFunction,\n    match: matchExpr,\n    attrHandle: {},\n    find: {},\n    relative: {\n      '>': {\n        dir: 'parentNode',\n        first: true\n      },\n      ' ': {\n        dir: 'parentNode'\n      },\n      '+': {\n        dir: 'previousSibling',\n        first: true\n      },\n      '~': {\n        dir: 'previousSibling'\n      }\n    },\n    preFilter: {\n      ATTR: function (match) {\n        match[1] = match[1].replace(runescape, funescape);\n        match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n\n        if (match[2] === '~=') {\n          match[3] = ' ' + match[3] + ' ';\n        }\n\n        return match.slice(0, 4);\n      },\n      CHILD: function (match) {\n        match[1] = match[1].toLowerCase();\n\n        if (match[1].slice(0, 3) === 'nth') {\n          if (!match[3]) {\n            Sizzle.error(match[0]);\n          }\n\n          match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n          match[5] = +(match[7] + match[8] || match[3] === 'odd');\n        } else if (match[3]) {\n          Sizzle.error(match[0]);\n        }\n\n        return match;\n      },\n      PSEUDO: function (match) {\n        var excess,\n            unquoted = !match[6] && match[2];\n\n        if (matchExpr.CHILD.test(match[0])) {\n          return null;\n        }\n\n        if (match[3]) {\n          match[2] = match[4] || match[5] || '';\n        } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n          match[0] = match[0].slice(0, excess);\n          match[2] = unquoted.slice(0, excess);\n        }\n\n        return match.slice(0, 3);\n      }\n    },\n    filter: {\n      TAG: function (nodeNameSelector) {\n        var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n        return nodeNameSelector === '*' ? function () {\n          return true;\n        } : function (elem) {\n          return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n        };\n      },\n      CLASS: function (className) {\n        var pattern = classCache[className + ' '];\n        return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n          return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n        });\n      },\n      ATTR: function (name, operator, check) {\n        return function (elem) {\n          var result = Sizzle.attr(elem, name);\n\n          if (result == null) {\n            return operator === '!=';\n          }\n\n          if (!operator) {\n            return true;\n          }\n\n          result += '';\n          return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n        };\n      },\n      CHILD: function (type, what, argument, first, last) {\n        var simple = type.slice(0, 3) !== 'nth',\n            forward = type.slice(-4) !== 'last',\n            ofType = what === 'of-type';\n        return first === 1 && last === 0 ? function (elem) {\n          return !!elem.parentNode;\n        } : function (elem, context, xml) {\n          var cache,\n              outerCache,\n              node,\n              diff,\n              nodeIndex,\n              start,\n              dir = simple !== forward ? 'nextSibling' : 'previousSibling',\n              parent = elem.parentNode,\n              name = ofType && elem.nodeName.toLowerCase(),\n              useCache = !xml && !ofType;\n\n          if (parent) {\n            if (simple) {\n              while (dir) {\n                node = elem;\n\n                while (node = node[dir]) {\n                  if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                    return false;\n                  }\n                }\n\n                start = dir = type === 'only' && !start && 'nextSibling';\n              }\n\n              return true;\n            }\n\n            start = [forward ? parent.firstChild : parent.lastChild];\n\n            if (forward && useCache) {\n              outerCache = parent[expando] || (parent[expando] = {});\n              cache = outerCache[type] || [];\n              nodeIndex = cache[0] === dirruns && cache[1];\n              diff = cache[0] === dirruns && cache[2];\n              node = nodeIndex && parent.childNodes[nodeIndex];\n\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if (node.nodeType === 1 && ++diff && node === elem) {\n                  outerCache[type] = [dirruns, nodeIndex, diff];\n                  break;\n                }\n              }\n            } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n              diff = cache[1];\n            } else {\n              while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                  if (useCache) {\n                    (node[expando] || (node[expando] = {}))[type] = [dirruns, diff];\n                  }\n\n                  if (node === elem) {\n                    break;\n                  }\n                }\n              }\n            }\n\n            diff -= last;\n            return diff === first || diff % first === 0 && diff / first >= 0;\n          }\n        };\n      },\n      PSEUDO: function (pseudo, argument) {\n        var args,\n            fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n\n        if (fn[expando]) {\n          return fn(argument);\n        }\n\n        if (fn.length > 1) {\n          args = [pseudo, pseudo, '', argument];\n          return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n            var idx,\n                matched = fn(seed, argument),\n                i = matched.length;\n\n            while (i--) {\n              idx = indexOf.call(seed, matched[i]);\n              seed[idx] = !(matches[idx] = matched[i]);\n            }\n          }) : function (elem) {\n            return fn(elem, 0, args);\n          };\n        }\n\n        return fn;\n      }\n    },\n    pseudos: {\n      not: markFunction(function (selector) {\n        var input = [],\n            results = [],\n            matcher = compile(selector.replace(rtrim, '$1'));\n        return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n          var elem,\n              unmatched = matcher(seed, null, xml, []),\n              i = seed.length;\n\n          while (i--) {\n            if (elem = unmatched[i]) {\n              seed[i] = !(matches[i] = elem);\n            }\n          }\n        }) : function (elem, context, xml) {\n          input[0] = elem;\n          matcher(input, null, xml, results);\n          input[0] = null;\n          return !results.pop();\n        };\n      }),\n      has: markFunction(function (selector) {\n        return function (elem) {\n          return Sizzle(selector, elem).length > 0;\n        };\n      }),\n      contains: markFunction(function (text) {\n        text = text.replace(runescape, funescape);\n        return function (elem) {\n          return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n        };\n      }),\n      lang: markFunction(function (lang) {\n        if (!ridentifier.test(lang || '')) {\n          Sizzle.error('unsupported lang: ' + lang);\n        }\n\n        lang = lang.replace(runescape, funescape).toLowerCase();\n        return function (elem) {\n          var elemLang;\n\n          do {\n            if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n              elemLang = elemLang.toLowerCase();\n              return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n            }\n          } while ((elem = elem.parentNode) && elem.nodeType === 1);\n\n          return false;\n        };\n      }),\n      target: function (elem) {\n        var hash = window.location && window.location.hash;\n        return hash && hash.slice(1) === elem.id;\n      },\n      root: function (elem) {\n        return elem === docElem;\n      },\n      focus: function (elem) {\n        return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n      },\n      enabled: function (elem) {\n        return elem.disabled === false;\n      },\n      disabled: function (elem) {\n        return elem.disabled === true;\n      },\n      checked: function (elem) {\n        var nodeName = elem.nodeName.toLowerCase();\n        return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n      },\n      selected: function (elem) {\n        if (elem.parentNode) {\n          elem.parentNode.selectedIndex;\n        }\n\n        return elem.selected === true;\n      },\n      empty: function (elem) {\n        for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n          if (elem.nodeType < 6) {\n            return false;\n          }\n        }\n\n        return true;\n      },\n      parent: function (elem) {\n        return !Expr.pseudos.empty(elem);\n      },\n      header: function (elem) {\n        return rheader.test(elem.nodeName);\n      },\n      input: function (elem) {\n        return rinputs.test(elem.nodeName);\n      },\n      button: function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === 'button' || name === 'button';\n      },\n      text: function (elem) {\n        var attr;\n        return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n      },\n      first: createPositionalPseudo(function () {\n        return [0];\n      }),\n      last: createPositionalPseudo(function (matchIndexes, length) {\n        return [length - 1];\n      }),\n      eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n        return [argument < 0 ? argument + length : argument];\n      }),\n      even: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 0;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      odd: createPositionalPseudo(function (matchIndexes, length) {\n        var i = 1;\n\n        for (; i < length; i += 2) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; --i >= 0;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      }),\n      gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n        var i = argument < 0 ? argument + length : argument;\n\n        for (; ++i < length;) {\n          matchIndexes.push(i);\n        }\n\n        return matchIndexes;\n      })\n    }\n  };\n  Expr.pseudos.nth = Expr.pseudos.eq;\n  each$k(['radio', 'checkbox', 'file', 'password', 'image'], function (i) {\n    Expr.pseudos[i] = createInputPseudo(i);\n  });\n  each$k(['submit', 'reset'], function (i) {\n    Expr.pseudos[i] = createButtonPseudo(i);\n  });\n\n  function setFilters() {}\n\n  setFilters.prototype = Expr.filters = Expr.pseudos;\n  Expr.setFilters = new setFilters();\n\n  tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n    var matched,\n        match,\n        tokens,\n        type,\n        soFar,\n        groups,\n        preFilters,\n        cached = tokenCache[selector + ' '];\n\n    if (cached) {\n      return parseOnly ? 0 : cached.slice(0);\n    }\n\n    soFar = selector;\n    groups = [];\n    preFilters = Expr.preFilter;\n\n    while (soFar) {\n      if (!matched || (match = rcomma.exec(soFar))) {\n        if (match) {\n          soFar = soFar.slice(match[0].length) || soFar;\n        }\n\n        groups.push(tokens = []);\n      }\n\n      matched = false;\n\n      if (match = rcombinators.exec(soFar)) {\n        matched = match.shift();\n        tokens.push({\n          value: matched,\n          type: match[0].replace(rtrim, ' ')\n        });\n        soFar = soFar.slice(matched.length);\n      }\n\n      for (type in Expr.filter) {\n        if (!Expr.filter.hasOwnProperty(type)) {\n          continue;\n        }\n\n        if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: type,\n            matches: match\n          });\n          soFar = soFar.slice(matched.length);\n        }\n      }\n\n      if (!matched) {\n        break;\n      }\n    }\n\n    return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n  };\n\n  function toSelector(tokens) {\n    var i = 0,\n        len = tokens.length,\n        selector = '';\n\n    for (; i < len; i++) {\n      selector += tokens[i].value;\n    }\n\n    return selector;\n  }\n\n  function addCombinator(matcher, combinator, base) {\n    var dir = combinator.dir,\n        checkNonElements = base && dir === 'parentNode',\n        doneName = done++;\n    return combinator.first ? function (elem, context, xml) {\n      while (elem = elem[dir]) {\n        if (elem.nodeType === 1 || checkNonElements) {\n          return matcher(elem, context, xml);\n        }\n      }\n    } : function (elem, context, xml) {\n      var oldCache,\n          outerCache,\n          newCache = [dirruns, doneName];\n\n      if (xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            if (matcher(elem, context, xml)) {\n              return true;\n            }\n          }\n        }\n      } else {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            outerCache = elem[expando] || (elem[expando] = {});\n\n            if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n              return newCache[2] = oldCache[2];\n            } else {\n              outerCache[dir] = newCache;\n\n              if (newCache[2] = matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        }\n      }\n    };\n  }\n\n  function elementMatcher(matchers) {\n    return matchers.length > 1 ? function (elem, context, xml) {\n      var i = matchers.length;\n\n      while (i--) {\n        if (!matchers[i](elem, context, xml)) {\n          return false;\n        }\n      }\n\n      return true;\n    } : matchers[0];\n  }\n\n  function multipleContexts(selector, contexts, results) {\n    var i = 0,\n        len = contexts.length;\n\n    for (; i < len; i++) {\n      Sizzle(selector, contexts[i], results);\n    }\n\n    return results;\n  }\n\n  function condense(unmatched, map, filter, context, xml) {\n    var elem,\n        newUnmatched = [],\n        i = 0,\n        len = unmatched.length,\n        mapped = map != null;\n\n    for (; i < len; i++) {\n      if (elem = unmatched[i]) {\n        if (!filter || filter(elem, context, xml)) {\n          newUnmatched.push(elem);\n\n          if (mapped) {\n            map.push(i);\n          }\n        }\n      }\n    }\n\n    return newUnmatched;\n  }\n\n  function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n    if (postFilter && !postFilter[expando]) {\n      postFilter = setMatcher(postFilter);\n    }\n\n    if (postFinder && !postFinder[expando]) {\n      postFinder = setMatcher(postFinder, postSelector);\n    }\n\n    return markFunction(function (seed, results, context, xml) {\n      var temp,\n          i,\n          elem,\n          preMap = [],\n          postMap = [],\n          preexisting = results.length,\n          elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []),\n          matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems,\n          matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n\n      if (matcher) {\n        matcher(matcherIn, matcherOut, context, xml);\n      }\n\n      if (postFilter) {\n        temp = condense(matcherOut, postMap);\n        postFilter(temp, [], context, xml);\n        i = temp.length;\n\n        while (i--) {\n          if (elem = temp[i]) {\n            matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n          }\n        }\n      }\n\n      if (seed) {\n        if (postFinder || preFilter) {\n          if (postFinder) {\n            temp = [];\n            i = matcherOut.length;\n\n            while (i--) {\n              if (elem = matcherOut[i]) {\n                temp.push(matcherIn[i] = elem);\n              }\n            }\n\n            postFinder(null, matcherOut = [], temp, xml);\n          }\n\n          i = matcherOut.length;\n\n          while (i--) {\n            if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf.call(seed, elem) : preMap[i]) > -1) {\n              seed[temp] = !(results[temp] = elem);\n            }\n          }\n        }\n      } else {\n        matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n\n        if (postFinder) {\n          postFinder(null, results, matcherOut, xml);\n        } else {\n          push$1.apply(results, matcherOut);\n        }\n      }\n    });\n  }\n\n  function matcherFromTokens(tokens) {\n    var checkContext,\n        matcher,\n        j,\n        len = tokens.length,\n        leadingRelative = Expr.relative[tokens[0].type],\n        implicitRelative = leadingRelative || Expr.relative[' '],\n        i = leadingRelative ? 1 : 0,\n        matchContext = addCombinator(function (elem) {\n      return elem === checkContext;\n    }, implicitRelative, true),\n        matchAnyContext = addCombinator(function (elem) {\n      return indexOf.call(checkContext, elem) > -1;\n    }, implicitRelative, true),\n        matchers = [function (elem, context, xml) {\n      var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n      checkContext = null;\n      return ret;\n    }];\n\n    for (; i < len; i++) {\n      if (matcher = Expr.relative[tokens[i].type]) {\n        matchers = [addCombinator(elementMatcher(matchers), matcher)];\n      } else {\n        matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n\n        if (matcher[expando]) {\n          j = ++i;\n\n          for (; j < len; j++) {\n            if (Expr.relative[tokens[j].type]) {\n              break;\n            }\n          }\n\n          return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({\n            value: tokens[i - 2].type === ' ' ? '*' : ''\n          })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n        }\n\n        matchers.push(matcher);\n      }\n    }\n\n    return elementMatcher(matchers);\n  }\n\n  function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n    var bySet = setMatchers.length > 0,\n        byElement = elementMatchers.length > 0,\n        superMatcher = function (seed, context, xml, results, outermost) {\n      var elem,\n          j,\n          matcher,\n          matchedCount = 0,\n          i = '0',\n          unmatched = seed && [],\n          setMatched = [],\n          contextBackup = outermostContext,\n          elems = seed || byElement && Expr.find.TAG('*', outermost),\n          dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1,\n          len = elems.length;\n\n      if (outermost) {\n        outermostContext = context !== document$1 && context;\n      }\n\n      for (; i !== len && (elem = elems[i]) != null; i++) {\n        if (byElement && elem) {\n          j = 0;\n\n          while (matcher = elementMatchers[j++]) {\n            if (matcher(elem, context, xml)) {\n              results.push(elem);\n              break;\n            }\n          }\n\n          if (outermost) {\n            dirruns = dirrunsUnique;\n          }\n        }\n\n        if (bySet) {\n          if (elem = !matcher && elem) {\n            matchedCount--;\n          }\n\n          if (seed) {\n            unmatched.push(elem);\n          }\n        }\n      }\n\n      matchedCount += i;\n\n      if (bySet && i !== matchedCount) {\n        j = 0;\n\n        while (matcher = setMatchers[j++]) {\n          matcher(unmatched, setMatched, context, xml);\n        }\n\n        if (seed) {\n          if (matchedCount > 0) {\n            while (i--) {\n              if (!(unmatched[i] || setMatched[i])) {\n                setMatched[i] = pop.call(results);\n              }\n            }\n          }\n\n          setMatched = condense(setMatched);\n        }\n\n        push$1.apply(results, setMatched);\n\n        if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n          Sizzle.uniqueSort(results);\n        }\n      }\n\n      if (outermost) {\n        dirruns = dirrunsUnique;\n        outermostContext = contextBackup;\n      }\n\n      return unmatched;\n    };\n\n    return bySet ? markFunction(superMatcher) : superMatcher;\n  }\n\n  compile = Sizzle.compile = function (selector, match) {\n    var i,\n        setMatchers = [],\n        elementMatchers = [],\n        cached = compilerCache[selector + ' '];\n\n    if (!cached) {\n      if (!match) {\n        match = tokenize(selector);\n      }\n\n      i = match.length;\n\n      while (i--) {\n        cached = matcherFromTokens(match[i]);\n\n        if (cached[expando]) {\n          setMatchers.push(cached);\n        } else {\n          elementMatchers.push(cached);\n        }\n      }\n\n      cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n      cached.selector = selector;\n    }\n\n    return cached;\n  };\n\n  select$1 = Sizzle.select = function (selector, context, results, seed) {\n    var i,\n        tokens,\n        token,\n        type,\n        find,\n        compiled = typeof selector === 'function' && selector,\n        match = !seed && tokenize(selector = compiled.selector || selector);\n    results = results || [];\n\n    if (match.length === 1) {\n      tokens = match[0] = match[0].slice(0);\n\n      if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n        context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n\n        if (!context) {\n          return results;\n        } else if (compiled) {\n          context = context.parentNode;\n        }\n\n        selector = selector.slice(tokens.shift().value.length);\n      }\n\n      i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n\n      while (i--) {\n        token = tokens[i];\n\n        if (Expr.relative[type = token.type]) {\n          break;\n        }\n\n        if (find = Expr.find[type]) {\n          if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n            tokens.splice(i, 1);\n            selector = seed.length && toSelector(tokens);\n\n            if (!selector) {\n              push$1.apply(results, seed);\n              return results;\n            }\n\n            break;\n          }\n        }\n      }\n    }\n\n    (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n    return results;\n  };\n\n  support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n  support.detectDuplicates = !!hasDuplicate;\n  setDocument();\n  support.sortDetached = true;\n  var doc = document;\n  var push = Array.prototype.push;\n  var slice = Array.prototype.slice;\n  var rquickExpr = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n  var Event$1 = EventUtils.Event;\n  var skipUniques = Tools.makeMap('children,contents,next,prev');\n\n  var isDefined = function (obj) {\n    return typeof obj !== 'undefined';\n  };\n\n  var isString = function (obj) {\n    return typeof obj === 'string';\n  };\n\n  var isWindow = function (obj) {\n    return obj && obj === obj.window;\n  };\n\n  var createFragment$1 = function (html, fragDoc) {\n    fragDoc = fragDoc || doc;\n    var container = fragDoc.createElement('div');\n    var frag = fragDoc.createDocumentFragment();\n    container.innerHTML = html;\n    var node;\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n    var i;\n\n    if (isString(sourceItem)) {\n      sourceItem = createFragment$1(sourceItem, getElementDocument(targetNodes[0]));\n    } else if (sourceItem.length && !sourceItem.nodeType) {\n      sourceItem = DomQuery.makeArray(sourceItem);\n\n      if (reverse) {\n        for (i = sourceItem.length - 1; i >= 0; i--) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      } else {\n        for (i = 0; i < sourceItem.length; i++) {\n          domManipulate(targetNodes, sourceItem[i], callback, reverse);\n        }\n      }\n\n      return targetNodes;\n    }\n\n    if (sourceItem.nodeType) {\n      i = targetNodes.length;\n\n      while (i--) {\n        callback.call(targetNodes[i], sourceItem);\n      }\n    }\n\n    return targetNodes;\n  };\n\n  var hasClass = function (node, className) {\n    return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n  };\n\n  var wrap$2 = function (elements, wrapper, all) {\n    var lastParent, newWrapper;\n    wrapper = DomQuery(wrapper)[0];\n    elements.each(function () {\n      var self = this;\n\n      if (!all || lastParent !== self.parentNode) {\n        lastParent = self.parentNode;\n        newWrapper = wrapper.cloneNode(false);\n        self.parentNode.insertBefore(newWrapper, self);\n        newWrapper.appendChild(self);\n      } else {\n        newWrapper.appendChild(self);\n      }\n    });\n    return elements;\n  };\n\n  var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n  var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n  var propFix = {\n    for: 'htmlFor',\n    class: 'className',\n    readonly: 'readOnly'\n  };\n  var cssFix = {\n    float: 'cssFloat'\n  };\n  var attrHooks = {},\n      cssHooks = {};\n\n  var DomQueryConstructor = function (selector, context) {\n    return new DomQuery.fn.init(selector, context);\n  };\n\n  var inArray$1 = function (item, array) {\n    var i;\n\n    if (array.indexOf) {\n      return array.indexOf(item);\n    }\n\n    i = array.length;\n\n    while (i--) {\n      if (array[i] === item) {\n        return i;\n      }\n    }\n\n    return -1;\n  };\n\n  var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n\n  var trim$1 = function (str) {\n    return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n  };\n\n  var each$g = function (obj, callback) {\n    var length, key, i, value;\n\n    if (obj) {\n      length = obj.length;\n\n      if (length === undefined) {\n        for (key in obj) {\n          if (obj.hasOwnProperty(key)) {\n            value = obj[key];\n\n            if (callback.call(value, key, value) === false) {\n              break;\n            }\n          }\n        }\n      } else {\n        for (i = 0; i < length; i++) {\n          value = obj[i];\n\n          if (callback.call(value, i, value) === false) {\n            break;\n          }\n        }\n      }\n    }\n\n    return obj;\n  };\n\n  var grep$2 = function (array, callback) {\n    var out = [];\n    each$g(array, function (i, item) {\n      if (callback(item, i)) {\n        out.push(item);\n      }\n    });\n    return out;\n  };\n\n  var getElementDocument = function (element) {\n    if (!element) {\n      return doc;\n    }\n\n    if (element.nodeType === 9) {\n      return element;\n    }\n\n    return element.ownerDocument;\n  };\n\n  DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n    constructor: DomQueryConstructor,\n    selector: '',\n    context: null,\n    length: 0,\n    init: function (selector, context) {\n      var self = this;\n      var match, node;\n\n      if (!selector) {\n        return self;\n      }\n\n      if (selector.nodeType) {\n        self.context = self[0] = selector;\n        self.length = 1;\n        return self;\n      }\n\n      if (context && context.nodeType) {\n        self.context = context;\n      } else {\n        if (context) {\n          return DomQuery(selector).attr(context);\n        }\n\n        self.context = context = document;\n      }\n\n      if (isString(selector)) {\n        self.selector = selector;\n\n        if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n          match = [null, selector, null];\n        } else {\n          match = rquickExpr.exec(selector);\n        }\n\n        if (match) {\n          if (match[1]) {\n            node = createFragment$1(selector, getElementDocument(context)).firstChild;\n\n            while (node) {\n              push.call(self, node);\n              node = node.nextSibling;\n            }\n          } else {\n            node = getElementDocument(context).getElementById(match[2]);\n\n            if (!node) {\n              return self;\n            }\n\n            if (node.id !== match[2]) {\n              return self.find(selector);\n            }\n\n            self.length = 1;\n            self[0] = node;\n          }\n        } else {\n          return DomQuery(context).find(selector);\n        }\n      } else {\n        this.add(selector, false);\n      }\n\n      return self;\n    },\n    toArray: function () {\n      return Tools.toArray(this);\n    },\n    add: function (items, sort) {\n      var self = this;\n      var nodes, i;\n\n      if (isString(items)) {\n        return self.add(DomQuery(items));\n      }\n\n      if (sort !== false) {\n        nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n        self.length = nodes.length;\n\n        for (i = 0; i < nodes.length; i++) {\n          self[i] = nodes[i];\n        }\n      } else {\n        push.apply(self, DomQuery.makeArray(items));\n      }\n\n      return self;\n    },\n    attr: function (name, value) {\n      var self = this;\n      var hook;\n\n      if (typeof name === 'object') {\n        each$g(name, function (name, value) {\n          self.attr(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          var hook;\n\n          if (this.nodeType === 1) {\n            hook = attrHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            if (value === null) {\n              this.removeAttribute(name, 2);\n            } else {\n              this.setAttribute(name, value, 2);\n            }\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType === 1) {\n          hook = attrHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(self[0], name);\n          }\n\n          if (booleanMap[name]) {\n            return self.prop(name) ? name : undefined;\n          }\n\n          value = self[0].getAttribute(name, 2);\n\n          if (value === null) {\n            value = undefined;\n          }\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    removeAttr: function (name) {\n      return this.attr(name, null);\n    },\n    prop: function (name, value) {\n      var self = this;\n      name = propFix[name] || name;\n\n      if (typeof name === 'object') {\n        each$g(name, function (name, value) {\n          self.prop(name, value);\n        });\n      } else if (isDefined(value)) {\n        this.each(function () {\n          if (this.nodeType === 1) {\n            this[name] = value;\n          }\n        });\n      } else {\n        if (self[0] && self[0].nodeType && name in self[0]) {\n          return self[0][name];\n        }\n\n        return value;\n      }\n\n      return self;\n    },\n    css: function (name, value) {\n      var self = this;\n      var elm, hook;\n\n      var camel = function (name) {\n        return name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n      };\n\n      var dashed = function (name) {\n        return name.replace(/[A-Z]/g, function (a) {\n          return '-' + a;\n        });\n      };\n\n      if (typeof name === 'object') {\n        each$g(name, function (name, value) {\n          self.css(name, value);\n        });\n      } else {\n        if (isDefined(value)) {\n          name = camel(name);\n\n          if (typeof value === 'number' && !numericCssMap[name]) {\n            value = value.toString() + 'px';\n          }\n\n          self.each(function () {\n            var style = this.style;\n            hook = cssHooks[name];\n\n            if (hook && hook.set) {\n              hook.set(this, value);\n              return;\n            }\n\n            try {\n              this.style[cssFix[name] || name] = value;\n            } catch (ex) {}\n\n            if (value === null || value === '') {\n              if (style.removeProperty) {\n                style.removeProperty(dashed(name));\n              } else {\n                style.removeAttribute(name);\n              }\n            }\n          });\n        } else {\n          elm = self[0];\n          hook = cssHooks[name];\n\n          if (hook && hook.get) {\n            return hook.get(elm);\n          }\n\n          if (elm.ownerDocument.defaultView) {\n            try {\n              return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n            } catch (ex) {\n              return undefined;\n            }\n          } else if (elm.currentStyle) {\n            return elm.currentStyle[camel(name)];\n          } else {\n            return '';\n          }\n        }\n      }\n\n      return self;\n    },\n    remove: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n        Event$1.clean(node);\n\n        if (node.parentNode) {\n          node.parentNode.removeChild(node);\n        }\n      }\n\n      return this;\n    },\n    empty: function () {\n      var self = this;\n      var node,\n          i = this.length;\n\n      while (i--) {\n        node = self[i];\n\n        while (node.firstChild) {\n          node.removeChild(node.firstChild);\n        }\n      }\n\n      return this;\n    },\n    html: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        try {\n          while (i--) {\n            self[i].innerHTML = value;\n          }\n        } catch (ex) {\n          DomQuery(self[i]).empty().append(value);\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerHTML : '';\n    },\n    text: function (value) {\n      var self = this;\n      var i;\n\n      if (isDefined(value)) {\n        i = self.length;\n\n        while (i--) {\n          if ('innerText' in self[i]) {\n            self[i].innerText = value;\n          } else {\n            self[0].textContent = value;\n          }\n        }\n\n        return self;\n      }\n\n      return self[0] ? self[0].innerText || self[0].textContent : '';\n    },\n    append: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.appendChild(node);\n        }\n      });\n    },\n    prepend: function () {\n      return domManipulate(this, arguments, function (node) {\n        if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n          this.insertBefore(node, this.firstChild);\n        }\n      }, true);\n    },\n    before: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this);\n        });\n      }\n\n      return self;\n    },\n    after: function () {\n      var self = this;\n\n      if (self[0] && self[0].parentNode) {\n        return domManipulate(self, arguments, function (node) {\n          this.parentNode.insertBefore(node, this.nextSibling);\n        }, true);\n      }\n\n      return self;\n    },\n    appendTo: function (val) {\n      DomQuery(val).append(this);\n      return this;\n    },\n    prependTo: function (val) {\n      DomQuery(val).prepend(this);\n      return this;\n    },\n    replaceWith: function (content) {\n      return this.before(content).remove();\n    },\n    wrap: function (content) {\n      return wrap$2(this, content);\n    },\n    wrapAll: function (content) {\n      return wrap$2(this, content, true);\n    },\n    wrapInner: function (content) {\n      this.each(function () {\n        DomQuery(this).contents().wrapAll(content);\n      });\n      return this;\n    },\n    unwrap: function () {\n      return this.parent().each(function () {\n        DomQuery(this).replaceWith(this.childNodes);\n      });\n    },\n    clone: function () {\n      var result = [];\n      this.each(function () {\n        result.push(this.cloneNode(true));\n      });\n      return DomQuery(result);\n    },\n    addClass: function (className) {\n      return this.toggleClass(className, true);\n    },\n    removeClass: function (className) {\n      return this.toggleClass(className, false);\n    },\n    toggleClass: function (className, state) {\n      var self = this;\n\n      if (typeof className !== 'string') {\n        return self;\n      }\n\n      if (className.indexOf(' ') !== -1) {\n        each$g(className.split(' '), function () {\n          self.toggleClass(this, state);\n        });\n      } else {\n        self.each(function (index, node) {\n          var classState = hasClass(node, className);\n\n          if (classState !== state) {\n            var existingClassName = node.className;\n\n            if (classState) {\n              node.className = trim$1((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n            } else {\n              node.className += existingClassName ? ' ' + className : className;\n            }\n          }\n        });\n      }\n\n      return self;\n    },\n    hasClass: function (className) {\n      return hasClass(this[0], className);\n    },\n    each: function (callback) {\n      return each$g(this, callback);\n    },\n    on: function (name, callback) {\n      return this.each(function () {\n        Event$1.bind(this, name, callback);\n      });\n    },\n    off: function (name, callback) {\n      return this.each(function () {\n        Event$1.unbind(this, name, callback);\n      });\n    },\n    trigger: function (name) {\n      return this.each(function () {\n        if (typeof name === 'object') {\n          Event$1.fire(this, name.type, name);\n        } else {\n          Event$1.fire(this, name);\n        }\n      });\n    },\n    show: function () {\n      return this.css('display', '');\n    },\n    hide: function () {\n      return this.css('display', 'none');\n    },\n    slice: function () {\n      return DomQuery(slice.apply(this, arguments));\n    },\n    eq: function (index) {\n      return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n    },\n    first: function () {\n      return this.eq(0);\n    },\n    last: function () {\n      return this.eq(-1);\n    },\n    find: function (selector) {\n      var i, l;\n      var ret = [];\n\n      for (i = 0, l = this.length; i < l; i++) {\n        DomQuery.find(selector, this[i], ret);\n      }\n\n      return DomQuery(ret);\n    },\n    filter: function (selector) {\n      if (typeof selector === 'function') {\n        return DomQuery(grep$2(this.toArray(), function (item, i) {\n          return selector(i, item);\n        }));\n      }\n\n      return DomQuery(DomQuery.filter(selector, this.toArray()));\n    },\n    closest: function (selector) {\n      var result = [];\n\n      if (selector instanceof DomQuery) {\n        selector = selector[0];\n      }\n\n      this.each(function (i, node) {\n        while (node) {\n          if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n            result.push(node);\n            break;\n          } else if (node === selector) {\n            result.push(node);\n            break;\n          }\n\n          node = node.parentNode;\n        }\n      });\n      return DomQuery(result);\n    },\n    offset: function (offset) {\n      var elm, doc, docElm;\n      var x = 0,\n          y = 0,\n          pos;\n\n      if (!offset) {\n        elm = this[0];\n\n        if (elm) {\n          doc = elm.ownerDocument;\n          docElm = doc.documentElement;\n\n          if (elm.getBoundingClientRect) {\n            pos = elm.getBoundingClientRect();\n            x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n            y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n          }\n        }\n\n        return {\n          left: x,\n          top: y\n        };\n      }\n\n      return this.css(offset);\n    },\n    push: push,\n    sort: Array.prototype.sort,\n    splice: Array.prototype.splice\n  };\n  Tools.extend(DomQueryConstructor, {\n    extend: Tools.extend,\n    makeArray: function (object) {\n      if (isWindow(object) || object.nodeType) {\n        return [object];\n      }\n\n      return Tools.toArray(object);\n    },\n    inArray: inArray$1,\n    isArray: Tools.isArray,\n    each: each$g,\n    trim: trim$1,\n    grep: grep$2,\n    find: Sizzle,\n    expr: Sizzle.selectors,\n    unique: Sizzle.uniqueSort,\n    text: Sizzle.getText,\n    contains: Sizzle.contains,\n    filter: function (expr, elems, not) {\n      var i = elems.length;\n\n      if (not) {\n        expr = ':not(' + expr + ')';\n      }\n\n      while (i--) {\n        if (elems[i].nodeType !== 1) {\n          elems.splice(i, 1);\n        }\n      }\n\n      if (elems.length === 1) {\n        elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n      } else {\n        elems = DomQuery.find.matches(expr, elems);\n      }\n\n      return elems;\n    }\n  });\n\n  var dir = function (el, prop, until) {\n    var matched = [];\n    var cur = el[prop];\n\n    if (typeof until !== 'string' && until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    while (cur && cur.nodeType !== 9) {\n      if (until !== undefined) {\n        if (cur === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(cur).is(until)) {\n          break;\n        }\n      }\n\n      if (cur.nodeType === 1) {\n        matched.push(cur);\n      }\n\n      cur = cur[prop];\n    }\n\n    return matched;\n  };\n\n  var sibling$1 = function (node, siblingName, nodeType, until) {\n    var result = [];\n\n    if (until instanceof DomQuery) {\n      until = until[0];\n    }\n\n    for (; node; node = node[siblingName]) {\n      if (nodeType && node.nodeType !== nodeType) {\n        continue;\n      }\n\n      if (until !== undefined) {\n        if (node === until) {\n          break;\n        }\n\n        if (typeof until === 'string' && DomQuery(node).is(until)) {\n          break;\n        }\n      }\n\n      result.push(node);\n    }\n\n    return result;\n  };\n\n  var firstSibling = function (node, siblingName, nodeType) {\n    for (node = node[siblingName]; node; node = node[siblingName]) {\n      if (node.nodeType === nodeType) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  each$g({\n    parent: function (node) {\n      var parent = node.parentNode;\n      return parent && parent.nodeType !== 11 ? parent : null;\n    },\n    parents: function (node) {\n      return dir(node, 'parentNode');\n    },\n    next: function (node) {\n      return firstSibling(node, 'nextSibling', 1);\n    },\n    prev: function (node) {\n      return firstSibling(node, 'previousSibling', 1);\n    },\n    children: function (node) {\n      return sibling$1(node.firstChild, 'nextSibling', 1);\n    },\n    contents: function (node) {\n      return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        if (!skipUniques[name]) {\n          result = DomQuery.unique(result);\n        }\n\n        if (name.indexOf('parents') === 0) {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (selector) {\n        return wrappedResult.filter(selector);\n      }\n\n      return wrappedResult;\n    };\n  });\n  each$g({\n    parentsUntil: function (node, until) {\n      return dir(node, 'parentNode', until);\n    },\n    nextUntil: function (node, until) {\n      return sibling$1(node, 'nextSibling', 1, until).slice(1);\n    },\n    prevUntil: function (node, until) {\n      return sibling$1(node, 'previousSibling', 1, until).slice(1);\n    }\n  }, function (name, fn) {\n    DomQueryConstructor.fn[name] = function (selector, filter) {\n      var self = this;\n      var result = [];\n      self.each(function () {\n        var nodes = fn.call(result, this, selector, result);\n\n        if (nodes) {\n          if (DomQuery.isArray(nodes)) {\n            result.push.apply(result, nodes);\n          } else {\n            result.push(nodes);\n          }\n        }\n      });\n\n      if (this.length > 1) {\n        result = DomQuery.unique(result);\n\n        if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n          result = result.reverse();\n        }\n      }\n\n      var wrappedResult = DomQuery(result);\n\n      if (filter) {\n        return wrappedResult.filter(filter);\n      }\n\n      return wrappedResult;\n    };\n  });\n\n  DomQueryConstructor.fn.is = function (selector) {\n    return !!selector && this.filter(selector).length > 0;\n  };\n\n  DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n\n  DomQueryConstructor.overrideDefaults = function (callback) {\n    var defaults;\n\n    var sub = function (selector, context) {\n      defaults = defaults || callback();\n\n      if (arguments.length === 0) {\n        selector = defaults.element;\n      }\n\n      if (!context) {\n        context = defaults.context;\n      }\n\n      return new sub.fn.init(selector, context);\n    };\n\n    DomQuery.extend(sub, this);\n    return sub;\n  };\n\n  DomQueryConstructor.attrHooks = attrHooks;\n  DomQueryConstructor.cssHooks = cssHooks;\n  var DomQuery = DomQueryConstructor;\n  var each$f = Tools.each;\n  var grep$1 = Tools.grep;\n  var isIE = Env.ie;\n  var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n\n  var setupAttrHooks = function (styles, settings, getContext) {\n    var keepValues = settings.keep_values;\n    var keepUrlHook = {\n      set: function ($elm, value, name) {\n        if (settings.url_converter && value !== null) {\n          value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n        }\n\n        $elm.attr('data-mce-' + name, value).attr(name, value);\n      },\n      get: function ($elm, name) {\n        return $elm.attr('data-mce-' + name) || $elm.attr(name);\n      }\n    };\n    var attrHooks = {\n      style: {\n        set: function ($elm, value) {\n          if (value !== null && typeof value === 'object') {\n            $elm.css(value);\n            return;\n          }\n\n          if (keepValues) {\n            $elm.attr('data-mce-style', value);\n          }\n\n          if (value !== null && typeof value === 'string') {\n            $elm.removeAttr('style');\n            $elm.css(styles.parse(value));\n          } else {\n            $elm.attr('style', value);\n          }\n        },\n        get: function ($elm) {\n          var value = $elm.attr('data-mce-style') || $elm.attr('style');\n          value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n          return value;\n        }\n      }\n    };\n\n    if (keepValues) {\n      attrHooks.href = attrHooks.src = keepUrlHook;\n    }\n\n    return attrHooks;\n  };\n\n  var updateInternalStyleAttr = function (styles, $elm) {\n    var rawValue = $elm.attr('style');\n    var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n\n    if (!value) {\n      value = null;\n    }\n\n    $elm.attr('data-mce-style', value);\n  };\n\n  var findNodeIndex = function (node, normalized) {\n    var idx = 0,\n        lastNodeType,\n        nodeType;\n\n    if (node) {\n      for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n        nodeType = node.nodeType;\n\n        if (normalized && nodeType === 3) {\n          if (nodeType === lastNodeType || !node.nodeValue.length) {\n            continue;\n          }\n        }\n\n        idx++;\n        lastNodeType = nodeType;\n      }\n    }\n\n    return idx;\n  };\n\n  var DOMUtils = function (doc, settings) {\n    if (settings === void 0) {\n      settings = {};\n    }\n\n    var addedStyles = {};\n    var win = window;\n    var files = {};\n    var counter = 0;\n    var stdMode = true;\n    var boxModel = true;\n    var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n      contentCssCors: settings.contentCssCors,\n      referrerPolicy: settings.referrerPolicy\n    });\n    var boundEvents = [];\n    var schema = settings.schema ? settings.schema : Schema({});\n    var styles = Styles({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope\n    }, settings.schema);\n    var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n    var blockElementsMap = schema.getBlockElements();\n    var $ = DomQuery.overrideDefaults(function () {\n      return {\n        context: doc,\n        element: self.getRoot()\n      };\n    });\n\n    var isBlock = function (node) {\n      if (typeof node === 'string') {\n        return !!blockElementsMap[node];\n      } else if (node) {\n        var type = node.nodeType;\n\n        if (type) {\n          return !!(type === 1 && blockElementsMap[node.nodeName]);\n        }\n      }\n\n      return false;\n    };\n\n    var get = function (elm) {\n      return elm && doc && isString$1(elm) ? doc.getElementById(elm) : elm;\n    };\n\n    var $$ = function (elm) {\n      return $(typeof elm === 'string' ? get(elm) : elm);\n    };\n\n    var getAttrib = function (elm, name, defaultVal) {\n      var hook, value;\n      var $elm = $$(elm);\n\n      if ($elm.length) {\n        hook = attrHooks[name];\n\n        if (hook && hook.get) {\n          value = hook.get($elm, name);\n        } else {\n          value = $elm.attr(name);\n        }\n      }\n\n      if (typeof value === 'undefined') {\n        value = defaultVal || '';\n      }\n\n      return value;\n    };\n\n    var getAttribs = function (elm) {\n      var node = get(elm);\n\n      if (!node) {\n        return [];\n      }\n\n      return node.attributes;\n    };\n\n    var setAttrib = function (elm, name, value) {\n      if (value === '') {\n        value = null;\n      }\n\n      var $elm = $$(elm);\n      var originalValue = $elm.attr(name);\n\n      if (!$elm.length) {\n        return;\n      }\n\n      var hook = attrHooks[name];\n\n      if (hook && hook.set) {\n        hook.set($elm, value, name);\n      } else {\n        $elm.attr(name, value);\n      }\n\n      if (originalValue !== value && settings.onSetAttrib) {\n        settings.onSetAttrib({\n          attrElm: $elm,\n          attrName: name,\n          attrValue: value\n        });\n      }\n    };\n\n    var clone = function (node, deep) {\n      if (!isIE || node.nodeType !== 1 || deep) {\n        return node.cloneNode(deep);\n      } else {\n        var clone_1 = doc.createElement(node.nodeName);\n        each$f(getAttribs(node), function (attr) {\n          setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n        });\n        return clone_1;\n      }\n    };\n\n    var getRoot = function () {\n      return settings.root_element || doc.body;\n    };\n\n    var getViewPort = function (argWin) {\n      var vp = getBounds(argWin);\n      return {\n        x: vp.x,\n        y: vp.y,\n        w: vp.width,\n        h: vp.height\n      };\n    };\n\n    var getPos$1 = function (elm, rootElm) {\n      return getPos(doc.body, get(elm), rootElm);\n    };\n\n    var setStyle = function (elm, name, value) {\n      var $elm = isString$1(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var setStyles = function (elm, stylesArg) {\n      var $elm = $$(elm).css(stylesArg);\n\n      if (settings.update_styles) {\n        updateInternalStyleAttr(styles, $elm);\n      }\n    };\n\n    var getStyle = function (elm, name, computed) {\n      var $elm = $$(elm);\n\n      if (computed) {\n        return $elm.css(name);\n      }\n\n      name = name.replace(/-(\\D)/g, function (a, b) {\n        return b.toUpperCase();\n      });\n\n      if (name === 'float') {\n        name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n      }\n\n      return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n    };\n\n    var getSize = function (elm) {\n      var w, h;\n      elm = get(elm);\n      w = getStyle(elm, 'width');\n      h = getStyle(elm, 'height');\n\n      if (w.indexOf('px') === -1) {\n        w = 0;\n      }\n\n      if (h.indexOf('px') === -1) {\n        h = 0;\n      }\n\n      return {\n        w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n        h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n      };\n    };\n\n    var getRect = function (elm) {\n      elm = get(elm);\n      var pos = getPos$1(elm);\n      var size = getSize(elm);\n      return {\n        x: pos.x,\n        y: pos.y,\n        w: size.w,\n        h: size.h\n      };\n    };\n\n    var is = function (elm, selector) {\n      var i;\n\n      if (!elm) {\n        return false;\n      }\n\n      if (!Array.isArray(elm)) {\n        if (selector === '*') {\n          return elm.nodeType === 1;\n        }\n\n        if (simpleSelectorRe.test(selector)) {\n          var selectors = selector.toLowerCase().split(/,/);\n          var elmName = elm.nodeName.toLowerCase();\n\n          for (i = selectors.length - 1; i >= 0; i--) {\n            if (selectors[i] === elmName) {\n              return true;\n            }\n          }\n\n          return false;\n        }\n\n        if (elm.nodeType && elm.nodeType !== 1) {\n          return false;\n        }\n      }\n\n      var elms = !Array.isArray(elm) ? [elm] : elm;\n      return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n    };\n\n    var getParents = function (elm, selector, root, collect) {\n      var result = [];\n      var selectorVal;\n      var node = get(elm);\n      collect = collect === undefined;\n      root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n\n      if (Tools.is(selector, 'string')) {\n        selectorVal = selector;\n\n        if (selector === '*') {\n          selector = function (node) {\n            return node.nodeType === 1;\n          };\n        } else {\n          selector = function (node) {\n            return is(node, selectorVal);\n          };\n        }\n      }\n\n      while (node) {\n        if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment(node)) {\n          break;\n        }\n\n        if (!selector || typeof selector === 'function' && selector(node)) {\n          if (collect) {\n            result.push(node);\n          } else {\n            return [node];\n          }\n        }\n\n        node = node.parentNode;\n      }\n\n      return collect ? result : null;\n    };\n\n    var getParent = function (node, selector, root) {\n      var parents = getParents(node, selector, root, false);\n      return parents && parents.length > 0 ? parents[0] : null;\n    };\n\n    var _findSib = function (node, selector, name) {\n      var func = selector;\n\n      if (node) {\n        if (typeof selector === 'string') {\n          func = function (node) {\n            return is(node, selector);\n          };\n        }\n\n        for (node = node[name]; node; node = node[name]) {\n          if (typeof func === 'function' && func(node)) {\n            return node;\n          }\n        }\n      }\n\n      return null;\n    };\n\n    var getNext = function (node, selector) {\n      return _findSib(node, selector, 'nextSibling');\n    };\n\n    var getPrev = function (node, selector) {\n      return _findSib(node, selector, 'previousSibling');\n    };\n\n    var select = function (selector, scope) {\n      return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n    };\n\n    var run = function (elm, func, scope) {\n      var result;\n      var node = typeof elm === 'string' ? get(elm) : elm;\n\n      if (!node) {\n        return false;\n      }\n\n      if (Tools.isArray(node) && (node.length || node.length === 0)) {\n        result = [];\n        each$f(node, function (elm, i) {\n          if (elm) {\n            result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n          }\n        });\n        return result;\n      }\n\n      var context = scope ? scope : this;\n      return func.call(context, node);\n    };\n\n    var setAttribs = function (elm, attrs) {\n      $$(elm).each(function (i, node) {\n        each$f(attrs, function (value, name) {\n          setAttrib(node, name, value);\n        });\n      });\n    };\n\n    var setHTML = function (elm, html) {\n      var $elm = $$(elm);\n\n      if (isIE) {\n        $elm.each(function (i, target) {\n          if (target.canHaveHTML === false) {\n            return;\n          }\n\n          while (target.firstChild) {\n            target.removeChild(target.firstChild);\n          }\n\n          try {\n            target.innerHTML = '<br>' + html;\n            target.removeChild(target.firstChild);\n          } catch (ex) {\n            DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n          }\n\n          return html;\n        });\n      } else {\n        $elm.html(html);\n      }\n    };\n\n    var add = function (parentElm, name, attrs, html, create) {\n      return run(parentElm, function (parentElm) {\n        var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n        setAttribs(newElm, attrs);\n\n        if (html) {\n          if (typeof html !== 'string' && html.nodeType) {\n            newElm.appendChild(html);\n          } else if (typeof html === 'string') {\n            setHTML(newElm, html);\n          }\n        }\n\n        return !create ? parentElm.appendChild(newElm) : newElm;\n      });\n    };\n\n    var create = function (name, attrs, html) {\n      return add(doc.createElement(name), name, attrs, html, true);\n    };\n\n    var decode = Entities.decode;\n    var encode = Entities.encodeAllRaw;\n\n    var createHTML = function (name, attrs, html) {\n      var outHtml = '',\n          key;\n      outHtml += '<' + name;\n\n      for (key in attrs) {\n        if (hasNonNullableKey(attrs, key)) {\n          outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n        }\n      }\n\n      if (typeof html !== 'undefined') {\n        return outHtml + '>' + html + '</' + name + '>';\n      }\n\n      return outHtml + ' />';\n    };\n\n    var createFragment = function (html) {\n      var node;\n      var container = doc.createElement('div');\n      var frag = doc.createDocumentFragment();\n      frag.appendChild(container);\n\n      if (html) {\n        container.innerHTML = html;\n      }\n\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n\n      frag.removeChild(container);\n      return frag;\n    };\n\n    var remove = function (node, keepChildren) {\n      var $node = $$(node);\n\n      if (keepChildren) {\n        $node.each(function () {\n          var child;\n\n          while (child = this.firstChild) {\n            if (child.nodeType === 3 && child.data.length === 0) {\n              this.removeChild(child);\n            } else {\n              this.parentNode.insertBefore(child, this);\n            }\n          }\n        }).remove();\n      } else {\n        $node.remove();\n      }\n\n      return $node.length > 1 ? $node.toArray() : $node[0];\n    };\n\n    var removeAllAttribs = function (e) {\n      return run(e, function (e) {\n        var i;\n        var attrs = e.attributes;\n\n        for (i = attrs.length - 1; i >= 0; i--) {\n          e.removeAttributeNode(attrs.item(i));\n        }\n      });\n    };\n\n    var parseStyle = function (cssText) {\n      return styles.parse(cssText);\n    };\n\n    var serializeStyle = function (stylesArg, name) {\n      return styles.serialize(stylesArg, name);\n    };\n\n    var addStyle = function (cssText) {\n      var head, styleElm;\n\n      if (self !== DOMUtils.DOM && doc === document) {\n        if (addedStyles[cssText]) {\n          return;\n        }\n\n        addedStyles[cssText] = true;\n      }\n\n      styleElm = doc.getElementById('mceDefaultStyles');\n\n      if (!styleElm) {\n        styleElm = doc.createElement('style');\n        styleElm.id = 'mceDefaultStyles';\n        styleElm.type = 'text/css';\n        head = doc.getElementsByTagName('head')[0];\n\n        if (head.firstChild) {\n          head.insertBefore(styleElm, head.firstChild);\n        } else {\n          head.appendChild(styleElm);\n        }\n      }\n\n      if (styleElm.styleSheet) {\n        styleElm.styleSheet.cssText += cssText;\n      } else {\n        styleElm.appendChild(doc.createTextNode(cssText));\n      }\n    };\n\n    var loadCSS = function (urls) {\n      if (!urls) {\n        urls = '';\n      }\n\n      each$k(urls.split(','), function (url) {\n        files[url] = true;\n        styleSheetLoader.load(url, noop);\n      });\n    };\n\n    var toggleClass = function (elm, cls, state) {\n      $$(elm).toggleClass(cls, state).each(function () {\n        if (this.className === '') {\n          DomQuery(this).attr('class', null);\n        }\n      });\n    };\n\n    var addClass = function (elm, cls) {\n      $$(elm).addClass(cls);\n    };\n\n    var removeClass = function (elm, cls) {\n      toggleClass(elm, cls, false);\n    };\n\n    var hasClass = function (elm, cls) {\n      return $$(elm).hasClass(cls);\n    };\n\n    var show = function (elm) {\n      $$(elm).show();\n    };\n\n    var hide = function (elm) {\n      $$(elm).hide();\n    };\n\n    var isHidden = function (elm) {\n      return $$(elm).css('display') === 'none';\n    };\n\n    var uniqueId = function (prefix) {\n      return (!prefix ? 'mce_' : prefix) + counter++;\n    };\n\n    var getOuterHTML = function (elm) {\n      var node = typeof elm === 'string' ? get(elm) : elm;\n      return isElement$5(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n    };\n\n    var setOuterHTML = function (elm, html) {\n      $$(elm).each(function () {\n        try {\n          if ('outerHTML' in this) {\n            this.outerHTML = html;\n            return;\n          }\n        } catch (ex) {}\n\n        remove(DomQuery(this).html(html), true);\n      });\n    };\n\n    var insertAfter = function (node, reference) {\n      var referenceNode = get(reference);\n      return run(node, function (node) {\n        var parent = referenceNode.parentNode;\n        var nextSibling = referenceNode.nextSibling;\n\n        if (nextSibling) {\n          parent.insertBefore(node, nextSibling);\n        } else {\n          parent.appendChild(node);\n        }\n\n        return node;\n      });\n    };\n\n    var replace = function (newElm, oldElm, keepChildren) {\n      return run(oldElm, function (oldElm) {\n        if (Tools.is(oldElm, 'array')) {\n          newElm = newElm.cloneNode(true);\n        }\n\n        if (keepChildren) {\n          each$f(grep$1(oldElm.childNodes), function (node) {\n            newElm.appendChild(node);\n          });\n        }\n\n        return oldElm.parentNode.replaceChild(newElm, oldElm);\n      });\n    };\n\n    var rename = function (elm, name) {\n      var newElm;\n\n      if (elm.nodeName !== name.toUpperCase()) {\n        newElm = create(name);\n        each$f(getAttribs(elm), function (attrNode) {\n          setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n        });\n        replace(newElm, elm, true);\n      }\n\n      return newElm || elm;\n    };\n\n    var findCommonAncestor = function (a, b) {\n      var ps = a,\n          pe;\n\n      while (ps) {\n        pe = b;\n\n        while (pe && ps !== pe) {\n          pe = pe.parentNode;\n        }\n\n        if (ps === pe) {\n          break;\n        }\n\n        ps = ps.parentNode;\n      }\n\n      if (!ps && a.ownerDocument) {\n        return a.ownerDocument.documentElement;\n      }\n\n      return ps;\n    };\n\n    var toHex = function (rgbVal) {\n      return styles.toHex(Tools.trim(rgbVal));\n    };\n\n    var isNonEmptyElement = function (node) {\n      if (isElement$5(node)) {\n        var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n\n        if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    var isEmpty = function (node, elements) {\n      var type,\n          name,\n          brCount = 0;\n\n      if (isNonEmptyElement(node)) {\n        return false;\n      }\n\n      node = node.firstChild;\n\n      if (node) {\n        var walker = new DomTreeWalker(node, node.parentNode);\n        var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n        elements = elements || (schema ? schema.getNonEmptyElements() : null);\n\n        do {\n          type = node.nodeType;\n\n          if (isElement$5(node)) {\n            var bogusVal = node.getAttribute('data-mce-bogus');\n\n            if (bogusVal) {\n              node = walker.next(bogusVal === 'all');\n              continue;\n            }\n\n            name = node.nodeName.toLowerCase();\n\n            if (elements && elements[name]) {\n              if (name === 'br') {\n                brCount++;\n                node = walker.next();\n                continue;\n              }\n\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (type === 8) {\n            return false;\n          }\n\n          if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n\n          node = walker.next();\n        } while (node);\n      }\n\n      return brCount <= 1;\n    };\n\n    var createRng = function () {\n      return doc.createRange();\n    };\n\n    var split = function (parentElm, splitElm, replacementElm) {\n      var range = createRng();\n      var beforeFragment;\n      var afterFragment;\n      var parentNode;\n\n      if (parentElm && splitElm) {\n        range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n        range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n        beforeFragment = range.extractContents();\n        range = createRng();\n        range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n        range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n        afterFragment = range.extractContents();\n        parentNode = parentElm.parentNode;\n        parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n\n        if (replacementElm) {\n          parentNode.insertBefore(replacementElm, parentElm);\n        } else {\n          parentNode.insertBefore(splitElm, parentElm);\n        }\n\n        parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n        remove(parentElm);\n        return replacementElm || splitElm;\n      }\n    };\n\n    var bind = function (target, name, func, scope) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = bind(target[i], name, func, scope);\n        }\n\n        return rv;\n      }\n\n      if (settings.collect && (target === doc || target === win)) {\n        boundEvents.push([target, name, func, scope]);\n      }\n\n      var output = events.bind(target, name, func, scope || self);\n      return output;\n    };\n\n    var unbind = function (target, name, func) {\n      if (Tools.isArray(target)) {\n        var i = target.length;\n        var rv = [];\n\n        while (i--) {\n          rv[i] = unbind(target[i], name, func);\n        }\n\n        return rv;\n      } else {\n        if (boundEvents.length > 0 && (target === doc || target === win)) {\n          var i = boundEvents.length;\n\n          while (i--) {\n            var item = boundEvents[i];\n\n            if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n              events.unbind(item[0], item[1], item[2]);\n            }\n          }\n        }\n\n        return events.unbind(target, name, func);\n      }\n    };\n\n    var fire = function (target, name, evt) {\n      return events.fire(target, name, evt);\n    };\n\n    var getContentEditable = function (node) {\n      if (node && isElement$5(node)) {\n        var contentEditable = node.getAttribute('data-mce-contenteditable');\n\n        if (contentEditable && contentEditable !== 'inherit') {\n          return contentEditable;\n        }\n\n        return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n      } else {\n        return null;\n      }\n    };\n\n    var getContentEditableParent = function (node) {\n      var root = getRoot();\n      var state = null;\n\n      for (; node && node !== root; node = node.parentNode) {\n        state = getContentEditable(node);\n\n        if (state !== null) {\n          break;\n        }\n      }\n\n      return state;\n    };\n\n    var destroy = function () {\n      if (boundEvents.length > 0) {\n        var i = boundEvents.length;\n\n        while (i--) {\n          var item = boundEvents[i];\n          events.unbind(item[0], item[1], item[2]);\n        }\n      }\n\n      each$j(files, function (_, url) {\n        styleSheetLoader.unload(url);\n        delete files[url];\n      });\n\n      if (Sizzle.setDocument) {\n        Sizzle.setDocument();\n      }\n    };\n\n    var isChildOf = function (node, parent) {\n      if (!isIE) {\n        return node === parent || parent.contains(node);\n      } else {\n        while (node) {\n          if (parent === node) {\n            return true;\n          }\n\n          node = node.parentNode;\n        }\n\n        return false;\n      }\n    };\n\n    var dumpRng = function (r) {\n      return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n    };\n\n    var self = {\n      doc: doc,\n      settings: settings,\n      win: win,\n      files: files,\n      stdMode: stdMode,\n      boxModel: boxModel,\n      styleSheetLoader: styleSheetLoader,\n      boundEvents: boundEvents,\n      styles: styles,\n      schema: schema,\n      events: events,\n      isBlock: isBlock,\n      $: $,\n      $$: $$,\n      root: null,\n      clone: clone,\n      getRoot: getRoot,\n      getViewPort: getViewPort,\n      getRect: getRect,\n      getSize: getSize,\n      getParent: getParent,\n      getParents: getParents,\n      get: get,\n      getNext: getNext,\n      getPrev: getPrev,\n      select: select,\n      is: is,\n      add: add,\n      create: create,\n      createHTML: createHTML,\n      createFragment: createFragment,\n      remove: remove,\n      setStyle: setStyle,\n      getStyle: getStyle,\n      setStyles: setStyles,\n      removeAllAttribs: removeAllAttribs,\n      setAttrib: setAttrib,\n      setAttribs: setAttribs,\n      getAttrib: getAttrib,\n      getPos: getPos$1,\n      parseStyle: parseStyle,\n      serializeStyle: serializeStyle,\n      addStyle: addStyle,\n      loadCSS: loadCSS,\n      addClass: addClass,\n      removeClass: removeClass,\n      hasClass: hasClass,\n      toggleClass: toggleClass,\n      show: show,\n      hide: hide,\n      isHidden: isHidden,\n      uniqueId: uniqueId,\n      setHTML: setHTML,\n      getOuterHTML: getOuterHTML,\n      setOuterHTML: setOuterHTML,\n      decode: decode,\n      encode: encode,\n      insertAfter: insertAfter,\n      replace: replace,\n      rename: rename,\n      findCommonAncestor: findCommonAncestor,\n      toHex: toHex,\n      run: run,\n      getAttribs: getAttribs,\n      isEmpty: isEmpty,\n      createRng: createRng,\n      nodeIndex: findNodeIndex,\n      split: split,\n      bind: bind,\n      unbind: unbind,\n      fire: fire,\n      getContentEditable: getContentEditable,\n      getContentEditableParent: getContentEditableParent,\n      destroy: destroy,\n      isChildOf: isChildOf,\n      dumpRng: dumpRng\n    };\n    var attrHooks = setupAttrHooks(styles, settings, constant(self));\n    return self;\n  };\n\n  DOMUtils.DOM = DOMUtils(document);\n  DOMUtils.nodeIndex = findNodeIndex;\n  var DOM$a = DOMUtils.DOM;\n  var each$e = Tools.each,\n      grep = Tools.grep;\n  var QUEUED = 0;\n  var LOADING = 1;\n  var LOADED = 2;\n  var FAILED = 3;\n\n  var ScriptLoader = function () {\n    function ScriptLoader(settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n\n      this.states = {};\n      this.queue = [];\n      this.scriptLoadedCallbacks = {};\n      this.queueLoadedCallbacks = [];\n      this.loading = 0;\n      this.settings = settings;\n    }\n\n    ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n      this.settings.referrerPolicy = referrerPolicy;\n    };\n\n    ScriptLoader.prototype.loadScript = function (url, success, failure) {\n      var dom = DOM$a;\n      var elm;\n\n      var cleanup = function () {\n        dom.remove(id);\n\n        if (elm) {\n          elm.onerror = elm.onload = elm = null;\n        }\n      };\n\n      var done = function () {\n        cleanup();\n        success();\n      };\n\n      var error = function () {\n        cleanup();\n\n        if (isFunction(failure)) {\n          failure();\n        } else {\n          if (typeof console !== 'undefined' && console.log) {\n            console.log('Failed to load script: ' + url);\n          }\n        }\n      };\n\n      var id = dom.uniqueId();\n      elm = document.createElement('script');\n      elm.id = id;\n      elm.type = 'text/javascript';\n      elm.src = Tools._addCacheSuffix(url);\n\n      if (this.settings.referrerPolicy) {\n        dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n      }\n\n      elm.onload = done;\n      elm.onerror = error;\n      (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n    };\n\n    ScriptLoader.prototype.isDone = function (url) {\n      return this.states[url] === LOADED;\n    };\n\n    ScriptLoader.prototype.markDone = function (url) {\n      this.states[url] = LOADED;\n    };\n\n    ScriptLoader.prototype.add = function (url, success, scope, failure) {\n      var state = this.states[url];\n      this.queue.push(url);\n\n      if (state === undefined) {\n        this.states[url] = QUEUED;\n      }\n\n      if (success) {\n        if (!this.scriptLoadedCallbacks[url]) {\n          this.scriptLoadedCallbacks[url] = [];\n        }\n\n        this.scriptLoadedCallbacks[url].push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n      }\n    };\n\n    ScriptLoader.prototype.load = function (url, success, scope, failure) {\n      return this.add(url, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.remove = function (url) {\n      delete this.states[url];\n      delete this.scriptLoadedCallbacks[url];\n    };\n\n    ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n      this.loadScripts(this.queue, success, scope, failure);\n    };\n\n    ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n      var self = this;\n      var failures = [];\n\n      var execCallbacks = function (name, url) {\n        each$e(self.scriptLoadedCallbacks[url], function (callback) {\n          if (isFunction(callback[name])) {\n            callback[name].call(callback.scope);\n          }\n        });\n        self.scriptLoadedCallbacks[url] = undefined;\n      };\n\n      self.queueLoadedCallbacks.push({\n        success: success,\n        failure: failure,\n        scope: scope || this\n      });\n\n      var loadScripts = function () {\n        var loadingScripts = grep(scripts);\n        scripts.length = 0;\n        each$e(loadingScripts, function (url) {\n          if (self.states[url] === LOADED) {\n            execCallbacks('success', url);\n            return;\n          }\n\n          if (self.states[url] === FAILED) {\n            execCallbacks('failure', url);\n            return;\n          }\n\n          if (self.states[url] !== LOADING) {\n            self.states[url] = LOADING;\n            self.loading++;\n            self.loadScript(url, function () {\n              self.states[url] = LOADED;\n              self.loading--;\n              execCallbacks('success', url);\n              loadScripts();\n            }, function () {\n              self.states[url] = FAILED;\n              self.loading--;\n              failures.push(url);\n              execCallbacks('failure', url);\n              loadScripts();\n            });\n          }\n        });\n\n        if (!self.loading) {\n          var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n          self.queueLoadedCallbacks.length = 0;\n          each$e(notifyCallbacks, function (callback) {\n            if (failures.length === 0) {\n              if (isFunction(callback.success)) {\n                callback.success.call(callback.scope);\n              }\n            } else {\n              if (isFunction(callback.failure)) {\n                callback.failure.call(callback.scope, failures);\n              }\n            }\n          });\n        }\n      };\n\n      loadScripts();\n    };\n\n    ScriptLoader.ScriptLoader = new ScriptLoader();\n    return ScriptLoader;\n  }();\n\n  var Cell = function (initial) {\n    var value = initial;\n\n    var get = function () {\n      return value;\n    };\n\n    var set = function (v) {\n      value = v;\n    };\n\n    return {\n      get: get,\n      set: set\n    };\n  };\n\n  var isRaw = function (str) {\n    return isObject(str) && has$2(str, 'raw');\n  };\n\n  var isTokenised = function (str) {\n    return isArray$1(str) && str.length > 1;\n  };\n\n  var data = {};\n  var currentCode = Cell('en');\n\n  var getLanguageData = function () {\n    return get$9(data, currentCode.get());\n  };\n\n  var getData = function () {\n    return map$2(data, function (value) {\n      return __assign({}, value);\n    });\n  };\n\n  var setCode = function (newCode) {\n    if (newCode) {\n      currentCode.set(newCode);\n    }\n  };\n\n  var getCode = function () {\n    return currentCode.get();\n  };\n\n  var add$4 = function (code, items) {\n    var langData = data[code];\n\n    if (!langData) {\n      data[code] = langData = {};\n    }\n\n    each$j(items, function (translation, name) {\n      langData[name.toLowerCase()] = translation;\n    });\n  };\n\n  var translate = function (text) {\n    var langData = getLanguageData().getOr({});\n\n    var toString = function (obj) {\n      if (isFunction(obj)) {\n        return Object.prototype.toString.call(obj);\n      }\n\n      return !isEmpty(obj) ? '' + obj : '';\n    };\n\n    var isEmpty = function (text) {\n      return text === '' || text === null || text === undefined;\n    };\n\n    var getLangData = function (text) {\n      var textstr = toString(text);\n      return get$9(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n    };\n\n    var removeContext = function (str) {\n      return str.replace(/{context:\\w+}$/, '');\n    };\n\n    if (isEmpty(text)) {\n      return '';\n    }\n\n    if (isRaw(text)) {\n      return toString(text.raw);\n    }\n\n    if (isTokenised(text)) {\n      var values_1 = text.slice(1);\n      var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n        return has$2(values_1, $2) ? toString(values_1[$2]) : $1;\n      });\n      return removeContext(substitued);\n    }\n\n    return removeContext(getLangData(text));\n  };\n\n  var isRtl$1 = function () {\n    return getLanguageData().bind(function (items) {\n      return get$9(items, '_dir');\n    }).exists(function (dir) {\n      return dir === 'rtl';\n    });\n  };\n\n  var hasCode = function (code) {\n    return has$2(data, code);\n  };\n\n  var I18n = {\n    getData: getData,\n    setCode: setCode,\n    getCode: getCode,\n    add: add$4,\n    translate: translate,\n    isRtl: isRtl$1,\n    hasCode: hasCode\n  };\n\n  var AddOnManager = function () {\n    var items = [];\n    var urls = {};\n    var lookup = {};\n    var _listeners = [];\n\n    var runListeners = function (name, state) {\n      var matchedListeners = filter$4(_listeners, function (listener) {\n        return listener.name === name && listener.state === state;\n      });\n      each$k(matchedListeners, function (listener) {\n        return listener.callback();\n      });\n    };\n\n    var get = function (name) {\n      if (lookup[name]) {\n        return lookup[name].instance;\n      }\n\n      return undefined;\n    };\n\n    var dependencies = function (name) {\n      var result;\n\n      if (lookup[name]) {\n        result = lookup[name].dependencies;\n      }\n\n      return result || [];\n    };\n\n    var requireLangPack = function (name, languages) {\n      if (AddOnManager.languageLoad !== false) {\n        waitFor(name, function () {\n          var language = I18n.getCode();\n          var wrappedLanguages = ',' + (languages || '') + ',';\n\n          if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n            return;\n          }\n\n          ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n        }, 'loaded');\n      }\n    };\n\n    var add = function (id, addOn, dependencies) {\n      var addOnConstructor = addOn;\n      items.push(addOnConstructor);\n      lookup[id] = {\n        instance: addOnConstructor,\n        dependencies: dependencies\n      };\n      runListeners(id, 'added');\n      return addOnConstructor;\n    };\n\n    var remove = function (name) {\n      delete urls[name];\n      delete lookup[name];\n    };\n\n    var createUrl = function (baseUrl, dep) {\n      if (typeof dep === 'object') {\n        return dep;\n      }\n\n      return typeof baseUrl === 'string' ? {\n        prefix: '',\n        resource: dep,\n        suffix: ''\n      } : {\n        prefix: baseUrl.prefix,\n        resource: dep,\n        suffix: baseUrl.suffix\n      };\n    };\n\n    var addComponents = function (pluginName, scripts) {\n      var pluginUrl = urls[pluginName];\n      each$k(scripts, function (script) {\n        ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n      });\n    };\n\n    var loadDependencies = function (name, addOnUrl, success, scope) {\n      var deps = dependencies(name);\n      each$k(deps, function (dep) {\n        var newUrl = createUrl(addOnUrl, dep);\n        load(newUrl.resource, newUrl, undefined, undefined);\n      });\n\n      if (success) {\n        if (scope) {\n          success.call(scope);\n        } else {\n          success.call(ScriptLoader);\n        }\n      }\n    };\n\n    var load = function (name, addOnUrl, success, scope, failure) {\n      if (urls[name]) {\n        return;\n      }\n\n      var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n\n      if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n        urlString = AddOnManager.baseURL + '/' + urlString;\n      }\n\n      urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n\n      var done = function () {\n        runListeners(name, 'loaded');\n        loadDependencies(name, addOnUrl, success, scope);\n      };\n\n      if (lookup[name]) {\n        done();\n      } else {\n        ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n      }\n    };\n\n    var waitFor = function (name, callback, state) {\n      if (state === void 0) {\n        state = 'added';\n      }\n\n      if (has$2(lookup, name) && state === 'added') {\n        callback();\n      } else if (has$2(urls, name) && state === 'loaded') {\n        callback();\n      } else {\n        _listeners.push({\n          name: name,\n          state: state,\n          callback: callback\n        });\n      }\n    };\n\n    return {\n      items: items,\n      urls: urls,\n      lookup: lookup,\n      _listeners: _listeners,\n      get: get,\n      dependencies: dependencies,\n      requireLangPack: requireLangPack,\n      add: add,\n      remove: remove,\n      createUrl: createUrl,\n      addComponents: addComponents,\n      load: load,\n      waitFor: waitFor\n    };\n  };\n\n  AddOnManager.languageLoad = true;\n  AddOnManager.baseURL = '';\n  AddOnManager.PluginManager = AddOnManager();\n  AddOnManager.ThemeManager = AddOnManager();\n\n  var singleton = function (doRevoke) {\n    var subject = Cell(Optional.none());\n\n    var revoke = function () {\n      return subject.get().each(doRevoke);\n    };\n\n    var clear = function () {\n      revoke();\n      subject.set(Optional.none());\n    };\n\n    var isSet = function () {\n      return subject.get().isSome();\n    };\n\n    var get = function () {\n      return subject.get();\n    };\n\n    var set = function (s) {\n      revoke();\n      subject.set(Optional.some(s));\n    };\n\n    return {\n      clear: clear,\n      isSet: isSet,\n      get: get,\n      set: set\n    };\n  };\n\n  var value = function () {\n    var subject = singleton(noop);\n\n    var on = function (f) {\n      return subject.get().each(f);\n    };\n\n    return __assign(__assign({}, subject), {\n      on: on\n    });\n  };\n\n  var first = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (!isNull(timer)) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (isNull(timer)) {\n        timer = setTimeout(function () {\n          timer = null;\n          fn.apply(null, args);\n        }, rate);\n      }\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var last = function (fn, rate) {\n    var timer = null;\n\n    var cancel = function () {\n      if (!isNull(timer)) {\n        clearTimeout(timer);\n        timer = null;\n      }\n    };\n\n    var throttle = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      cancel();\n      timer = setTimeout(function () {\n        timer = null;\n        fn.apply(null, args);\n      }, rate);\n    };\n\n    return {\n      cancel: cancel,\n      throttle: throttle\n    };\n  };\n\n  var read$4 = function (element, attr) {\n    var value = get$6(element, attr);\n    return value === undefined || value === '' ? [] : value.split(' ');\n  };\n\n  var add$3 = function (element, attr, id) {\n    var old = read$4(element, attr);\n    var nu = old.concat([id]);\n    set$1(element, attr, nu.join(' '));\n    return true;\n  };\n\n  var remove$5 = function (element, attr, id) {\n    var nu = filter$4(read$4(element, attr), function (v) {\n      return v !== id;\n    });\n\n    if (nu.length > 0) {\n      set$1(element, attr, nu.join(' '));\n    } else {\n      remove$6(element, attr);\n    }\n\n    return false;\n  };\n\n  var supports = function (element) {\n    return element.dom.classList !== undefined;\n  };\n\n  var get$4 = function (element) {\n    return read$4(element, 'class');\n  };\n\n  var add$2 = function (element, clazz) {\n    return add$3(element, 'class', clazz);\n  };\n\n  var remove$4 = function (element, clazz) {\n    return remove$5(element, 'class', clazz);\n  };\n\n  var add$1 = function (element, clazz) {\n    if (supports(element)) {\n      element.dom.classList.add(clazz);\n    } else {\n      add$2(element, clazz);\n    }\n  };\n\n  var cleanClass = function (element) {\n    var classList = supports(element) ? element.dom.classList : get$4(element);\n\n    if (classList.length === 0) {\n      remove$6(element, 'class');\n    }\n  };\n\n  var remove$3 = function (element, clazz) {\n    if (supports(element)) {\n      var classList = element.dom.classList;\n      classList.remove(clazz);\n    } else {\n      remove$4(element, clazz);\n    }\n\n    cleanClass(element);\n  };\n\n  var has = function (element, clazz) {\n    return supports(element) && element.dom.classList.contains(clazz);\n  };\n\n  var descendants$1 = function (scope, predicate) {\n    var result = [];\n    each$k(children(scope), function (x) {\n      if (predicate(x)) {\n        result = result.concat([x]);\n      }\n\n      result = result.concat(descendants$1(x, predicate));\n    });\n    return result;\n  };\n\n  var descendants = function (scope, selector) {\n    return all(selector, scope);\n  };\n\n  var annotation = constant('mce-annotation');\n  var dataAnnotation = constant('data-mce-annotation');\n  var dataAnnotationId = constant('data-mce-annotation-uid');\n\n  var identify = function (editor, annotationName) {\n    var rng = editor.selection.getRng();\n    var start = SugarElement.fromDom(rng.startContainer);\n    var root = SugarElement.fromDom(editor.getBody());\n    var selector = annotationName.fold(function () {\n      return '.' + annotation();\n    }, function (an) {\n      return '[' + dataAnnotation() + '=\"' + an + '\"]';\n    });\n    var newStart = child$1(start, rng.startOffset).getOr(start);\n    var closest = closest$2(newStart, selector, function (n) {\n      return eq(n, root);\n    });\n\n    var getAttr = function (c, property) {\n      if (has$1(c, property)) {\n        return Optional.some(get$6(c, property));\n      } else {\n        return Optional.none();\n      }\n    };\n\n    return closest.bind(function (c) {\n      return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n        return getAttr(c, '' + dataAnnotation()).map(function (name) {\n          var elements = findMarkers(editor, uid);\n          return {\n            uid: uid,\n            name: name,\n            elements: elements\n          };\n        });\n      });\n    });\n  };\n\n  var isAnnotation = function (elem) {\n    return isElement$6(elem) && has(elem, annotation());\n  };\n\n  var findMarkers = function (editor, uid) {\n    var body = SugarElement.fromDom(editor.getBody());\n    return descendants(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n  };\n\n  var findAll = function (editor, name) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var markers = descendants(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n    var directory = {};\n    each$k(markers, function (m) {\n      var uid = get$6(m, dataAnnotationId());\n      var nodesAlready = get$9(directory, uid).getOr([]);\n      directory[uid] = nodesAlready.concat([m]);\n    });\n    return directory;\n  };\n\n  var setup$n = function (editor, _registry) {\n    var changeCallbacks = Cell({});\n\n    var initData = function () {\n      return {\n        listeners: [],\n        previous: value()\n      };\n    };\n\n    var withCallbacks = function (name, f) {\n      updateCallbacks(name, function (data) {\n        f(data);\n        return data;\n      });\n    };\n\n    var updateCallbacks = function (name, f) {\n      var callbackMap = changeCallbacks.get();\n      var data = get$9(callbackMap, name).getOrThunk(initData);\n      var outputData = f(data);\n      callbackMap[name] = outputData;\n      changeCallbacks.set(callbackMap);\n    };\n\n    var fireCallbacks = function (name, uid, elements) {\n      withCallbacks(name, function (data) {\n        each$k(data.listeners, function (f) {\n          return f(true, name, {\n            uid: uid,\n            nodes: map$3(elements, function (elem) {\n              return elem.dom;\n            })\n          });\n        });\n      });\n    };\n\n    var fireNoAnnotation = function (name) {\n      withCallbacks(name, function (data) {\n        each$k(data.listeners, function (f) {\n          return f(false, name);\n        });\n      });\n    };\n\n    var onNodeChange = last(function () {\n      var callbackMap = changeCallbacks.get();\n      var annotations = sort(keys(callbackMap));\n      each$k(annotations, function (name) {\n        updateCallbacks(name, function (data) {\n          var prev = data.previous.get();\n          identify(editor, Optional.some(name)).fold(function () {\n            if (prev.isSome()) {\n              fireNoAnnotation(name);\n              data.previous.clear();\n            }\n          }, function (_a) {\n            var uid = _a.uid,\n                name = _a.name,\n                elements = _a.elements;\n\n            if (!is$1(prev, uid)) {\n              fireCallbacks(name, uid, elements);\n              data.previous.set(uid);\n            }\n          });\n          return {\n            previous: data.previous,\n            listeners: data.listeners\n          };\n        });\n      });\n    }, 30);\n    editor.on('remove', function () {\n      onNodeChange.cancel();\n    });\n    editor.on('NodeChange', function () {\n      onNodeChange.throttle();\n    });\n\n    var addListener = function (name, f) {\n      updateCallbacks(name, function (data) {\n        return {\n          previous: data.previous,\n          listeners: data.listeners.concat([f])\n        };\n      });\n    };\n\n    return {\n      addListener: addListener\n    };\n  };\n\n  var setup$m = function (editor, registry) {\n    var identifyParserNode = function (span) {\n      return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n    };\n\n    editor.on('init', function () {\n      editor.serializer.addNodeFilter('span', function (spans) {\n        each$k(spans, function (span) {\n          identifyParserNode(span).each(function (settings) {\n            if (settings.persistent === false) {\n              span.unwrap();\n            }\n          });\n        });\n      });\n    });\n  };\n\n  var create$7 = function () {\n    var annotations = {};\n\n    var register = function (name, settings) {\n      annotations[name] = {\n        name: name,\n        settings: settings\n      };\n    };\n\n    var lookup = function (name) {\n      return get$9(annotations, name).map(function (a) {\n        return a.settings;\n      });\n    };\n\n    return {\n      register: register,\n      lookup: lookup\n    };\n  };\n\n  var unique = 0;\n\n  var generate = function (prefix) {\n    var date = new Date();\n    var time = date.getTime();\n    var random = Math.floor(Math.random() * 1000000000);\n    unique++;\n    return prefix + '_' + random + unique + String(time);\n  };\n\n  var add = function (element, classes) {\n    each$k(classes, function (x) {\n      add$1(element, x);\n    });\n  };\n\n  var fromHtml = function (html, scope) {\n    var doc = scope || document;\n    var div = doc.createElement('div');\n    div.innerHTML = html;\n    return children(SugarElement.fromDom(div));\n  };\n\n  var fromDom$1 = function (nodes) {\n    return map$3(nodes, SugarElement.fromDom);\n  };\n\n  var get$3 = function (element) {\n    return element.dom.innerHTML;\n  };\n\n  var set = function (element, content) {\n    var owner = owner$1(element);\n    var docDom = owner.dom;\n    var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n    var contentElements = fromHtml(content, docDom);\n    append(fragment, contentElements);\n    empty(element);\n    append$1(element, fragment);\n  };\n\n  var clone$1 = function (original, isDeep) {\n    return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n  };\n\n  var shallow = function (original) {\n    return clone$1(original, false);\n  };\n\n  var deep$1 = function (original) {\n    return clone$1(original, true);\n  };\n\n  var TextWalker = function (startNode, rootNode, isBoundary) {\n    if (isBoundary === void 0) {\n      isBoundary = never;\n    }\n\n    var walker = new DomTreeWalker(startNode, rootNode);\n\n    var walk = function (direction) {\n      var next;\n\n      do {\n        next = walker[direction]();\n      } while (next && !isText$7(next) && !isBoundary(next));\n\n      return Optional.from(next).filter(isText$7);\n    };\n\n    return {\n      current: function () {\n        return Optional.from(walker.current()).filter(isText$7);\n      },\n      next: function () {\n        return walk('next');\n      },\n      prev: function () {\n        return walk('prev');\n      },\n      prev2: function () {\n        return walk('prev2');\n      }\n    };\n  };\n\n  var TextSeeker = function (dom, isBoundary) {\n    var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n      return dom.isBlock(node) || isBr$5(node) || isContentEditableFalse$b(node);\n    };\n\n    var walk = function (node, offset, walker, process) {\n      if (isText$7(node)) {\n        var newOffset = process(node, offset, node.data);\n\n        if (newOffset !== -1) {\n          return Optional.some({\n            container: node,\n            offset: newOffset\n          });\n        }\n      }\n\n      return walker().bind(function (next) {\n        return walk(next.container, next.offset, walker, process);\n      });\n    };\n\n    var backwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.prev().map(function (prev) {\n          return {\n            container: prev,\n            offset: prev.length\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    var forwards = function (node, offset, process, root) {\n      var walker = TextWalker(node, root, isBlockBoundary);\n      return walk(node, offset, function () {\n        return walker.next().map(function (next) {\n          return {\n            container: next,\n            offset: 0\n          };\n        });\n      }, process).getOrNull();\n    };\n\n    return {\n      backwards: backwards,\n      forwards: forwards\n    };\n  };\n\n  var round$2 = Math.round;\n\n  var clone = function (rect) {\n    if (!rect) {\n      return {\n        left: 0,\n        top: 0,\n        bottom: 0,\n        right: 0,\n        width: 0,\n        height: 0\n      };\n    }\n\n    return {\n      left: round$2(rect.left),\n      top: round$2(rect.top),\n      bottom: round$2(rect.bottom),\n      right: round$2(rect.right),\n      width: round$2(rect.width),\n      height: round$2(rect.height)\n    };\n  };\n\n  var collapse = function (rect, toStart) {\n    rect = clone(rect);\n\n    if (toStart) {\n      rect.right = rect.left;\n    } else {\n      rect.left = rect.left + rect.width;\n      rect.right = rect.left;\n    }\n\n    rect.width = 0;\n    return rect;\n  };\n\n  var isEqual = function (rect1, rect2) {\n    return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n  };\n\n  var isValidOverflow = function (overflowY, rect1, rect2) {\n    return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n  };\n\n  var isAbove$1 = function (rect1, rect2) {\n    var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n\n    if (rect1.bottom - halfHeight < rect2.top) {\n      return true;\n    }\n\n    if (rect1.top > rect2.bottom) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n  };\n\n  var isBelow$1 = function (rect1, rect2) {\n    if (rect1.top > rect2.bottom) {\n      return true;\n    }\n\n    if (rect1.bottom < rect2.top) {\n      return false;\n    }\n\n    return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n  };\n\n  var containsXY = function (rect, clientX, clientY) {\n    return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n  };\n\n  var clamp$2 = function (value, min, max) {\n    return Math.min(Math.max(value, min), max);\n  };\n\n  var getSelectedNode = function (range) {\n    var startContainer = range.startContainer,\n        startOffset = range.startOffset;\n\n    if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n      return startContainer.childNodes[startOffset];\n    }\n\n    return null;\n  };\n\n  var getNode$1 = function (container, offset) {\n    if (isElement$5(container) && container.hasChildNodes()) {\n      var childNodes = container.childNodes;\n      var safeOffset = clamp$2(offset, 0, childNodes.length - 1);\n      return childNodes[safeOffset];\n    } else {\n      return container;\n    }\n  };\n\n  var getNodeUnsafe = function (container, offset) {\n    if (offset < 0 && isElement$5(container) && container.hasChildNodes()) {\n      return undefined;\n    } else {\n      return getNode$1(container, offset);\n    }\n  };\n\n  var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n\n  var isExtendingChar = function (ch) {\n    return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n  };\n\n  var or = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (args[i](x)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n  };\n\n  var and = function () {\n    var args = [];\n\n    for (var _i = 0; _i < arguments.length; _i++) {\n      args[_i] = arguments[_i];\n    }\n\n    return function (x) {\n      for (var i = 0; i < args.length; i++) {\n        if (!args[i](x)) {\n          return false;\n        }\n      }\n\n      return true;\n    };\n  };\n\n  var isElement$3 = isElement$5;\n  var isCaretCandidate$2 = isCaretCandidate$3;\n  var isBlock$1 = matchStyleValues('display', 'block table');\n  var isFloated = matchStyleValues('float', 'left right');\n  var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$2, not(isFloated));\n  var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n  var isText$4 = isText$7;\n  var isBr$2 = isBr$5;\n  var nodeIndex$1 = DOMUtils.nodeIndex;\n  var resolveIndex$1 = getNodeUnsafe;\n\n  var createRange$1 = function (doc) {\n    return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n  };\n\n  var isWhiteSpace$1 = function (chr) {\n    return chr && /[\\r\\n\\t ]/.test(chr);\n  };\n\n  var isRange = function (rng) {\n    return !!rng.setStart && !!rng.setEnd;\n  };\n\n  var isHiddenWhiteSpaceRange = function (range) {\n    var container = range.startContainer;\n    var offset = range.startOffset;\n\n    if (isWhiteSpace$1(range.toString()) && isNotPre(container.parentNode) && isText$7(container)) {\n      var text = container.data;\n\n      if (isWhiteSpace$1(text[offset - 1]) || isWhiteSpace$1(text[offset + 1])) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var getBrClientRect = function (brNode) {\n    var doc = brNode.ownerDocument;\n    var rng = createRange$1(doc);\n    var nbsp$1 = doc.createTextNode(nbsp);\n    var parentNode = brNode.parentNode;\n    parentNode.insertBefore(nbsp$1, brNode);\n    rng.setStart(nbsp$1, 0);\n    rng.setEnd(nbsp$1, 1);\n    var clientRect = clone(rng.getBoundingClientRect());\n    parentNode.removeChild(nbsp$1);\n    return clientRect;\n  };\n\n  var getBoundingClientRectWebKitText = function (rng) {\n    var sc = rng.startContainer;\n    var ec = rng.endContainer;\n    var so = rng.startOffset;\n    var eo = rng.endOffset;\n\n    if (sc === ec && isText$7(ec) && so === 0 && eo === 1) {\n      var newRng = rng.cloneRange();\n      newRng.setEndAfter(ec);\n      return getBoundingClientRect$1(newRng);\n    } else {\n      return null;\n    }\n  };\n\n  var isZeroRect = function (r) {\n    return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n  };\n\n  var getBoundingClientRect$1 = function (item) {\n    var clientRect;\n    var clientRects = item.getClientRects();\n\n    if (clientRects.length > 0) {\n      clientRect = clone(clientRects[0]);\n    } else {\n      clientRect = clone(item.getBoundingClientRect());\n    }\n\n    if (!isRange(item) && isBr$2(item) && isZeroRect(clientRect)) {\n      return getBrClientRect(item);\n    }\n\n    if (isZeroRect(clientRect) && isRange(item)) {\n      return getBoundingClientRectWebKitText(item);\n    }\n\n    return clientRect;\n  };\n\n  var collapseAndInflateWidth = function (clientRect, toStart) {\n    var newClientRect = collapse(clientRect, toStart);\n    newClientRect.width = 1;\n    newClientRect.right = newClientRect.left + 1;\n    return newClientRect;\n  };\n\n  var getCaretPositionClientRects = function (caretPosition) {\n    var clientRects = [];\n\n    var addUniqueAndValidRect = function (clientRect) {\n      if (clientRect.height === 0) {\n        return;\n      }\n\n      if (clientRects.length > 0) {\n        if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n          return;\n        }\n      }\n\n      clientRects.push(clientRect);\n    };\n\n    var addCharacterOffset = function (container, offset) {\n      var range = createRange$1(container.ownerDocument);\n\n      if (offset < container.data.length) {\n        if (isExtendingChar(container.data[offset])) {\n          return clientRects;\n        }\n\n        if (isExtendingChar(container.data[offset - 1])) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), false));\n            return clientRects;\n          }\n        }\n      }\n\n      if (offset > 0) {\n        range.setStart(container, offset - 1);\n        range.setEnd(container, offset);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), false));\n        }\n      }\n\n      if (offset < container.data.length) {\n        range.setStart(container, offset);\n        range.setEnd(container, offset + 1);\n\n        if (!isHiddenWhiteSpaceRange(range)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), true));\n        }\n      }\n    };\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (isText$4(container)) {\n      addCharacterOffset(container, offset);\n      return clientRects;\n    }\n\n    if (isElement$3(container)) {\n      if (caretPosition.isAtEnd()) {\n        var node = resolveIndex$1(container, offset);\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, node.data.length);\n        }\n\n        if (isValidElementCaretCandidate(node) && !isBr$2(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), false));\n        }\n      } else {\n        var node = resolveIndex$1(container, offset);\n\n        if (isText$4(node)) {\n          addCharacterOffset(node, 0);\n        }\n\n        if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), false));\n          return clientRects;\n        }\n\n        var beforeNode = resolveIndex$1(caretPosition.container(), caretPosition.offset() - 1);\n\n        if (isValidElementCaretCandidate(beforeNode) && !isBr$2(beforeNode)) {\n          if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(beforeNode), false));\n          }\n        }\n\n        if (isValidElementCaretCandidate(node)) {\n          addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), true));\n        }\n      }\n    }\n\n    return clientRects;\n  };\n\n  var CaretPosition = function (container, offset, clientRects) {\n    var isAtStart = function () {\n      if (isText$4(container)) {\n        return offset === 0;\n      }\n\n      return offset === 0;\n    };\n\n    var isAtEnd = function () {\n      if (isText$4(container)) {\n        return offset >= container.data.length;\n      }\n\n      return offset >= container.childNodes.length;\n    };\n\n    var toRange = function () {\n      var range = createRange$1(container.ownerDocument);\n      range.setStart(container, offset);\n      range.setEnd(container, offset);\n      return range;\n    };\n\n    var getClientRects = function () {\n      if (!clientRects) {\n        clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n      }\n\n      return clientRects;\n    };\n\n    var isVisible = function () {\n      return getClientRects().length > 0;\n    };\n\n    var isEqual = function (caretPosition) {\n      return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n    };\n\n    var getNode = function (before) {\n      return resolveIndex$1(container, before ? offset - 1 : offset);\n    };\n\n    return {\n      container: constant(container),\n      offset: constant(offset),\n      toRange: toRange,\n      getClientRects: getClientRects,\n      isVisible: isVisible,\n      isAtStart: isAtStart,\n      isAtEnd: isAtEnd,\n      isEqual: isEqual,\n      getNode: getNode\n    };\n  };\n\n  CaretPosition.fromRangeStart = function (range) {\n    return CaretPosition(range.startContainer, range.startOffset);\n  };\n\n  CaretPosition.fromRangeEnd = function (range) {\n    return CaretPosition(range.endContainer, range.endOffset);\n  };\n\n  CaretPosition.after = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex$1(node) + 1);\n  };\n\n  CaretPosition.before = function (node) {\n    return CaretPosition(node.parentNode, nodeIndex$1(node));\n  };\n\n  CaretPosition.isAbove = function (pos1, pos2) {\n    return lift2(head(pos2.getClientRects()), last$2(pos1.getClientRects()), isAbove$1).getOr(false);\n  };\n\n  CaretPosition.isBelow = function (pos1, pos2) {\n    return lift2(last$2(pos2.getClientRects()), head(pos1.getClientRects()), isBelow$1).getOr(false);\n  };\n\n  CaretPosition.isAtStart = function (pos) {\n    return pos ? pos.isAtStart() : false;\n  };\n\n  CaretPosition.isAtEnd = function (pos) {\n    return pos ? pos.isAtEnd() : false;\n  };\n\n  CaretPosition.isTextPosition = function (pos) {\n    return pos ? isText$7(pos.container()) : false;\n  };\n\n  CaretPosition.isElementPosition = function (pos) {\n    return CaretPosition.isTextPosition(pos) === false;\n  };\n\n  var trimEmptyTextNode$1 = function (dom, node) {\n    if (isText$7(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var insertNode = function (dom, rng, node) {\n    rng.insertNode(node);\n    trimEmptyTextNode$1(dom, node.previousSibling);\n    trimEmptyTextNode$1(dom, node.nextSibling);\n  };\n\n  var insertFragment = function (dom, rng, frag) {\n    var firstChild = Optional.from(frag.firstChild);\n    var lastChild = Optional.from(frag.lastChild);\n    rng.insertNode(frag);\n    firstChild.each(function (child) {\n      return trimEmptyTextNode$1(dom, child.previousSibling);\n    });\n    lastChild.each(function (child) {\n      return trimEmptyTextNode$1(dom, child.nextSibling);\n    });\n  };\n\n  var rangeInsertNode = function (dom, rng, node) {\n    if (isDocumentFragment(node)) {\n      insertFragment(dom, rng, node);\n    } else {\n      insertNode(dom, rng, node);\n    }\n  };\n\n  var isText$3 = isText$7;\n  var isBogus = isBogus$2;\n  var nodeIndex = DOMUtils.nodeIndex;\n\n  var normalizedParent = function (node) {\n    var parentNode = node.parentNode;\n\n    if (isBogus(parentNode)) {\n      return normalizedParent(parentNode);\n    }\n\n    return parentNode;\n  };\n\n  var getChildNodes = function (node) {\n    if (!node) {\n      return [];\n    }\n\n    return reduce(node.childNodes, function (result, node) {\n      if (isBogus(node) && node.nodeName !== 'BR') {\n        result = result.concat(getChildNodes(node));\n      } else {\n        result.push(node);\n      }\n\n      return result;\n    }, []);\n  };\n\n  var normalizedTextOffset = function (node, offset) {\n    while (node = node.previousSibling) {\n      if (!isText$3(node)) {\n        break;\n      }\n\n      offset += node.data.length;\n    }\n\n    return offset;\n  };\n\n  var equal = function (a) {\n    return function (b) {\n      return a === b;\n    };\n  };\n\n  var normalizedNodeIndex = function (node) {\n    var nodes, index;\n    nodes = getChildNodes(normalizedParent(node));\n    index = findIndex$1(nodes, equal(node), node);\n    nodes = nodes.slice(0, index + 1);\n    var numTextFragments = reduce(nodes, function (result, node, i) {\n      if (isText$3(node) && isText$3(nodes[i - 1])) {\n        result++;\n      }\n\n      return result;\n    }, 0);\n    nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n    index = findIndex$1(nodes, equal(node), node);\n    return index - numTextFragments;\n  };\n\n  var createPathItem = function (node) {\n    var name;\n\n    if (isText$3(node)) {\n      name = 'text()';\n    } else {\n      name = node.nodeName.toLowerCase();\n    }\n\n    return name + '[' + normalizedNodeIndex(node) + ']';\n  };\n\n  var parentsUntil$1 = function (root, node, predicate) {\n    var parents = [];\n\n    for (node = node.parentNode; node !== root; node = node.parentNode) {\n      if (predicate && predicate(node)) {\n        break;\n      }\n\n      parents.push(node);\n    }\n\n    return parents;\n  };\n\n  var create$6 = function (root, caretPosition) {\n    var container,\n        offset,\n        path = [],\n        outputOffset,\n        childNodes,\n        parents;\n    container = caretPosition.container();\n    offset = caretPosition.offset();\n\n    if (isText$3(container)) {\n      outputOffset = normalizedTextOffset(container, offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length) {\n        outputOffset = 'after';\n        offset = childNodes.length - 1;\n      } else {\n        outputOffset = 'before';\n      }\n\n      container = childNodes[offset];\n    }\n\n    path.push(createPathItem(container));\n    parents = parentsUntil$1(root, container);\n    parents = filter$2(parents, not(isBogus$2));\n    path = path.concat(map$1(parents, function (node) {\n      return createPathItem(node);\n    }));\n    return path.reverse().join('/') + ',' + outputOffset;\n  };\n\n  var resolvePathItem = function (node, name, index) {\n    var nodes = getChildNodes(node);\n    nodes = filter$2(nodes, function (node, index) {\n      return !isText$3(node) || !isText$3(nodes[index - 1]);\n    });\n    nodes = filter$2(nodes, matchNodeNames([name]));\n    return nodes[index];\n  };\n\n  var findTextPosition = function (container, offset) {\n    var node = container,\n        targetOffset = 0,\n        dataLen;\n\n    while (isText$3(node)) {\n      dataLen = node.data.length;\n\n      if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n        container = node;\n        offset = offset - targetOffset;\n        break;\n      }\n\n      if (!isText$3(node.nextSibling)) {\n        container = node;\n        offset = dataLen;\n        break;\n      }\n\n      targetOffset += dataLen;\n      node = node.nextSibling;\n    }\n\n    if (isText$3(container) && offset > container.data.length) {\n      offset = container.data.length;\n    }\n\n    return CaretPosition(container, offset);\n  };\n\n  var resolve$2 = function (root, path) {\n    var offset;\n\n    if (!path) {\n      return null;\n    }\n\n    var parts = path.split(',');\n    var paths = parts[0].split('/');\n    offset = parts.length > 1 ? parts[1] : 'before';\n    var container = reduce(paths, function (result, value) {\n      var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n\n      if (!match) {\n        return null;\n      }\n\n      if (match[1] === 'text()') {\n        match[1] = '#text';\n      }\n\n      return resolvePathItem(result, match[1], parseInt(match[2], 10));\n    }, root);\n\n    if (!container) {\n      return null;\n    }\n\n    if (!isText$3(container)) {\n      if (offset === 'after') {\n        offset = nodeIndex(container) + 1;\n      } else {\n        offset = nodeIndex(container);\n      }\n\n      return CaretPosition(container.parentNode, offset);\n    }\n\n    return findTextPosition(container, parseInt(offset, 10));\n  };\n\n  var isContentEditableFalse$9 = isContentEditableFalse$b;\n\n  var getNormalizedTextOffset = function (trim, container, offset) {\n    var node, trimmedOffset;\n    trimmedOffset = trim(container.data.slice(0, offset)).length;\n\n    for (node = container.previousSibling; node && isText$7(node); node = node.previousSibling) {\n      trimmedOffset += trim(node.data).length;\n    }\n\n    return trimmedOffset;\n  };\n\n  var getPoint = function (dom, trim, normalized, rng, start) {\n    var container = rng[start ? 'startContainer' : 'endContainer'];\n    var offset = rng[start ? 'startOffset' : 'endOffset'];\n    var point = [];\n    var childNodes,\n        after = 0;\n    var root = dom.getRoot();\n\n    if (isText$7(container)) {\n      point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n    } else {\n      childNodes = container.childNodes;\n\n      if (offset >= childNodes.length && childNodes.length) {\n        after = 1;\n        offset = Math.max(0, childNodes.length - 1);\n      }\n\n      point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n    }\n\n    for (; container && container !== root; container = container.parentNode) {\n      point.push(dom.nodeIndex(container, normalized));\n    }\n\n    return point;\n  };\n\n  var getLocation = function (trim, selection, normalized, rng) {\n    var dom = selection.dom,\n        bookmark = {};\n    bookmark.start = getPoint(dom, trim, normalized, rng, true);\n\n    if (!selection.isCollapsed()) {\n      bookmark.end = getPoint(dom, trim, normalized, rng, false);\n    }\n\n    if (isRangeInCaretContainerBlock(rng)) {\n      bookmark.isFakeCaret = true;\n    }\n\n    return bookmark;\n  };\n\n  var findIndex = function (dom, name, element) {\n    var count = 0;\n    Tools.each(dom.select(name), function (node) {\n      if (node.getAttribute('data-mce-bogus') === 'all') {\n        return;\n      }\n\n      if (node === element) {\n        return false;\n      }\n\n      count++;\n    });\n    return count;\n  };\n\n  var moveEndPoint$1 = function (rng, start) {\n    var container, offset, childNodes;\n    var prefix = start ? 'start' : 'end';\n    container = rng[prefix + 'Container'];\n    offset = rng[prefix + 'Offset'];\n\n    if (isElement$5(container) && container.nodeName === 'TR') {\n      childNodes = container.childNodes;\n      container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n\n      if (container) {\n        offset = start ? 0 : container.childNodes.length;\n        rng['set' + (start ? 'Start' : 'End')](container, offset);\n      }\n    }\n  };\n\n  var normalizeTableCellSelection = function (rng) {\n    moveEndPoint$1(rng, true);\n    moveEndPoint$1(rng, false);\n    return rng;\n  };\n\n  var findSibling = function (node, offset) {\n    var sibling;\n\n    if (isElement$5(node)) {\n      node = getNode$1(node, offset);\n\n      if (isContentEditableFalse$9(node)) {\n        return node;\n      }\n    }\n\n    if (isCaretContainer$2(node)) {\n      if (isText$7(node) && isCaretContainerBlock$1(node)) {\n        node = node.parentNode;\n      }\n\n      sibling = node.previousSibling;\n\n      if (isContentEditableFalse$9(sibling)) {\n        return sibling;\n      }\n\n      sibling = node.nextSibling;\n\n      if (isContentEditableFalse$9(sibling)) {\n        return sibling;\n      }\n    }\n  };\n\n  var findAdjacentContentEditableFalseElm = function (rng) {\n    return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n  };\n\n  var getOffsetBookmark = function (trim, normalized, selection) {\n    var element = selection.getNode();\n    var name = element ? element.nodeName : null;\n    var rng = selection.getRng();\n\n    if (isContentEditableFalse$9(element) || name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex(selection.dom, name, element)\n      };\n    }\n\n    var sibling = findAdjacentContentEditableFalseElm(rng);\n\n    if (sibling) {\n      name = sibling.tagName;\n      return {\n        name: name,\n        index: findIndex(selection.dom, name, sibling)\n      };\n    }\n\n    return getLocation(trim, selection, normalized, rng);\n  };\n\n  var getCaretBookmark = function (selection) {\n    var rng = selection.getRng();\n    return {\n      start: create$6(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n      end: create$6(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n    };\n  };\n\n  var getRangeBookmark = function (selection) {\n    return {\n      rng: selection.getRng()\n    };\n  };\n\n  var createBookmarkSpan = function (dom, id, filled) {\n    var args = {\n      'data-mce-type': 'bookmark',\n      id: id,\n      'style': 'overflow:hidden;line-height:0px'\n    };\n    return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n  };\n\n  var getPersistentBookmark = function (selection, filled) {\n    var dom = selection.dom;\n    var rng = selection.getRng();\n    var id = dom.uniqueId();\n    var collapsed = selection.isCollapsed();\n    var element = selection.getNode();\n    var name = element.nodeName;\n\n    if (name === 'IMG') {\n      return {\n        name: name,\n        index: findIndex(dom, name, element)\n      };\n    }\n\n    var rng2 = normalizeTableCellSelection(rng.cloneRange());\n\n    if (!collapsed) {\n      rng2.collapse(false);\n      var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n      rangeInsertNode(dom, rng2, endBookmarkNode);\n    }\n\n    rng = normalizeTableCellSelection(rng);\n    rng.collapse(true);\n    var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n    rangeInsertNode(dom, rng, startBookmarkNode);\n    selection.moveToBookmark({\n      id: id,\n      keep: true\n    });\n    return {\n      id: id\n    };\n  };\n\n  var getBookmark$2 = function (selection, type, normalized) {\n    if (type === 2) {\n      return getOffsetBookmark(trim$2, normalized, selection);\n    } else if (type === 3) {\n      return getCaretBookmark(selection);\n    } else if (type) {\n      return getRangeBookmark(selection);\n    } else {\n      return getPersistentBookmark(selection, false);\n    }\n  };\n\n  var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n  var DOM$9 = DOMUtils.DOM;\n  var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n\n  var getBodySetting = function (editor, name, defaultValue) {\n    var value = editor.getParam(name, defaultValue);\n\n    if (value.indexOf('=') !== -1) {\n      var bodyObj = editor.getParam(name, '', 'hash');\n      return get$9(bodyObj, editor.id).getOr(defaultValue);\n    } else {\n      return value;\n    }\n  };\n\n  var getIframeAttrs = function (editor) {\n    return editor.getParam('iframe_attrs', {});\n  };\n\n  var getDocType = function (editor) {\n    return editor.getParam('doctype', '<!DOCTYPE html>');\n  };\n\n  var getDocumentBaseUrl = function (editor) {\n    return editor.getParam('document_base_url', '');\n  };\n\n  var getBodyId = function (editor) {\n    return getBodySetting(editor, 'body_id', 'tinymce');\n  };\n\n  var getBodyClass = function (editor) {\n    return getBodySetting(editor, 'body_class', '');\n  };\n\n  var getContentSecurityPolicy = function (editor) {\n    return editor.getParam('content_security_policy', '');\n  };\n\n  var shouldPutBrInPre$1 = function (editor) {\n    return editor.getParam('br_in_pre', true);\n  };\n\n  var getForcedRootBlock = function (editor) {\n    if (editor.getParam('force_p_newlines', false)) {\n      return 'p';\n    }\n\n    var block = editor.getParam('forced_root_block', 'p');\n\n    if (block === false) {\n      return '';\n    } else if (block === true) {\n      return 'p';\n    } else {\n      return block;\n    }\n  };\n\n  var getForcedRootBlockAttrs = function (editor) {\n    return editor.getParam('forced_root_block_attrs', {});\n  };\n\n  var getBrNewLineSelector = function (editor) {\n    return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n  };\n\n  var getNoNewLineSelector = function (editor) {\n    return editor.getParam('no_newline_selector', '');\n  };\n\n  var shouldKeepStyles = function (editor) {\n    return editor.getParam('keep_styles', true);\n  };\n\n  var shouldEndContainerOnEmptyBlock = function (editor) {\n    return editor.getParam('end_container_on_empty_block', false);\n  };\n\n  var getFontStyleValues = function (editor) {\n    return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n  };\n\n  var getFontSizeClasses = function (editor) {\n    return Tools.explode(editor.getParam('font_size_classes', ''));\n  };\n\n  var getImagesDataImgFilter = function (editor) {\n    return editor.getParam('images_dataimg_filter', always, 'function');\n  };\n\n  var isAutomaticUploadsEnabled = function (editor) {\n    return editor.getParam('automatic_uploads', true, 'boolean');\n  };\n\n  var shouldReuseFileName = function (editor) {\n    return editor.getParam('images_reuse_filename', false, 'boolean');\n  };\n\n  var shouldReplaceBlobUris = function (editor) {\n    return editor.getParam('images_replace_blob_uris', true, 'boolean');\n  };\n\n  var getIconPackName = function (editor) {\n    return editor.getParam('icons', '', 'string');\n  };\n\n  var getIconsUrl = function (editor) {\n    return editor.getParam('icons_url', '', 'string');\n  };\n\n  var getImageUploadUrl = function (editor) {\n    return editor.getParam('images_upload_url', '', 'string');\n  };\n\n  var getImageUploadBasePath = function (editor) {\n    return editor.getParam('images_upload_base_path', '', 'string');\n  };\n\n  var getImagesUploadCredentials = function (editor) {\n    return editor.getParam('images_upload_credentials', false, 'boolean');\n  };\n\n  var getImagesUploadHandler = function (editor) {\n    return editor.getParam('images_upload_handler', null, 'function');\n  };\n\n  var shouldUseContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors', false, 'boolean');\n  };\n\n  var getReferrerPolicy = function (editor) {\n    return editor.getParam('referrer_policy', '', 'string');\n  };\n\n  var getLanguageCode = function (editor) {\n    return editor.getParam('language', 'en', 'string');\n  };\n\n  var getLanguageUrl = function (editor) {\n    return editor.getParam('language_url', '', 'string');\n  };\n\n  var shouldIndentUseMargin = function (editor) {\n    return editor.getParam('indent_use_margin', false);\n  };\n\n  var getIndentation = function (editor) {\n    return editor.getParam('indentation', '40px', 'string');\n  };\n\n  var getContentCss = function (editor) {\n    var contentCss = editor.getParam('content_css');\n\n    if (isString$1(contentCss)) {\n      return map$3(contentCss.split(','), trim$4);\n    } else if (isArray$1(contentCss)) {\n      return contentCss;\n    } else if (contentCss === false || editor.inline) {\n      return [];\n    } else {\n      return ['default'];\n    }\n  };\n\n  var getFontCss = function (editor) {\n    var fontCss = editor.getParam('font_css', []);\n    return isArray$1(fontCss) ? fontCss : map$3(fontCss.split(','), trim$4);\n  };\n\n  var getDirectionality = function (editor) {\n    return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n  };\n\n  var getInlineBoundarySelector = function (editor) {\n    return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n  };\n\n  var getObjectResizing = function (editor) {\n    var selector = editor.getParam('object_resizing');\n\n    if (selector === false || Env.iOS) {\n      return false;\n    } else {\n      return isString$1(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n    }\n  };\n\n  var getResizeImgProportional = function (editor) {\n    return editor.getParam('resize_img_proportional', true, 'boolean');\n  };\n\n  var getPlaceholder = function (editor) {\n    return editor.getParam('placeholder', DOM$9.getAttrib(editor.getElement(), 'placeholder'), 'string');\n  };\n\n  var getEventRoot = function (editor) {\n    return editor.getParam('event_root');\n  };\n\n  var getServiceMessage = function (editor) {\n    return editor.getParam('service_message');\n  };\n\n  var getTheme = function (editor) {\n    return editor.getParam('theme');\n  };\n\n  var shouldValidate = function (editor) {\n    return editor.getParam('validate');\n  };\n\n  var isInlineBoundariesEnabled = function (editor) {\n    return editor.getParam('inline_boundaries') !== false;\n  };\n\n  var getFormats = function (editor) {\n    return editor.getParam('formats');\n  };\n\n  var getPreviewStyles = function (editor) {\n    var style = editor.getParam('preview_styles', defaultPreviewStyles);\n\n    if (isString$1(style)) {\n      return style;\n    } else {\n      return '';\n    }\n  };\n\n  var canFormatEmptyLines = function (editor) {\n    return editor.getParam('format_empty_lines', false, 'boolean');\n  };\n\n  var getCustomUiSelector = function (editor) {\n    return editor.getParam('custom_ui_selector', '', 'string');\n  };\n\n  var getThemeUrl = function (editor) {\n    return editor.getParam('theme_url');\n  };\n\n  var isInline = function (editor) {\n    return editor.getParam('inline');\n  };\n\n  var hasHiddenInput = function (editor) {\n    return editor.getParam('hidden_input');\n  };\n\n  var shouldPatchSubmit = function (editor) {\n    return editor.getParam('submit_patch');\n  };\n\n  var isEncodingXml = function (editor) {\n    return editor.getParam('encoding') === 'xml';\n  };\n\n  var shouldAddFormSubmitTrigger = function (editor) {\n    return editor.getParam('add_form_submit_trigger');\n  };\n\n  var shouldAddUnloadTrigger = function (editor) {\n    return editor.getParam('add_unload_trigger');\n  };\n\n  var hasForcedRootBlock = function (editor) {\n    return getForcedRootBlock(editor) !== '';\n  };\n\n  var getCustomUndoRedoLevels = function (editor) {\n    return editor.getParam('custom_undo_redo_levels', 0, 'number');\n  };\n\n  var shouldDisableNodeChange = function (editor) {\n    return editor.getParam('disable_nodechange');\n  };\n\n  var isReadOnly$1 = function (editor) {\n    return editor.getParam('readonly');\n  };\n\n  var hasContentCssCors = function (editor) {\n    return editor.getParam('content_css_cors');\n  };\n\n  var getPlugins = function (editor) {\n    return editor.getParam('plugins', '', 'string');\n  };\n\n  var getExternalPlugins$1 = function (editor) {\n    return editor.getParam('external_plugins');\n  };\n\n  var shouldBlockUnsupportedDrop = function (editor) {\n    return editor.getParam('block_unsupported_drop', true, 'boolean');\n  };\n\n  var isVisualAidsEnabled = function (editor) {\n    return editor.getParam('visual', true, 'boolean');\n  };\n\n  var getVisualAidsTableClass = function (editor) {\n    return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n  };\n\n  var getVisualAidsAnchorClass = function (editor) {\n    return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n  };\n\n  var getIframeAriaText = function (editor) {\n    return editor.getParam('iframe_aria_text', 'Rich Text Area. Press ALT-0 for help.', 'string');\n  };\n\n  var isElement$2 = isElement$5;\n  var isText$2 = isText$7;\n\n  var removeNode$1 = function (node) {\n    var parentNode = node.parentNode;\n\n    if (parentNode) {\n      parentNode.removeChild(node);\n    }\n  };\n\n  var trimCount = function (text) {\n    var trimmedText = trim$2(text);\n    return {\n      count: text.length - trimmedText.length,\n      text: trimmedText\n    };\n  };\n\n  var deleteZwspChars = function (caretContainer) {\n    var idx;\n\n    while ((idx = caretContainer.data.lastIndexOf(ZWSP$1)) !== -1) {\n      caretContainer.deleteData(idx, 1);\n    }\n  };\n\n  var removeUnchanged = function (caretContainer, pos) {\n    remove$2(caretContainer);\n    return pos;\n  };\n\n  var removeTextAndReposition = function (caretContainer, pos) {\n    var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n    var after = trimCount(caretContainer.data.substr(pos.offset()));\n    var text = before.text + after.text;\n\n    if (text.length > 0) {\n      deleteZwspChars(caretContainer);\n      return CaretPosition(caretContainer, pos.offset() - before.count);\n    } else {\n      return pos;\n    }\n  };\n\n  var removeElementAndReposition = function (caretContainer, pos) {\n    var parentNode = pos.container();\n    var newPosition = indexOf$2(from(parentNode.childNodes), caretContainer).map(function (index) {\n      return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n    }).getOr(pos);\n    remove$2(caretContainer);\n    return newPosition;\n  };\n\n  var removeTextCaretContainer = function (caretContainer, pos) {\n    return isText$2(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeElementCaretContainer = function (caretContainer, pos) {\n    return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n  };\n\n  var removeAndReposition = function (container, pos) {\n    return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n  };\n\n  var remove$2 = function (caretContainerNode) {\n    if (isElement$2(caretContainerNode) && isCaretContainer$2(caretContainerNode)) {\n      if (hasContent(caretContainerNode)) {\n        caretContainerNode.removeAttribute('data-mce-caret');\n      } else {\n        removeNode$1(caretContainerNode);\n      }\n    }\n\n    if (isText$2(caretContainerNode)) {\n      deleteZwspChars(caretContainerNode);\n\n      if (caretContainerNode.data.length === 0) {\n        removeNode$1(caretContainerNode);\n      }\n    }\n  };\n\n  var browser$2 = detect().browser;\n  var isContentEditableFalse$8 = isContentEditableFalse$b;\n  var isMedia$1 = isMedia$2;\n  var isTableCell$3 = isTableCell$5;\n  var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n\n  var getAbsoluteClientRect = function (root, element, before) {\n    var clientRect = collapse(element.getBoundingClientRect(), before);\n    var scrollX;\n    var scrollY;\n\n    if (root.tagName === 'BODY') {\n      var docElm = root.ownerDocument.documentElement;\n      scrollX = root.scrollLeft || docElm.scrollLeft;\n      scrollY = root.scrollTop || docElm.scrollTop;\n    } else {\n      var rootRect = root.getBoundingClientRect();\n      scrollX = root.scrollLeft - rootRect.left;\n      scrollY = root.scrollTop - rootRect.top;\n    }\n\n    clientRect.left += scrollX;\n    clientRect.right += scrollX;\n    clientRect.top += scrollY;\n    clientRect.bottom += scrollY;\n    clientRect.width = 1;\n    var margin = element.offsetWidth - element.clientWidth;\n\n    if (margin > 0) {\n      if (before) {\n        margin *= -1;\n      }\n\n      clientRect.left += margin;\n      clientRect.right += margin;\n    }\n\n    return clientRect;\n  };\n\n  var trimInlineCaretContainers = function (root) {\n    var fakeCaretTargetNodes = descendants(SugarElement.fromDom(root), inlineFakeCaretSelector);\n\n    for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n      var node = fakeCaretTargetNodes[i].dom;\n      var sibling = node.previousSibling;\n\n      if (endsWithCaretContainer$1(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(data.length - 1, 1);\n        }\n      }\n\n      sibling = node.nextSibling;\n\n      if (startsWithCaretContainer$1(sibling)) {\n        var data = sibling.data;\n\n        if (data.length === 1) {\n          sibling.parentNode.removeChild(sibling);\n        } else {\n          sibling.deleteData(0, 1);\n        }\n      }\n    }\n  };\n\n  var FakeCaret = function (editor, root, isBlock, hasFocus) {\n    var lastVisualCaret = value();\n    var cursorInterval;\n    var caretContainerNode;\n    var rootBlock = getForcedRootBlock(editor);\n    var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n\n    var show = function (before, element) {\n      var rng;\n      hide();\n\n      if (isTableCell$3(element)) {\n        return null;\n      }\n\n      if (isBlock(element)) {\n        caretContainerNode = insertBlock$1(caretBlock, element, before);\n        var clientRect = getAbsoluteClientRect(root, element, before);\n        DomQuery(caretContainerNode).css('top', clientRect.top);\n        var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(__assign({}, clientRect)).appendTo(root)[0];\n        lastVisualCaret.set({\n          caret: caret,\n          element: element,\n          before: before\n        });\n\n        if (before) {\n          DomQuery(caret).addClass('mce-visual-caret-before');\n        }\n\n        startBlink();\n        rng = element.ownerDocument.createRange();\n        rng.setStart(caretContainerNode, 0);\n        rng.setEnd(caretContainerNode, 0);\n      } else {\n        caretContainerNode = insertInline$1(element, before);\n        rng = element.ownerDocument.createRange();\n\n        if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          rng.setStart(caretContainerNode, 1);\n          rng.setEnd(caretContainerNode, 1);\n        }\n\n        return rng;\n      }\n\n      return rng;\n    };\n\n    var hide = function () {\n      trimInlineCaretContainers(root);\n\n      if (caretContainerNode) {\n        remove$2(caretContainerNode);\n        caretContainerNode = null;\n      }\n\n      lastVisualCaret.on(function (caretState) {\n        DomQuery(caretState.caret).remove();\n        lastVisualCaret.clear();\n      });\n\n      if (cursorInterval) {\n        Delay.clearInterval(cursorInterval);\n        cursorInterval = undefined;\n      }\n    };\n\n    var startBlink = function () {\n      cursorInterval = Delay.setInterval(function () {\n        if (hasFocus()) {\n          DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n        } else {\n          DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n        }\n      }, 500);\n    };\n\n    var reposition = function () {\n      lastVisualCaret.on(function (caretState) {\n        var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n        DomQuery(caretState.caret).css(__assign({}, clientRect));\n      });\n    };\n\n    var destroy = function () {\n      return Delay.clearInterval(cursorInterval);\n    };\n\n    var getCss = function () {\n      return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n    };\n\n    return {\n      show: show,\n      hide: hide,\n      getCss: getCss,\n      reposition: reposition,\n      destroy: destroy\n    };\n  };\n\n  var isFakeCaretTableBrowser = function () {\n    return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n  };\n\n  var isInlineFakeCaretTarget = function (node) {\n    return isContentEditableFalse$8(node) || isMedia$1(node);\n  };\n\n  var isFakeCaretTarget = function (node) {\n    return isInlineFakeCaretTarget(node) || isTable$3(node) && isFakeCaretTableBrowser();\n  };\n\n  var isContentEditableFalse$7 = isContentEditableFalse$b;\n  var isMedia = isMedia$2;\n  var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n  var isCaretContainer = isCaretContainer$2;\n  var isCaretContainerBlock = isCaretContainerBlock$1;\n  var isElement$1 = isElement$5;\n  var isCaretCandidate$1 = isCaretCandidate$3;\n\n  var isForwards = function (direction) {\n    return direction > 0;\n  };\n\n  var isBackwards = function (direction) {\n    return direction < 0;\n  };\n\n  var skipCaretContainers = function (walk, shallow) {\n    var node;\n\n    while (node = walk(shallow)) {\n      if (!isCaretContainerBlock(node)) {\n        return node;\n      }\n    }\n\n    return null;\n  };\n\n  var findNode$1 = function (node, direction, predicateFn, rootNode, shallow) {\n    var walker = new DomTreeWalker(node, rootNode);\n    var isCefOrCaretContainer = isContentEditableFalse$7(node) || isCaretContainerBlock(node);\n\n    if (isBackwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.prev.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    if (isForwards(direction)) {\n      if (isCefOrCaretContainer) {\n        node = skipCaretContainers(walker.next.bind(walker), true);\n\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n\n      while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n        if (predicateFn(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var getParentBlock$2 = function (node, rootNode) {\n    while (node && node !== rootNode) {\n      if (isBlockLike(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n    return getParentBlock$2(caretPosition1.container(), rootNode) === getParentBlock$2(caretPosition2.container(), rootNode);\n  };\n\n  var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n    if (!caretPosition) {\n      return null;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (!isElement$1(container)) {\n      return null;\n    }\n\n    return container.childNodes[offset + relativeOffset];\n  };\n\n  var beforeAfter = function (before, node) {\n    var range = node.ownerDocument.createRange();\n\n    if (before) {\n      range.setStartBefore(node);\n      range.setEndBefore(node);\n    } else {\n      range.setStartAfter(node);\n      range.setEndAfter(node);\n    }\n\n    return range;\n  };\n\n  var isNodesInSameBlock = function (root, node1, node2) {\n    return getParentBlock$2(node1, root) === getParentBlock$2(node2, root);\n  };\n\n  var lean = function (left, root, node) {\n    var siblingName = left ? 'previousSibling' : 'nextSibling';\n\n    while (node && node !== root) {\n      var sibling = node[siblingName];\n\n      if (isCaretContainer(sibling)) {\n        sibling = sibling[siblingName];\n      }\n\n      if (isContentEditableFalse$7(sibling) || isMedia(sibling)) {\n        if (isNodesInSameBlock(root, sibling, node)) {\n          return sibling;\n        }\n\n        break;\n      }\n\n      if (isCaretCandidate$1(sibling)) {\n        break;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var before$2 = curry(beforeAfter, true);\n  var after$2 = curry(beforeAfter, false);\n\n  var normalizeRange = function (direction, root, range) {\n    var node;\n    var leanLeft = curry(lean, true, root);\n    var leanRight = curry(lean, false, root);\n    var container = range.startContainer;\n    var offset = range.startOffset;\n\n    if (isCaretContainerBlock$1(container)) {\n      if (!isElement$1(container)) {\n        container = container.parentNode;\n      }\n\n      var location_1 = container.getAttribute('data-mce-caret');\n\n      if (location_1 === 'before') {\n        node = container.nextSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return before$2(node);\n        }\n      }\n\n      if (location_1 === 'after') {\n        node = container.previousSibling;\n\n        if (isFakeCaretTarget(node)) {\n          return after$2(node);\n        }\n      }\n    }\n\n    if (!range.collapsed) {\n      return range;\n    }\n\n    if (isText$7(container)) {\n      if (isCaretContainer(container)) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n\n          node = leanLeft(container);\n\n          if (node) {\n            return after$2(node);\n          }\n        }\n\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$2(node);\n          }\n\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (endsWithCaretContainer$1(container) && offset >= container.data.length - 1) {\n        if (direction === 1) {\n          node = leanRight(container);\n\n          if (node) {\n            return before$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (startsWithCaretContainer$1(container) && offset <= 1) {\n        if (direction === -1) {\n          node = leanLeft(container);\n\n          if (node) {\n            return after$2(node);\n          }\n        }\n\n        return range;\n      }\n\n      if (offset === container.data.length) {\n        node = leanRight(container);\n\n        if (node) {\n          return before$2(node);\n        }\n\n        return range;\n      }\n\n      if (offset === 0) {\n        node = leanLeft(container);\n\n        if (node) {\n          return after$2(node);\n        }\n\n        return range;\n      }\n    }\n\n    return range;\n  };\n\n  var getRelativeCefElm = function (forward, caretPosition) {\n    return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$7);\n  };\n\n  var getNormalizedRangeEndPoint = function (direction, root, range) {\n    var normalizedRange = normalizeRange(direction, root, range);\n\n    if (direction === -1) {\n      return CaretPosition.fromRangeStart(normalizedRange);\n    }\n\n    return CaretPosition.fromRangeEnd(normalizedRange);\n  };\n\n  var getElementFromPosition = function (pos) {\n    return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n  };\n\n  var getElementFromPrevPosition = function (pos) {\n    return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n  };\n\n  var getVisualCaretPosition = function (walkFn, caretPosition) {\n    while (caretPosition = walkFn(caretPosition)) {\n      if (caretPosition.isVisible()) {\n        return caretPosition;\n      }\n    }\n\n    return caretPosition;\n  };\n\n  var isMoveInsideSameBlock = function (from, to) {\n    var inSameBlock = isInSameBlock(from, to);\n\n    if (!inSameBlock && isBr$5(from.getNode())) {\n      return true;\n    }\n\n    return inSameBlock;\n  };\n\n  var HDirection;\n\n  (function (HDirection) {\n    HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n    HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n  })(HDirection || (HDirection = {}));\n\n  var isContentEditableFalse$6 = isContentEditableFalse$b;\n  var isText$1 = isText$7;\n  var isElement = isElement$5;\n  var isBr$1 = isBr$5;\n  var isCaretCandidate = isCaretCandidate$3;\n  var isAtomic = isAtomic$1;\n  var isEditableCaretCandidate = isEditableCaretCandidate$1;\n\n  var getParents$3 = function (node, root) {\n    var parents = [];\n\n    while (node && node !== root) {\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    return parents;\n  };\n\n  var nodeAtIndex = function (container, offset) {\n    if (container.hasChildNodes() && offset < container.childNodes.length) {\n      return container.childNodes[offset];\n    }\n\n    return null;\n  };\n\n  var getCaretCandidatePosition = function (direction, node) {\n    if (isForwards(direction)) {\n      if (isCaretCandidate(node.previousSibling) && !isText$1(node.previousSibling)) {\n        return CaretPosition.before(node);\n      }\n\n      if (isText$1(node)) {\n        return CaretPosition(node, 0);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isCaretCandidate(node.nextSibling) && !isText$1(node.nextSibling)) {\n        return CaretPosition.after(node);\n      }\n\n      if (isText$1(node)) {\n        return CaretPosition(node, node.data.length);\n      }\n    }\n\n    if (isBackwards(direction)) {\n      if (isBr$1(node)) {\n        return CaretPosition.before(node);\n      }\n\n      return CaretPosition.after(node);\n    }\n\n    return CaretPosition.before(node);\n  };\n\n  var moveForwardFromBr = function (root, nextNode) {\n    var nextSibling = nextNode.nextSibling;\n\n    if (nextSibling && isCaretCandidate(nextSibling)) {\n      if (isText$1(nextSibling)) {\n        return CaretPosition(nextSibling, 0);\n      } else {\n        return CaretPosition.before(nextSibling);\n      }\n    } else {\n      return findCaretPosition$1(HDirection.Forwards, CaretPosition.after(nextNode), root);\n    }\n  };\n\n  var findCaretPosition$1 = function (direction, startPos, root) {\n    var node;\n    var nextNode;\n    var innerNode;\n    var caretPosition;\n\n    if (!isElement(root) || !startPos) {\n      return null;\n    }\n\n    if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n      caretPosition = CaretPosition.after(root.lastChild);\n\n      if (isBackwards(direction) && isCaretCandidate(root.lastChild) && isElement(root.lastChild)) {\n        return isBr$1(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n      }\n    } else {\n      caretPosition = startPos;\n    }\n\n    var container = caretPosition.container();\n    var offset = caretPosition.offset();\n\n    if (isText$1(container)) {\n      if (isBackwards(direction) && offset > 0) {\n        return CaretPosition(container, --offset);\n      }\n\n      if (isForwards(direction) && offset < container.length) {\n        return CaretPosition(container, ++offset);\n      }\n\n      node = container;\n    } else {\n      if (isBackwards(direction) && offset > 0) {\n        nextNode = nodeAtIndex(container, offset - 1);\n\n        if (isCaretCandidate(nextNode)) {\n          if (!isAtomic(nextNode)) {\n            innerNode = findNode$1(nextNode, direction, isEditableCaretCandidate, nextNode);\n\n            if (innerNode) {\n              if (isText$1(innerNode)) {\n                return CaretPosition(innerNode, innerNode.data.length);\n              }\n\n              return CaretPosition.after(innerNode);\n            }\n          }\n\n          if (isText$1(nextNode)) {\n            return CaretPosition(nextNode, nextNode.data.length);\n          }\n\n          return CaretPosition.before(nextNode);\n        }\n      }\n\n      if (isForwards(direction) && offset < container.childNodes.length) {\n        nextNode = nodeAtIndex(container, offset);\n\n        if (isCaretCandidate(nextNode)) {\n          if (isBr$1(nextNode)) {\n            return moveForwardFromBr(root, nextNode);\n          }\n\n          if (!isAtomic(nextNode)) {\n            innerNode = findNode$1(nextNode, direction, isEditableCaretCandidate, nextNode);\n\n            if (innerNode) {\n              if (isText$1(innerNode)) {\n                return CaretPosition(innerNode, 0);\n              }\n\n              return CaretPosition.before(innerNode);\n            }\n          }\n\n          if (isText$1(nextNode)) {\n            return CaretPosition(nextNode, 0);\n          }\n\n          return CaretPosition.after(nextNode);\n        }\n      }\n\n      node = nextNode ? nextNode : caretPosition.getNode();\n    }\n\n    if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n      node = findNode$1(node, direction, always, root, true);\n\n      if (isEditableCaretCandidate(node, root)) {\n        return getCaretCandidatePosition(direction, node);\n      }\n    }\n\n    nextNode = findNode$1(node, direction, isEditableCaretCandidate, root);\n    var rootContentEditableFalseElm = last$1(filter$4(getParents$3(container, root), isContentEditableFalse$6));\n\n    if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n      if (isForwards(direction)) {\n        caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n      } else {\n        caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n      }\n\n      return caretPosition;\n    }\n\n    if (nextNode) {\n      return getCaretCandidatePosition(direction, nextNode);\n    }\n\n    return null;\n  };\n\n  var CaretWalker = function (root) {\n    return {\n      next: function (caretPosition) {\n        return findCaretPosition$1(HDirection.Forwards, caretPosition, root);\n      },\n      prev: function (caretPosition) {\n        return findCaretPosition$1(HDirection.Backwards, caretPosition, root);\n      }\n    };\n  };\n\n  var walkToPositionIn = function (forward, root, start) {\n    var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n    return fromPosition(forward, root, position);\n  };\n\n  var afterElement = function (node) {\n    return isBr$5(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n  };\n\n  var isBeforeOrStart = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      return position.offset() === 0;\n    } else {\n      return isCaretCandidate$3(position.getNode());\n    }\n  };\n\n  var isAfterOrEnd = function (position) {\n    if (CaretPosition.isTextPosition(position)) {\n      var container = position.container();\n      return position.offset() === container.data.length;\n    } else {\n      return isCaretCandidate$3(position.getNode(true));\n    }\n  };\n\n  var isBeforeAfterSameElement = function (from, to) {\n    return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n  };\n\n  var isAtBr = function (position) {\n    return !CaretPosition.isTextPosition(position) && isBr$5(position.getNode());\n  };\n\n  var shouldSkipPosition = function (forward, from, to) {\n    if (forward) {\n      return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n    } else {\n      return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n    }\n  };\n\n  var fromPosition = function (forward, root, pos) {\n    var walker = CaretWalker(root);\n    return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n  };\n\n  var navigate = function (forward, root, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n        return fromPosition(forward, root, to);\n      } else {\n        return Optional.some(to);\n      }\n    });\n  };\n\n  var navigateIgnore = function (forward, root, from, ignoreFilter) {\n    return navigate(forward, root, from).bind(function (pos) {\n      return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n    });\n  };\n\n  var positionIn = function (forward, element) {\n    var startNode = forward ? element.firstChild : element.lastChild;\n\n    if (isText$7(startNode)) {\n      return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n    } else if (startNode) {\n      if (isCaretCandidate$3(startNode)) {\n        return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n      } else {\n        return walkToPositionIn(forward, element, startNode);\n      }\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var nextPosition = curry(fromPosition, true);\n  var prevPosition = curry(fromPosition, false);\n  var firstPositionIn = curry(positionIn, true);\n  var lastPositionIn = curry(positionIn, false);\n  var CARET_ID$1 = '_mce_caret';\n\n  var isCaretNode = function (node) {\n    return isElement$5(node) && node.id === CARET_ID$1;\n  };\n\n  var getParentCaretContainer = function (body, node) {\n    while (node && node !== body) {\n      if (node.id === CARET_ID$1) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isStringPathBookmark = function (bookmark) {\n    return isString$1(bookmark.start);\n  };\n\n  var isRangeBookmark = function (bookmark) {\n    return has$2(bookmark, 'rng');\n  };\n\n  var isIdBookmark = function (bookmark) {\n    return has$2(bookmark, 'id');\n  };\n\n  var isIndexBookmark = function (bookmark) {\n    return has$2(bookmark, 'name');\n  };\n\n  var isPathBookmark = function (bookmark) {\n    return Tools.isArray(bookmark.start);\n  };\n\n  var addBogus = function (dom, node) {\n    if (isElement$5(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n      node.innerHTML = '<br data-mce-bogus=\"1\" />';\n    }\n\n    return node;\n  };\n\n  var resolveCaretPositionBookmark = function (dom, bookmark) {\n    var pos;\n    var rng = dom.createRng();\n    pos = resolve$2(dom.getRoot(), bookmark.start);\n    rng.setStart(pos.container(), pos.offset());\n    pos = resolve$2(dom.getRoot(), bookmark.end);\n    rng.setEnd(pos.container(), pos.offset());\n    return rng;\n  };\n\n  var insertZwsp = function (node, rng) {\n    var textNode = node.ownerDocument.createTextNode(ZWSP$1);\n    node.appendChild(textNode);\n    rng.setStart(textNode, 0);\n    rng.setEnd(textNode, 0);\n  };\n\n  var isEmpty$1 = function (node) {\n    return node.hasChildNodes() === false;\n  };\n\n  var tryFindRangePosition = function (node, rng) {\n    return lastPositionIn(node).fold(never, function (pos) {\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      return true;\n    });\n  };\n\n  var padEmptyCaretContainer = function (root, node, rng) {\n    if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n      insertZwsp(node, rng);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var setEndPoint = function (dom, start, bookmark, rng) {\n    var point = bookmark[start ? 'start' : 'end'];\n    var i, node, offset, children;\n    var root = dom.getRoot();\n\n    if (point) {\n      offset = point[0];\n\n      for (node = root, i = point.length - 1; i >= 1; i--) {\n        children = node.childNodes;\n\n        if (padEmptyCaretContainer(root, node, rng)) {\n          return true;\n        }\n\n        if (point[i] > children.length - 1) {\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n\n          return tryFindRangePosition(node, rng);\n        }\n\n        node = children[point[i]];\n      }\n\n      if (node.nodeType === 3) {\n        offset = Math.min(point[0], node.nodeValue.length);\n      }\n\n      if (node.nodeType === 1) {\n        offset = Math.min(point[0], node.childNodes.length);\n      }\n\n      if (start) {\n        rng.setStart(node, offset);\n      } else {\n        rng.setEnd(node, offset);\n      }\n    }\n\n    return true;\n  };\n\n  var isValidTextNode = function (node) {\n    return isText$7(node) && node.data.length > 0;\n  };\n\n  var restoreEndPoint = function (dom, suffix, bookmark) {\n    var marker = dom.get(bookmark.id + '_' + suffix),\n        node,\n        idx,\n        next,\n        prev;\n    var keep = bookmark.keep;\n    var container, offset;\n\n    if (marker) {\n      node = marker.parentNode;\n\n      if (suffix === 'start') {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.nextSibling)) {\n            node = marker.nextSibling;\n            idx = 0;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker) + 1;\n          }\n        }\n\n        container = node;\n        offset = idx;\n      } else {\n        if (!keep) {\n          idx = dom.nodeIndex(marker);\n        } else {\n          if (marker.hasChildNodes()) {\n            node = marker.firstChild;\n            idx = 1;\n          } else if (isValidTextNode(marker.previousSibling)) {\n            node = marker.previousSibling;\n            idx = marker.previousSibling.data.length;\n          } else {\n            node = marker.parentNode;\n            idx = dom.nodeIndex(marker);\n          }\n        }\n\n        container = node;\n        offset = idx;\n      }\n\n      if (!keep) {\n        prev = marker.previousSibling;\n        next = marker.nextSibling;\n        Tools.each(Tools.grep(marker.childNodes), function (node) {\n          if (isText$7(node)) {\n            node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n          }\n        });\n\n        while (marker = dom.get(bookmark.id + '_' + suffix)) {\n          dom.remove(marker, true);\n        }\n\n        if (prev && next && prev.nodeType === next.nodeType && isText$7(prev) && !Env.opera) {\n          idx = prev.nodeValue.length;\n          prev.appendData(next.nodeValue);\n          dom.remove(next);\n          container = prev;\n          offset = idx;\n        }\n      }\n\n      return Optional.some(CaretPosition(container, offset));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolvePaths = function (dom, bookmark) {\n    var rng = dom.createRng();\n\n    if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n      return Optional.some(rng);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var resolveId = function (dom, bookmark) {\n    var startPos = restoreEndPoint(dom, 'start', bookmark);\n    var endPos = restoreEndPoint(dom, 'end', bookmark);\n    return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n      var rng = dom.createRng();\n      rng.setStart(addBogus(dom, spos.container()), spos.offset());\n      rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n      return rng;\n    });\n  };\n\n  var resolveIndex = function (dom, bookmark) {\n    return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n      var rng = dom.createRng();\n      rng.selectNode(elm);\n      return rng;\n    });\n  };\n\n  var resolve$1 = function (selection, bookmark) {\n    var dom = selection.dom;\n\n    if (bookmark) {\n      if (isPathBookmark(bookmark)) {\n        return resolvePaths(dom, bookmark);\n      } else if (isStringPathBookmark(bookmark)) {\n        return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n      } else if (isIdBookmark(bookmark)) {\n        return resolveId(dom, bookmark);\n      } else if (isIndexBookmark(bookmark)) {\n        return resolveIndex(dom, bookmark);\n      } else if (isRangeBookmark(bookmark)) {\n        return Optional.some(bookmark.rng);\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var getBookmark$1 = function (selection, type, normalized) {\n    return getBookmark$2(selection, type, normalized);\n  };\n\n  var moveToBookmark = function (selection, bookmark) {\n    resolve$1(selection, bookmark).each(function (rng) {\n      selection.setRng(rng);\n    });\n  };\n\n  var isBookmarkNode$1 = function (node) {\n    return isElement$5(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n  };\n\n  var is = function (expected) {\n    return function (actual) {\n      return expected === actual;\n    };\n  };\n\n  var isNbsp = is(nbsp);\n\n  var isWhiteSpace = function (chr) {\n    return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n  };\n\n  var isContent = function (chr) {\n    return !isWhiteSpace(chr) && !isNbsp(chr);\n  };\n\n  var isNode = function (node) {\n    return !!node.nodeType;\n  };\n\n  var isInlineBlock = function (node) {\n    return node && /^(IMG)$/.test(node.nodeName);\n  };\n\n  var moveStart = function (dom, selection, rng) {\n    var offset = rng.startOffset;\n    var container = rng.startContainer;\n\n    if (container === rng.endContainer) {\n      if (isInlineBlock(container.childNodes[offset])) {\n        return;\n      }\n    }\n\n    if (isElement$5(container)) {\n      var nodes = container.childNodes;\n      var walker = void 0;\n\n      if (offset < nodes.length) {\n        container = nodes[offset];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n      } else {\n        container = nodes[nodes.length - 1];\n        walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        walker.next(true);\n      }\n\n      for (var node = walker.current(); node; node = walker.next()) {\n        if (isText$7(node) && !isWhiteSpaceNode$1(node)) {\n          rng.setStart(node, 0);\n          selection.setRng(rng);\n          return;\n        }\n      }\n    }\n  };\n\n  var getNonWhiteSpaceSibling = function (node, next, inc) {\n    if (node) {\n      var nextName = next ? 'nextSibling' : 'previousSibling';\n\n      for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n        if (isElement$5(node) || !isWhiteSpaceNode$1(node)) {\n          return node;\n        }\n      }\n    }\n  };\n\n  var isTextBlock$1 = function (editor, name) {\n    if (isNode(name)) {\n      name = name.nodeName;\n    }\n\n    return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n  };\n\n  var isValid = function (ed, parent, child) {\n    return ed.schema.isValidChild(parent, child);\n  };\n\n  var isWhiteSpaceNode$1 = function (node, allowSpaces) {\n    if (allowSpaces === void 0) {\n      allowSpaces = false;\n    }\n\n    if (isNonNullable(node) && isText$7(node)) {\n      var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n      return isWhitespaceText(data);\n    } else {\n      return false;\n    }\n  };\n\n  var isEmptyTextNode$1 = function (node) {\n    return isNonNullable(node) && isText$7(node) && node.length === 0;\n  };\n\n  var replaceVars = function (value, vars) {\n    if (isFunction(value)) {\n      value = value(vars);\n    } else if (isNonNullable(vars)) {\n      value = value.replace(/%(\\w+)/g, function (str, name) {\n        return vars[name] || str;\n      });\n    }\n\n    return value;\n  };\n\n  var isEq$5 = function (str1, str2) {\n    str1 = str1 || '';\n    str2 = str2 || '';\n    str1 = '' + (str1.nodeName || str1);\n    str2 = '' + (str2.nodeName || str2);\n    return str1.toLowerCase() === str2.toLowerCase();\n  };\n\n  var normalizeStyleValue = function (dom, value, name) {\n    if (name === 'color' || name === 'backgroundColor') {\n      value = dom.toHex(value);\n    }\n\n    if (name === 'fontWeight' && value === 700) {\n      value = 'bold';\n    }\n\n    if (name === 'fontFamily') {\n      value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n    }\n\n    return '' + value;\n  };\n\n  var getStyle = function (dom, node, name) {\n    return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n  };\n\n  var getTextDecoration = function (dom, node) {\n    var decoration;\n    dom.getParent(node, function (n) {\n      decoration = dom.getStyle(n, 'text-decoration');\n      return decoration && decoration !== 'none';\n    });\n    return decoration;\n  };\n\n  var getParents$2 = function (dom, node, selector) {\n    return dom.getParents(node, selector, dom.getRoot());\n  };\n\n  var isVariableFormatName = function (editor, formatName) {\n    var hasVariableValues = function (format) {\n      var isVariableValue = function (val) {\n        return val.length > 1 && val.charAt(0) === '%';\n      };\n\n      return exists(['styles', 'attributes'], function (key) {\n        return get$9(format, key).exists(function (field) {\n          var fieldValues = isArray$1(field) ? field : values(field);\n          return exists(fieldValues, isVariableValue);\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), hasVariableValues);\n  };\n\n  var areSimilarFormats = function (editor, formatName, otherFormatName) {\n    var validKeys = ['inline', 'block', 'selector', 'attributes', 'styles', 'classes'];\n\n    var filterObj = function (format) {\n      return filter$3(format, function (_, key) {\n        return exists(validKeys, function (validKey) {\n          return validKey === key;\n        });\n      });\n    };\n\n    return exists(editor.formatter.get(formatName), function (fmt1) {\n      var filteredFmt1 = filterObj(fmt1);\n      return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n        var filteredFmt2 = filterObj(fmt2);\n        return equal$1(filteredFmt1, filteredFmt2);\n      });\n    });\n  };\n\n  var isBlockFormat = function (format) {\n    return hasNonNullableKey(format, 'block');\n  };\n\n  var isSelectorFormat = function (format) {\n    return hasNonNullableKey(format, 'selector');\n  };\n\n  var isInlineFormat = function (format) {\n    return hasNonNullableKey(format, 'inline');\n  };\n\n  var isMixedFormat = function (format) {\n    return isSelectorFormat(format) && isInlineFormat(format) && is$1(get$9(format, 'mixed'), true);\n  };\n\n  var shouldExpandToSelector = function (format) {\n    return isSelectorFormat(format) && format.expand !== false && !isInlineFormat(format);\n  };\n\n  var isBookmarkNode = isBookmarkNode$1;\n  var getParents$1 = getParents$2;\n  var isWhiteSpaceNode = isWhiteSpaceNode$1;\n  var isTextBlock = isTextBlock$1;\n\n  var isBogusBr = function (node) {\n    return isBr$5(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n  };\n\n  var findParentContentEditable = function (dom, node) {\n    var parent = node;\n\n    while (parent) {\n      if (isElement$5(parent) && dom.getContentEditable(parent)) {\n        return dom.getContentEditable(parent) === 'false' ? parent : node;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return node;\n  };\n\n  var walkText = function (start, node, offset, predicate) {\n    var str = node.data;\n\n    for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n      if (predicate(str.charAt(i))) {\n        return start ? i + 1 : i;\n      }\n    }\n\n    return -1;\n  };\n\n  var findSpace = function (start, node, offset) {\n    return walkText(start, node, offset, function (c) {\n      return isNbsp(c) || isWhiteSpace(c);\n    });\n  };\n\n  var findContent = function (start, node, offset) {\n    return walkText(start, node, offset, isContent);\n  };\n\n  var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n    var lastTextNode;\n    var rootNode = dom.getParent(container, dom.isBlock) || body;\n\n    var walk = function (container, offset, pred) {\n      var textSeeker = TextSeeker(dom);\n      var walker = start ? textSeeker.backwards : textSeeker.forwards;\n      return Optional.from(walker(container, offset, function (text, textOffset) {\n        if (isBookmarkNode(text.parentNode)) {\n          return -1;\n        } else {\n          lastTextNode = text;\n          return pred(start, text, textOffset);\n        }\n      }, rootNode));\n    };\n\n    var spaceResult = walk(container, offset, findSpace);\n    return spaceResult.bind(function (result) {\n      return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n    }).orThunk(function () {\n      return lastTextNode ? Optional.some({\n        container: lastTextNode,\n        offset: start ? 0 : lastTextNode.length\n      }) : Optional.none();\n    });\n  };\n\n  var findSelectorEndPoint = function (dom, formatList, rng, container, siblingName) {\n    if (isText$7(container) && isEmpty$3(container.data) && container[siblingName]) {\n      container = container[siblingName];\n    }\n\n    var parents = getParents$1(dom, container);\n\n    for (var i = 0; i < parents.length; i++) {\n      for (var y = 0; y < formatList.length; y++) {\n        var curFormat = formatList[y];\n\n        if (isNonNullable(curFormat.collapsed) && curFormat.collapsed !== rng.collapsed) {\n          continue;\n        }\n\n        if (isSelectorFormat(curFormat) && dom.is(parents[i], curFormat.selector)) {\n          return parents[i];\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var findBlockEndPoint = function (editor, formatList, container, siblingName) {\n    var node = container;\n    var dom = editor.dom;\n    var root = dom.getRoot();\n    var format = formatList[0];\n\n    if (isBlockFormat(format)) {\n      node = format.wrapper ? null : dom.getParent(container, format.block, root);\n    }\n\n    if (!node) {\n      var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n      node = dom.getParent(isText$7(container) ? container.parentNode : container, function (node) {\n        return node !== root && isTextBlock(editor, node);\n      }, scopeRoot);\n    }\n\n    if (node && isBlockFormat(format) && format.wrapper) {\n      node = getParents$1(dom, node, 'ul,ol').reverse()[0] || node;\n    }\n\n    if (!node) {\n      node = container;\n\n      while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n        node = node[siblingName];\n\n        if (isEq$5(node, 'br')) {\n          break;\n        }\n      }\n    }\n\n    return node || container;\n  };\n\n  var isAtBlockBoundary$1 = function (dom, root, container, siblingName) {\n    var parent = container.parentNode;\n\n    if (isNonNullable(container[siblingName])) {\n      return false;\n    } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n      return true;\n    } else {\n      return isAtBlockBoundary$1(dom, root, parent, siblingName);\n    }\n  };\n\n  var findParentContainer = function (dom, formatList, container, offset, start) {\n    var parent = container;\n    var siblingName = start ? 'previousSibling' : 'nextSibling';\n    var root = dom.getRoot();\n\n    if (isText$7(container) && !isWhiteSpaceNode(container)) {\n      if (start ? offset > 0 : offset < container.data.length) {\n        return container;\n      }\n    }\n\n    while (true) {\n      if (!formatList[0].block_expand && dom.isBlock(parent)) {\n        return parent;\n      }\n\n      for (var sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n        var allowSpaces = isText$7(sibling) && !isAtBlockBoundary$1(dom, root, sibling, siblingName);\n\n        if (!isBookmarkNode(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode(sibling, allowSpaces)) {\n          return parent;\n        }\n      }\n\n      if (parent === root || parent.parentNode === root) {\n        container = parent;\n        break;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return container;\n  };\n\n  var isSelfOrParentBookmark = function (container) {\n    return isBookmarkNode(container.parentNode) || isBookmarkNode(container);\n  };\n\n  var expandRng = function (editor, rng, formatList, includeTrailingSpace) {\n    if (includeTrailingSpace === void 0) {\n      includeTrailingSpace = false;\n    }\n\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n    var dom = editor.dom;\n    var format = formatList[0];\n\n    if (isElement$5(startContainer) && startContainer.hasChildNodes()) {\n      startContainer = getNode$1(startContainer, startOffset);\n\n      if (isText$7(startContainer)) {\n        startOffset = 0;\n      }\n    }\n\n    if (isElement$5(endContainer) && endContainer.hasChildNodes()) {\n      endContainer = getNode$1(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n\n      if (isText$7(endContainer)) {\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    startContainer = findParentContentEditable(dom, startContainer);\n    endContainer = findParentContentEditable(dom, endContainer);\n\n    if (isSelfOrParentBookmark(startContainer)) {\n      startContainer = isBookmarkNode(startContainer) ? startContainer : startContainer.parentNode;\n\n      if (rng.collapsed) {\n        startContainer = startContainer.previousSibling || startContainer;\n      } else {\n        startContainer = startContainer.nextSibling || startContainer;\n      }\n\n      if (isText$7(startContainer)) {\n        startOffset = rng.collapsed ? startContainer.length : 0;\n      }\n    }\n\n    if (isSelfOrParentBookmark(endContainer)) {\n      endContainer = isBookmarkNode(endContainer) ? endContainer : endContainer.parentNode;\n\n      if (rng.collapsed) {\n        endContainer = endContainer.nextSibling || endContainer;\n      } else {\n        endContainer = endContainer.previousSibling || endContainer;\n      }\n\n      if (isText$7(endContainer)) {\n        endOffset = rng.collapsed ? 0 : endContainer.length;\n      }\n    }\n\n    if (rng.collapsed) {\n      var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n      startPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        startContainer = container;\n        startOffset = offset;\n      });\n      var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n      endPoint.each(function (_a) {\n        var container = _a.container,\n            offset = _a.offset;\n        endContainer = container;\n        endOffset = offset;\n      });\n    }\n\n    if (isInlineFormat(format) || format.block_expand) {\n      if (!isInlineFormat(format) || !isText$7(startContainer) || startOffset === 0) {\n        startContainer = findParentContainer(dom, formatList, startContainer, startOffset, true);\n      }\n\n      if (!isInlineFormat(format) || !isText$7(endContainer) || endOffset === endContainer.nodeValue.length) {\n        endContainer = findParentContainer(dom, formatList, endContainer, endOffset, false);\n      }\n    }\n\n    if (shouldExpandToSelector(format)) {\n      startContainer = findSelectorEndPoint(dom, formatList, rng, startContainer, 'previousSibling');\n      endContainer = findSelectorEndPoint(dom, formatList, rng, endContainer, 'nextSibling');\n    }\n\n    if (isBlockFormat(format) || isSelectorFormat(format)) {\n      startContainer = findBlockEndPoint(editor, formatList, startContainer, 'previousSibling');\n      endContainer = findBlockEndPoint(editor, formatList, endContainer, 'nextSibling');\n\n      if (isBlockFormat(format)) {\n        if (!dom.isBlock(startContainer)) {\n          startContainer = findParentContainer(dom, formatList, startContainer, startOffset, true);\n        }\n\n        if (!dom.isBlock(endContainer)) {\n          endContainer = findParentContainer(dom, formatList, endContainer, endOffset, false);\n        }\n      }\n    }\n\n    if (isElement$5(startContainer)) {\n      startOffset = dom.nodeIndex(startContainer);\n      startContainer = startContainer.parentNode;\n    }\n\n    if (isElement$5(endContainer)) {\n      endOffset = dom.nodeIndex(endContainer) + 1;\n      endContainer = endContainer.parentNode;\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var walk$2 = function (dom, rng, callback) {\n    var startOffset = rng.startOffset;\n    var startContainer = getNode$1(rng.startContainer, startOffset);\n    var endOffset = rng.endOffset;\n    var endContainer = getNode$1(rng.endContainer, endOffset - 1);\n\n    var exclude = function (nodes) {\n      var firstNode = nodes[0];\n\n      if (isText$7(firstNode) && firstNode === startContainer && startOffset >= firstNode.data.length) {\n        nodes.splice(0, 1);\n      }\n\n      var lastNode = nodes[nodes.length - 1];\n\n      if (endOffset === 0 && nodes.length > 0 && lastNode === endContainer && isText$7(lastNode)) {\n        nodes.splice(nodes.length - 1, 1);\n      }\n\n      return nodes;\n    };\n\n    var collectSiblings = function (node, name, endNode) {\n      var siblings = [];\n\n      for (; node && node !== endNode; node = node[name]) {\n        siblings.push(node);\n      }\n\n      return siblings;\n    };\n\n    var findEndPoint = function (node, root) {\n      return dom.getParent(node, function (node) {\n        return node.parentNode === root;\n      }, root);\n    };\n\n    var walkBoundary = function (startNode, endNode, next) {\n      var siblingName = next ? 'nextSibling' : 'previousSibling';\n\n      for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n        parent_1 = node.parentNode;\n        var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n\n        if (siblings_1.length) {\n          if (!next) {\n            siblings_1.reverse();\n          }\n\n          callback(exclude(siblings_1));\n        }\n      }\n    };\n\n    if (startContainer === endContainer) {\n      return callback(exclude([startContainer]));\n    }\n\n    var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n\n    if (dom.isChildOf(startContainer, endContainer)) {\n      return walkBoundary(startContainer, ancestor, true);\n    }\n\n    if (dom.isChildOf(endContainer, startContainer)) {\n      return walkBoundary(endContainer, ancestor);\n    }\n\n    var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n    var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n    walkBoundary(startContainer, startPoint, true);\n    var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n\n    if (siblings.length) {\n      callback(exclude(siblings));\n    }\n\n    walkBoundary(endContainer, endPoint);\n  };\n\n  var getRanges = function (selection) {\n    var ranges = [];\n\n    if (selection) {\n      for (var i = 0; i < selection.rangeCount; i++) {\n        ranges.push(selection.getRangeAt(i));\n      }\n    }\n\n    return ranges;\n  };\n\n  var getSelectedNodes = function (ranges) {\n    return bind(ranges, function (range) {\n      var node = getSelectedNode(range);\n      return node ? [SugarElement.fromDom(node)] : [];\n    });\n  };\n\n  var hasMultipleRanges = function (selection) {\n    return getRanges(selection).length > 1;\n  };\n\n  var getCellsFromRanges = function (ranges) {\n    return filter$4(getSelectedNodes(ranges), isTableCell$4);\n  };\n\n  var getCellsFromElement = function (elm) {\n    return descendants(elm, 'td[data-mce-selected],th[data-mce-selected]');\n  };\n\n  var getCellsFromElementOrRanges = function (ranges, element) {\n    var selectedCells = getCellsFromElement(element);\n    return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n  };\n\n  var getCellsFromEditor = function (editor) {\n    return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n  };\n\n  var getClosestTable = function (cell, isRoot) {\n    return ancestor$2(cell, 'table', isRoot);\n  };\n\n  var getStartNode = function (rng) {\n    var sc = rng.startContainer,\n        so = rng.startOffset;\n\n    if (isText$7(sc)) {\n      return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n    } else {\n      return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getEndNode = function (rng) {\n    var ec = rng.endContainer,\n        eo = rng.endOffset;\n\n    if (isText$7(ec)) {\n      return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n    } else {\n      return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n    }\n  };\n\n  var getFirstChildren = function (node) {\n    return firstChild(node).fold(constant([node]), function (child) {\n      return [node].concat(getFirstChildren(child));\n    });\n  };\n\n  var getLastChildren$1 = function (node) {\n    return lastChild(node).fold(constant([node]), function (child) {\n      if (name(child) === 'br') {\n        return prevSibling(child).map(function (sibling) {\n          return [node].concat(getLastChildren$1(sibling));\n        }).getOr([]);\n      } else {\n        return [node].concat(getLastChildren$1(child));\n      }\n    });\n  };\n\n  var hasAllContentsSelected = function (elm, rng) {\n    return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n      var start = find$3(getFirstChildren(elm), curry(eq, startNode));\n      var end = find$3(getLastChildren$1(elm), curry(eq, endNode));\n      return start.isSome() && end.isSome();\n    }).getOr(false);\n  };\n\n  var moveEndPoint = function (dom, rng, node, start) {\n    var root = node,\n        walker = new DomTreeWalker(node, root);\n    var moveCaretBeforeOnEnterElementsMap = filter$3(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n      return !contains$3(['td', 'th', 'table'], name.toLowerCase());\n    });\n\n    do {\n      if (isText$7(node) && Tools.trim(node.nodeValue).length !== 0) {\n        if (start) {\n          rng.setStart(node, 0);\n        } else {\n          rng.setEnd(node, node.nodeValue.length);\n        }\n\n        return;\n      }\n\n      if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n        if (start) {\n          rng.setStartBefore(node);\n        } else {\n          if (node.nodeName === 'BR') {\n            rng.setEndBefore(node);\n          } else {\n            rng.setEndAfter(node);\n          }\n        }\n\n        return;\n      }\n    } while (node = start ? walker.next() : walker.prev());\n\n    if (root.nodeName === 'BODY') {\n      if (start) {\n        rng.setStart(root, 0);\n      } else {\n        rng.setEnd(root, root.childNodes.length);\n      }\n    }\n  };\n\n  var hasAnyRanges = function (editor) {\n    var sel = editor.selection.getSel();\n    return sel && sel.rangeCount > 0;\n  };\n\n  var runOnRanges = function (editor, executor) {\n    var fakeSelectionNodes = getCellsFromEditor(editor);\n\n    if (fakeSelectionNodes.length > 0) {\n      each$k(fakeSelectionNodes, function (elem) {\n        var node = elem.dom;\n        var fakeNodeRng = editor.dom.createRng();\n        fakeNodeRng.setStartBefore(node);\n        fakeNodeRng.setEndAfter(node);\n        executor(fakeNodeRng, true);\n      });\n    } else {\n      executor(editor.selection.getRng(), false);\n    }\n  };\n\n  var preserve = function (selection, fillBookmark, executor) {\n    var bookmark = getPersistentBookmark(selection, fillBookmark);\n    executor(bookmark);\n    selection.moveToBookmark(bookmark);\n  };\n\n  var NodeValue = function (is, name) {\n    var get = function (element) {\n      if (!is(element)) {\n        throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n      }\n\n      return getOption(element).getOr('');\n    };\n\n    var getOption = function (element) {\n      return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n    };\n\n    var set = function (element, value) {\n      if (!is(element)) {\n        throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n      }\n\n      element.dom.nodeValue = value;\n    };\n\n    return {\n      get: get,\n      getOption: getOption,\n      set: set\n    };\n  };\n\n  var api$1 = NodeValue(isText$8, 'text');\n\n  var get$2 = function (element) {\n    return api$1.get(element);\n  };\n\n  var isZeroWidth = function (elem) {\n    return isText$8(elem) && get$2(elem) === ZWSP$1;\n  };\n\n  var context = function (editor, elem, wrapName, nodeName) {\n    return parent(elem).fold(function () {\n      return 'skipping';\n    }, function (parent) {\n      if (nodeName === 'br' || isZeroWidth(elem)) {\n        return 'valid';\n      } else if (isAnnotation(elem)) {\n        return 'existing';\n      } else if (isCaretNode(elem.dom)) {\n        return 'caret';\n      } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n        return 'invalid-child';\n      } else {\n        return 'valid';\n      }\n    });\n  };\n\n  var applyWordGrab = function (editor, rng) {\n    var r = expandRng(editor, rng, [{\n      inline: 'span'\n    }]);\n    rng.setStart(r.startContainer, r.startOffset);\n    rng.setEnd(r.endContainer, r.endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n    var _b = _a.uid,\n        uid = _b === void 0 ? generate('mce-annotation') : _b,\n        data = __rest(_a, ['uid']);\n\n    var master = SugarElement.fromTag('span', eDoc);\n    add$1(master, annotation());\n    set$1(master, '' + dataAnnotationId(), uid);\n    set$1(master, '' + dataAnnotation(), annotationName);\n\n    var _c = decorate(uid, data),\n        _d = _c.attributes,\n        attributes = _d === void 0 ? {} : _d,\n        _e = _c.classes,\n        classes = _e === void 0 ? [] : _e;\n\n    setAll$1(master, attributes);\n    add(master, classes);\n    return master;\n  };\n\n  var annotate = function (editor, rng, annotationName, decorate, data) {\n    var newWrappers = [];\n    var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n    var wrapper = value();\n\n    var finishWrapper = function () {\n      wrapper.clear();\n    };\n\n    var getOrOpenWrapper = function () {\n      return wrapper.get().getOrThunk(function () {\n        var nu = shallow(master);\n        newWrappers.push(nu);\n        wrapper.set(nu);\n        return nu;\n      });\n    };\n\n    var processElements = function (elems) {\n      each$k(elems, processElement);\n    };\n\n    var processElement = function (elem) {\n      var ctx = context(editor, elem, 'span', name(elem));\n\n      switch (ctx) {\n        case 'invalid-child':\n          {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n\n        case 'valid':\n          {\n            var w = getOrOpenWrapper();\n            wrap$3(elem, w);\n            break;\n          }\n      }\n    };\n\n    var processNodes = function (nodes) {\n      var elems = map$3(nodes, SugarElement.fromDom);\n      processElements(elems);\n    };\n\n    walk$2(editor.dom, rng, function (nodes) {\n      finishWrapper();\n      processNodes(nodes);\n    });\n    return newWrappers;\n  };\n\n  var annotateWithBookmark = function (editor, name, settings, data) {\n    editor.undoManager.transact(function () {\n      var selection = editor.selection;\n      var initialRng = selection.getRng();\n      var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n\n      if (initialRng.collapsed && !hasFakeSelection) {\n        applyWordGrab(editor, initialRng);\n      }\n\n      if (selection.getRng().collapsed && !hasFakeSelection) {\n        var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n        set(wrapper, nbsp);\n        selection.getRng().insertNode(wrapper.dom);\n        selection.select(wrapper.dom);\n      } else {\n        preserve(selection, false, function () {\n          runOnRanges(editor, function (selectionRng) {\n            annotate(editor, selectionRng, name, settings.decorate, data);\n          });\n        });\n      }\n    });\n  };\n\n  var Annotator = function (editor) {\n    var registry = create$7();\n    setup$m(editor, registry);\n    var changes = setup$n(editor);\n    return {\n      register: function (name, settings) {\n        registry.register(name, settings);\n      },\n      annotate: function (name, data) {\n        registry.lookup(name).each(function (settings) {\n          annotateWithBookmark(editor, name, settings, data);\n        });\n      },\n      annotationChanged: function (name, callback) {\n        changes.addListener(name, callback);\n      },\n      remove: function (name) {\n        identify(editor, Optional.some(name)).each(function (_a) {\n          var elements = _a.elements;\n          each$k(elements, unwrap);\n        });\n      },\n      getAll: function (name) {\n        var directory = findAll(editor, name);\n        return map$2(directory, function (elems) {\n          return map$3(elems, function (elem) {\n            return elem.dom;\n          });\n        });\n      }\n    };\n  };\n\n  var BookmarkManager = function (selection) {\n    return {\n      getBookmark: curry(getBookmark$1, selection),\n      moveToBookmark: curry(moveToBookmark, selection)\n    };\n  };\n\n  BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n  var getContentEditableRoot$1 = function (root, node) {\n    while (node && node !== root) {\n      if (isContentEditableTrue$4(node) || isContentEditableFalse$b(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var isXYWithinRange = function (clientX, clientY, range) {\n    if (range.collapsed) {\n      return false;\n    }\n\n    if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n      var elm = range.startContainer.childNodes[range.startOffset];\n\n      if (isElement$5(elm)) {\n        return exists(elm.getClientRects(), function (rect) {\n          return containsXY(rect, clientX, clientY);\n        });\n      }\n    }\n\n    return exists(range.getClientRects(), function (rect) {\n      return containsXY(rect, clientX, clientY);\n    });\n  };\n\n  var firePreProcess = function (editor, args) {\n    return editor.fire('PreProcess', args);\n  };\n\n  var firePostProcess = function (editor, args) {\n    return editor.fire('PostProcess', args);\n  };\n\n  var fireRemove = function (editor) {\n    return editor.fire('remove');\n  };\n\n  var fireDetach = function (editor) {\n    return editor.fire('detach');\n  };\n\n  var fireSwitchMode = function (editor, mode) {\n    return editor.fire('SwitchMode', {\n      mode: mode\n    });\n  };\n\n  var fireObjectResizeStart = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResizeStart', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var fireObjectResized = function (editor, target, width, height, origin) {\n    editor.fire('ObjectResized', {\n      target: target,\n      width: width,\n      height: height,\n      origin: origin\n    });\n  };\n\n  var firePreInit = function (editor) {\n    return editor.fire('PreInit');\n  };\n\n  var firePostRender = function (editor) {\n    return editor.fire('PostRender');\n  };\n\n  var fireInit = function (editor) {\n    return editor.fire('Init');\n  };\n\n  var firePlaceholderToggle = function (editor, state) {\n    return editor.fire('PlaceholderToggle', {\n      state: state\n    });\n  };\n\n  var fireError = function (editor, errorType, error) {\n    return editor.fire(errorType, error);\n  };\n\n  var fireFormatApply = function (editor, format, node, vars) {\n    return editor.fire('FormatApply', {\n      format: format,\n      node: node,\n      vars: vars\n    });\n  };\n\n  var fireFormatRemove = function (editor, format, node, vars) {\n    return editor.fire('FormatRemove', {\n      format: format,\n      node: node,\n      vars: vars\n    });\n  };\n\n  var VK = {\n    BACKSPACE: 8,\n    DELETE: 46,\n    DOWN: 40,\n    ENTER: 13,\n    ESC: 27,\n    LEFT: 37,\n    RIGHT: 39,\n    SPACEBAR: 32,\n    TAB: 9,\n    UP: 38,\n    PAGE_UP: 33,\n    PAGE_DOWN: 34,\n    END: 35,\n    HOME: 36,\n    modifierPressed: function (e) {\n      return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n    },\n    metaKeyPressed: function (e) {\n      return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n    }\n  };\n  var isContentEditableFalse$5 = isContentEditableFalse$b;\n\n  var ControlSelection = function (selection, editor) {\n    var elementSelectionAttr = 'data-mce-selected';\n    var dom = editor.dom,\n        each = Tools.each;\n    var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n    var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n    var width, height;\n    var editableDoc = editor.getDoc(),\n        rootDocument = document;\n    var abs = Math.abs,\n        round = Math.round,\n        rootElement = editor.getBody();\n    var startScrollWidth, startScrollHeight;\n    var resizeHandles = {\n      nw: [0, 0, -1, -1],\n      ne: [1, 0, 1, -1],\n      se: [1, 1, 1, 1],\n      sw: [0, 1, -1, 1]\n    };\n\n    var isImage = function (elm) {\n      return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n    };\n\n    var isMedia = function (elm) {\n      return isMedia$2(elm) || dom.hasClass(elm, 'mce-preview-object');\n    };\n\n    var isEventOnImageOutsideRange = function (evt, range) {\n      if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n        var touch = evt.touches[0];\n        return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n      } else {\n        return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n      }\n    };\n\n    var contextMenuSelectImage = function (evt) {\n      var target = evt.target;\n\n      if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n        editor.selection.select(target);\n      }\n    };\n\n    var getResizeTargets = function (elm) {\n      if (dom.is(elm, 'figure.image')) {\n        return [elm.querySelector('img')];\n      } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n        return [elm, elm.firstElementChild];\n      } else {\n        return [elm];\n      }\n    };\n\n    var isResizable = function (elm) {\n      var selector = getObjectResizing(editor);\n\n      if (!selector) {\n        return false;\n      }\n\n      if (elm.getAttribute('data-mce-resize') === 'false') {\n        return false;\n      }\n\n      if (elm === editor.getBody()) {\n        return false;\n      }\n\n      if (dom.hasClass(elm, 'mce-preview-object')) {\n        return is$2(SugarElement.fromDom(elm.firstElementChild), selector);\n      } else {\n        return is$2(SugarElement.fromDom(elm), selector);\n      }\n    };\n\n    var createGhostElement = function (elm) {\n      if (isMedia(elm)) {\n        return dom.create('img', {\n          src: Env.transparentSrc\n        });\n      } else {\n        return elm.cloneNode(true);\n      }\n    };\n\n    var setSizeProp = function (element, name, value) {\n      if (isNonNullable(value)) {\n        var targets = getResizeTargets(element);\n        each$k(targets, function (target) {\n          if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n            dom.setStyle(target, name, value);\n          } else {\n            dom.setAttrib(target, name, '' + value);\n          }\n        });\n      }\n    };\n\n    var setGhostElmSize = function (ghostElm, width, height) {\n      setSizeProp(ghostElm, 'width', width);\n      setSizeProp(ghostElm, 'height', height);\n    };\n\n    var resizeGhostElement = function (e) {\n      var deltaX, deltaY, proportional;\n      var resizeHelperX, resizeHelperY;\n      deltaX = e.screenX - startX;\n      deltaY = e.screenY - startY;\n      width = deltaX * selectedHandle[2] + startW;\n      height = deltaY * selectedHandle[3] + startH;\n      width = width < 5 ? 5 : width;\n      height = height < 5 ? 5 : height;\n\n      if ((isImage(selectedElm) || isMedia(selectedElm)) && getResizeImgProportional(editor) !== false) {\n        proportional = !VK.modifierPressed(e);\n      } else {\n        proportional = VK.modifierPressed(e);\n      }\n\n      if (proportional) {\n        if (abs(deltaX) > abs(deltaY)) {\n          height = round(width * ratio);\n          width = round(height / ratio);\n        } else {\n          width = round(height / ratio);\n          height = round(width * ratio);\n        }\n      }\n\n      setGhostElmSize(selectedElmGhost, width, height);\n      resizeHelperX = selectedHandle.startPos.x + deltaX;\n      resizeHelperY = selectedHandle.startPos.y + deltaY;\n      resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n      resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n      dom.setStyles(resizeHelper, {\n        left: resizeHelperX,\n        top: resizeHelperY,\n        display: 'block'\n      });\n      resizeHelper.innerHTML = width + ' &times; ' + height;\n\n      if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n        dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n      }\n\n      if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n        dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n      }\n\n      deltaX = rootElement.scrollWidth - startScrollWidth;\n      deltaY = rootElement.scrollHeight - startScrollHeight;\n\n      if (deltaX + deltaY !== 0) {\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX - deltaX,\n          top: resizeHelperY - deltaY\n        });\n      }\n\n      if (!resizeStarted) {\n        fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n        resizeStarted = true;\n      }\n    };\n\n    var endGhostResize = function () {\n      var wasResizeStarted = resizeStarted;\n      resizeStarted = false;\n\n      if (wasResizeStarted) {\n        setSizeProp(selectedElm, 'width', width);\n        setSizeProp(selectedElm, 'height', height);\n      }\n\n      dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n      dom.unbind(editableDoc, 'mouseup', endGhostResize);\n\n      if (rootDocument !== editableDoc) {\n        dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n        dom.unbind(rootDocument, 'mouseup', endGhostResize);\n      }\n\n      dom.remove(selectedElmGhost);\n      dom.remove(resizeHelper);\n      dom.remove(resizeBackdrop);\n      showResizeRect(selectedElm);\n\n      if (wasResizeStarted) {\n        fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n        dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n      }\n\n      editor.nodeChanged();\n    };\n\n    var showResizeRect = function (targetElm) {\n      unbindResizeHandleEvents();\n      var position = dom.getPos(targetElm, rootElement);\n      var selectedElmX = position.x;\n      var selectedElmY = position.y;\n      var rect = targetElm.getBoundingClientRect();\n      var targetWidth = rect.width || rect.right - rect.left;\n      var targetHeight = rect.height || rect.bottom - rect.top;\n\n      if (selectedElm !== targetElm) {\n        hideResizeRect();\n        selectedElm = targetElm;\n        width = height = 0;\n      }\n\n      var e = editor.fire('ObjectSelected', {\n        target: targetElm\n      });\n      var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n\n      if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n        each(resizeHandles, function (handle, name) {\n          var handleElm;\n\n          var startDrag = function (e) {\n            var target = getResizeTargets(selectedElm)[0];\n            startX = e.screenX;\n            startY = e.screenY;\n            startW = target.clientWidth;\n            startH = target.clientHeight;\n            ratio = startH / startW;\n            selectedHandle = handle;\n            selectedHandle.name = name;\n            selectedHandle.startPos = {\n              x: targetWidth * handle[0] + selectedElmX,\n              y: targetHeight * handle[1] + selectedElmY\n            };\n            startScrollWidth = rootElement.scrollWidth;\n            startScrollHeight = rootElement.scrollHeight;\n            resizeBackdrop = dom.add(rootElement, 'div', {\n              'class': 'mce-resize-backdrop',\n              'data-mce-bogus': 'all'\n            });\n            dom.setStyles(resizeBackdrop, {\n              position: 'fixed',\n              left: '0',\n              top: '0',\n              width: '100%',\n              height: '100%'\n            });\n            selectedElmGhost = createGhostElement(selectedElm);\n            dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n            dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n            selectedElmGhost.contentEditable = 'false';\n            dom.setStyles(selectedElmGhost, {\n              left: selectedElmX,\n              top: selectedElmY,\n              margin: 0\n            });\n            setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n            selectedElmGhost.removeAttribute(elementSelectionAttr);\n            rootElement.appendChild(selectedElmGhost);\n            dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n            dom.bind(editableDoc, 'mouseup', endGhostResize);\n\n            if (rootDocument !== editableDoc) {\n              dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n              dom.bind(rootDocument, 'mouseup', endGhostResize);\n            }\n\n            resizeHelper = dom.add(rootElement, 'div', {\n              'class': 'mce-resize-helper',\n              'data-mce-bogus': 'all'\n            }, startW + ' &times; ' + startH);\n          };\n\n          handleElm = dom.get('mceResizeHandle' + name);\n\n          if (handleElm) {\n            dom.remove(handleElm);\n          }\n\n          handleElm = dom.add(rootElement, 'div', {\n            'id': 'mceResizeHandle' + name,\n            'data-mce-bogus': 'all',\n            'class': 'mce-resizehandle',\n            'unselectable': true,\n            'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n          });\n\n          if (Env.ie === 11) {\n            handleElm.contentEditable = false;\n          }\n\n          dom.bind(handleElm, 'mousedown', function (e) {\n            e.stopImmediatePropagation();\n            e.preventDefault();\n            startDrag(e);\n          });\n          handle.elm = handleElm;\n          dom.setStyles(handleElm, {\n            left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n            top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n          });\n        });\n      } else {\n        hideResizeRect();\n      }\n\n      if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n        selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n      }\n    };\n\n    var hideResizeRect = function () {\n      unbindResizeHandleEvents();\n\n      if (selectedElm) {\n        selectedElm.removeAttribute(elementSelectionAttr);\n      }\n\n      each$j(resizeHandles, function (value, name) {\n        var handleElm = dom.get('mceResizeHandle' + name);\n\n        if (handleElm) {\n          dom.unbind(handleElm);\n          dom.remove(handleElm);\n        }\n      });\n    };\n\n    var updateResizeRect = function (e) {\n      var startElm, controlElm;\n\n      var isChildOrEqual = function (node, parent) {\n        if (node) {\n          do {\n            if (node === parent) {\n              return true;\n            }\n          } while (node = node.parentNode);\n        }\n      };\n\n      if (resizeStarted || editor.removed) {\n        return;\n      }\n\n      each(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n        img.removeAttribute(elementSelectionAttr);\n      });\n      controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n      controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n\n      if (isChildOrEqual(controlElm, rootElement)) {\n        disableGeckoResize();\n        startElm = selection.getStart(true);\n\n        if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n          showResizeRect(controlElm);\n          return;\n        }\n      }\n\n      hideResizeRect();\n    };\n\n    var isWithinContentEditableFalse = function (elm) {\n      return isContentEditableFalse$5(getContentEditableRoot$1(editor.getBody(), elm));\n    };\n\n    var unbindResizeHandleEvents = function () {\n      each$j(resizeHandles, function (handle) {\n        if (handle.elm) {\n          dom.unbind(handle.elm);\n          delete handle.elm;\n        }\n      });\n    };\n\n    var disableGeckoResize = function () {\n      try {\n        editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n      } catch (ex) {}\n    };\n\n    editor.on('init', function () {\n      disableGeckoResize();\n\n      if (Env.browser.isIE() || Env.browser.isEdge()) {\n        editor.on('mousedown click', function (e) {\n          var target = e.target,\n              nodeName = target.nodeName;\n\n          if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n            if (e.button !== 2) {\n              editor.selection.select(target, nodeName === 'TABLE');\n            }\n\n            if (e.type === 'mousedown') {\n              editor.nodeChanged();\n            }\n          }\n        });\n\n        var handleMSControlSelect_1 = function (e) {\n          var delayedSelect = function (node) {\n            Delay.setEditorTimeout(editor, function () {\n              return editor.selection.select(node);\n            });\n          };\n\n          if (isWithinContentEditableFalse(e.target) || isMedia$2(e.target)) {\n            e.preventDefault();\n            delayedSelect(e.target);\n            return;\n          }\n\n          if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n            e.preventDefault();\n\n            if (e.target.tagName === 'IMG') {\n              delayedSelect(e.target);\n            }\n          }\n        };\n\n        dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        editor.on('remove', function () {\n          return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n        });\n      }\n\n      var throttledUpdateResizeRect = Delay.throttle(function (e) {\n        if (!editor.composing) {\n          updateResizeRect(e);\n        }\n      });\n      editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n      editor.on('keyup compositionend', function (e) {\n        if (selectedElm && selectedElm.nodeName === 'TABLE') {\n          throttledUpdateResizeRect(e);\n        }\n      });\n      editor.on('hide blur', hideResizeRect);\n      editor.on('contextmenu longpress', contextMenuSelectImage, true);\n    });\n    editor.on('remove', unbindResizeHandleEvents);\n\n    var destroy = function () {\n      selectedElm = selectedElmGhost = resizeBackdrop = null;\n    };\n\n    return {\n      isResizable: isResizable,\n      showResizeRect: showResizeRect,\n      hideResizeRect: hideResizeRect,\n      updateResizeRect: updateResizeRect,\n      destroy: destroy\n    };\n  };\n\n  var hasCeProperty = function (node) {\n    return isContentEditableTrue$4(node) || isContentEditableFalse$b(node);\n  };\n\n  var findParent$1 = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var findClosestIeRange = function (clientX, clientY, doc) {\n    var rects;\n    var element = doc.elementFromPoint(clientX, clientY);\n    var rng = doc.body.createTextRange();\n\n    if (!element || element.tagName === 'HTML') {\n      element = doc.body;\n    }\n\n    rng.moveToElementText(element);\n    rects = Tools.toArray(rng.getClientRects());\n    rects = rects.sort(function (a, b) {\n      a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n      b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n      return a - b;\n    });\n\n    if (rects.length > 0) {\n      clientY = (rects[0].bottom + rects[0].top) / 2;\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n        return rng;\n      } catch (ex) {}\n    }\n\n    return null;\n  };\n\n  var moveOutOfContentEditableFalse = function (rng, rootNode) {\n    var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n    return isContentEditableFalse$b(findParent$1(parentElement, rootNode, hasCeProperty)) ? null : rng;\n  };\n\n  var fromPoint = function (clientX, clientY, doc) {\n    var rng, point;\n    var pointDoc = doc;\n\n    if (pointDoc.caretPositionFromPoint) {\n      point = pointDoc.caretPositionFromPoint(clientX, clientY);\n\n      if (point) {\n        rng = doc.createRange();\n        rng.setStart(point.offsetNode, point.offset);\n        rng.collapse(true);\n      }\n    } else if (pointDoc.caretRangeFromPoint) {\n      rng = pointDoc.caretRangeFromPoint(clientX, clientY);\n    } else if (pointDoc.body.createTextRange) {\n      rng = pointDoc.body.createTextRange();\n\n      try {\n        rng.moveToPoint(clientX, clientY);\n        rng.collapse(true);\n      } catch (ex) {\n        rng = findClosestIeRange(clientX, clientY, doc);\n      }\n\n      return moveOutOfContentEditableFalse(rng, doc.body);\n    }\n\n    return rng;\n  };\n\n  var isEq$4 = function (rng1, rng2) {\n    return rng1 && rng2 && rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset && rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset;\n  };\n\n  var findParent = function (node, rootNode, predicate) {\n    while (node && node !== rootNode) {\n      if (predicate(node)) {\n        return node;\n      }\n\n      node = node.parentNode;\n    }\n\n    return null;\n  };\n\n  var hasParent$1 = function (node, rootNode, predicate) {\n    return findParent(node, rootNode, predicate) !== null;\n  };\n\n  var hasParentWithName = function (node, rootNode, name) {\n    return hasParent$1(node, rootNode, function (node) {\n      return node.nodeName === name;\n    });\n  };\n\n  var isTable = function (node) {\n    return node && node.nodeName === 'TABLE';\n  };\n\n  var isTableCell$2 = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var isCeFalseCaretContainer = function (node, rootNode) {\n    return isCaretContainer$2(node) && hasParent$1(node, rootNode, isCaretNode) === false;\n  };\n\n  var hasBrBeforeAfter = function (dom, node, left) {\n    var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (isBr$5(node)) {\n        return true;\n      }\n    }\n  };\n\n  var isPrevNode = function (node, name) {\n    return node.previousSibling && node.previousSibling.nodeName === name;\n  };\n\n  var hasContentEditableFalseParent = function (body, node) {\n    while (node && node !== body) {\n      if (isContentEditableFalse$b(node)) {\n        return true;\n      }\n\n      node = node.parentNode;\n    }\n\n    return false;\n  };\n\n  var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n    var lastInlineElement;\n    var body = dom.getRoot();\n    var node;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n\n    if (left && isBr$5(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n      return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n    }\n\n    var walker = new DomTreeWalker(startNode, parentBlockContainer);\n\n    while (node = walker[left ? 'prev' : 'next']()) {\n      if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n        return Optional.none();\n      }\n\n      if (isText$7(node) && node.nodeValue.length > 0) {\n        if (hasParentWithName(node, body, 'A') === false) {\n          return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n        }\n\n        return Optional.none();\n      }\n\n      if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        return Optional.none();\n      }\n\n      lastInlineElement = node;\n    }\n\n    if (collapsed && lastInlineElement) {\n      return Optional.some(CaretPosition(lastInlineElement, 0));\n    }\n\n    return Optional.none();\n  };\n\n  var normalizeEndPoint = function (dom, collapsed, start, rng) {\n    var container, offset;\n    var body = dom.getRoot();\n    var node;\n    var directionLeft,\n        normalized = false;\n    container = rng[(start ? 'start' : 'end') + 'Container'];\n    offset = rng[(start ? 'start' : 'end') + 'Offset'];\n    var isAfterNode = isElement$5(container) && offset === container.childNodes.length;\n    var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n    directionLeft = start;\n\n    if (isCaretContainer$2(container)) {\n      return Optional.none();\n    }\n\n    if (isElement$5(container) && offset > container.childNodes.length - 1) {\n      directionLeft = false;\n    }\n\n    if (isDocument$1(container)) {\n      container = body;\n      offset = 0;\n    }\n\n    if (container === body) {\n      if (directionLeft) {\n        node = container.childNodes[offset > 0 ? offset - 1 : 0];\n\n        if (node) {\n          if (isCaretContainer$2(node)) {\n            return Optional.none();\n          }\n\n          if (nonEmptyElementsMap[node.nodeName] || isTable(node)) {\n            return Optional.none();\n          }\n        }\n      }\n\n      if (container.hasChildNodes()) {\n        offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n        container = container.childNodes[offset];\n        offset = isText$7(container) && isAfterNode ? container.data.length : 0;\n\n        if (!collapsed && container === body.lastChild && isTable(container)) {\n          return Optional.none();\n        }\n\n        if (hasContentEditableFalseParent(body, container) || isCaretContainer$2(container)) {\n          return Optional.none();\n        }\n\n        if (container.hasChildNodes() && isTable(container) === false) {\n          node = container;\n          var walker = new DomTreeWalker(container, body);\n\n          do {\n            if (isContentEditableFalse$b(node) || isCaretContainer$2(node)) {\n              normalized = false;\n              break;\n            }\n\n            if (isText$7(node) && node.nodeValue.length > 0) {\n              offset = directionLeft ? 0 : node.nodeValue.length;\n              container = node;\n              normalized = true;\n              break;\n            }\n\n            if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$2(node)) {\n              offset = dom.nodeIndex(node);\n              container = node.parentNode;\n\n              if (!directionLeft) {\n                offset++;\n              }\n\n              normalized = true;\n              break;\n            }\n          } while (node = directionLeft ? walker.next() : walker.prev());\n        }\n      }\n    }\n\n    if (collapsed) {\n      if (isText$7(container) && offset === 0) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n\n      if (isElement$5(container)) {\n        node = container.childNodes[offset];\n\n        if (!node) {\n          node = container.childNodes[offset - 1];\n        }\n\n        if (node && isBr$5(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n      }\n    }\n\n    if (directionLeft && !collapsed && isText$7(container) && offset === container.nodeValue.length) {\n      findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n        container = pos.container();\n        offset = pos.offset();\n        normalized = true;\n      });\n    }\n\n    return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n  };\n\n  var normalize$2 = function (dom, rng) {\n    var collapsed = rng.collapsed,\n        normRng = rng.cloneRange();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n      if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n        normRng.setStart(pos.container(), pos.offset());\n      }\n    });\n\n    if (!collapsed) {\n      normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n        normRng.setEnd(pos.container(), pos.offset());\n      });\n    }\n\n    if (collapsed) {\n      normRng.collapse(true);\n    }\n\n    return isEq$4(rng, normRng) ? Optional.none() : Optional.some(normRng);\n  };\n\n  var splitText = function (node, offset) {\n    return node.splitText(offset);\n  };\n\n  var split = function (rng) {\n    var startContainer = rng.startContainer,\n        startOffset = rng.startOffset,\n        endContainer = rng.endContainer,\n        endOffset = rng.endOffset;\n\n    if (startContainer === endContainer && isText$7(startContainer)) {\n      if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        endContainer = splitText(startContainer, startOffset);\n        startContainer = endContainer.previousSibling;\n\n        if (endOffset > startOffset) {\n          endOffset = endOffset - startOffset;\n          startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n          startOffset = 0;\n        } else {\n          endOffset = 0;\n        }\n      }\n    } else {\n      if (isText$7(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n        startContainer = splitText(startContainer, startOffset);\n        startOffset = 0;\n      }\n\n      if (isText$7(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n        endContainer = splitText(endContainer, endOffset).previousSibling;\n        endOffset = endContainer.nodeValue.length;\n      }\n    }\n\n    return {\n      startContainer: startContainer,\n      startOffset: startOffset,\n      endContainer: endContainer,\n      endOffset: endOffset\n    };\n  };\n\n  var RangeUtils = function (dom) {\n    var walk = function (rng, callback) {\n      return walk$2(dom, rng, callback);\n    };\n\n    var split$1 = split;\n\n    var normalize = function (rng) {\n      return normalize$2(dom, rng).fold(never, function (normalizedRng) {\n        rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n        rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n        return true;\n      });\n    };\n\n    return {\n      walk: walk,\n      split: split$1,\n      normalize: normalize\n    };\n  };\n\n  RangeUtils.compareRanges = isEq$4;\n  RangeUtils.getCaretRangeFromPoint = fromPoint;\n  RangeUtils.getSelectedNode = getSelectedNode;\n  RangeUtils.getNode = getNode$1;\n\n  var Dimension = function (name, getOffset) {\n    var set = function (element, h) {\n      if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n        throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n      }\n\n      var dom = element.dom;\n\n      if (isSupported(dom)) {\n        dom.style[name] = h + 'px';\n      }\n    };\n\n    var get = function (element) {\n      var r = getOffset(element);\n\n      if (r <= 0 || r === null) {\n        var css = get$5(element, name);\n        return parseFloat(css) || 0;\n      }\n\n      return r;\n    };\n\n    var getOuter = get;\n\n    var aggregate = function (element, properties) {\n      return foldl(properties, function (acc, property) {\n        var val = get$5(element, property);\n        var value = val === undefined ? 0 : parseInt(val, 10);\n        return isNaN(value) ? acc : acc + value;\n      }, 0);\n    };\n\n    var max = function (element, value, properties) {\n      var cumulativeInclusions = aggregate(element, properties);\n      var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n      return absoluteMax;\n    };\n\n    return {\n      set: set,\n      get: get,\n      getOuter: getOuter,\n      aggregate: aggregate,\n      max: max\n    };\n  };\n\n  var api = Dimension('height', function (element) {\n    var dom = element.dom;\n    return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n  });\n\n  var get$1 = function (element) {\n    return api.get(element);\n  };\n\n  var walkUp = function (navigation, doc) {\n    var frame = navigation.view(doc);\n    return frame.fold(constant([]), function (f) {\n      var parent = navigation.owner(f);\n      var rest = walkUp(navigation, parent);\n      return [f].concat(rest);\n    });\n  };\n\n  var pathTo = function (element, navigation) {\n    var d = navigation.owner(element);\n    return walkUp(navigation, d);\n  };\n\n  var view = function (doc) {\n    var _a;\n\n    var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n    return element.map(SugarElement.fromDom);\n  };\n\n  var owner = function (element) {\n    return documentOrOwner(element);\n  };\n\n  var Navigation = /*#__PURE__*/Object.freeze({\n    __proto__: null,\n    view: view,\n    owner: owner\n  });\n\n  var find$1 = function (element) {\n    var doc = SugarElement.fromDom(document);\n    var scroll = get$8(doc);\n    var frames = pathTo(element, Navigation);\n    var offset = viewport(element);\n    var r = foldr(frames, function (b, a) {\n      var loc = viewport(a);\n      return {\n        left: b.left + loc.left,\n        top: b.top + loc.top\n      };\n    }, {\n      left: 0,\n      top: 0\n    });\n    return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n  };\n\n  var excludeFromDescend = function (element) {\n    return name(element) === 'textarea';\n  };\n\n  var fireScrollIntoViewEvent = function (editor, data) {\n    var scrollEvent = editor.fire('ScrollIntoView', data);\n    return scrollEvent.isDefaultPrevented();\n  };\n\n  var fireAfterScrollIntoViewEvent = function (editor, data) {\n    editor.fire('AfterScrollIntoView', data);\n  };\n\n  var descend = function (element, offset) {\n    var children$1 = children(element);\n\n    if (children$1.length === 0 || excludeFromDescend(element)) {\n      return {\n        element: element,\n        offset: offset\n      };\n    } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n      return {\n        element: children$1[offset],\n        offset: 0\n      };\n    } else {\n      var last = children$1[children$1.length - 1];\n\n      if (excludeFromDescend(last)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else {\n        if (name(last) === 'img') {\n          return {\n            element: last,\n            offset: 1\n          };\n        } else if (isText$8(last)) {\n          return {\n            element: last,\n            offset: get$2(last).length\n          };\n        } else {\n          return {\n            element: last,\n            offset: children(last).length\n          };\n        }\n      }\n    }\n  };\n\n  var markerInfo = function (element, cleanupFun) {\n    var pos = absolute(element);\n    var height = get$1(element);\n    return {\n      element: element,\n      bottom: pos.top + height,\n      height: height,\n      pos: pos,\n      cleanup: cleanupFun\n    };\n  };\n\n  var createMarker = function (element, offset) {\n    var startPoint = descend(element, offset);\n    var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\" style=\"display: inline-block;\">' + ZWSP$1 + '</span>');\n    before$4(startPoint.element, span);\n    return markerInfo(span, function () {\n      return remove$7(span);\n    });\n  };\n\n  var elementMarker = function (element) {\n    return markerInfo(SugarElement.fromDom(element), noop);\n  };\n\n  var withMarker = function (editor, f, rng, alignToTop) {\n    preserveWith(editor, function (_s, _e) {\n      return applyWithMarker(editor, f, rng, alignToTop);\n    }, rng);\n  };\n\n  var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n    var data = {\n      elm: marker.element.dom,\n      alignToTop: alignToTop\n    };\n\n    if (fireScrollIntoViewEvent(editor, data)) {\n      return;\n    }\n\n    var scrollTop = get$8(doc).top;\n    f(doc, scrollTop, marker, alignToTop);\n    fireAfterScrollIntoViewEvent(editor, data);\n  };\n\n  var applyWithMarker = function (editor, f, rng, alignToTop) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var doc = SugarElement.fromDom(editor.getDoc());\n    reflow(body);\n    var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n    withScrollEvents(editor, doc, f, marker, alignToTop);\n    marker.cleanup();\n  };\n\n  var withElement = function (editor, element, f, alignToTop) {\n    var doc = SugarElement.fromDom(editor.getDoc());\n    withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n  };\n\n  var preserveWith = function (editor, f, rng) {\n    var startElement = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endElement = rng.endContainer;\n    var endOffset = rng.endOffset;\n    f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n    var newRng = editor.dom.createRng();\n    newRng.setStart(startElement, startOffset);\n    newRng.setEnd(endElement, endOffset);\n    editor.selection.setRng(rng);\n  };\n\n  var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n    var pos = marker.pos;\n\n    if (alignToTop) {\n      to(pos.left, pos.top, doc);\n    } else {\n      var y = pos.top - viewHeight + marker.height;\n      to(pos.left, y, doc);\n    }\n  };\n\n  var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n    var viewportBottom = viewHeight + scrollTop;\n    var markerTop = marker.pos.top;\n    var markerBottom = marker.bottom;\n    var largerThanViewport = markerBottom - markerTop >= viewHeight;\n\n    if (markerTop < scrollTop) {\n      scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n    } else if (markerTop > viewportBottom) {\n      var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n      scrollToMarker(marker, viewHeight, align, doc);\n    } else if (markerBottom > viewportBottom && !largerThanViewport) {\n      scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n    }\n  };\n\n  var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n    var viewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n  };\n\n  var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n    var frameViewHeight = doc.dom.defaultView.innerHeight;\n    intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n    var op = find$1(marker.element);\n    var viewportBounds = getBounds(window);\n\n    if (op.top < viewportBounds.y) {\n      intoView(marker.element, alignToTop !== false);\n    } else if (op.top > viewportBounds.bottom) {\n      intoView(marker.element, alignToTop === true);\n    }\n  };\n\n  var rangeIntoWindow = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoWindow, rng, alignToTop);\n  };\n\n  var elementIntoWindow = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoWindow, alignToTop);\n  };\n\n  var rangeIntoFrame = function (editor, rng, alignToTop) {\n    return withMarker(editor, intoFrame, rng, alignToTop);\n  };\n\n  var elementIntoFrame = function (editor, element, alignToTop) {\n    return withElement(editor, element, intoFrame, alignToTop);\n  };\n\n  var scrollElementIntoView = function (editor, element, alignToTop) {\n    var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n    scroller(editor, element, alignToTop);\n  };\n\n  var scrollRangeIntoView = function (editor, rng, alignToTop) {\n    var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n    scroller(editor, rng, alignToTop);\n  };\n\n  var getDocument = function () {\n    return SugarElement.fromDom(document);\n  };\n\n  var focus$1 = function (element) {\n    return element.dom.focus();\n  };\n\n  var hasFocus$1 = function (element) {\n    var root = getRootNode(element).dom;\n    return element.dom === root.activeElement;\n  };\n\n  var active = function (root) {\n    if (root === void 0) {\n      root = getDocument();\n    }\n\n    return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n  };\n\n  var search = function (element) {\n    return active(getRootNode(element)).filter(function (e) {\n      return element.dom.contains(e.dom);\n    });\n  };\n\n  var create$5 = function (start, soffset, finish, foffset) {\n    return {\n      start: start,\n      soffset: soffset,\n      finish: finish,\n      foffset: foffset\n    };\n  };\n\n  var SimRange = {\n    create: create$5\n  };\n  var adt$1 = Adt.generate([{\n    before: ['element']\n  }, {\n    on: ['element', 'offset']\n  }, {\n    after: ['element']\n  }]);\n\n  var cata = function (subject, onBefore, onOn, onAfter) {\n    return subject.fold(onBefore, onOn, onAfter);\n  };\n\n  var getStart$2 = function (situ) {\n    return situ.fold(identity, identity, identity);\n  };\n\n  var before$1 = adt$1.before;\n  var on = adt$1.on;\n  var after$1 = adt$1.after;\n  var Situ = {\n    before: before$1,\n    on: on,\n    after: after$1,\n    cata: cata,\n    getStart: getStart$2\n  };\n  var adt = Adt.generate([{\n    domRange: ['rng']\n  }, {\n    relative: ['startSitu', 'finishSitu']\n  }, {\n    exact: ['start', 'soffset', 'finish', 'foffset']\n  }]);\n\n  var exactFromRange = function (simRange) {\n    return adt.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n  };\n\n  var getStart$1 = function (selection) {\n    return selection.match({\n      domRange: function (rng) {\n        return SugarElement.fromDom(rng.startContainer);\n      },\n      relative: function (startSitu, _finishSitu) {\n        return Situ.getStart(startSitu);\n      },\n      exact: function (start, _soffset, _finish, _foffset) {\n        return start;\n      }\n    });\n  };\n\n  var domRange = adt.domRange;\n  var relative = adt.relative;\n  var exact = adt.exact;\n\n  var getWin = function (selection) {\n    var start = getStart$1(selection);\n    return defaultView(start);\n  };\n\n  var range = SimRange.create;\n  var SimSelection = {\n    domRange: domRange,\n    relative: relative,\n    exact: exact,\n    exactFromRange: exactFromRange,\n    getWin: getWin,\n    range: range\n  };\n  var browser$1 = detect().browser;\n\n  var clamp$1 = function (offset, element) {\n    var max = isText$8(element) ? get$2(element).length : children(element).length + 1;\n\n    if (offset > max) {\n      return max;\n    } else if (offset < 0) {\n      return 0;\n    }\n\n    return offset;\n  };\n\n  var normalizeRng = function (rng) {\n    return SimSelection.range(rng.start, clamp$1(rng.soffset, rng.start), rng.finish, clamp$1(rng.foffset, rng.finish));\n  };\n\n  var isOrContains = function (root, elm) {\n    return !isRestrictedNode(elm.dom) && (contains$1(root, elm) || eq(root, elm));\n  };\n\n  var isRngInRoot = function (root) {\n    return function (rng) {\n      return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n    };\n  };\n\n  var shouldStore = function (editor) {\n    return editor.inline === true || browser$1.isIE();\n  };\n\n  var nativeRangeToSelectionRange = function (r) {\n    return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n  };\n\n  var readRange = function (win) {\n    var selection = win.getSelection();\n    var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n    return rng.map(nativeRangeToSelectionRange);\n  };\n\n  var getBookmark = function (root) {\n    var win = defaultView(root);\n    return readRange(win.dom).filter(isRngInRoot(root));\n  };\n\n  var validate = function (root, bookmark) {\n    return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n  };\n\n  var bookmarkToNativeRng = function (bookmark) {\n    var rng = document.createRange();\n\n    try {\n      rng.setStart(bookmark.start.dom, bookmark.soffset);\n      rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n      return Optional.some(rng);\n    } catch (_) {\n      return Optional.none();\n    }\n  };\n\n  var store = function (editor) {\n    var newBookmark = shouldStore(editor) ? getBookmark(SugarElement.fromDom(editor.getBody())) : Optional.none();\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var storeNative = function (editor, rng) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n    var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n    editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n  };\n\n  var getRng = function (editor) {\n    var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n    return bookmark.bind(function (x) {\n      return validate(SugarElement.fromDom(editor.getBody()), x);\n    }).bind(bookmarkToNativeRng);\n  };\n\n  var restore = function (editor) {\n    getRng(editor).each(function (rng) {\n      return editor.selection.setRng(rng);\n    });\n  };\n\n  var isEditorUIElement$1 = function (elm) {\n    var className = elm.className.toString();\n    return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n  };\n\n  var FocusManager = {\n    isEditorUIElement: isEditorUIElement$1\n  };\n\n  var isManualNodeChange = function (e) {\n    return e.type === 'nodechange' && e.selectionChange;\n  };\n\n  var registerPageMouseUp = function (editor, throttledStore) {\n    var mouseUpPage = function () {\n      throttledStore.throttle();\n    };\n\n    DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n    editor.on('remove', function () {\n      DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n    });\n  };\n\n  var registerFocusOut = function (editor) {\n    editor.on('focusout', function () {\n      store(editor);\n    });\n  };\n\n  var registerMouseUp = function (editor, throttledStore) {\n    editor.on('mouseup touchend', function (_e) {\n      throttledStore.throttle();\n    });\n  };\n\n  var registerEditorEvents = function (editor, throttledStore) {\n    var browser = detect().browser;\n\n    if (browser.isIE()) {\n      registerFocusOut(editor);\n    } else {\n      registerMouseUp(editor, throttledStore);\n    }\n\n    editor.on('keyup NodeChange', function (e) {\n      if (!isManualNodeChange(e)) {\n        store(editor);\n      }\n    });\n  };\n\n  var register$3 = function (editor) {\n    var throttledStore = first(function () {\n      store(editor);\n    }, 0);\n    editor.on('init', function () {\n      if (editor.inline) {\n        registerPageMouseUp(editor, throttledStore);\n      }\n\n      registerEditorEvents(editor, throttledStore);\n    });\n    editor.on('remove', function () {\n      throttledStore.cancel();\n    });\n  };\n\n  var documentFocusInHandler;\n  var DOM$8 = DOMUtils.DOM;\n\n  var isEditorUIElement = function (elm) {\n    return FocusManager.isEditorUIElement(elm);\n  };\n\n  var isEditorContentAreaElement = function (elm) {\n    var classList = elm.classList;\n\n    if (classList !== undefined) {\n      return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n    } else {\n      return false;\n    }\n  };\n\n  var isUIElement = function (editor, elm) {\n    var customSelector = getCustomUiSelector(editor);\n    var parent = DOM$8.getParent(elm, function (elm) {\n      return isEditorUIElement(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n    });\n    return parent !== null;\n  };\n\n  var getActiveElement = function (editor) {\n    try {\n      var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(root).fold(function () {\n        return document.body;\n      }, function (x) {\n        return x.dom;\n      });\n    } catch (ex) {\n      return document.body;\n    }\n  };\n\n  var registerEvents$1 = function (editorManager, e) {\n    var editor = e.editor;\n    register$3(editor);\n    editor.on('focusin', function () {\n      var focusedEditor = editorManager.focusedEditor;\n\n      if (focusedEditor !== editor) {\n        if (focusedEditor) {\n          focusedEditor.fire('blur', {\n            focusedEditor: editor\n          });\n        }\n\n        editorManager.setActive(editor);\n        editorManager.focusedEditor = editor;\n        editor.fire('focus', {\n          blurredEditor: focusedEditor\n        });\n        editor.focus(true);\n      }\n    });\n    editor.on('focusout', function () {\n      Delay.setEditorTimeout(editor, function () {\n        var focusedEditor = editorManager.focusedEditor;\n\n        if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n          editor.fire('blur', {\n            focusedEditor: null\n          });\n          editorManager.focusedEditor = null;\n        }\n      });\n    });\n\n    if (!documentFocusInHandler) {\n      documentFocusInHandler = function (e) {\n        var activeEditor = editorManager.activeEditor;\n\n        if (activeEditor) {\n          getOriginalEventTarget(e).each(function (target) {\n            if (target.ownerDocument === document) {\n              if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                activeEditor.fire('blur', {\n                  focusedEditor: null\n                });\n                editorManager.focusedEditor = null;\n              }\n            }\n          });\n        }\n      };\n\n      DOM$8.bind(document, 'focusin', documentFocusInHandler);\n    }\n  };\n\n  var unregisterDocumentEvents = function (editorManager, e) {\n    if (editorManager.focusedEditor === e.editor) {\n      editorManager.focusedEditor = null;\n    }\n\n    if (!editorManager.activeEditor) {\n      DOM$8.unbind(document, 'focusin', documentFocusInHandler);\n      documentFocusInHandler = null;\n    }\n  };\n\n  var setup$l = function (editorManager) {\n    editorManager.on('AddEditor', curry(registerEvents$1, editorManager));\n    editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n  };\n\n  var getContentEditableHost = function (editor, node) {\n    return editor.dom.getParent(node, function (node) {\n      return editor.dom.getContentEditable(node) === 'true';\n    });\n  };\n\n  var getCollapsedNode = function (rng) {\n    return rng.collapsed ? Optional.from(getNode$1(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n  };\n\n  var getFocusInElement = function (root, rng) {\n    return getCollapsedNode(rng).bind(function (node) {\n      if (isTableSection(node)) {\n        return Optional.some(node);\n      } else if (contains$1(root, node) === false) {\n        return Optional.some(root);\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var normalizeSelection$1 = function (editor, rng) {\n    getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n      return firstPositionIn(elm.dom);\n    }).fold(function () {\n      editor.selection.normalize();\n      return;\n    }, function (caretPos) {\n      return editor.selection.setRng(caretPos.toRange());\n    });\n  };\n\n  var focusBody = function (body) {\n    if (body.setActive) {\n      try {\n        body.setActive();\n      } catch (ex) {\n        body.focus();\n      }\n    } else {\n      body.focus();\n    }\n  };\n\n  var hasElementFocus = function (elm) {\n    return hasFocus$1(elm) || search(elm).isSome();\n  };\n\n  var hasIframeFocus = function (editor) {\n    return editor.iframeElement && hasFocus$1(SugarElement.fromDom(editor.iframeElement));\n  };\n\n  var hasInlineFocus = function (editor) {\n    var rawBody = editor.getBody();\n    return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n  };\n\n  var hasUiFocus = function (editor) {\n    var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n    return active(dos).filter(function (elem) {\n      return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n    }).isSome();\n  };\n\n  var hasFocus = function (editor) {\n    return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n  };\n\n  var hasEditorOrUiFocus = function (editor) {\n    return hasFocus(editor) || hasUiFocus(editor);\n  };\n\n  var focusEditor = function (editor) {\n    var selection = editor.selection;\n    var body = editor.getBody();\n    var rng = selection.getRng();\n    editor.quirks.refreshContentEditable();\n\n    if (editor.bookmark !== undefined && hasFocus(editor) === false) {\n      getRng(editor).each(function (bookmarkRng) {\n        editor.selection.setRng(bookmarkRng);\n        rng = bookmarkRng;\n      });\n    }\n\n    var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n\n    if (editor.$.contains(body, contentEditableHost)) {\n      focusBody(contentEditableHost);\n      normalizeSelection$1(editor, rng);\n      activateEditor(editor);\n      return;\n    }\n\n    if (!editor.inline) {\n      if (!Env.opera) {\n        focusBody(body);\n      }\n\n      editor.getWin().focus();\n    }\n\n    if (Env.gecko || editor.inline) {\n      focusBody(body);\n      normalizeSelection$1(editor, rng);\n    }\n\n    activateEditor(editor);\n  };\n\n  var activateEditor = function (editor) {\n    return editor.editorManager.setActive(editor);\n  };\n\n  var focus = function (editor, skipFocus) {\n    if (editor.removed) {\n      return;\n    }\n\n    if (skipFocus) {\n      activateEditor(editor);\n    } else {\n      focusEditor(editor);\n    }\n  };\n\n  var getEndpointElement = function (root, rng, start, real, resolve) {\n    var container = start ? rng.startContainer : rng.endContainer;\n    var offset = start ? rng.startOffset : rng.endOffset;\n    return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n      return !real || !rng.collapsed ? child$1(elm, resolve(elm, offset)).getOr(elm) : elm;\n    }).bind(function (elm) {\n      return isElement$6(elm) ? Optional.some(elm) : parent(elm).filter(isElement$6);\n    }).map(function (elm) {\n      return elm.dom;\n    }).getOr(root);\n  };\n\n  var getStart = function (root, rng, real) {\n    return getEndpointElement(root, rng, true, real, function (elm, offset) {\n      return Math.min(childNodesCount(elm), offset);\n    });\n  };\n\n  var getEnd = function (root, rng, real) {\n    return getEndpointElement(root, rng, false, real, function (elm, offset) {\n      return offset > 0 ? offset - 1 : offset;\n    });\n  };\n\n  var skipEmptyTextNodes = function (node, forwards) {\n    var orig = node;\n\n    while (node && isText$7(node) && node.length === 0) {\n      node = forwards ? node.nextSibling : node.previousSibling;\n    }\n\n    return node || orig;\n  };\n\n  var getNode = function (root, rng) {\n    var elm, startContainer, endContainer;\n\n    if (!rng) {\n      return root;\n    }\n\n    startContainer = rng.startContainer;\n    endContainer = rng.endContainer;\n    var startOffset = rng.startOffset;\n    var endOffset = rng.endOffset;\n    elm = rng.commonAncestorContainer;\n\n    if (!rng.collapsed) {\n      if (startContainer === endContainer) {\n        if (endOffset - startOffset < 2) {\n          if (startContainer.hasChildNodes()) {\n            elm = startContainer.childNodes[startOffset];\n          }\n        }\n      }\n\n      if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n        if (startContainer.length === startOffset) {\n          startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n        } else {\n          startContainer = startContainer.parentNode;\n        }\n\n        if (endOffset === 0) {\n          endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n        } else {\n          endContainer = endContainer.parentNode;\n        }\n\n        if (startContainer && startContainer === endContainer) {\n          return startContainer;\n        }\n      }\n    }\n\n    if (elm && elm.nodeType === 3) {\n      return elm.parentNode;\n    }\n\n    return elm;\n  };\n\n  var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n    var node;\n    var selectedBlocks = [];\n    var root = dom.getRoot();\n    startElm = dom.getParent(startElm || getStart(root, rng, rng.collapsed), dom.isBlock);\n    endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n\n    if (startElm && startElm !== root) {\n      selectedBlocks.push(startElm);\n    }\n\n    if (startElm && endElm && startElm !== endElm) {\n      node = startElm;\n      var walker = new DomTreeWalker(startElm, root);\n\n      while ((node = walker.next()) && node !== endElm) {\n        if (dom.isBlock(node)) {\n          selectedBlocks.push(node);\n        }\n      }\n    }\n\n    if (endElm && startElm !== endElm && endElm !== root) {\n      selectedBlocks.push(endElm);\n    }\n\n    return selectedBlocks;\n  };\n\n  var select = function (dom, node, content) {\n    return Optional.from(node).map(function (node) {\n      var idx = dom.nodeIndex(node);\n      var rng = dom.createRng();\n      rng.setStart(node.parentNode, idx);\n      rng.setEnd(node.parentNode, idx + 1);\n\n      if (content) {\n        moveEndPoint(dom, rng, node, true);\n        moveEndPoint(dom, rng, node, false);\n      }\n\n      return rng;\n    });\n  };\n\n  var processRanges = function (editor, ranges) {\n    return map$3(ranges, function (range) {\n      var evt = editor.fire('GetSelectionRange', {\n        range: range\n      });\n      return evt.range !== range ? evt.range : range;\n    });\n  };\n\n  var typeLookup = {\n    '#text': 3,\n    '#comment': 8,\n    '#cdata': 4,\n    '#pi': 7,\n    '#doctype': 10,\n    '#document-fragment': 11\n  };\n\n  var walk$1 = function (node, root, prev) {\n    var startName = prev ? 'lastChild' : 'firstChild';\n    var siblingName = prev ? 'prev' : 'next';\n\n    if (node[startName]) {\n      return node[startName];\n    }\n\n    if (node !== root) {\n      var sibling = node[siblingName];\n\n      if (sibling) {\n        return sibling;\n      }\n\n      for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n        sibling = parent_1[siblingName];\n\n        if (sibling) {\n          return sibling;\n        }\n      }\n    }\n  };\n\n  var isEmptyTextNode = function (node) {\n    if (!isWhitespaceText(node.value)) {\n      return false;\n    }\n\n    var parentNode = node.parent;\n\n    if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n      return false;\n    }\n\n    return true;\n  };\n\n  var isNonEmptyElement = function (node) {\n    var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n    return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n  };\n\n  var AstNode = function () {\n    function AstNode(name, type) {\n      this.name = name;\n      this.type = type;\n\n      if (type === 1) {\n        this.attributes = [];\n        this.attributes.map = {};\n      }\n    }\n\n    AstNode.create = function (name, attrs) {\n      var node = new AstNode(name, typeLookup[name] || 1);\n\n      if (attrs) {\n        each$j(attrs, function (value, attrName) {\n          node.attr(attrName, value);\n        });\n      }\n\n      return node;\n    };\n\n    AstNode.prototype.replace = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      self.insert(node, self);\n      self.remove();\n      return self;\n    };\n\n    AstNode.prototype.attr = function (name, value) {\n      var self = this;\n      var attrs;\n\n      if (typeof name !== 'string') {\n        if (name !== undefined && name !== null) {\n          each$j(name, function (value, key) {\n            self.attr(key, value);\n          });\n        }\n\n        return self;\n      }\n\n      if (attrs = self.attributes) {\n        if (value !== undefined) {\n          if (value === null) {\n            if (name in attrs.map) {\n              delete attrs.map[name];\n              var i = attrs.length;\n\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs.splice(i, 1);\n                  return self;\n                }\n              }\n            }\n\n            return self;\n          }\n\n          if (name in attrs.map) {\n            var i = attrs.length;\n\n            while (i--) {\n              if (attrs[i].name === name) {\n                attrs[i].value = value;\n                break;\n              }\n            }\n          } else {\n            attrs.push({\n              name: name,\n              value: value\n            });\n          }\n\n          attrs.map[name] = value;\n          return self;\n        }\n\n        return attrs.map[name];\n      }\n    };\n\n    AstNode.prototype.clone = function () {\n      var self = this;\n      var clone = new AstNode(self.name, self.type);\n      var selfAttrs;\n\n      if (selfAttrs = self.attributes) {\n        var cloneAttrs = [];\n        cloneAttrs.map = {};\n\n        for (var i = 0, l = selfAttrs.length; i < l; i++) {\n          var selfAttr = selfAttrs[i];\n\n          if (selfAttr.name !== 'id') {\n            cloneAttrs[cloneAttrs.length] = {\n              name: selfAttr.name,\n              value: selfAttr.value\n            };\n            cloneAttrs.map[selfAttr.name] = selfAttr.value;\n          }\n        }\n\n        clone.attributes = cloneAttrs;\n      }\n\n      clone.value = self.value;\n      clone.shortEnded = self.shortEnded;\n      return clone;\n    };\n\n    AstNode.prototype.wrap = function (wrapper) {\n      var self = this;\n      self.parent.insert(wrapper, self);\n      wrapper.append(self);\n      return self;\n    };\n\n    AstNode.prototype.unwrap = function () {\n      var self = this;\n\n      for (var node = self.firstChild; node;) {\n        var next = node.next;\n        self.insert(node, self, true);\n        node = next;\n      }\n\n      self.remove();\n    };\n\n    AstNode.prototype.remove = function () {\n      var self = this,\n          parent = self.parent,\n          next = self.next,\n          prev = self.prev;\n\n      if (parent) {\n        if (parent.firstChild === self) {\n          parent.firstChild = next;\n\n          if (next) {\n            next.prev = null;\n          }\n        } else {\n          prev.next = next;\n        }\n\n        if (parent.lastChild === self) {\n          parent.lastChild = prev;\n\n          if (prev) {\n            prev.next = null;\n          }\n        } else {\n          next.prev = prev;\n        }\n\n        self.parent = self.next = self.prev = null;\n      }\n\n      return self;\n    };\n\n    AstNode.prototype.append = function (node) {\n      var self = this;\n\n      if (node.parent) {\n        node.remove();\n      }\n\n      var last = self.lastChild;\n\n      if (last) {\n        last.next = node;\n        node.prev = last;\n        self.lastChild = node;\n      } else {\n        self.lastChild = self.firstChild = node;\n      }\n\n      node.parent = self;\n      return node;\n    };\n\n    AstNode.prototype.insert = function (node, refNode, before) {\n      if (node.parent) {\n        node.remove();\n      }\n\n      var parent = refNode.parent || this;\n\n      if (before) {\n        if (refNode === parent.firstChild) {\n          parent.firstChild = node;\n        } else {\n          refNode.prev.next = node;\n        }\n\n        node.prev = refNode.prev;\n        node.next = refNode;\n        refNode.prev = node;\n      } else {\n        if (refNode === parent.lastChild) {\n          parent.lastChild = node;\n        } else {\n          refNode.next.prev = node;\n        }\n\n        node.next = refNode.next;\n        node.prev = refNode;\n        refNode.next = node;\n      }\n\n      node.parent = parent;\n      return node;\n    };\n\n    AstNode.prototype.getAll = function (name) {\n      var self = this;\n      var collection = [];\n\n      for (var node = self.firstChild; node; node = walk$1(node, self)) {\n        if (node.name === name) {\n          collection.push(node);\n        }\n      }\n\n      return collection;\n    };\n\n    AstNode.prototype.children = function () {\n      var self = this;\n      var collection = [];\n\n      for (var node = self.firstChild; node; node = node.next) {\n        collection.push(node);\n      }\n\n      return collection;\n    };\n\n    AstNode.prototype.empty = function () {\n      var self = this;\n\n      if (self.firstChild) {\n        var nodes = [];\n\n        for (var node = self.firstChild; node; node = walk$1(node, self)) {\n          nodes.push(node);\n        }\n\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n        }\n      }\n\n      self.firstChild = self.lastChild = null;\n      return self;\n    };\n\n    AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n      if (whitespace === void 0) {\n        whitespace = {};\n      }\n\n      var self = this;\n      var node = self.firstChild;\n\n      if (isNonEmptyElement(self)) {\n        return false;\n      }\n\n      if (node) {\n        do {\n          if (node.type === 1) {\n            if (node.attr('data-mce-bogus')) {\n              continue;\n            }\n\n            if (elements[node.name]) {\n              return false;\n            }\n\n            if (isNonEmptyElement(node)) {\n              return false;\n            }\n          }\n\n          if (node.type === 8) {\n            return false;\n          }\n\n          if (node.type === 3 && !isEmptyTextNode(node)) {\n            return false;\n          }\n\n          if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n            return false;\n          }\n\n          if (predicate && predicate(node)) {\n            return false;\n          }\n        } while (node = walk$1(node, self));\n      }\n\n      return true;\n    };\n\n    AstNode.prototype.walk = function (prev) {\n      return walk$1(this, null, prev);\n    };\n\n    return AstNode;\n  }();\n\n  var extractBase64DataUris = function (html) {\n    var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=\\s]+)/gi;\n    var chunks = [];\n    var uris = {};\n    var prefix = generate('img');\n    var matches;\n    var index = 0;\n    var count = 0;\n\n    while (matches = dataImageUri.exec(html)) {\n      var uri = matches[0];\n      var imageId = prefix + '_' + count++;\n      uris[imageId] = uri;\n\n      if (index < matches.index) {\n        chunks.push(html.substr(index, matches.index - index));\n      }\n\n      chunks.push(imageId);\n      index = matches.index + uri.length;\n    }\n\n    var re = new RegExp(prefix + '_[0-9]+', 'g');\n\n    if (index === 0) {\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: html,\n        re: re\n      };\n    } else {\n      if (index < html.length) {\n        chunks.push(html.substr(index));\n      }\n\n      return {\n        prefix: prefix,\n        uris: uris,\n        html: chunks.join(''),\n        re: re\n      };\n    }\n  };\n\n  var restoreDataUris = function (html, result) {\n    return html.replace(result.re, function (imageId) {\n      return get$9(result.uris, imageId).getOr(imageId);\n    });\n  };\n\n  var parseDataUri$1 = function (uri) {\n    var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=\\s]+)/i.exec(uri);\n\n    if (matches) {\n      return Optional.some({\n        type: matches[1],\n        data: decodeURIComponent(matches[2])\n      });\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var each$d = Tools.each,\n      trim = Tools.trim;\n  var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n  var DEFAULT_PORTS = {\n    ftp: 21,\n    http: 80,\n    https: 443,\n    mailto: 25\n  };\n  var safeSvgDataUrlElements = ['img', 'video'];\n\n  var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n    if (isNonNullable(allowSvgDataUrls)) {\n      return !allowSvgDataUrls;\n    } else {\n      return isNonNullable(tagName) ? !contains$3(safeSvgDataUrlElements, tagName) : true;\n    }\n  };\n\n  var isInvalidUri = function (settings, uri, tagName) {\n    if (settings.allow_html_data_urls) {\n      return false;\n    } else if (/^data:image\\//i.test(uri)) {\n      return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n    } else {\n      return /^data:/i.test(uri);\n    }\n  };\n\n  var URI = function () {\n    function URI(url, settings) {\n      url = trim(url);\n      this.settings = settings || {};\n      var baseUri = this.settings.base_uri;\n      var self = this;\n\n      if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n        self.source = url;\n        return;\n      }\n\n      var isProtocolRelative = url.indexOf('//') === 0;\n\n      if (url.indexOf('/') === 0 && !isProtocolRelative) {\n        url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n      }\n\n      if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n        var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n\n        if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n          url = '//mce_host' + self.toAbsPath(baseUrl, url);\n        } else {\n          var match = /([^#?]*)([#?]?.*)/.exec(url);\n          url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n        }\n      }\n\n      url = url.replace(/@@/g, '(mce_at)');\n      var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n      each$d(queryParts, function (v, i) {\n        var part = urlMatch[i];\n\n        if (part) {\n          part = part.replace(/\\(mce_at\\)/g, '@@');\n        }\n\n        self[v] = part;\n      });\n\n      if (baseUri) {\n        if (!self.protocol) {\n          self.protocol = baseUri.protocol;\n        }\n\n        if (!self.userInfo) {\n          self.userInfo = baseUri.userInfo;\n        }\n\n        if (!self.port && self.host === 'mce_host') {\n          self.port = baseUri.port;\n        }\n\n        if (!self.host || self.host === 'mce_host') {\n          self.host = baseUri.host;\n        }\n\n        self.source = '';\n      }\n\n      if (isProtocolRelative) {\n        self.protocol = '';\n      }\n    }\n\n    URI.parseDataUri = function (uri) {\n      var type;\n      var uriComponents = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriComponents[0]);\n\n      if (matches) {\n        type = matches[1];\n      }\n\n      return {\n        type: type,\n        data: uriComponents[1]\n      };\n    };\n\n    URI.isDomSafe = function (uri, context, options) {\n      if (options === void 0) {\n        options = {};\n      }\n\n      if (options.allow_script_urls) {\n        return true;\n      } else {\n        var decodedUri = Entities.decode(uri).replace(/[\\s\\u0000-\\u001F]+/g, '');\n\n        try {\n          decodedUri = decodeURIComponent(decodedUri);\n        } catch (ex) {\n          decodedUri = unescape(decodedUri);\n        }\n\n        if (/((java|vb)script|mhtml):/i.test(decodedUri)) {\n          return false;\n        }\n\n        return !isInvalidUri(options, decodedUri, context);\n      }\n    };\n\n    URI.getDocumentBaseUrl = function (loc) {\n      var baseUrl;\n\n      if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n        baseUrl = loc.href;\n      } else {\n        baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n      }\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n        baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(baseUrl)) {\n          baseUrl += '/';\n        }\n      }\n\n      return baseUrl;\n    };\n\n    URI.prototype.setPath = function (path) {\n      var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n      this.path = pathMatch[0];\n      this.directory = pathMatch[1];\n      this.file = pathMatch[2];\n      this.source = '';\n      this.getURI();\n    };\n\n    URI.prototype.toRelative = function (uri) {\n      var output;\n\n      if (uri === './') {\n        return uri;\n      }\n\n      var relativeUri = new URI(uri, {\n        base_uri: this\n      });\n\n      if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n        return relativeUri.getURI();\n      }\n\n      var tu = this.getURI(),\n          uu = relativeUri.getURI();\n\n      if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n        return tu;\n      }\n\n      output = this.toRelPath(this.path, relativeUri.path);\n\n      if (relativeUri.query) {\n        output += '?' + relativeUri.query;\n      }\n\n      if (relativeUri.anchor) {\n        output += '#' + relativeUri.anchor;\n      }\n\n      return output;\n    };\n\n    URI.prototype.toAbsolute = function (uri, noHost) {\n      var absoluteUri = new URI(uri, {\n        base_uri: this\n      });\n      return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n    };\n\n    URI.prototype.isSameOrigin = function (uri) {\n      if (this.host == uri.host && this.protocol == uri.protocol) {\n        if (this.port == uri.port) {\n          return true;\n        }\n\n        var defaultPort = DEFAULT_PORTS[this.protocol];\n\n        if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n          return true;\n        }\n      }\n\n      return false;\n    };\n\n    URI.prototype.toRelPath = function (base, path) {\n      var breakPoint = 0,\n          out = '',\n          i,\n          l;\n      var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n      var items = path.split('/');\n\n      if (normalizedBase.length >= items.length) {\n        for (i = 0, l = normalizedBase.length; i < l; i++) {\n          if (i >= items.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (normalizedBase.length < items.length) {\n        for (i = 0, l = items.length; i < l; i++) {\n          if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n            breakPoint = i + 1;\n            break;\n          }\n        }\n      }\n\n      if (breakPoint === 1) {\n        return path;\n      }\n\n      for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n        out += '../';\n      }\n\n      for (i = breakPoint - 1, l = items.length; i < l; i++) {\n        if (i !== breakPoint - 1) {\n          out += '/' + items[i];\n        } else {\n          out += items[i];\n        }\n      }\n\n      return out;\n    };\n\n    URI.prototype.toAbsPath = function (base, path) {\n      var i,\n          nb = 0,\n          o = [],\n          outPath;\n      var tr = /\\/$/.test(path) ? '/' : '';\n      var normalizedBase = base.split('/');\n      var normalizedPath = path.split('/');\n      each$d(normalizedBase, function (k) {\n        if (k) {\n          o.push(k);\n        }\n      });\n      normalizedBase = o;\n\n      for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n        if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n          continue;\n        }\n\n        if (normalizedPath[i] === '..') {\n          nb++;\n          continue;\n        }\n\n        if (nb > 0) {\n          nb--;\n          continue;\n        }\n\n        o.push(normalizedPath[i]);\n      }\n\n      i = normalizedBase.length - nb;\n\n      if (i <= 0) {\n        outPath = reverse(o).join('/');\n      } else {\n        outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n      }\n\n      if (outPath.indexOf('/') !== 0) {\n        outPath = '/' + outPath;\n      }\n\n      if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n        outPath += tr;\n      }\n\n      return outPath;\n    };\n\n    URI.prototype.getURI = function (noProtoHost) {\n      if (noProtoHost === void 0) {\n        noProtoHost = false;\n      }\n\n      var s;\n\n      if (!this.source || noProtoHost) {\n        s = '';\n\n        if (!noProtoHost) {\n          if (this.protocol) {\n            s += this.protocol + '://';\n          } else {\n            s += '//';\n          }\n\n          if (this.userInfo) {\n            s += this.userInfo + '@';\n          }\n\n          if (this.host) {\n            s += this.host;\n          }\n\n          if (this.port) {\n            s += ':' + this.port;\n          }\n        }\n\n        if (this.path) {\n          s += this.path;\n        }\n\n        if (this.query) {\n          s += '?' + this.query;\n        }\n\n        if (this.anchor) {\n          s += '#' + this.anchor;\n        }\n\n        this.source = s;\n      }\n\n      return this.source;\n    };\n\n    return URI;\n  }();\n\n  var filteredClobberElements = Tools.makeMap('button,fieldset,form,iframe,img,image,input,object,output,select,textarea');\n\n  var isValidPrefixAttrName = function (name) {\n    return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n  };\n\n  var findMatchingEndTagIndex = function (schema, html, startIndex) {\n    var startTagRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)/g;\n    var endTagRegExp = /(?:\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n    var shortEndedElements = schema.getShortEndedElements();\n    var count = 1,\n        index = startIndex;\n\n    while (count !== 0) {\n      startTagRegExp.lastIndex = index;\n\n      while (true) {\n        var startMatch = startTagRegExp.exec(html);\n\n        if (startMatch === null) {\n          return index;\n        } else if (startMatch[1] === '!') {\n          if (startsWith(startMatch[2], '--')) {\n            index = findCommentEndIndex(html, false, startMatch.index + '!--'.length);\n          } else {\n            index = findCommentEndIndex(html, true, startMatch.index + 1);\n          }\n\n          break;\n        } else {\n          endTagRegExp.lastIndex = startTagRegExp.lastIndex;\n          var endMatch = endTagRegExp.exec(html);\n\n          if (isNull(endMatch) || endMatch.index !== startTagRegExp.lastIndex) {\n            continue;\n          }\n\n          if (startMatch[1] === '/') {\n            count -= 1;\n          } else if (!has$2(shortEndedElements, startMatch[2])) {\n            count += 1;\n          }\n\n          index = startTagRegExp.lastIndex + endMatch[0].length;\n          break;\n        }\n      }\n    }\n\n    return index;\n  };\n\n  var isConditionalComment = function (html, startIndex) {\n    return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n  };\n\n  var findCommentEndIndex = function (html, isBogus, startIndex) {\n    if (startIndex === void 0) {\n      startIndex = 0;\n    }\n\n    var lcHtml = html.toLowerCase();\n\n    if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n      var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n      return lcHtml.indexOf('>', endIfIndex);\n    } else {\n      if (isBogus) {\n        var endIndex = lcHtml.indexOf('>', startIndex);\n        return endIndex !== -1 ? endIndex : lcHtml.length;\n      } else {\n        var endCommentRegexp = /--!?>/g;\n        endCommentRegexp.lastIndex = startIndex;\n        var match = endCommentRegexp.exec(html);\n        return match ? match.index + match[0].length : lcHtml.length;\n      }\n    }\n  };\n\n  var checkBogusAttribute = function (regExp, attrString) {\n    var matches = regExp.exec(attrString);\n\n    if (matches) {\n      var name_1 = matches[1];\n      var value = matches[2];\n      return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n    } else {\n      return null;\n    }\n  };\n\n  var SaxParser = function (settings, schema) {\n    var _a;\n\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    settings = settings || {};\n    var doc = (_a = settings.document) !== null && _a !== void 0 ? _a : document;\n    var form = doc.createElement('form');\n\n    if (settings.fix_self_closing !== false) {\n      settings.fix_self_closing = true;\n    }\n\n    var comment = settings.comment ? settings.comment : noop;\n    var cdata = settings.cdata ? settings.cdata : noop;\n    var text = settings.text ? settings.text : noop;\n    var start = settings.start ? settings.start : noop;\n    var end = settings.end ? settings.end : noop;\n    var pi = settings.pi ? settings.pi : noop;\n    var doctype = settings.doctype ? settings.doctype : noop;\n\n    var parseInternal = function (base64Extract, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      var html = base64Extract.html;\n      var matches,\n          index = 0,\n          value,\n          endRegExp;\n      var stack = [];\n      var attrList, i, textData, name;\n      var isInternalElement, isShortEnded;\n      var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n      var attributesRequired, attributesDefault, attributesForced;\n      var anyAttributesRequired,\n          attrValue,\n          idCount = 0;\n      var decode = Entities.decode;\n      var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n      var parsingMode = format === 'html' ? 0 : 1;\n\n      var processEndTag = function (name) {\n        var pos, i;\n        pos = stack.length;\n\n        while (pos--) {\n          if (stack[pos].name === name) {\n            break;\n          }\n        }\n\n        if (pos >= 0) {\n          for (i = stack.length - 1; i >= pos; i--) {\n            name = stack[i];\n\n            if (name.valid) {\n              end(name.name);\n            }\n          }\n\n          stack.length = pos;\n        }\n      };\n\n      var processText = function (value, raw) {\n        return text(restoreDataUris(value, base64Extract), raw);\n      };\n\n      var processComment = function (value) {\n        if (value === '') {\n          return;\n        }\n\n        if (value.charAt(0) === '>') {\n          value = ' ' + value;\n        }\n\n        if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n          value = ' ' + value;\n        }\n\n        comment(restoreDataUris(value, base64Extract));\n      };\n\n      var processAttr = function (value) {\n        return restoreDataUris(value, base64Extract);\n      };\n\n      var processMalformedComment = function (value, startIndex) {\n        var startTag = value || '';\n        var isBogus = !startsWith(startTag, '--');\n        var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n        value = html.substr(startIndex, endIndex - startIndex);\n        processComment(isBogus ? startTag + value : value);\n        return endIndex + 1;\n      };\n\n      var parseAttribute = function (tagName, name, value, val2, val3) {\n        name = name.toLowerCase();\n        value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n\n        if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n          var attrRule = validAttributesMap[name];\n\n          if (!attrRule && validAttributePatterns) {\n            var i_1 = validAttributePatterns.length;\n\n            while (i_1--) {\n              attrRule = validAttributePatterns[i_1];\n\n              if (attrRule.pattern.test(name)) {\n                break;\n              }\n            }\n\n            if (i_1 === -1) {\n              attrRule = null;\n            }\n          }\n\n          if (!attrRule) {\n            return;\n          }\n\n          if (attrRule.validValues && !(value in attrRule.validValues)) {\n            return;\n          }\n        }\n\n        var isNameOrId = name === 'name' || name === 'id';\n\n        if (isNameOrId && tagName in filteredClobberElements && (value in doc || value in form)) {\n          return;\n        }\n\n        if (filteredUrlAttrs[name] && !URI.isDomSafe(value, tagName, settings)) {\n          return;\n        }\n\n        if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n          return;\n        }\n\n        attrList.map[name] = value;\n        attrList.push({\n          name: name,\n          value: value\n        });\n      };\n\n      var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n      var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n      var shortEndedElements = schema.getShortEndedElements();\n      var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n      var fillAttrsMap = schema.getBoolAttrs();\n      var validate = settings.validate;\n      var removeInternalElements = settings.remove_internals;\n      var fixSelfClosing = settings.fix_self_closing;\n      var specialElements = schema.getSpecialElements();\n      var processHtml = html + '>';\n\n      while (matches = tokenRegExp.exec(processHtml)) {\n        var matchText = matches[0];\n\n        if (index < matches.index) {\n          processText(decode(html.substr(index, matches.index - index)));\n        }\n\n        if (value = matches[7]) {\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          processEndTag(value);\n        } else if (value = matches[8]) {\n          if (matches.index + matchText.length > html.length) {\n            processText(decode(html.substr(matches.index)));\n            index = matches.index + matchText.length;\n            continue;\n          }\n\n          value = value.toLowerCase();\n\n          if (value.charAt(0) === ':') {\n            value = value.substr(1);\n          }\n\n          isShortEnded = value in shortEndedElements;\n\n          if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n            processEndTag(value);\n          }\n\n          var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n\n          if (bogusValue !== null) {\n            if (bogusValue === 'all') {\n              index = findMatchingEndTagIndex(schema, html, tokenRegExp.lastIndex);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n\n            isValidElement = false;\n          }\n\n          if (!validate || (elementRule = schema.getElementRule(value))) {\n            isValidElement = true;\n\n            if (validate) {\n              validAttributesMap = elementRule.attributes;\n              validAttributePatterns = elementRule.attributePatterns;\n            }\n\n            if (attribsValue = matches[9]) {\n              isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n\n              if (isInternalElement && removeInternalElements) {\n                isValidElement = false;\n              }\n\n              attrList = [];\n              attrList.map = {};\n              attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                parseAttribute(value, name, val, val2, val3);\n                return '';\n              });\n            } else {\n              attrList = [];\n              attrList.map = {};\n            }\n\n            if (validate && !isInternalElement) {\n              attributesRequired = elementRule.attributesRequired;\n              attributesDefault = elementRule.attributesDefault;\n              attributesForced = elementRule.attributesForced;\n              anyAttributesRequired = elementRule.removeEmptyAttrs;\n\n              if (anyAttributesRequired && !attrList.length) {\n                isValidElement = false;\n              }\n\n              if (attributesForced) {\n                i = attributesForced.length;\n\n                while (i--) {\n                  attr = attributesForced[i];\n                  name = attr.name;\n                  attrValue = attr.value;\n\n                  if (attrValue === '{$uid}') {\n                    attrValue = 'mce_' + idCount++;\n                  }\n\n                  attrList.map[name] = attrValue;\n                  attrList.push({\n                    name: name,\n                    value: attrValue\n                  });\n                }\n              }\n\n              if (attributesDefault) {\n                i = attributesDefault.length;\n\n                while (i--) {\n                  attr = attributesDefault[i];\n                  name = attr.name;\n\n                  if (!(name in attrList.map)) {\n                    attrValue = attr.value;\n\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n              }\n\n              if (attributesRequired) {\n                i = attributesRequired.length;\n\n                while (i--) {\n                  if (attributesRequired[i] in attrList.map) {\n                    break;\n                  }\n                }\n\n                if (i === -1) {\n                  isValidElement = false;\n                }\n              }\n\n              if (attr = attrList.map['data-mce-bogus']) {\n                if (attr === 'all') {\n                  index = findMatchingEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                  tokenRegExp.lastIndex = index;\n                  continue;\n                }\n\n                isValidElement = false;\n              }\n            }\n\n            if (isValidElement) {\n              start(value, attrList, isShortEnded);\n            }\n          } else {\n            isValidElement = false;\n          }\n\n          if (endRegExp = specialElements[value]) {\n            endRegExp.lastIndex = index = matches.index + matchText.length;\n\n            if (matches = endRegExp.exec(html)) {\n              if (isValidElement) {\n                textData = html.substr(index, matches.index - index);\n              }\n\n              index = matches.index + matches[0].length;\n            } else {\n              textData = html.substr(index);\n              index = html.length;\n            }\n\n            if (isValidElement) {\n              if (textData.length > 0) {\n                processText(textData, true);\n              }\n\n              end(value);\n            }\n\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n\n          if (!isShortEnded) {\n            if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n              stack.push({\n                name: value,\n                valid: isValidElement\n              });\n            } else if (isValidElement) {\n              end(value);\n            }\n          }\n        } else if (value = matches[1]) {\n          processComment(value);\n        } else if (value = matches[2]) {\n          var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n\n          if (isValidCdataSection) {\n            cdata(value);\n          } else {\n            index = processMalformedComment('', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        } else if (value = matches[3]) {\n          doctype(value);\n        } else if ((value = matches[4]) || matchText === '<!') {\n          index = processMalformedComment(value, matches.index + matchText.length);\n          tokenRegExp.lastIndex = index;\n          continue;\n        } else if (value = matches[5]) {\n          if (parsingMode === 1) {\n            pi(value, matches[6]);\n          } else {\n            index = processMalformedComment('?', matches.index + 2);\n            tokenRegExp.lastIndex = index;\n            continue;\n          }\n        }\n\n        index = matches.index + matchText.length;\n      }\n\n      if (index < html.length) {\n        processText(decode(html.substr(index)));\n      }\n\n      for (i = stack.length - 1; i >= 0; i--) {\n        value = stack[i];\n\n        if (value.valid) {\n          end(value.name);\n        }\n      }\n    };\n\n    var parse = function (html, format) {\n      if (format === void 0) {\n        format = 'html';\n      }\n\n      parseInternal(extractBase64DataUris(html), format);\n    };\n\n    return {\n      parse: parse\n    };\n  };\n\n  SaxParser.findEndTag = findMatchingEndTagIndex;\n\n  var trimHtml = function (tempAttrs, html) {\n    var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n    return html.replace(trimContentRegExp, '');\n  };\n\n  var trimInternal = function (serializer, html) {\n    var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n    var schema = serializer.schema;\n    var content = trimHtml(serializer.getTempAttrs(), html);\n    var shortEndedElements = schema.getShortEndedElements();\n    var matches;\n\n    while (matches = bogusAllRegExp.exec(content)) {\n      var index = bogusAllRegExp.lastIndex;\n      var matchLength = matches[0].length;\n      var endTagIndex = void 0;\n\n      if (shortEndedElements[matches[1]]) {\n        endTagIndex = index;\n      } else {\n        endTagIndex = SaxParser.findEndTag(schema, content, index);\n      }\n\n      content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n      bogusAllRegExp.lastIndex = index - matchLength;\n    }\n\n    return trim$2(content);\n  };\n\n  var trimExternal = trimInternal;\n\n  var trimEmptyContents = function (editor, html) {\n    var blockName = getForcedRootBlock(editor);\n    var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n    return html.replace(emptyRegExp, '');\n  };\n\n  var setupArgs$3 = function (args, format) {\n    return __assign(__assign({}, args), {\n      format: format,\n      get: true,\n      getInner: true\n    });\n  };\n\n  var getContentFromBody = function (editor, args, format, body) {\n    var defaultedArgs = setupArgs$3(args, format);\n    var updatedArgs = args.no_events ? defaultedArgs : editor.fire('BeforeGetContent', defaultedArgs);\n    var content;\n\n    if (updatedArgs.format === 'raw') {\n      content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n    } else if (updatedArgs.format === 'text') {\n      content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n    } else if (updatedArgs.format === 'tree') {\n      content = editor.serializer.serialize(body, updatedArgs);\n    } else {\n      content = trimEmptyContents(editor, editor.serializer.serialize(body, updatedArgs));\n    }\n\n    if (!contains$3(['text', 'tree'], updatedArgs.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n      updatedArgs.content = Tools.trim(content);\n    } else {\n      updatedArgs.content = content;\n    }\n\n    if (updatedArgs.no_events) {\n      return updatedArgs.content;\n    } else {\n      return editor.fire('GetContent', updatedArgs).content;\n    }\n  };\n\n  var getContentInternal = function (editor, args, format) {\n    return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n      return getContentFromBody(editor, args, format, body);\n    });\n  };\n\n  var each$c = Tools.each;\n\n  var ElementUtils = function (dom) {\n    var compare = function (node1, node2) {\n      if (node1.nodeName !== node2.nodeName) {\n        return false;\n      }\n\n      var getAttribs = function (node) {\n        var attribs = {};\n        each$c(dom.getAttribs(node), function (attr) {\n          var name = attr.nodeName.toLowerCase();\n\n          if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n            attribs[name] = dom.getAttrib(node, name);\n          }\n        });\n        return attribs;\n      };\n\n      var compareObjects = function (obj1, obj2) {\n        var value, name;\n\n        for (name in obj1) {\n          if (has$2(obj1, name)) {\n            value = obj2[name];\n\n            if (typeof value === 'undefined') {\n              return false;\n            }\n\n            if (obj1[name] !== value) {\n              return false;\n            }\n\n            delete obj2[name];\n          }\n        }\n\n        for (name in obj2) {\n          if (has$2(obj2, name)) {\n            return false;\n          }\n        }\n\n        return true;\n      };\n\n      if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n        return false;\n      }\n\n      if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n        return false;\n      }\n\n      return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n    };\n\n    return {\n      compare: compare\n    };\n  };\n\n  var makeMap$1 = Tools.makeMap;\n\n  var Writer = function (settings) {\n    var html = [];\n    settings = settings || {};\n    var indent = settings.indent;\n    var indentBefore = makeMap$1(settings.indent_before || '');\n    var indentAfter = makeMap$1(settings.indent_after || '');\n    var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n    var htmlOutput = settings.element_format === 'html';\n    return {\n      start: function (name, attrs, empty) {\n        var i, l, attr, value;\n\n        if (indent && indentBefore[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n\n        html.push('<', name);\n\n        if (attrs) {\n          for (i = 0, l = attrs.length; i < l; i++) {\n            attr = attrs[i];\n            html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n          }\n        }\n\n        if (!empty || htmlOutput) {\n          html[html.length] = '>';\n        } else {\n          html[html.length] = ' />';\n        }\n\n        if (empty && indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      end: function (name) {\n        var value;\n        html.push('</', name, '>');\n\n        if (indent && indentAfter[name] && html.length > 0) {\n          value = html[html.length - 1];\n\n          if (value.length > 0 && value !== '\\n') {\n            html.push('\\n');\n          }\n        }\n      },\n      text: function (text, raw) {\n        if (text.length > 0) {\n          html[html.length] = raw ? text : encode(text);\n        }\n      },\n      cdata: function (text) {\n        html.push('<![CDATA[', text, ']]>');\n      },\n      comment: function (text) {\n        html.push('<!--', text, '-->');\n      },\n      pi: function (name, text) {\n        if (text) {\n          html.push('<?', name, ' ', encode(text), '?>');\n        } else {\n          html.push('<?', name, '?>');\n        }\n\n        if (indent) {\n          html.push('\\n');\n        }\n      },\n      doctype: function (text) {\n        html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n      },\n      reset: function () {\n        html.length = 0;\n      },\n      getContent: function () {\n        return html.join('').replace(/\\n$/, '');\n      }\n    };\n  };\n\n  var HtmlSerializer = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var writer = Writer(settings);\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n\n    var serialize = function (node) {\n      var validate = settings.validate;\n      var handlers = {\n        3: function (node) {\n          writer.text(node.value, node.raw);\n        },\n        8: function (node) {\n          writer.comment(node.value);\n        },\n        7: function (node) {\n          writer.pi(node.name, node.value);\n        },\n        10: function (node) {\n          writer.doctype(node.value);\n        },\n        4: function (node) {\n          writer.cdata(node.value);\n        },\n        11: function (node) {\n          if (node = node.firstChild) {\n            do {\n              walk(node);\n            } while (node = node.next);\n          }\n        }\n      };\n      writer.reset();\n\n      var walk = function (node) {\n        var handler = handlers[node.type];\n\n        if (!handler) {\n          var name_1 = node.name;\n          var isEmpty = node.shortEnded;\n          var attrs = node.attributes;\n\n          if (validate && attrs && attrs.length > 1) {\n            var sortedAttrs = [];\n            sortedAttrs.map = {};\n            var elementRule = schema.getElementRule(node.name);\n\n            if (elementRule) {\n              for (var i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                var attrName = elementRule.attributesOrder[i];\n\n                if (attrName in attrs.map) {\n                  var attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              for (var i = 0, l = attrs.length; i < l; i++) {\n                var attrName = attrs[i].name;\n\n                if (!(attrName in sortedAttrs.map)) {\n                  var attrValue = attrs.map[attrName];\n                  sortedAttrs.map[attrName] = attrValue;\n                  sortedAttrs.push({\n                    name: attrName,\n                    value: attrValue\n                  });\n                }\n              }\n\n              attrs = sortedAttrs;\n            }\n          }\n\n          writer.start(node.name, attrs, isEmpty);\n\n          if (!isEmpty) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n\n            writer.end(name_1);\n          }\n        } else {\n          handler(node);\n        }\n      };\n\n      if (node.type === 1 && !settings.inner) {\n        walk(node);\n      } else {\n        handlers[11](node);\n      }\n\n      return writer.getContent();\n    };\n\n    return {\n      serialize: serialize\n    };\n  };\n\n  var nonInheritableStyles = new Set();\n\n  (function () {\n    var nonInheritableStylesArr = ['margin', 'margin-left', 'margin-right', 'margin-top', 'margin-bottom', 'padding', 'padding-left', 'padding-right', 'padding-top', 'padding-bottom', 'border', 'border-width', 'border-style', 'border-color', 'background', 'background-attachment', 'background-clip', 'background-color', 'background-image', 'background-origin', 'background-position', 'background-repeat', 'background-size', 'float', 'position', 'left', 'right', 'top', 'bottom', 'z-index', 'display', 'transform', 'width', 'max-width', 'min-width', 'height', 'max-height', 'min-height', 'overflow', 'overflow-x', 'overflow-y', 'text-overflow', 'vertical-align', 'transition', 'transition-delay', 'transition-duration', 'transition-property', 'transition-timing-function'];\n    each$k(nonInheritableStylesArr, function (style) {\n      nonInheritableStyles.add(style);\n    });\n  })();\n\n  var shorthandStyleProps = ['font', 'text-decoration', 'text-emphasis'];\n\n  var getStyleProps = function (dom, node) {\n    return keys(dom.parseStyle(dom.getAttrib(node, 'style')));\n  };\n\n  var isNonInheritableStyle = function (style) {\n    return nonInheritableStyles.has(style);\n  };\n\n  var hasInheritableStyles = function (dom, node) {\n    return forall(getStyleProps(dom, node), function (style) {\n      return !isNonInheritableStyle(style);\n    });\n  };\n\n  var getLonghandStyleProps = function (styles) {\n    return filter$4(styles, function (style) {\n      return exists(shorthandStyleProps, function (prop) {\n        return startsWith(style, prop);\n      });\n    });\n  };\n\n  var hasStyleConflict = function (dom, node, parentNode) {\n    var nodeStyleProps = getStyleProps(dom, node);\n    var parentNodeStyleProps = getStyleProps(dom, parentNode);\n\n    var valueMismatch = function (prop) {\n      var nodeValue = dom.getStyle(node, prop);\n      var parentValue = dom.getStyle(parentNode, prop);\n      return isNotEmpty(nodeValue) && isNotEmpty(parentValue) && nodeValue !== parentValue;\n    };\n\n    return exists(nodeStyleProps, function (nodeStyleProp) {\n      var propExists = function (props) {\n        return exists(props, function (prop) {\n          return prop === nodeStyleProp;\n        });\n      };\n\n      if (!propExists(parentNodeStyleProps) && propExists(shorthandStyleProps)) {\n        var longhandProps = getLonghandStyleProps(parentNodeStyleProps);\n        return exists(longhandProps, valueMismatch);\n      } else {\n        return valueMismatch(nodeStyleProp);\n      }\n    });\n  };\n\n  var isChar = function (forward, predicate, pos) {\n    return Optional.from(pos.container()).filter(isText$7).exists(function (text) {\n      var delta = forward ? 0 : -1;\n      return predicate(text.data.charAt(pos.offset() + delta));\n    });\n  };\n\n  var isBeforeSpace = curry(isChar, true, isWhiteSpace);\n  var isAfterSpace = curry(isChar, false, isWhiteSpace);\n\n  var isEmptyText = function (pos) {\n    var container = pos.container();\n    return isText$7(container) && (container.data.length === 0 || isZwsp(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n  };\n\n  var matchesElementPosition = function (before, predicate) {\n    return function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n    };\n  };\n\n  var isImageBlock = function (node) {\n    return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n  };\n\n  var isCefNode = function (node) {\n    return isContentEditableFalse$b(node) && !isBogusAll$1(node);\n  };\n\n  var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n  var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n  var isBeforeMedia = matchesElementPosition(true, isMedia$2);\n  var isAfterMedia = matchesElementPosition(false, isMedia$2);\n  var isBeforeTable = matchesElementPosition(true, isTable$3);\n  var isAfterTable = matchesElementPosition(false, isTable$3);\n  var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n  var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n  var getLastChildren = function (elm) {\n    var children = [];\n    var rawNode = elm.dom;\n\n    while (rawNode) {\n      children.push(SugarElement.fromDom(rawNode));\n      rawNode = rawNode.lastChild;\n    }\n\n    return children;\n  };\n\n  var removeTrailingBr = function (elm) {\n    var allBrs = descendants(elm, 'br');\n    var brs = filter$4(getLastChildren(elm).slice(-1), isBr$4);\n\n    if (allBrs.length === brs.length) {\n      each$k(brs, remove$7);\n    }\n  };\n\n  var fillWithPaddingBr = function (elm) {\n    empty(elm);\n    append$1(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n  };\n\n  var trimBlockTrailingBr = function (elm) {\n    lastChild(elm).each(function (lastChild) {\n      prevSibling(lastChild).each(function (lastChildPrevSibling) {\n        if (isBlock$2(elm) && isBr$4(lastChild) && isBlock$2(lastChildPrevSibling)) {\n          remove$7(lastChild);\n        }\n      });\n    });\n  };\n\n  var dropLast = function (xs) {\n    return xs.slice(0, -1);\n  };\n\n  var parentsUntil = function (start, root, predicate) {\n    if (contains$1(root, start)) {\n      return dropLast(parents$1(start, function (elm) {\n        return predicate(elm) || eq(elm, root);\n      }));\n    } else {\n      return [];\n    }\n  };\n\n  var parents = function (start, root) {\n    return parentsUntil(start, root, never);\n  };\n\n  var parentsAndSelf = function (start, root) {\n    return [start].concat(parents(start, root));\n  };\n\n  var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n    return navigateIgnore(forward, root, from, isEmptyText);\n  };\n\n  var getClosestBlock$1 = function (root, pos) {\n    return find$3(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n  };\n\n  var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n    return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n      return getClosestBlock$1(root, pos).fold(function () {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      }, function (fromBlock) {\n        return isInSameBlock(newPos, pos, root.dom) === false && contains$1(fromBlock, SugarElement.fromDom(newPos.container()));\n      });\n    });\n  };\n\n  var isAtBlockBoundary = function (forward, root, pos) {\n    return getClosestBlock$1(root, pos).fold(function () {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return isInSameBlock(newPos, pos, root.dom) === false;\n      });\n    }, function (parent) {\n      return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n    });\n  };\n\n  var isAtStartOfBlock = curry(isAtBlockBoundary, false);\n  var isAtEndOfBlock = curry(isAtBlockBoundary, true);\n  var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n  var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n  var isBr = function (pos) {\n    return getElementFromPosition(pos).exists(isBr$4);\n  };\n\n  var findBr = function (forward, root, pos) {\n    var parentBlocks = filter$4(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n    var scope = head(parentBlocks).getOr(root);\n    return fromPosition(forward, scope.dom, pos).filter(isBr);\n  };\n\n  var isBeforeBr$1 = function (root, pos) {\n    return getElementFromPosition(pos).exists(isBr$4) || findBr(true, root, pos).isSome();\n  };\n\n  var isAfterBr = function (root, pos) {\n    return getElementFromPrevPosition(pos).exists(isBr$4) || findBr(false, root, pos).isSome();\n  };\n\n  var findPreviousBr = curry(findBr, false);\n  var findNextBr = curry(findBr, true);\n\n  var isInMiddleOfText = function (pos) {\n    return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n  };\n\n  var getClosestBlock = function (root, pos) {\n    var parentBlocks = filter$4(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n    return head(parentBlocks).getOr(root);\n  };\n\n  var hasSpaceBefore = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isAfterSpace(pos);\n    } else {\n      return isAfterSpace(pos) || prevPosition(getClosestBlock(root, pos).dom, pos).exists(isAfterSpace);\n    }\n  };\n\n  var hasSpaceAfter = function (root, pos) {\n    if (isInMiddleOfText(pos)) {\n      return isBeforeSpace(pos);\n    } else {\n      return isBeforeSpace(pos) || nextPosition(getClosestBlock(root, pos).dom, pos).exists(isBeforeSpace);\n    }\n  };\n\n  var isPreValue = function (value) {\n    return contains$3(['pre', 'pre-wrap'], value);\n  };\n\n  var isInPre = function (pos) {\n    return getElementFromPosition(pos).bind(function (elm) {\n      return closest$3(elm, isElement$6);\n    }).exists(function (elm) {\n      return isPreValue(get$5(elm, 'white-space'));\n    });\n  };\n\n  var isAtBeginningOfBody = function (root, pos) {\n    return prevPosition(root.dom, pos).isNone();\n  };\n\n  var isAtEndOfBody = function (root, pos) {\n    return nextPosition(root.dom, pos).isNone();\n  };\n\n  var isAtLineBoundary = function (root, pos) {\n    return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr$1(root, pos);\n  };\n\n  var needsToHaveNbsp = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbspLeft = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n    }\n  };\n\n  var leanRight = function (pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$7(container) && offset < container.data.length) {\n      return CaretPosition(container, offset + 1);\n    } else {\n      return pos;\n    }\n  };\n\n  var needsToBeNbspRight = function (root, pos) {\n    if (isInPre(pos)) {\n      return false;\n    } else {\n      return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr$1(root, pos) || hasSpaceAfter(root, pos);\n    }\n  };\n\n  var needsToBeNbsp = function (root, pos) {\n    return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n  };\n\n  var isNbspAt = function (text, offset) {\n    return isNbsp(text.charAt(offset));\n  };\n\n  var hasNbsp = function (pos) {\n    var container = pos.container();\n    return isText$7(container) && contains$2(container.data, nbsp);\n  };\n\n  var normalizeNbspMiddle = function (text) {\n    var chars = text.split('');\n    return map$3(chars, function (chr, i) {\n      if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent(chars[i - 1]) && isContent(chars[i + 1])) {\n        return ' ';\n      } else {\n        return chr;\n      }\n    }).join('');\n  };\n\n  var normalizeNbspAtStart = function (root, node) {\n    var text = node.data;\n    var firstPos = CaretPosition(node, 0);\n\n    if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n      node.data = ' ' + text.slice(1);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspInMiddleOfTextNode = function (node) {\n    var text = node.data;\n    var newText = normalizeNbspMiddle(text);\n\n    if (newText !== text) {\n      node.data = newText;\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbspAtEnd = function (root, node) {\n    var text = node.data;\n    var lastPos = CaretPosition(node, text.length - 1);\n\n    if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n      node.data = text.slice(0, -1) + ' ';\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var normalizeNbsps = function (root, pos) {\n    return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n      var container = pos.container();\n      var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n      return normalized ? Optional.some(pos) : Optional.none();\n    });\n  };\n\n  var normalizeNbspsInEditor = function (editor) {\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n    }\n  };\n\n  var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n    var result = foldl(content, function (acc, c) {\n      if (isWhiteSpace(c) || isNbsp(c)) {\n        if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + nbsp\n          };\n        } else {\n          return {\n            previousCharIsSpace: true,\n            str: acc.str + ' '\n          };\n        }\n      } else {\n        return {\n          previousCharIsSpace: false,\n          str: acc.str + c\n        };\n      }\n    }, {\n      previousCharIsSpace: false,\n      str: ''\n    });\n    return result.str;\n  };\n\n  var normalize$1 = function (node, offset, count) {\n    if (count === 0) {\n      return;\n    }\n\n    var elm = SugarElement.fromDom(node);\n    var root = ancestor$3(elm, isBlock$2).getOr(elm);\n    var whitespace = node.data.slice(offset, offset + count);\n    var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n    var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n    node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n  };\n\n  var normalizeWhitespaceAfter = function (node, offset) {\n    var content = node.data.slice(offset);\n    var whitespaceCount = content.length - lTrim(content).length;\n    normalize$1(node, offset, whitespaceCount);\n  };\n\n  var normalizeWhitespaceBefore = function (node, offset) {\n    var content = node.data.slice(0, offset);\n    var whitespaceCount = content.length - rTrim(content).length;\n    normalize$1(node, offset - whitespaceCount, whitespaceCount);\n  };\n\n  var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n    if (mergeToPrev === void 0) {\n      mergeToPrev = true;\n    }\n\n    var whitespaceOffset = rTrim(prevNode.data).length;\n    var newNode = mergeToPrev ? prevNode : nextNode;\n    var removeNode = mergeToPrev ? nextNode : prevNode;\n\n    if (mergeToPrev) {\n      newNode.appendData(removeNode.data);\n    } else {\n      newNode.insertData(0, removeNode.data);\n    }\n\n    remove$7(SugarElement.fromDom(removeNode));\n\n    if (normalizeWhitespace) {\n      normalizeWhitespaceAfter(newNode, whitespaceOffset);\n    }\n\n    return newNode;\n  };\n\n  var needsReposition = function (pos, elm) {\n    var container = pos.container();\n    var offset = pos.offset();\n    return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n  };\n\n  var reposition = function (elm, pos) {\n    return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n  };\n\n  var beforeOrStartOf = function (node) {\n    return isText$7(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n  };\n\n  var afterOrEndOf = function (node) {\n    return isText$7(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n  };\n\n  var getPreviousSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate$3(elm.previousSibling)) {\n      return Optional.some(afterOrEndOf(elm.previousSibling));\n    } else {\n      return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n    }\n  };\n\n  var getNextSiblingCaretPosition = function (elm) {\n    if (isCaretCandidate$3(elm.nextSibling)) {\n      return Optional.some(beforeOrStartOf(elm.nextSibling));\n    } else {\n      return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n    }\n  };\n\n  var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n    var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n    return prevPosition(rootElement, startPosition).fold(function () {\n      return nextPosition(rootElement, CaretPosition.after(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n    return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n      return prevPosition(rootElement, CaretPosition.before(elm));\n    }, Optional.some);\n  };\n\n  var findCaretPositionBackwards = function (rootElement, elm) {\n    return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n      return getNextSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionBackwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPositionForward = function (rootElement, elm) {\n    return getNextSiblingCaretPosition(elm).orThunk(function () {\n      return getPreviousSiblingCaretPosition(elm);\n    }).orThunk(function () {\n      return findCaretPositionForwardsFromElm(rootElement, elm);\n    });\n  };\n\n  var findCaretPosition = function (forward, rootElement, elm) {\n    return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n  };\n\n  var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n    return findCaretPosition(forward, rootElement, elm).map(curry(reposition, elm));\n  };\n\n  var setSelection$1 = function (editor, forward, pos) {\n    pos.fold(function () {\n      editor.focus();\n    }, function (pos) {\n      editor.selection.setRng(pos.toRange(), forward);\n    });\n  };\n\n  var eqRawNode = function (rawNode) {\n    return function (elm) {\n      return elm.dom === rawNode;\n    };\n  };\n\n  var isBlock = function (editor, elm) {\n    return elm && has$2(editor.schema.getBlockElements(), name(elm));\n  };\n\n  var paddEmptyBlock = function (elm) {\n    if (isEmpty$2(elm)) {\n      var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n      empty(elm);\n      append$1(elm, br);\n      return Optional.some(CaretPosition.before(br.dom));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n    var prevTextOpt = prevSibling(elm).filter(isText$8);\n    var nextTextOpt = nextSibling(elm).filter(isText$8);\n    remove$7(elm);\n    return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n      var prevNode = prev.dom,\n          nextNode = next.dom;\n      var offset = prevNode.data.length;\n      mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n      return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n    }).orThunk(function () {\n      if (normalizeWhitespace) {\n        prevTextOpt.each(function (elm) {\n          return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n        });\n        nextTextOpt.each(function (elm) {\n          return normalizeWhitespaceAfter(elm.dom, 0);\n        });\n      }\n\n      return afterDeletePosOpt;\n    });\n  };\n\n  var isInlineElement = function (editor, element) {\n    return has$2(editor.schema.getTextInlineElements(), name(element));\n  };\n\n  var deleteElement$2 = function (editor, forward, elm, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n    var parentBlock = ancestor$3(elm, curry(isBlock, editor), eqRawNode(editor.getBody()));\n    var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n    } else {\n      parentBlock.bind(paddEmptyBlock).fold(function () {\n        if (moveCaret) {\n          setSelection$1(editor, forward, normalizedAfterDeletePos);\n        }\n      }, function (paddPos) {\n        if (moveCaret) {\n          setSelection$1(editor, forward, Optional.some(paddPos));\n        }\n      });\n    }\n  };\n\n  var isRootFromElement = function (root) {\n    return function (cur) {\n      return eq(root, cur);\n    };\n  };\n\n  var getTableCells = function (table) {\n    return descendants(table, 'td,th');\n  };\n\n  var getTableDetailsFromRange = function (rng, isRoot) {\n    var getTable = function (node) {\n      return getClosestTable(SugarElement.fromDom(node), isRoot);\n    };\n\n    var startTable = getTable(rng.startContainer);\n    var endTable = getTable(rng.endContainer);\n    var isStartInTable = startTable.isSome();\n    var isEndInTable = endTable.isSome();\n    var isSameTable = lift2(startTable, endTable, eq).getOr(false);\n    var isMultiTable = !isSameTable && isStartInTable && isEndInTable;\n    return {\n      startTable: startTable,\n      endTable: endTable,\n      isStartInTable: isStartInTable,\n      isEndInTable: isEndInTable,\n      isSameTable: isSameTable,\n      isMultiTable: isMultiTable\n    };\n  };\n\n  var tableCellRng = function (start, end) {\n    return {\n      start: start,\n      end: end\n    };\n  };\n\n  var tableSelection = function (rng, table, cells) {\n    return {\n      rng: rng,\n      table: table,\n      cells: cells\n    };\n  };\n\n  var deleteAction = Adt.generate([{\n    singleCellTable: ['rng', 'cell']\n  }, {\n    fullTable: ['table']\n  }, {\n    partialTable: ['cells', 'outsideDetails']\n  }, {\n    multiTable: ['startTableCells', 'endTableCells', 'betweenRng']\n  }]);\n\n  var getClosestCell$1 = function (container, isRoot) {\n    return closest$2(SugarElement.fromDom(container), 'td,th', isRoot);\n  };\n\n  var isExpandedCellRng = function (cellRng) {\n    return !eq(cellRng.start, cellRng.end);\n  };\n\n  var getTableFromCellRng = function (cellRng, isRoot) {\n    return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n      return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n        return someIf(eq(startParentTable, endParentTable), startParentTable);\n      });\n    });\n  };\n\n  var isSingleCellTable = function (cellRng, isRoot) {\n    return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n      var rows = table.dom.rows;\n      return rows.length === 1 && rows[0].cells.length === 1;\n    });\n  };\n\n  var getCellRng = function (rng, isRoot) {\n    var startCell = getClosestCell$1(rng.startContainer, isRoot);\n    var endCell = getClosestCell$1(rng.endContainer, isRoot);\n    return lift2(startCell, endCell, tableCellRng);\n  };\n\n  var getCellRangeFromStartTable = function (isRoot) {\n    return function (startCell) {\n      return getClosestTable(startCell, isRoot).bind(function (table) {\n        return last$2(getTableCells(table)).map(function (endCell) {\n          return tableCellRng(startCell, endCell);\n        });\n      });\n    };\n  };\n\n  var getCellRangeFromEndTable = function (isRoot) {\n    return function (endCell) {\n      return getClosestTable(endCell, isRoot).bind(function (table) {\n        return head(getTableCells(table)).map(function (startCell) {\n          return tableCellRng(startCell, endCell);\n        });\n      });\n    };\n  };\n\n  var getTableSelectionFromCellRng = function (isRoot) {\n    return function (cellRng) {\n      return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n        return tableSelection(cellRng, table, getTableCells(table));\n      });\n    };\n  };\n\n  var getTableSelections = function (cellRng, selectionDetails, rng, isRoot) {\n    if (rng.collapsed || !cellRng.forall(isExpandedCellRng)) {\n      return Optional.none();\n    } else if (selectionDetails.isSameTable) {\n      var sameTableSelection = cellRng.bind(getTableSelectionFromCellRng(isRoot));\n      return Optional.some({\n        start: sameTableSelection,\n        end: sameTableSelection\n      });\n    } else {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      var startTableSelection = startCell.bind(getCellRangeFromStartTable(isRoot)).bind(getTableSelectionFromCellRng(isRoot));\n      var endTableSelection = endCell.bind(getCellRangeFromEndTable(isRoot)).bind(getTableSelectionFromCellRng(isRoot));\n      return Optional.some({\n        start: startTableSelection,\n        end: endTableSelection\n      });\n    }\n  };\n\n  var getCellIndex = function (cells, cell) {\n    return findIndex$2(cells, function (x) {\n      return eq(x, cell);\n    });\n  };\n\n  var getSelectedCells = function (tableSelection) {\n    return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n      return tableSelection.cells.slice(startIndex, endIndex + 1);\n    });\n  };\n\n  var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n    return optCellRng.exists(function (cellRng) {\n      return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n    });\n  };\n\n  var unselectCells = function (rng, selectionDetails) {\n    var startTable = selectionDetails.startTable,\n        endTable = selectionDetails.endTable;\n    var otherContentRng = rng.cloneRange();\n    startTable.each(function (table) {\n      return otherContentRng.setStartAfter(table.dom);\n    });\n    endTable.each(function (table) {\n      return otherContentRng.setEndBefore(table.dom);\n    });\n    return otherContentRng;\n  };\n\n  var handleSingleTable = function (cellRng, selectionDetails, rng, isRoot) {\n    return getTableSelections(cellRng, selectionDetails, rng, isRoot).bind(function (_a) {\n      var start = _a.start,\n          end = _a.end;\n      return start.or(end);\n    }).bind(function (tableSelection) {\n      var isSameTable = selectionDetails.isSameTable;\n      var selectedCells = getSelectedCells(tableSelection).getOr([]);\n\n      if (isSameTable && tableSelection.cells.length === selectedCells.length) {\n        return Optional.some(deleteAction.fullTable(tableSelection.table));\n      } else if (selectedCells.length > 0) {\n        if (isSameTable) {\n          return Optional.some(deleteAction.partialTable(selectedCells, Optional.none()));\n        } else {\n          var otherContentRng = unselectCells(rng, selectionDetails);\n          return Optional.some(deleteAction.partialTable(selectedCells, Optional.some(__assign(__assign({}, selectionDetails), {\n            rng: otherContentRng\n          }))));\n        }\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var handleMultiTable = function (cellRng, selectionDetails, rng, isRoot) {\n    return getTableSelections(cellRng, selectionDetails, rng, isRoot).bind(function (_a) {\n      var start = _a.start,\n          end = _a.end;\n      var startTableSelectedCells = start.bind(getSelectedCells).getOr([]);\n      var endTableSelectedCells = end.bind(getSelectedCells).getOr([]);\n\n      if (startTableSelectedCells.length > 0 && endTableSelectedCells.length > 0) {\n        var otherContentRng = unselectCells(rng, selectionDetails);\n        return Optional.some(deleteAction.multiTable(startTableSelectedCells, endTableSelectedCells, otherContentRng));\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var getActionFromRange = function (root, rng) {\n    var isRoot = isRootFromElement(root);\n    var optCellRng = getCellRng(rng, isRoot);\n    var selectionDetails = getTableDetailsFromRange(rng, isRoot);\n\n    if (isSingleCellTableContentSelected(optCellRng, rng, isRoot)) {\n      return optCellRng.map(function (cellRng) {\n        return deleteAction.singleCellTable(rng, cellRng.start);\n      });\n    } else if (selectionDetails.isMultiTable) {\n      return handleMultiTable(optCellRng, selectionDetails, rng, isRoot);\n    } else {\n      return handleSingleTable(optCellRng, selectionDetails, rng, isRoot);\n    }\n  };\n\n  var freefallRtl = function (root) {\n    var child = isComment$1(root) ? prevSibling(root) : lastChild(root);\n    return child.bind(freefallRtl).orThunk(function () {\n      return Optional.some(root);\n    });\n  };\n\n  var cleanCells = function (cells) {\n    return each$k(cells, function (cell) {\n      remove$6(cell, 'contenteditable');\n      fillWithPaddingBr(cell);\n    });\n  };\n\n  var getOutsideBlock = function (editor, container) {\n    return Optional.from(editor.dom.getParent(container, editor.dom.isBlock)).map(SugarElement.fromDom);\n  };\n\n  var handleEmptyBlock = function (editor, startInTable, emptyBlock) {\n    emptyBlock.each(function (block) {\n      if (startInTable) {\n        remove$7(block);\n      } else {\n        fillWithPaddingBr(block);\n        editor.selection.setCursorLocation(block.dom, 0);\n      }\n    });\n  };\n\n  var deleteContentInsideCell = function (editor, cell, rng, isFirstCellInSelection) {\n    var insideTableRng = rng.cloneRange();\n\n    if (isFirstCellInSelection) {\n      insideTableRng.setStart(rng.startContainer, rng.startOffset);\n      insideTableRng.setEndAfter(cell.dom.lastChild);\n    } else {\n      insideTableRng.setStartBefore(cell.dom.firstChild);\n      insideTableRng.setEnd(rng.endContainer, rng.endOffset);\n    }\n\n    deleteCellContents(editor, insideTableRng, cell, false);\n  };\n\n  var collapseAndRestoreCellSelection = function (editor) {\n    var selectedCells = getCellsFromEditor(editor);\n    var selectedNode = SugarElement.fromDom(editor.selection.getNode());\n\n    if (isTableCell$5(selectedNode.dom) && isEmpty$2(selectedNode)) {\n      editor.selection.setCursorLocation(selectedNode.dom, 0);\n    } else {\n      editor.selection.collapse(true);\n    }\n\n    if (selectedCells.length > 1 && exists(selectedCells, function (cell) {\n      return eq(cell, selectedNode);\n    })) {\n      set$1(selectedNode, 'data-mce-selected', '1');\n    }\n  };\n\n  var emptySingleTableCells = function (editor, cells, outsideDetails) {\n    var editorRng = editor.selection.getRng();\n    var cellsToClean = outsideDetails.bind(function (_a) {\n      var rng = _a.rng,\n          isStartInTable = _a.isStartInTable;\n      var outsideBlock = getOutsideBlock(editor, isStartInTable ? rng.endContainer : rng.startContainer);\n      rng.deleteContents();\n      handleEmptyBlock(editor, isStartInTable, outsideBlock.filter(isEmpty$2));\n      var endPointCell = isStartInTable ? cells[0] : cells[cells.length - 1];\n      deleteContentInsideCell(editor, endPointCell, editorRng, isStartInTable);\n\n      if (!isEmpty$2(endPointCell)) {\n        return Optional.some(isStartInTable ? cells.slice(1) : cells.slice(0, -1));\n      } else {\n        return Optional.none();\n      }\n    }).getOr(cells);\n    cleanCells(cellsToClean);\n    collapseAndRestoreCellSelection(editor);\n    return true;\n  };\n\n  var emptyMultiTableCells = function (editor, startTableCells, endTableCells, betweenRng) {\n    var rng = editor.selection.getRng();\n    var startCell = startTableCells[0];\n    var endCell = endTableCells[endTableCells.length - 1];\n    deleteContentInsideCell(editor, startCell, rng, true);\n    deleteContentInsideCell(editor, endCell, rng, false);\n    var startTableCellsToClean = isEmpty$2(startCell) ? startTableCells : startTableCells.slice(1);\n    var endTableCellsToClean = isEmpty$2(endCell) ? endTableCells : endTableCells.slice(0, -1);\n    cleanCells(startTableCellsToClean.concat(endTableCellsToClean));\n    betweenRng.deleteContents();\n    collapseAndRestoreCellSelection(editor);\n    return true;\n  };\n\n  var deleteCellContents = function (editor, rng, cell, moveSelection) {\n    if (moveSelection === void 0) {\n      moveSelection = true;\n    }\n\n    rng.deleteContents();\n    var lastNode = freefallRtl(cell).getOr(cell);\n    var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n\n    if (isEmpty$2(lastBlock)) {\n      fillWithPaddingBr(lastBlock);\n\n      if (moveSelection) {\n        editor.selection.setCursorLocation(lastBlock.dom, 0);\n      }\n    }\n\n    if (!eq(cell, lastBlock)) {\n      var additionalCleanupNodes = is$1(parent(lastBlock), cell) ? [] : siblings(lastBlock);\n      each$k(additionalCleanupNodes.concat(children(cell)), function (node) {\n        if (!eq(node, lastBlock) && !contains$1(node, lastBlock) && isEmpty$2(node)) {\n          remove$7(node);\n        }\n      });\n    }\n\n    return true;\n  };\n\n  var deleteTableElement = function (editor, table) {\n    deleteElement$2(editor, false, table);\n    return true;\n  };\n\n  var deleteCellRange = function (editor, rootElm, rng) {\n    return getActionFromRange(rootElm, rng).map(function (action) {\n      return action.fold(curry(deleteCellContents, editor), curry(deleteTableElement, editor), curry(emptySingleTableCells, editor), curry(emptyMultiTableCells, editor));\n    });\n  };\n\n  var deleteCaptionRange = function (editor, caption) {\n    return emptyElement(editor, caption);\n  };\n\n  var deleteTableRange = function (editor, rootElm, rng, startElm) {\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCellRange(editor, rootElm, rng);\n    }, function (caption) {\n      return deleteCaptionRange(editor, caption);\n    }).getOr(false);\n  };\n\n  var deleteRange$2 = function (editor, startElm, selectedCells) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    return selectedCells.length !== 0 ? emptySingleTableCells(editor, selectedCells, Optional.none()) : deleteTableRange(editor, rootNode, rng, startElm);\n  };\n\n  var getParentCell = function (rootElm, elm) {\n    return find$3(parentsAndSelf(elm, rootElm), isTableCell$4);\n  };\n\n  var getParentCaption = function (rootElm, elm) {\n    return find$3(parentsAndSelf(elm, rootElm), isTag('caption'));\n  };\n\n  var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n        return eq(toCell, fromCell) === false;\n      });\n    });\n  };\n\n  var emptyElement = function (editor, elm) {\n    fillWithPaddingBr(elm);\n    editor.selection.setCursorLocation(elm.dom, 0);\n    return Optional.some(true);\n  };\n\n  var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n    return firstPositionIn(fromCaption.dom).bind(function (first) {\n      return lastPositionIn(fromCaption.dom).map(function (last) {\n        return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n      });\n    }).getOr(true);\n  };\n\n  var emptyCaretCaption = function (editor, elm) {\n    return emptyElement(editor, elm);\n  };\n\n  var validateCaretCaption = function (rootElm, fromCaption, to) {\n    return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n      return eq(toCaption, fromCaption) === false;\n    });\n  };\n\n  var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n    return navigate(forward, editor.getBody(), from).bind(function (to) {\n      return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n    }).or(Optional.some(true));\n  };\n\n  var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return getParentCell(rootElm, startElm).bind(function (fromCell) {\n      return isEmpty$2(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n    }).getOr(false);\n  };\n\n  var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isEmpty$2(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n  };\n\n  var isNearTable = function (forward, pos) {\n    return forward ? isBeforeTable(pos) : isAfterTable(pos);\n  };\n\n  var isBeforeOrAfterTable = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n      return isNearTable(forward, pos);\n    });\n  };\n\n  var deleteCaret$3 = function (editor, forward, startElm) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    return getParentCaption(rootElm, startElm).fold(function () {\n      return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n    }, function (fromCaption) {\n      return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n    });\n  };\n\n  var backspaceDelete$9 = function (editor, forward) {\n    var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n    var cells = getCellsFromEditor(editor);\n    return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret$3(editor, forward, startElm) : deleteRange$2(editor, startElm, cells);\n  };\n\n  var createRange = function (sc, so, ec, eo) {\n    var rng = document.createRange();\n    rng.setStart(sc, so);\n    rng.setEnd(ec, eo);\n    return rng;\n  };\n\n  var normalizeBlockSelectionRange = function (rng) {\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n    var rootNode = rng.commonAncestorContainer;\n    return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n      if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n        return createRange(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n      } else {\n        return rng;\n      }\n    }).getOr(rng);\n  };\n\n  var normalize = function (rng) {\n    return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n  };\n\n  var hasOnlyOneChild$1 = function (node) {\n    return node.firstChild && node.firstChild === node.lastChild;\n  };\n\n  var isPaddingNode = function (node) {\n    return node.name === 'br' || node.value === nbsp;\n  };\n\n  var isPaddedEmptyBlock = function (schema, node) {\n    var blockElements = schema.getBlockElements();\n    return blockElements[node.name] && hasOnlyOneChild$1(node) && isPaddingNode(node.firstChild);\n  };\n\n  var isEmptyFragmentElement = function (schema, node) {\n    var nonEmptyElements = schema.getNonEmptyElements();\n    return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n  };\n\n  var isListFragment = function (schema, fragment) {\n    var firstChild = fragment.firstChild;\n    var lastChild = fragment.lastChild;\n\n    if (firstChild && firstChild.name === 'meta') {\n      firstChild = firstChild.next;\n    }\n\n    if (lastChild && lastChild.attr('id') === 'mce_marker') {\n      lastChild = lastChild.prev;\n    }\n\n    if (isEmptyFragmentElement(schema, lastChild)) {\n      lastChild = lastChild.prev;\n    }\n\n    if (!firstChild || firstChild !== lastChild) {\n      return false;\n    }\n\n    return firstChild.name === 'ul' || firstChild.name === 'ol';\n  };\n\n  var cleanupDomFragment = function (domFragment) {\n    var firstChild = domFragment.firstChild;\n    var lastChild = domFragment.lastChild;\n\n    if (firstChild && firstChild.nodeName === 'META') {\n      firstChild.parentNode.removeChild(firstChild);\n    }\n\n    if (lastChild && lastChild.id === 'mce_marker') {\n      lastChild.parentNode.removeChild(lastChild);\n    }\n\n    return domFragment;\n  };\n\n  var toDomFragment = function (dom, serializer, fragment) {\n    var html = serializer.serialize(fragment);\n    var domFragment = dom.createFragment(html);\n    return cleanupDomFragment(domFragment);\n  };\n\n  var listItems = function (elm) {\n    return filter$4(elm.childNodes, function (child) {\n      return child.nodeName === 'LI';\n    });\n  };\n\n  var isPadding = function (node) {\n    return node.data === nbsp || isBr$5(node);\n  };\n\n  var isListItemPadded = function (node) {\n    return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n  };\n\n  var isEmptyOrPadded = function (elm) {\n    return !elm.firstChild || isListItemPadded(elm);\n  };\n\n  var trimListItems = function (elms) {\n    return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n  };\n\n  var getParentLi = function (dom, node) {\n    var parentBlock = dom.getParent(node, dom.isBlock);\n    return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n  };\n\n  var isParentBlockLi = function (dom, node) {\n    return !!getParentLi(dom, node);\n  };\n\n  var getSplit = function (parentNode, rng) {\n    var beforeRng = rng.cloneRange();\n    var afterRng = rng.cloneRange();\n    beforeRng.setStartBefore(parentNode);\n    afterRng.setEndAfter(parentNode);\n    return [beforeRng.cloneContents(), afterRng.cloneContents()];\n  };\n\n  var findFirstIn = function (node, rootNode) {\n    var caretPos = CaretPosition.before(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.next(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var findLastOf = function (node, rootNode) {\n    var caretPos = CaretPosition.after(node);\n    var caretWalker = CaretWalker(rootNode);\n    var newCaretPos = caretWalker.prev(caretPos);\n    return newCaretPos ? newCaretPos.toRange() : null;\n  };\n\n  var insertMiddle = function (target, elms, rootNode, rng) {\n    var parts = getSplit(target, rng);\n    var parentElm = target.parentNode;\n    parentElm.insertBefore(parts[0], target);\n    Tools.each(elms, function (li) {\n      parentElm.insertBefore(li, target);\n    });\n    parentElm.insertBefore(parts[1], target);\n    parentElm.removeChild(target);\n    return findLastOf(elms[elms.length - 1], rootNode);\n  };\n\n  var insertBefore$1 = function (target, elms, rootNode) {\n    var parentElm = target.parentNode;\n    Tools.each(elms, function (elm) {\n      parentElm.insertBefore(elm, target);\n    });\n    return findFirstIn(target, rootNode);\n  };\n\n  var insertAfter$1 = function (target, elms, rootNode, dom) {\n    dom.insertAfter(elms.reverse(), target);\n    return findLastOf(elms[0], rootNode);\n  };\n\n  var insertAtCaret$1 = function (serializer, dom, rng, fragment) {\n    var domFragment = toDomFragment(dom, serializer, fragment);\n    var liTarget = getParentLi(dom, rng.startContainer);\n    var liElms = trimListItems(listItems(domFragment.firstChild));\n    var BEGINNING = 1,\n        END = 2;\n    var rootNode = dom.getRoot();\n\n    var isAt = function (location) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(dom.getRoot());\n      var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n      return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n    };\n\n    if (isAt(BEGINNING)) {\n      return insertBefore$1(liTarget, liElms, rootNode);\n    } else if (isAt(END)) {\n      return insertAfter$1(liTarget, liElms, rootNode, dom);\n    }\n\n    return insertMiddle(liTarget, liElms, rootNode, rng);\n  };\n\n  var trimOrPadLeftRight = function (dom, rng, html) {\n    var root = SugarElement.fromDom(dom.getRoot());\n\n    if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n      html = html.replace(/^ /, '&nbsp;');\n    } else {\n      html = html.replace(/^&nbsp;/, ' ');\n    }\n\n    if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n      html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n    } else {\n      html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n    }\n\n    return html;\n  };\n\n  var isTableCell$1 = isTableCell$5;\n\n  var isTableCellContentSelected = function (dom, rng, cell) {\n    if (cell !== null) {\n      var endCell = dom.getParent(rng.endContainer, isTableCell$1);\n      return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n    } else {\n      return false;\n    }\n  };\n\n  var validInsertion = function (editor, value, parentNode) {\n    if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n      parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n    } else {\n      var node = parentNode.firstChild;\n      var node2 = parentNode.lastChild;\n\n      if (!node || node === node2 && node.nodeName === 'BR') {\n        editor.dom.setHTML(parentNode, value);\n      } else {\n        editor.selection.setContent(value);\n      }\n    }\n  };\n\n  var trimBrsFromTableCell = function (dom, elm) {\n    Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n  };\n\n  var reduceInlineTextElements = function (editor, merge) {\n    var textInlineElements = editor.schema.getTextInlineElements();\n    var dom = editor.dom;\n\n    if (merge) {\n      var root_1 = editor.getBody();\n      var elementUtils_1 = ElementUtils(dom);\n      Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n        var isInline = isNonNullable(textInlineElements[node.nodeName.toLowerCase()]);\n\n        if (isInline && hasInheritableStyles(dom, node)) {\n          for (var parentNode = node.parentNode; isNonNullable(parentNode) && parentNode !== root_1; parentNode = parentNode.parentNode) {\n            var styleConflict = hasStyleConflict(dom, node, parentNode);\n\n            if (styleConflict) {\n              break;\n            }\n\n            if (elementUtils_1.compare(parentNode, node)) {\n              dom.remove(node, true);\n              break;\n            }\n          }\n        }\n      });\n    }\n  };\n\n  var markFragmentElements = function (fragment) {\n    var node = fragment;\n\n    while (node = node.walk()) {\n      if (node.type === 1) {\n        node.attr('data-mce-fragment', '1');\n      }\n    }\n  };\n\n  var unmarkFragmentElements = function (elm) {\n    Tools.each(elm.getElementsByTagName('*'), function (elm) {\n      elm.removeAttribute('data-mce-fragment');\n    });\n  };\n\n  var isPartOfFragment = function (node) {\n    return !!node.getAttribute('data-mce-fragment');\n  };\n\n  var canHaveChildren = function (editor, node) {\n    return node && !editor.schema.getShortEndedElements()[node.nodeName];\n  };\n\n  var moveSelectionToMarker = function (editor, marker) {\n    var nextRng;\n    var dom = editor.dom;\n    var selection = editor.selection;\n\n    if (!marker) {\n      return;\n    }\n\n    selection.scrollIntoView(marker);\n    var parentEditableElm = getContentEditableRoot$1(editor.getBody(), marker);\n\n    if (dom.getContentEditable(parentEditableElm) === 'false') {\n      dom.remove(marker);\n      selection.select(parentEditableElm);\n      return;\n    }\n\n    var rng = dom.createRng();\n    var node = marker.previousSibling;\n\n    if (isText$7(node)) {\n      rng.setStart(node, node.nodeValue.length);\n\n      if (!Env.ie) {\n        var node2 = marker.nextSibling;\n\n        if (isText$7(node2)) {\n          node.appendData(node2.data);\n          node2.parentNode.removeChild(node2);\n        }\n      }\n    } else {\n      rng.setStartBefore(marker);\n      rng.setEndBefore(marker);\n    }\n\n    var findNextCaretRng = function (rng) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      var caretWalker = CaretWalker(editor.getBody());\n      caretPos = caretWalker.next(caretPos);\n\n      if (caretPos) {\n        return caretPos.toRange();\n      }\n    };\n\n    var parentBlock = dom.getParent(marker, dom.isBlock);\n    dom.remove(marker);\n\n    if (parentBlock && dom.isEmpty(parentBlock)) {\n      editor.$(parentBlock).empty();\n      rng.setStart(parentBlock, 0);\n      rng.setEnd(parentBlock, 0);\n\n      if (!isTableCell$1(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n        rng = nextRng;\n        dom.remove(parentBlock);\n      } else {\n        dom.add(parentBlock, dom.create('br', {\n          'data-mce-bogus': '1'\n        }));\n      }\n    }\n\n    selection.setRng(rng);\n  };\n\n  var deleteSelectedContent = function (editor) {\n    var dom = editor.dom;\n    var rng = normalize(editor.selection.getRng());\n    editor.selection.setRng(rng);\n    var startCell = dom.getParent(rng.startContainer, isTableCell$1);\n\n    if (isTableCellContentSelected(dom, rng, startCell)) {\n      deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n    } else {\n      editor.getDoc().execCommand('Delete', false, null);\n    }\n  };\n\n  var insertHtmlAtCaret = function (editor, value, details) {\n    var parentNode;\n    var rng, node;\n    var selection = editor.selection;\n    var dom = editor.dom;\n\n    if (/^ | $/.test(value)) {\n      value = trimOrPadLeftRight(dom, selection.getRng(), value);\n    }\n\n    var parser = editor.parser;\n    var merge = details.merge;\n    var serializer = HtmlSerializer({\n      validate: shouldValidate(editor)\n    }, editor.schema);\n    var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n    var args = editor.fire('BeforeSetContent', {\n      content: value,\n      format: 'html',\n      selection: true,\n      paste: details.paste\n    });\n\n    if (args.isDefaultPrevented()) {\n      editor.fire('SetContent', {\n        content: args.content,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      });\n      return;\n    }\n\n    value = args.content;\n\n    if (value.indexOf('{$caret}') === -1) {\n      value += '{$caret}';\n    }\n\n    value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n    rng = selection.getRng();\n    var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n    var body = editor.getBody();\n\n    if (caretElement === body && selection.isCollapsed()) {\n      if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n        rng = dom.createRng();\n        rng.setStart(body.firstChild, 0);\n        rng.setEnd(body.firstChild, 0);\n        selection.setRng(rng);\n      }\n    }\n\n    if (!selection.isCollapsed()) {\n      deleteSelectedContent(editor);\n    }\n\n    parentNode = selection.getNode();\n    var parserArgs = {\n      context: parentNode.nodeName.toLowerCase(),\n      data: details.data,\n      insert: true\n    };\n    var fragment = parser.parse(value, parserArgs);\n\n    if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n      rng = insertAtCaret$1(serializer, dom, selection.getRng(), fragment);\n      selection.setRng(rng);\n      editor.fire('SetContent', args);\n      return;\n    }\n\n    markFragmentElements(fragment);\n    node = fragment.lastChild;\n\n    if (node.attr('id') === 'mce_marker') {\n      var marker = node;\n\n      for (node = node.prev; node; node = node.walk(true)) {\n        if (node.type === 3 || !dom.isBlock(node.name)) {\n          if (editor.schema.isValidChild(node.parent.name, 'span')) {\n            node.parent.insert(marker, node, node.name === 'br');\n          }\n\n          break;\n        }\n      }\n    }\n\n    editor._selectionOverrides.showBlockCaretContainer(parentNode);\n\n    if (!parserArgs.invalid) {\n      value = serializer.serialize(fragment);\n      validInsertion(editor, value, parentNode);\n    } else {\n      editor.selection.setContent(bookmarkHtml);\n      parentNode = selection.getNode();\n      var rootNode = editor.getBody();\n\n      if (parentNode.nodeType === 9) {\n        parentNode = node = rootNode;\n      } else {\n        node = parentNode;\n      }\n\n      while (node !== rootNode) {\n        parentNode = node;\n        node = node.parentNode;\n      }\n\n      value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n      value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n        return serializer.serialize(fragment);\n      })));\n\n      if (parentNode === rootNode) {\n        dom.setHTML(rootNode, value);\n      } else {\n        dom.setOuterHTML(parentNode, value);\n      }\n    }\n\n    reduceInlineTextElements(editor, merge);\n    moveSelectionToMarker(editor, dom.get('mce_marker'));\n    unmarkFragmentElements(editor.getBody());\n    trimBrsFromTableCell(dom, selection.getStart());\n    editor.fire('SetContent', args);\n    editor.addVisual();\n  };\n\n  var traverse = function (node, fn) {\n    fn(node);\n\n    if (node.firstChild) {\n      traverse(node.firstChild, fn);\n    }\n\n    if (node.next) {\n      traverse(node.next, fn);\n    }\n  };\n\n  var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n    var nodeMatches = {};\n    var attrMatches = {};\n    var matches = [];\n\n    if (node.firstChild) {\n      traverse(node.firstChild, function (node) {\n        each$k(nodeFilters, function (filter) {\n          if (filter.name === node.name) {\n            if (nodeMatches[filter.name]) {\n              nodeMatches[filter.name].nodes.push(node);\n            } else {\n              nodeMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n        each$k(attributeFilters, function (filter) {\n          if (typeof node.attr(filter.name) === 'string') {\n            if (attrMatches[filter.name]) {\n              attrMatches[filter.name].nodes.push(node);\n            } else {\n              attrMatches[filter.name] = {\n                filter: filter,\n                nodes: [node]\n              };\n            }\n          }\n        });\n      });\n    }\n\n    for (var name_1 in nodeMatches) {\n      if (has$2(nodeMatches, name_1)) {\n        matches.push(nodeMatches[name_1]);\n      }\n    }\n\n    for (var name_2 in attrMatches) {\n      if (has$2(attrMatches, name_2)) {\n        matches.push(attrMatches[name_2]);\n      }\n    }\n\n    return matches;\n  };\n\n  var filter$1 = function (nodeFilters, attributeFilters, node) {\n    var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n    each$k(matches, function (match) {\n      each$k(match.filter.callbacks, function (callback) {\n        callback(match.nodes, match.filter.name, {});\n      });\n    });\n  };\n\n  var defaultFormat$1 = 'html';\n\n  var isTreeNode = function (content) {\n    return content instanceof AstNode;\n  };\n\n  var moveSelection = function (editor) {\n    if (hasFocus(editor)) {\n      firstPositionIn(editor.getBody()).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable$3(node) ? firstPositionIn(node).getOr(pos) : pos;\n        editor.selection.setRng(caretPos.toRange());\n      });\n    }\n  };\n\n  var setEditorHtml = function (editor, html, noSelection) {\n    editor.dom.setHTML(editor.getBody(), html);\n\n    if (noSelection !== true) {\n      moveSelection(editor);\n    }\n  };\n\n  var setContentString = function (editor, body, content, args) {\n    if (content.length === 0 || /^\\s+$/.test(content)) {\n      var padd = '<br data-mce-bogus=\"1\">';\n\n      if (body.nodeName === 'TABLE') {\n        content = '<tr><td>' + padd + '</td></tr>';\n      } else if (/^(UL|OL)$/.test(body.nodeName)) {\n        content = '<li>' + padd + '</li>';\n      }\n\n      var forcedRootBlockName = getForcedRootBlock(editor);\n\n      if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n        content = padd;\n        content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n      } else if (!content) {\n        content = '<br data-mce-bogus=\"1\">';\n      }\n\n      setEditorHtml(editor, content, args.no_selection);\n      editor.fire('SetContent', args);\n    } else {\n      if (args.format !== 'raw') {\n        content = HtmlSerializer({\n          validate: editor.validate\n        }, editor.schema).serialize(editor.parser.parse(content, {\n          isRootContent: true,\n          insert: true\n        }));\n      }\n\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n      setEditorHtml(editor, args.content, args.no_selection);\n\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n    }\n\n    return args.content;\n  };\n\n  var setContentTree = function (editor, body, content, args) {\n    filter$1(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n    var html = HtmlSerializer({\n      validate: editor.validate\n    }, editor.schema).serialize(content);\n    args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n    setEditorHtml(editor, args.content, args.no_selection);\n\n    if (!args.no_events) {\n      editor.fire('SetContent', args);\n    }\n\n    return content;\n  };\n\n  var setupArgs$2 = function (args, content) {\n    return __assign(__assign({\n      format: defaultFormat$1\n    }, args), {\n      set: true,\n      content: isTreeNode(content) ? '' : content\n    });\n  };\n\n  var setContentInternal = function (editor, content, args) {\n    var defaultedArgs = setupArgs$2(args, content);\n    var updatedArgs = args.no_events ? defaultedArgs : editor.fire('BeforeSetContent', defaultedArgs);\n\n    if (!isTreeNode(content)) {\n      content = updatedArgs.content;\n    }\n\n    return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n      return isTreeNode(content) ? setContentTree(editor, body, content, updatedArgs) : setContentString(editor, body, content, updatedArgs);\n    });\n  };\n\n  var sibling = function (scope, predicate) {\n    return sibling$2(scope, predicate).isSome();\n  };\n\n  var ensureIsRoot = function (isRoot) {\n    return isFunction(isRoot) ? isRoot : never;\n  };\n\n  var ancestor = function (scope, transform, isRoot) {\n    var element = scope.dom;\n    var stop = ensureIsRoot(isRoot);\n\n    while (element.parentNode) {\n      element = element.parentNode;\n      var el = SugarElement.fromDom(element);\n      var transformed = transform(el);\n\n      if (transformed.isSome()) {\n        return transformed;\n      } else if (stop(el)) {\n        break;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var closest$1 = function (scope, transform, isRoot) {\n    var current = transform(scope);\n    var stop = ensureIsRoot(isRoot);\n    return current.orThunk(function () {\n      return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n    });\n  };\n\n  var isEq$3 = isEq$5;\n\n  var matchesUnInheritedFormatSelector = function (ed, node, name) {\n    var formatList = ed.formatter.get(name);\n\n    if (formatList) {\n      for (var i = 0; i < formatList.length; i++) {\n        var format = formatList[i];\n\n        if (isSelectorFormat(format) && format.inherit === false && ed.dom.is(node, format.selector)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchParents = function (editor, node, name, vars, similar) {\n    var root = editor.dom.getRoot();\n\n    if (node === root) {\n      return false;\n    }\n\n    node = editor.dom.getParent(node, function (node) {\n      if (matchesUnInheritedFormatSelector(editor, node, name)) {\n        return true;\n      }\n\n      return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n    });\n    return !!matchNode(editor, node, name, vars, similar);\n  };\n\n  var matchName$1 = function (dom, node, format) {\n    if (isEq$3(node, format.inline)) {\n      return true;\n    }\n\n    if (isEq$3(node, format.block)) {\n      return true;\n    }\n\n    if (format.selector) {\n      return node.nodeType === 1 && dom.is(node, format.selector);\n    }\n  };\n\n  var matchItems = function (dom, node, format, itemName, similar, vars) {\n    var items = format[itemName];\n\n    if (isFunction(format.onmatch)) {\n      return format.onmatch(node, format, itemName);\n    }\n\n    if (items) {\n      if (isUndefined(items.length)) {\n        for (var key in items) {\n          if (has$2(items, key)) {\n            var value = itemName === 'attributes' ? dom.getAttrib(node, key) : getStyle(dom, node, key);\n            var expectedValue = replaceVars(items[key], vars);\n            var isEmptyValue = isNullable(value) || isEmpty$3(value);\n\n            if (isEmptyValue && isNullable(expectedValue)) {\n              continue;\n            }\n\n            if (similar && isEmptyValue && !format.exact) {\n              return false;\n            }\n\n            if ((!similar || format.exact) && !isEq$3(value, normalizeStyleValue(dom, expectedValue, key))) {\n              return false;\n            }\n          }\n        }\n      } else {\n        for (var i = 0; i < items.length; i++) {\n          if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return true;\n  };\n\n  var matchNode = function (ed, node, name, vars, similar) {\n    var formatList = ed.formatter.get(name);\n    var dom = ed.dom;\n\n    if (formatList && node) {\n      for (var i = 0; i < formatList.length; i++) {\n        var format = formatList[i];\n\n        if (matchName$1(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n          var classes = format.classes;\n\n          if (classes) {\n            for (var x = 0; x < classes.length; x++) {\n              if (!ed.dom.hasClass(node, replaceVars(classes[x], vars))) {\n                return;\n              }\n            }\n          }\n\n          return format;\n        }\n      }\n    }\n  };\n\n  var match$2 = function (editor, name, vars, node, similar) {\n    if (node) {\n      return matchParents(editor, node, name, vars, similar);\n    }\n\n    node = editor.selection.getNode();\n\n    if (matchParents(editor, node, name, vars, similar)) {\n      return true;\n    }\n\n    var startNode = editor.selection.getStart();\n\n    if (startNode !== node) {\n      if (matchParents(editor, startNode, name, vars, similar)) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var matchAll = function (editor, names, vars) {\n    var matchedFormatNames = [];\n    var checkedMap = {};\n    var startElement = editor.selection.getStart();\n    editor.dom.getParent(startElement, function (node) {\n      for (var i = 0; i < names.length; i++) {\n        var name_1 = names[i];\n\n        if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n          checkedMap[name_1] = true;\n          matchedFormatNames.push(name_1);\n        }\n      }\n    }, editor.dom.getRoot());\n    return matchedFormatNames;\n  };\n\n  var closest = function (editor, names) {\n    var isRoot = function (elm) {\n      return eq(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    var match = function (elm, name) {\n      return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n    };\n\n    return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n      return closest$1(SugarElement.fromDom(rawElm), function (elm) {\n        return findMap(names, function (name) {\n          return match(elm, name);\n        });\n      }, isRoot);\n    }).getOrNull();\n  };\n\n  var canApply = function (editor, name) {\n    var formatList = editor.formatter.get(name);\n    var dom = editor.dom;\n\n    if (formatList) {\n      var startNode = editor.selection.getStart();\n      var parents = getParents$2(dom, startNode);\n\n      for (var x = formatList.length - 1; x >= 0; x--) {\n        var format = formatList[x];\n\n        if (!isSelectorFormat(format) || isNonNullable(format.defaultBlock)) {\n          return true;\n        }\n\n        for (var i = parents.length - 1; i >= 0; i--) {\n          if (dom.is(parents[i], format.selector)) {\n            return true;\n          }\n        }\n      }\n    }\n\n    return false;\n  };\n\n  var matchAllOnNode = function (editor, node, formatNames) {\n    return foldl(formatNames, function (acc, name) {\n      var matchSimilar = isVariableFormatName(editor, name);\n\n      if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n        return acc.concat([name]);\n      } else {\n        return acc;\n      }\n    }, []);\n  };\n\n  var ZWSP = ZWSP$1,\n      CARET_ID = '_mce_caret';\n\n  var importNode = function (ownerDocument, node) {\n    return ownerDocument.importNode(node, true);\n  };\n\n  var getEmptyCaretContainers = function (node) {\n    var nodes = [];\n\n    while (node) {\n      if (node.nodeType === 3 && node.nodeValue !== ZWSP || node.childNodes.length > 1) {\n        return [];\n      }\n\n      if (node.nodeType === 1) {\n        nodes.push(node);\n      }\n\n      node = node.firstChild;\n    }\n\n    return nodes;\n  };\n\n  var isCaretContainerEmpty = function (node) {\n    return getEmptyCaretContainers(node).length > 0;\n  };\n\n  var findFirstTextNode = function (node) {\n    if (node) {\n      var walker = new DomTreeWalker(node, node);\n\n      for (node = walker.current(); node; node = walker.next()) {\n        if (isText$7(node)) {\n          return node;\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var createCaretContainer = function (fill) {\n    var caretContainer = SugarElement.fromTag('span');\n    setAll$1(caretContainer, {\n      'id': CARET_ID,\n      'data-mce-bogus': '1',\n      'data-mce-type': 'format-caret'\n    });\n\n    if (fill) {\n      append$1(caretContainer, SugarElement.fromText(ZWSP));\n    }\n\n    return caretContainer;\n  };\n\n  var trimZwspFromCaretContainer = function (caretContainerNode) {\n    var textNode = findFirstTextNode(caretContainerNode);\n\n    if (textNode && textNode.nodeValue.charAt(0) === ZWSP) {\n      textNode.deleteData(0, 1);\n    }\n\n    return textNode;\n  };\n\n  var removeCaretContainerNode = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (isCaretContainerEmpty(node)) {\n      deleteElement$2(editor, false, SugarElement.fromDom(node), moveCaret);\n    } else {\n      var rng = selection.getRng();\n      var block = dom.getParent(node, dom.isBlock);\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var textNode = trimZwspFromCaretContainer(node);\n      dom.remove(node, true);\n\n      if (startContainer === textNode && startOffset > 0) {\n        rng.setStart(textNode, startOffset - 1);\n      }\n\n      if (endContainer === textNode && endOffset > 0) {\n        rng.setEnd(textNode, endOffset - 1);\n      }\n\n      if (block && dom.isEmpty(block)) {\n        fillWithPaddingBr(SugarElement.fromDom(block));\n      }\n\n      selection.setRng(rng);\n    }\n  };\n\n  var removeCaretContainer = function (editor, node, moveCaret) {\n    if (moveCaret === void 0) {\n      moveCaret = true;\n    }\n\n    var dom = editor.dom,\n        selection = editor.selection;\n\n    if (!node) {\n      node = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n      if (!node) {\n        while (node = dom.get(CARET_ID)) {\n          removeCaretContainerNode(editor, node, false);\n        }\n      }\n    } else {\n      removeCaretContainerNode(editor, node, moveCaret);\n    }\n  };\n\n  var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n    var dom = editor.dom,\n        block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n\n    if (block && dom.isEmpty(block)) {\n      formatNode.parentNode.replaceChild(caretContainer, formatNode);\n    } else {\n      removeTrailingBr(SugarElement.fromDom(formatNode));\n\n      if (dom.isEmpty(formatNode)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        dom.insertAfter(caretContainer, formatNode);\n      }\n    }\n  };\n\n  var appendNode = function (parentNode, node) {\n    parentNode.appendChild(node);\n    return node;\n  };\n\n  var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n    var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n      return appendNode(parentNode, formatNode.cloneNode(false));\n    }, caretContainer);\n    return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP));\n  };\n\n  var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n    var formatter = editor.formatter;\n    var dom = editor.dom;\n    var validFormats = filter$4(keys(formatter.get()), function (formatName) {\n      return formatName !== name && !contains$2(formatName, 'removeformat');\n    });\n    var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n    var uniqueFormats = filter$4(matchedFormats, function (fmtName) {\n      return !areSimilarFormats(editor, fmtName, name);\n    });\n\n    if (uniqueFormats.length > 0) {\n      var clonedFormatNode = formatNode.cloneNode(false);\n      dom.add(caretContainer, clonedFormatNode);\n      formatter.remove(name, vars, clonedFormatNode, similar);\n      dom.remove(clonedFormatNode);\n      return Optional.some(clonedFormatNode);\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var applyCaretFormat = function (editor, name, vars) {\n    var caretContainer, textNode;\n    var selection = editor.selection;\n    var selectionRng = selection.getRng();\n    var offset = selectionRng.startOffset;\n    var container = selectionRng.startContainer;\n    var text = container.nodeValue;\n    caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n\n    if (caretContainer) {\n      textNode = findFirstTextNode(caretContainer);\n    }\n\n    var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n\n    if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n      var bookmark = selection.getBookmark();\n      selectionRng.collapse(true);\n      var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n      rng = split(rng);\n      editor.formatter.apply(name, vars, rng);\n      selection.moveToBookmark(bookmark);\n    } else {\n      if (!caretContainer || textNode.nodeValue !== ZWSP) {\n        caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n        textNode = caretContainer.firstChild;\n        selectionRng.insertNode(caretContainer);\n        offset = 1;\n        editor.formatter.apply(name, vars, caretContainer);\n      } else {\n        editor.formatter.apply(name, vars, caretContainer);\n      }\n\n      selection.setCursorLocation(textNode, offset);\n    }\n  };\n\n  var removeCaretFormat = function (editor, name, vars, similar) {\n    var dom = editor.dom;\n    var selection = editor.selection;\n    var hasContentAfter, node, formatNode;\n    var parents = [];\n    var rng = selection.getRng();\n    var container = rng.startContainer;\n    var offset = rng.startOffset;\n    node = container;\n\n    if (container.nodeType === 3) {\n      if (offset !== container.nodeValue.length) {\n        hasContentAfter = true;\n      }\n\n      node = node.parentNode;\n    }\n\n    while (node) {\n      if (matchNode(editor, node, name, vars, similar)) {\n        formatNode = node;\n        break;\n      }\n\n      if (node.nextSibling) {\n        hasContentAfter = true;\n      }\n\n      parents.push(node);\n      node = node.parentNode;\n    }\n\n    if (!formatNode) {\n      return;\n    }\n\n    if (hasContentAfter) {\n      var bookmark = selection.getBookmark();\n      rng.collapse(true);\n      var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n      expandedRng = split(expandedRng);\n      editor.formatter.remove(name, vars, expandedRng, similar);\n      selection.moveToBookmark(bookmark);\n    } else {\n      var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n      var newCaretContainer = createCaretContainer(false).dom;\n      insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n      var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n      var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n      removeCaretContainerNode(editor, caretContainer, false);\n      selection.setCursorLocation(caretTextNode, 1);\n\n      if (dom.isEmpty(formatNode)) {\n        dom.remove(formatNode);\n      }\n    }\n  };\n\n  var disableCaretContainer = function (editor, keyCode) {\n    var selection = editor.selection,\n        body = editor.getBody();\n    removeCaretContainer(editor, null, false);\n\n    if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n\n    if (keyCode === 37 || keyCode === 39) {\n      removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n    }\n  };\n\n  var setup$k = function (editor) {\n    editor.on('mouseup keydown', function (e) {\n      disableCaretContainer(editor, e.keyCode);\n    });\n  };\n\n  var replaceWithCaretFormat = function (targetNode, formatNodes) {\n    var caretContainer = createCaretContainer(false);\n    var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n    before$4(SugarElement.fromDom(targetNode), caretContainer);\n    remove$7(SugarElement.fromDom(targetNode));\n    return CaretPosition(innerMost, 0);\n  };\n\n  var isFormatElement = function (editor, element) {\n    var inlineElements = editor.schema.getTextInlineElements();\n    return has$2(inlineElements, name(element)) && !isCaretNode(element.dom) && !isBogus$2(element.dom);\n  };\n\n  var isEmptyCaretFormatElement = function (element) {\n    return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n  };\n\n  var postProcessHooks = {};\n  var filter = filter$2;\n  var each$b = each$i;\n\n  var addPostProcessHook = function (name, hook) {\n    var hooks = postProcessHooks[name];\n\n    if (!hooks) {\n      postProcessHooks[name] = [];\n    }\n\n    postProcessHooks[name].push(hook);\n  };\n\n  var postProcess$1 = function (name, editor) {\n    each$b(postProcessHooks[name], function (hook) {\n      hook(editor);\n    });\n  };\n\n  addPostProcessHook('pre', function (editor) {\n    var rng = editor.selection.getRng();\n    var blocks;\n\n    var hasPreSibling = function (pre) {\n      return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n    };\n\n    var joinPre = function (pre1, pre2) {\n      DomQuery(pre2).remove();\n      DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n    };\n\n    var isPre = matchNodeNames(['pre']);\n\n    if (!rng.collapsed) {\n      blocks = editor.selection.getSelectedBlocks();\n      each$b(filter(filter(blocks, isPre), hasPreSibling), function (pre) {\n        joinPre(pre.previousSibling, pre);\n      });\n    }\n  });\n  var each$a = Tools.each;\n\n  var isElementNode$1 = function (node) {\n    return isElement$5(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus$2(node);\n  };\n\n  var findElementSibling = function (node, siblingName) {\n    for (var sibling = node; sibling; sibling = sibling[siblingName]) {\n      if (isText$7(sibling) && isNotEmpty(sibling.data)) {\n        return node;\n      }\n\n      if (isElement$5(sibling) && !isBookmarkNode$1(sibling)) {\n        return sibling;\n      }\n    }\n\n    return node;\n  };\n\n  var mergeSiblingsNodes = function (dom, prev, next) {\n    var elementUtils = ElementUtils(dom);\n\n    if (prev && next) {\n      prev = findElementSibling(prev, 'previousSibling');\n      next = findElementSibling(next, 'nextSibling');\n\n      if (elementUtils.compare(prev, next)) {\n        for (var sibling = prev.nextSibling; sibling && sibling !== next;) {\n          var tmpSibling = sibling;\n          sibling = sibling.nextSibling;\n          prev.appendChild(tmpSibling);\n        }\n\n        dom.remove(next);\n        Tools.each(Tools.grep(next.childNodes), function (node) {\n          prev.appendChild(node);\n        });\n        return prev;\n      }\n    }\n\n    return next;\n  };\n\n  var mergeSiblings = function (dom, format, vars, node) {\n    if (node && format.merge_siblings !== false) {\n      var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n      mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n    }\n  };\n\n  var clearChildStyles = function (dom, format, node) {\n    if (format.clear_child_styles) {\n      var selector = format.links ? '*:not(a)' : '*';\n      each$a(dom.select(selector, node), function (node) {\n        if (isElementNode$1(node)) {\n          each$a(format.styles, function (value, name) {\n            dom.setStyle(node, name, '');\n          });\n        }\n      });\n    }\n  };\n\n  var processChildElements = function (node, filter, process) {\n    each$a(node.childNodes, function (node) {\n      if (isElementNode$1(node)) {\n        if (filter(node)) {\n          process(node);\n        }\n\n        if (node.hasChildNodes()) {\n          processChildElements(node, filter, process);\n        }\n      }\n    });\n  };\n\n  var unwrapEmptySpan = function (dom, node) {\n    if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n      dom.remove(node, true);\n    }\n  };\n\n  var hasStyle = function (dom, name) {\n    return function (node) {\n      return !!(node && getStyle(dom, node, name));\n    };\n  };\n\n  var applyStyle = function (dom, name, value) {\n    return function (node) {\n      dom.setStyle(node, name, value);\n\n      if (node.getAttribute('style') === '') {\n        node.removeAttribute('style');\n      }\n\n      unwrapEmptySpan(dom, node);\n    };\n  };\n\n  var removeResult = Adt.generate([{\n    keep: []\n  }, {\n    rename: ['name']\n  }, {\n    removed: []\n  }]);\n  var MCE_ATTR_RE = /^(src|href|style)$/;\n  var each$9 = Tools.each;\n  var isEq$2 = isEq$5;\n\n  var isTableCellOrRow = function (node) {\n    return /^(TR|TH|TD)$/.test(node.nodeName);\n  };\n\n  var isChildOfInlineParent = function (dom, node, parent) {\n    return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n  };\n\n  var getContainer = function (ed, rng, start) {\n    var container = rng[start ? 'startContainer' : 'endContainer'];\n    var offset = rng[start ? 'startOffset' : 'endOffset'];\n\n    if (isElement$5(container)) {\n      var lastIdx = container.childNodes.length - 1;\n\n      if (!start && offset) {\n        offset--;\n      }\n\n      container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n    }\n\n    if (isText$7(container) && start && offset >= container.nodeValue.length) {\n      container = new DomTreeWalker(container, ed.getBody()).next() || container;\n    }\n\n    if (isText$7(container) && !start && offset === 0) {\n      container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n    }\n\n    return container;\n  };\n\n  var normalizeTableSelection = function (node, start) {\n    var prop = start ? 'firstChild' : 'lastChild';\n\n    if (isTableCellOrRow(node) && node[prop]) {\n      var childNode = node[prop];\n\n      if (node.nodeName === 'TR') {\n        return childNode[prop] || childNode;\n      } else {\n        return childNode;\n      }\n    }\n\n    return node;\n  };\n\n  var wrap$1 = function (dom, node, name, attrs) {\n    var wrapper = dom.create(name, attrs);\n    node.parentNode.insertBefore(wrapper, node);\n    wrapper.appendChild(node);\n    return wrapper;\n  };\n\n  var wrapWithSiblings = function (dom, node, next, name, attrs) {\n    var start = SugarElement.fromDom(node);\n    var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n    var siblings = next ? nextSiblings(start) : prevSiblings(start);\n    append(wrapper, siblings);\n\n    if (next) {\n      before$4(start, wrapper);\n      prepend(wrapper, start);\n    } else {\n      after$3(start, wrapper);\n      append$1(wrapper, start);\n    }\n\n    return wrapper.dom;\n  };\n\n  var matchName = function (dom, node, format) {\n    if (isInlineFormat(format) && isEq$2(node, format.inline)) {\n      return true;\n    }\n\n    if (isBlockFormat(format) && isEq$2(node, format.block)) {\n      return true;\n    }\n\n    if (isSelectorFormat(format)) {\n      return isElement$5(node) && dom.is(node, format.selector);\n    }\n  };\n\n  var isColorFormatAndAnchor = function (node, format) {\n    return format.links && node.nodeName === 'A';\n  };\n\n  var find = function (dom, node, next, inc) {\n    var sibling = getNonWhiteSpaceSibling(node, next, inc);\n    return isNullable(sibling) || sibling.nodeName === 'BR' || dom.isBlock(sibling);\n  };\n\n  var removeNode = function (ed, node, format) {\n    var parentNode = node.parentNode;\n    var rootBlockElm;\n    var dom = ed.dom,\n        forcedRootBlock = getForcedRootBlock(ed);\n\n    if (isBlockFormat(format)) {\n      if (!forcedRootBlock) {\n        if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n          if (!find(dom, node, false) && !find(dom, node.firstChild, true, true)) {\n            node.insertBefore(dom.create('br'), node.firstChild);\n          }\n\n          if (!find(dom, node, true) && !find(dom, node.lastChild, false, true)) {\n            node.appendChild(dom.create('br'));\n          }\n        }\n      } else {\n        if (parentNode === dom.getRoot()) {\n          if (!format.list_block || !isEq$2(node, format.list_block)) {\n            each$k(from(node.childNodes), function (node) {\n              if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                if (!rootBlockElm) {\n                  rootBlockElm = wrap$1(dom, node, forcedRootBlock);\n                  dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                } else {\n                  rootBlockElm.appendChild(node);\n                }\n              } else {\n                rootBlockElm = null;\n              }\n            });\n          }\n        }\n      }\n    }\n\n    if (isMixedFormat(format) && !isEq$2(format.inline, node)) {\n      return;\n    }\n\n    dom.remove(node, true);\n  };\n\n  var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n    var stylesModified;\n    var dom = ed.dom;\n\n    if (!matchName(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n      return removeResult.keep();\n    }\n\n    var elm = node;\n\n    if (isInlineFormat(format) && format.remove === 'all' && isArray$1(format.preserve_attributes)) {\n      var attrsToPreserve = filter$4(dom.getAttribs(elm), function (attr) {\n        return contains$3(format.preserve_attributes, attr.name.toLowerCase());\n      });\n      dom.removeAllAttribs(elm);\n      each$k(attrsToPreserve, function (attr) {\n        return dom.setAttrib(elm, attr.name, attr.value);\n      });\n\n      if (attrsToPreserve.length > 0) {\n        return removeResult.rename('span');\n      }\n    }\n\n    if (format.remove !== 'all') {\n      each$9(format.styles, function (value, name) {\n        value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$2(getStyle(dom, compareNode, name), value)) {\n          dom.setStyle(elm, name, '');\n        }\n\n        stylesModified = true;\n      });\n\n      if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n        elm.removeAttribute('style');\n        elm.removeAttribute('data-mce-style');\n      }\n\n      each$9(format.attributes, function (value, name) {\n        var valueOut;\n        value = replaceVars(value, vars);\n\n        if (isNumber(name)) {\n          name = value;\n          compareNode = null;\n        }\n\n        if (format.remove_similar || !compareNode || isEq$2(dom.getAttrib(compareNode, name), value)) {\n          if (name === 'class') {\n            value = dom.getAttrib(elm, name);\n\n            if (value) {\n              valueOut = '';\n              each$k(value.split(/\\s+/), function (cls) {\n                if (/mce\\-\\w+/.test(cls)) {\n                  valueOut += (valueOut ? ' ' : '') + cls;\n                }\n              });\n\n              if (valueOut) {\n                dom.setAttrib(elm, name, valueOut);\n                return;\n              }\n            }\n          }\n\n          if (MCE_ATTR_RE.test(name)) {\n            elm.removeAttribute('data-mce-' + name);\n          }\n\n          if (name === 'style' && matchNodeNames(['li'])(elm) && dom.getStyle(elm, 'list-style-type') === 'none') {\n            elm.removeAttribute(name);\n            dom.setStyle(elm, 'list-style-type', 'none');\n            return;\n          }\n\n          if (name === 'class') {\n            elm.removeAttribute('className');\n          }\n\n          elm.removeAttribute(name);\n        }\n      });\n      each$9(format.classes, function (value) {\n        value = replaceVars(value, vars);\n\n        if (!compareNode || dom.hasClass(compareNode, value)) {\n          dom.removeClass(elm, value);\n        }\n      });\n      var attrs = dom.getAttribs(elm);\n\n      for (var i = 0; i < attrs.length; i++) {\n        var attrName = attrs[i].nodeName;\n\n        if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n          return removeResult.keep();\n        }\n      }\n    }\n\n    if (format.remove !== 'none') {\n      removeNode(ed, elm, format);\n      return removeResult.removed();\n    }\n\n    return removeResult.keep();\n  };\n\n  var removeFormat$1 = function (ed, format, vars, node, compareNode) {\n    return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n      ed.dom.rename(node, newName);\n      return true;\n    }, always);\n  };\n\n  var findFormatRoot = function (editor, container, name, vars, similar) {\n    var formatRoot;\n    each$k(getParents$2(editor.dom, container.parentNode).reverse(), function (parent) {\n      if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n        var format = matchNode(editor, parent, name, vars, similar);\n\n        if (format && format.split !== false) {\n          formatRoot = parent;\n        }\n      }\n    });\n    return formatRoot;\n  };\n\n  var removeFormatFromClone = function (editor, format, vars, clone) {\n    return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n      var fragment = editor.dom.createFragment();\n      fragment.appendChild(clone);\n      return editor.dom.rename(clone, newName);\n    }, constant(null));\n  };\n\n  var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n    var clone, lastClone, firstClone;\n    var dom = editor.dom;\n\n    if (formatRoot) {\n      var formatRootParent = formatRoot.parentNode;\n\n      for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n        clone = dom.clone(parent_1, false);\n\n        for (var i = 0; i < formatList.length; i++) {\n          clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n\n          if (clone === null) {\n            break;\n          }\n        }\n\n        if (clone) {\n          if (lastClone) {\n            clone.appendChild(lastClone);\n          }\n\n          if (!firstClone) {\n            firstClone = clone;\n          }\n\n          lastClone = clone;\n        }\n      }\n\n      if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n        container = dom.split(formatRoot, container);\n      }\n\n      if (lastClone) {\n        target.parentNode.insertBefore(lastClone, target);\n        firstClone.appendChild(target);\n\n        if (isInlineFormat(format)) {\n          mergeSiblings(dom, format, vars, lastClone);\n        }\n      }\n    }\n\n    return container;\n  };\n\n  var remove$1 = function (ed, name, vars, node, similar) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var contentEditable = true;\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var splitToFormatRoot = function (container) {\n      var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n      return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n    };\n\n    var isRemoveBookmarkNode = function (node) {\n      return isBookmarkNode$1(node) && isElement$5(node) && (node.id === '_start' || node.id === '_end');\n    };\n\n    var removeNodeFormat = function (node) {\n      return exists(formatList, function (fmt) {\n        return removeFormat$1(ed, fmt, vars, node, node);\n      });\n    };\n\n    var process = function (node) {\n      var lastContentEditable = true;\n      var hasContentEditableState = false;\n\n      if (isElement$5(node) && dom.getContentEditable(node)) {\n        lastContentEditable = contentEditable;\n        contentEditable = dom.getContentEditable(node) === 'true';\n        hasContentEditableState = true;\n      }\n\n      var children = from(node.childNodes);\n\n      if (contentEditable && !hasContentEditableState) {\n        var removed = removeNodeFormat(node);\n        var currentNodeMatches = removed || exists(formatList, function (f) {\n          return matchName$1(dom, node, f);\n        });\n        var parentNode = node.parentNode;\n\n        if (!currentNodeMatches && isNonNullable(parentNode) && shouldExpandToSelector(format)) {\n          removeNodeFormat(parentNode);\n        }\n      }\n\n      if (format.deep) {\n        if (children.length) {\n          for (var i = 0; i < children.length; i++) {\n            process(children[i]);\n          }\n\n          if (hasContentEditableState) {\n            contentEditable = lastContentEditable;\n          }\n        }\n      }\n\n      var textDecorations = ['underline', 'line-through', 'overline'];\n      each$k(textDecorations, function (decoration) {\n        if (isElement$5(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n          removeFormat$1(ed, {\n            deep: false,\n            exact: true,\n            inline: 'span',\n            styles: {\n              textDecoration: decoration\n            }\n          }, null, node);\n        }\n      });\n    };\n\n    var unwrap = function (start) {\n      var node = dom.get(start ? '_start' : '_end');\n      var out = node[start ? 'firstChild' : 'lastChild'];\n\n      if (isRemoveBookmarkNode(out)) {\n        out = out[start ? 'firstChild' : 'lastChild'];\n      }\n\n      if (isText$7(out) && out.data.length === 0) {\n        out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n      }\n\n      dom.remove(node, true);\n      return out;\n    };\n\n    var removeRngStyle = function (rng) {\n      var startContainer, endContainer;\n      var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n\n      if (format.split) {\n        expandedRng = split(expandedRng);\n        startContainer = getContainer(ed, expandedRng, true);\n        endContainer = getContainer(ed, expandedRng);\n\n        if (startContainer !== endContainer) {\n          startContainer = normalizeTableSelection(startContainer, true);\n          endContainer = normalizeTableSelection(endContainer, false);\n\n          if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n            var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(true);\n            return;\n          }\n\n          if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n            var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n            splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            }));\n            unwrap(false);\n            return;\n          }\n\n          startContainer = wrap$1(dom, startContainer, 'span', {\n            'id': '_start',\n            'data-mce-type': 'bookmark'\n          });\n          endContainer = wrap$1(dom, endContainer, 'span', {\n            'id': '_end',\n            'data-mce-type': 'bookmark'\n          });\n          var newRng = dom.createRng();\n          newRng.setStartAfter(startContainer);\n          newRng.setEndBefore(endContainer);\n          walk$2(dom, newRng, function (nodes) {\n            each$k(nodes, function (n) {\n              if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                splitToFormatRoot(n);\n              }\n            });\n          });\n          splitToFormatRoot(startContainer);\n          splitToFormatRoot(endContainer);\n          startContainer = unwrap(true);\n          endContainer = unwrap();\n        } else {\n          startContainer = endContainer = splitToFormatRoot(startContainer);\n        }\n\n        expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n        expandedRng.startOffset = dom.nodeIndex(startContainer);\n        expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n        expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n      }\n\n      walk$2(dom, expandedRng, function (nodes) {\n        each$k(nodes, process);\n      });\n    };\n\n    if (node) {\n      if (isNode(node)) {\n        var rng = dom.createRng();\n        rng.setStartBefore(node);\n        rng.setEndAfter(node);\n        removeRngStyle(rng);\n      } else {\n        removeRngStyle(node);\n      }\n\n      fireFormatRemove(ed, name, node, vars);\n      return;\n    }\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0; i < formatList.length; i++) {\n        if (formatList[i].ceFalseOverride) {\n          if (removeFormat$1(ed, formatList[i], vars, node, node)) {\n            break;\n          }\n        }\n      }\n\n      fireFormatRemove(ed, name, node, vars);\n      return;\n    }\n\n    if (!selection.isCollapsed() || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n      preserve(selection, true, function () {\n        runOnRanges(ed, removeRngStyle);\n      });\n\n      if (isInlineFormat(format) && match$2(ed, name, vars, selection.getStart())) {\n        moveStart(dom, selection, selection.getRng());\n      }\n\n      ed.nodeChanged();\n    } else {\n      removeCaretFormat(ed, name, vars, similar);\n    }\n\n    fireFormatRemove(ed, name, node, vars);\n  };\n\n  var each$8 = Tools.each;\n\n  var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n    var processTextDecorationsAndColor = function (n) {\n      if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n        var textDecoration = getTextDecoration(dom, n.parentNode);\n\n        if (dom.getStyle(n, 'color') && textDecoration) {\n          dom.setStyle(n, 'text-decoration', textDecoration);\n        } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n          dom.setStyle(n, 'text-decoration', null);\n        }\n      }\n    };\n\n    if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n      Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n      processTextDecorationsAndColor(node);\n    }\n  };\n\n  var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n    if (format.styles && format.styles.backgroundColor) {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n    }\n  };\n\n  var mergeSubSup = function (dom, format, vars, node) {\n    if (isInlineFormat(format) && (format.inline === 'sub' || format.inline === 'sup')) {\n      processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n      dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n    }\n  };\n\n  var mergeWithChildren = function (editor, formatList, vars, node) {\n    each$8(formatList, function (format) {\n      if (isInlineFormat(format)) {\n        each$8(editor.dom.select(format.inline, node), function (child) {\n          if (!isElementNode$1(child)) {\n            return;\n          }\n\n          removeFormat$1(editor, format, vars, child, format.exact ? child : null);\n        });\n      }\n\n      clearChildStyles(editor.dom, format, node);\n    });\n  };\n\n  var mergeWithParents = function (editor, format, name, vars, node) {\n    if (matchNode(editor, node.parentNode, name, vars)) {\n      if (removeFormat$1(editor, format, vars, node)) {\n        return;\n      }\n    }\n\n    if (format.merge_with_parents) {\n      editor.dom.getParent(node.parentNode, function (parent) {\n        if (matchNode(editor, parent, name, vars)) {\n          removeFormat$1(editor, format, vars, node);\n          return true;\n        }\n      });\n    }\n  };\n\n  var each$7 = Tools.each;\n\n  var isElementNode = function (node) {\n    return isElement$5(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus$2(node);\n  };\n\n  var canFormatBR = function (editor, format, node, parentName) {\n    if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n      var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n        td: {},\n        th: {},\n        li: {},\n        dt: {},\n        dd: {},\n        figcaption: {},\n        caption: {},\n        details: {},\n        summary: {}\n      });\n\n      var hasCaretNodeSibling = sibling(SugarElement.fromDom(node), function (sibling) {\n        return isCaretNode(sibling.dom);\n      });\n      return hasNonNullableKey(validBRParentElements, parentName) && isEmpty$2(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n    } else {\n      return false;\n    }\n  };\n\n  var applyFormat$1 = function (ed, name, vars, node) {\n    var formatList = ed.formatter.get(name);\n    var format = formatList[0];\n    var isCollapsed = !node && ed.selection.isCollapsed();\n    var dom = ed.dom;\n    var selection = ed.selection;\n\n    var setElementFormat = function (elm, fmt) {\n      if (fmt === void 0) {\n        fmt = format;\n      }\n\n      if (isFunction(fmt.onformat)) {\n        fmt.onformat(elm, fmt, vars, node);\n      }\n\n      each$7(fmt.styles, function (value, name) {\n        dom.setStyle(elm, name, replaceVars(value, vars));\n      });\n\n      if (fmt.styles) {\n        var styleVal = dom.getAttrib(elm, 'style');\n\n        if (styleVal) {\n          dom.setAttrib(elm, 'data-mce-style', styleVal);\n        }\n      }\n\n      each$7(fmt.attributes, function (value, name) {\n        dom.setAttrib(elm, name, replaceVars(value, vars));\n      });\n      each$7(fmt.classes, function (value) {\n        value = replaceVars(value, vars);\n\n        if (!dom.hasClass(elm, value)) {\n          dom.addClass(elm, value);\n        }\n      });\n    };\n\n    var applyNodeStyle = function (formatList, node) {\n      var found = false;\n      each$7(formatList, function (format) {\n        if (!isSelectorFormat(format)) {\n          return false;\n        }\n\n        if (isNonNullable(format.collapsed) && format.collapsed !== isCollapsed) {\n          return;\n        }\n\n        if (dom.is(node, format.selector) && !isCaretNode(node)) {\n          setElementFormat(node, format);\n          found = true;\n          return false;\n        }\n      });\n      return found;\n    };\n\n    var createWrapElement = function (wrapName) {\n      if (isString$1(wrapName)) {\n        var wrapElm = dom.create(wrapName);\n        setElementFormat(wrapElm);\n        return wrapElm;\n      } else {\n        return null;\n      }\n    };\n\n    var applyRngStyle = function (dom, rng, nodeSpecific) {\n      var newWrappers = [];\n      var contentEditable = true;\n      var wrapName = format.inline || format.block;\n      var wrapElm = createWrapElement(wrapName);\n      walk$2(dom, rng, function (nodes) {\n        var currentWrapElm;\n\n        var process = function (node) {\n          var hasContentEditableState = false;\n          var lastContentEditable = contentEditable;\n          var nodeName = node.nodeName.toLowerCase();\n          var parentNode = node.parentNode;\n          var parentName = parentNode.nodeName.toLowerCase();\n\n          if (isElement$5(node) && dom.getContentEditable(node)) {\n            lastContentEditable = contentEditable;\n            contentEditable = dom.getContentEditable(node) === 'true';\n            hasContentEditableState = true;\n          }\n\n          if (isBr$5(node) && !canFormatBR(ed, format, node, parentName)) {\n            currentWrapElm = null;\n\n            if (isBlockFormat(format)) {\n              dom.remove(node);\n            }\n\n            return;\n          }\n\n          if (isBlockFormat(format) && format.wrapper && matchNode(ed, node, name, vars)) {\n            currentWrapElm = null;\n            return;\n          }\n\n          if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n            var elm = dom.rename(node, wrapName);\n            setElementFormat(elm);\n            newWrappers.push(elm);\n            currentWrapElm = null;\n            return;\n          }\n\n          if (isSelectorFormat(format)) {\n            var found = applyNodeStyle(formatList, node);\n\n            if (!found && isNonNullable(parentNode) && shouldExpandToSelector(format)) {\n              found = applyNodeStyle(formatList, parentNode);\n            }\n\n            if (!isInlineFormat(format) || found) {\n              currentWrapElm = null;\n              return;\n            }\n          }\n\n          if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && isText$7(node) && isZwsp(node.data)) && !isCaretNode(node) && (!isInlineFormat(format) || !dom.isBlock(node))) {\n            if (!currentWrapElm) {\n              currentWrapElm = dom.clone(wrapElm, false);\n              node.parentNode.insertBefore(currentWrapElm, node);\n              newWrappers.push(currentWrapElm);\n            }\n\n            currentWrapElm.appendChild(node);\n          } else {\n            currentWrapElm = null;\n            each$k(from(node.childNodes), process);\n\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n\n            currentWrapElm = null;\n          }\n        };\n\n        each$k(nodes, process);\n      });\n\n      if (format.links === true) {\n        each$k(newWrappers, function (node) {\n          var process = function (node) {\n            if (node.nodeName === 'A') {\n              setElementFormat(node, format);\n            }\n\n            each$k(from(node.childNodes), process);\n          };\n\n          process(node);\n        });\n      }\n\n      each$k(newWrappers, function (node) {\n        var getChildCount = function (node) {\n          var count = 0;\n          each$k(node.childNodes, function (node) {\n            if (!isEmptyTextNode$1(node) && !isBookmarkNode$1(node)) {\n              count++;\n            }\n          });\n          return count;\n        };\n\n        var mergeStyles = function (node) {\n          var childElement = find$3(node.childNodes, isElementNode).filter(function (child) {\n            return matchName$1(dom, child, format);\n          });\n          return childElement.map(function (child) {\n            var clone = dom.clone(child, false);\n            setElementFormat(clone);\n            dom.replace(clone, node, true);\n            dom.remove(child, true);\n            return clone;\n          }).getOr(node);\n        };\n\n        var childCount = getChildCount(node);\n\n        if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n          dom.remove(node, true);\n          return;\n        }\n\n        if (isInlineFormat(format) || isBlockFormat(format) && format.wrapper) {\n          if (!format.exact && childCount === 1) {\n            node = mergeStyles(node);\n          }\n\n          mergeWithChildren(ed, formatList, vars, node);\n          mergeWithParents(ed, format, name, vars, node);\n          mergeBackgroundColorAndFontSize(dom, format, vars, node);\n          mergeTextDecorationsAndColor(dom, format, vars, node);\n          mergeSubSup(dom, format, vars, node);\n          mergeSiblings(dom, format, vars, node);\n        }\n      });\n    };\n\n    if (dom.getContentEditable(selection.getNode()) === 'false') {\n      node = selection.getNode();\n\n      for (var i = 0, l = formatList.length; i < l; i++) {\n        var formatItem = formatList[i];\n\n        if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n          setElementFormat(node, formatItem);\n          break;\n        }\n      }\n\n      fireFormatApply(ed, name, node, vars);\n      return;\n    }\n\n    if (format) {\n      if (node) {\n        if (isNode(node)) {\n          if (!applyNodeStyle(formatList, node)) {\n            var rng = dom.createRng();\n            rng.setStartBefore(node);\n            rng.setEndAfter(node);\n            applyRngStyle(dom, expandRng(ed, rng, formatList), true);\n          }\n        } else {\n          applyRngStyle(dom, node, true);\n        }\n      } else {\n        if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n          var curSelNode = selection.getNode();\n          var firstFormat = formatList[0];\n\n          if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n            applyFormat$1(ed, firstFormat.defaultBlock);\n          }\n\n          selection.setRng(normalize(selection.getRng()));\n          preserve(selection, true, function () {\n            runOnRanges(ed, function (selectionRng, fake) {\n              var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n              applyRngStyle(dom, expandedRng, false);\n            });\n          });\n          moveStart(dom, selection, selection.getRng());\n          ed.nodeChanged();\n        } else {\n          applyCaretFormat(ed, name, vars);\n        }\n      }\n\n      postProcess$1(name, ed);\n    }\n\n    fireFormatApply(ed, name, node, vars);\n  };\n\n  var hasVars = function (value) {\n    return has$2(value, 'vars');\n  };\n\n  var setup$j = function (registeredFormatListeners, editor) {\n    registeredFormatListeners.set({});\n    editor.on('NodeChange', function (e) {\n      updateAndFireChangeCallbacks(editor, e.element, registeredFormatListeners.get());\n    });\n    editor.on('FormatApply FormatRemove', function (e) {\n      var element = Optional.from(e.node).map(function (nodeOrRange) {\n        return isNode(nodeOrRange) ? nodeOrRange : nodeOrRange.startContainer;\n      }).bind(function (node) {\n        return isElement$5(node) ? Optional.some(node) : Optional.from(node.parentElement);\n      }).getOrThunk(function () {\n        return fallbackElement(editor);\n      });\n      updateAndFireChangeCallbacks(editor, element, registeredFormatListeners.get());\n    });\n  };\n\n  var fallbackElement = function (editor) {\n    return editor.selection.getStart();\n  };\n\n  var matchingNode = function (editor, parents, format, similar, vars) {\n    var isMatchingNode = function (node) {\n      var matchingFormat = editor.formatter.matchNode(node, format, vars !== null && vars !== void 0 ? vars : {}, similar);\n      return !isUndefined(matchingFormat);\n    };\n\n    var isUnableToMatch = function (node) {\n      if (matchesUnInheritedFormatSelector(editor, node, format)) {\n        return true;\n      } else {\n        if (!similar) {\n          return isNonNullable(editor.formatter.matchNode(node, format, vars, true));\n        } else {\n          return false;\n        }\n      }\n    };\n\n    return findUntil$1(parents, isMatchingNode, isUnableToMatch);\n  };\n\n  var getParents = function (editor, elm) {\n    var element = elm !== null && elm !== void 0 ? elm : fallbackElement(editor);\n    return filter$4(getParents$2(editor.dom, element), function (node) {\n      return isElement$5(node) && !isBogus$2(node);\n    });\n  };\n\n  var updateAndFireChangeCallbacks = function (editor, elm, registeredCallbacks) {\n    var parents = getParents(editor, elm);\n    each$j(registeredCallbacks, function (data, format) {\n      var runIfChanged = function (spec) {\n        var match = matchingNode(editor, parents, format, spec.similar, hasVars(spec) ? spec.vars : undefined);\n        var isSet = match.isSome();\n\n        if (spec.state.get() !== isSet) {\n          spec.state.set(isSet);\n          var node_1 = match.getOr(elm);\n\n          if (hasVars(spec)) {\n            spec.callback(isSet, {\n              node: node_1,\n              format: format,\n              parents: parents\n            });\n          } else {\n            each$k(spec.callbacks, function (callback) {\n              return callback(isSet, {\n                node: node_1,\n                format: format,\n                parents: parents\n              });\n            });\n          }\n        }\n      };\n\n      each$k([data.withSimilar, data.withoutSimilar], runIfChanged);\n      each$k(data.withVars, runIfChanged);\n    });\n  };\n\n  var addListeners = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each$k(formats.split(','), function (format) {\n      var group = get$9(formatChangeItems, format).getOrThunk(function () {\n        var base = {\n          withSimilar: {\n            state: Cell(false),\n            similar: true,\n            callbacks: []\n          },\n          withoutSimilar: {\n            state: Cell(false),\n            similar: false,\n            callbacks: []\n          },\n          withVars: []\n        };\n        formatChangeItems[format] = base;\n        return base;\n      });\n\n      var getCurrent = function () {\n        var parents = getParents(editor);\n        return matchingNode(editor, parents, format, similar, vars).isSome();\n      };\n\n      if (isUndefined(vars)) {\n        var toAppendTo = similar ? group.withSimilar : group.withoutSimilar;\n        toAppendTo.callbacks.push(callback);\n\n        if (toAppendTo.callbacks.length === 1) {\n          toAppendTo.state.set(getCurrent());\n        }\n      } else {\n        group.withVars.push({\n          state: Cell(getCurrent()),\n          similar: similar,\n          vars: vars,\n          callback: callback\n        });\n      }\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var removeListeners = function (registeredFormatListeners, formats, callback) {\n    var formatChangeItems = registeredFormatListeners.get();\n    each$k(formats.split(','), function (format) {\n      return get$9(formatChangeItems, format).each(function (group) {\n        formatChangeItems[format] = {\n          withSimilar: __assign(__assign({}, group.withSimilar), {\n            callbacks: filter$4(group.withSimilar.callbacks, function (cb) {\n              return cb !== callback;\n            })\n          }),\n          withoutSimilar: __assign(__assign({}, group.withoutSimilar), {\n            callbacks: filter$4(group.withoutSimilar.callbacks, function (cb) {\n              return cb !== callback;\n            })\n          }),\n          withVars: filter$4(group.withVars, function (item) {\n            return item.callback !== callback;\n          })\n        };\n      });\n    });\n    registeredFormatListeners.set(formatChangeItems);\n  };\n\n  var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n    if (registeredFormatListeners.get() === null) {\n      setup$j(registeredFormatListeners, editor);\n    }\n\n    addListeners(editor, registeredFormatListeners, formats, callback, similar, vars);\n    return {\n      unbind: function () {\n        return removeListeners(registeredFormatListeners, formats, callback);\n      }\n    };\n  };\n\n  var toggle = function (editor, name, vars, node) {\n    var fmt = editor.formatter.get(name);\n\n    if (match$2(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n      remove$1(editor, name, vars, node);\n    } else {\n      applyFormat$1(editor, name, vars, node);\n    }\n  };\n\n  var fromElements = function (elements, scope) {\n    var doc = scope || document;\n    var fragment = doc.createDocumentFragment();\n    each$k(elements, function (element) {\n      fragment.appendChild(element.dom);\n    });\n    return SugarElement.fromDom(fragment);\n  };\n\n  var tableModel = function (element, width, rows) {\n    return {\n      element: element,\n      width: width,\n      rows: rows\n    };\n  };\n\n  var tableRow = function (element, cells) {\n    return {\n      element: element,\n      cells: cells\n    };\n  };\n\n  var cellPosition = function (x, y) {\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var getSpan = function (td, key) {\n    var value = parseInt(get$6(td, key), 10);\n    return isNaN(value) ? 1 : value;\n  };\n\n  var fillout = function (table, x, y, tr, td) {\n    var rowspan = getSpan(td, 'rowspan');\n    var colspan = getSpan(td, 'colspan');\n    var rows = table.rows;\n\n    for (var y2 = y; y2 < y + rowspan; y2++) {\n      if (!rows[y2]) {\n        rows[y2] = tableRow(deep$1(tr), []);\n      }\n\n      for (var x2 = x; x2 < x + colspan; x2++) {\n        var cells = rows[y2].cells;\n        cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n      }\n    }\n  };\n\n  var cellExists = function (table, x, y) {\n    var rows = table.rows;\n    var cells = rows[y] ? rows[y].cells : [];\n    return !!cells[x];\n  };\n\n  var skipCellsX = function (table, x, y) {\n    while (cellExists(table, x, y)) {\n      x++;\n    }\n\n    return x;\n  };\n\n  var getWidth = function (rows) {\n    return foldl(rows, function (acc, row) {\n      return row.cells.length > acc ? row.cells.length : acc;\n    }, 0);\n  };\n\n  var findElementPos = function (table, element) {\n    var rows = table.rows;\n\n    for (var y = 0; y < rows.length; y++) {\n      var cells = rows[y].cells;\n\n      for (var x = 0; x < cells.length; x++) {\n        if (eq(cells[x], element)) {\n          return Optional.some(cellPosition(x, y));\n        }\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var extractRows = function (table, sx, sy, ex, ey) {\n    var newRows = [];\n    var rows = table.rows;\n\n    for (var y = sy; y <= ey; y++) {\n      var cells = rows[y].cells;\n      var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n      newRows.push(tableRow(rows[y].element, slice));\n    }\n\n    return newRows;\n  };\n\n  var subTable = function (table, startPos, endPos) {\n    var sx = startPos.x,\n        sy = startPos.y;\n    var ex = endPos.x,\n        ey = endPos.y;\n    var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n    return tableModel(table.element, getWidth(newRows), newRows);\n  };\n\n  var createDomTable = function (table, rows) {\n    var tableElement = shallow(table.element);\n    var tableBody = SugarElement.fromTag('tbody');\n    append(tableBody, rows);\n    append$1(tableElement, tableBody);\n    return tableElement;\n  };\n\n  var modelRowsToDomRows = function (table) {\n    return map$3(table.rows, function (row) {\n      var cells = map$3(row.cells, function (cell) {\n        var td = deep$1(cell);\n        remove$6(td, 'colspan');\n        remove$6(td, 'rowspan');\n        return td;\n      });\n      var tr = shallow(row.element);\n      append(tr, cells);\n      return tr;\n    });\n  };\n\n  var fromDom = function (tableElm) {\n    var table = tableModel(shallow(tableElm), 0, []);\n    each$k(descendants(tableElm, 'tr'), function (tr, y) {\n      each$k(descendants(tr, 'td,th'), function (td, x) {\n        fillout(table, skipCellsX(table, x, y), y, tr, td);\n      });\n    });\n    return tableModel(table.element, getWidth(table.rows), table.rows);\n  };\n\n  var toDom = function (table) {\n    return createDomTable(table, modelRowsToDomRows(table));\n  };\n\n  var subsection = function (table, startElement, endElement) {\n    return findElementPos(table, startElement).bind(function (startPos) {\n      return findElementPos(table, endElement).map(function (endPos) {\n        return subTable(table, startPos, endPos);\n      });\n    });\n  };\n\n  var findParentListContainer = function (parents) {\n    return find$3(parents, function (elm) {\n      return name(elm) === 'ul' || name(elm) === 'ol';\n    });\n  };\n\n  var getFullySelectedListWrappers = function (parents, rng) {\n    return find$3(parents, function (elm) {\n      return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n    }).fold(constant([]), function (_li) {\n      return findParentListContainer(parents).map(function (listCont) {\n        var listElm = SugarElement.fromTag(name(listCont));\n        var listStyles = filter$3(getAllRaw(listCont), function (_style, name) {\n          return startsWith(name, 'list-style');\n        });\n        setAll(listElm, listStyles);\n        return [SugarElement.fromTag('li'), listElm];\n      }).getOr([]);\n    });\n  };\n\n  var wrap = function (innerElm, elms) {\n    var wrapped = foldl(elms, function (acc, elm) {\n      append$1(elm, acc);\n      return elm;\n    }, innerElm);\n    return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n  };\n\n  var directListWrappers = function (commonAnchorContainer) {\n    if (isListItem(commonAnchorContainer)) {\n      return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n        return [commonAnchorContainer, listElm];\n      });\n    } else {\n      return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n    }\n  };\n\n  var getWrapElements = function (rootNode, rng) {\n    var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n    var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n    var wrapElements = filter$4(parents, function (elm) {\n      return isInline$1(elm) || isHeading(elm);\n    });\n    var listWrappers = getFullySelectedListWrappers(parents, rng);\n    var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n    return map$3(allWrappers, shallow);\n  };\n\n  var emptyFragment = function () {\n    return fromElements([]);\n  };\n\n  var getFragmentFromRange = function (rootNode, rng) {\n    return wrap(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n  };\n\n  var getParentTable = function (rootElm, cell) {\n    return ancestor$2(cell, 'table', curry(eq, rootElm));\n  };\n\n  var getTableFragment = function (rootNode, selectedTableCells) {\n    return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n      var firstCell = selectedTableCells[0];\n      var lastCell = selectedTableCells[selectedTableCells.length - 1];\n      var fullTableModel = fromDom(tableElm);\n      return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n        return fromElements([toDom(sectionedTableModel)]);\n      });\n    }).getOrThunk(emptyFragment);\n  };\n\n  var getSelectionFragment = function (rootNode, ranges) {\n    return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n  };\n\n  var read$3 = function (rootNode, ranges) {\n    var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n    return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n  };\n\n  var trimLeadingCollapsibleText = function (text) {\n    return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n  };\n\n  var isCollapsibleWhitespace = function (text, index) {\n    return index >= 0 && index < text.length && isWhiteSpace(text.charAt(index));\n  };\n\n  var getInnerText = function (bin, shouldTrim) {\n    var text = trim$2(bin.innerText);\n    return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n  };\n\n  var getContextNodeName = function (parentBlockOpt) {\n    return parentBlockOpt.map(function (block) {\n      return block.nodeName;\n    }).getOr('div').toLowerCase();\n  };\n\n  var getTextContent = function (editor) {\n    return Optional.from(editor.selection.getRng()).map(function (rng) {\n      var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n      var body = editor.getBody();\n      var contextNodeName = getContextNodeName(parentBlockOpt);\n      var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n      var bin = editor.dom.add(body, contextNodeName, {\n        'data-mce-bogus': 'all',\n        'style': 'overflow: hidden; opacity: 0;'\n      }, rng.cloneContents());\n      var text = getInnerText(bin, shouldTrimSpaces);\n      var nonRenderedText = trim$2(bin.textContent);\n      editor.dom.remove(bin);\n\n      if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n        var parentBlock = parentBlockOpt.getOr(body);\n        var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n        var textIndex = parentBlockText.indexOf(text);\n\n        if (textIndex === -1) {\n          return text;\n        } else {\n          var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n          var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n          return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n        }\n      } else {\n        return text;\n      }\n    }).getOr('');\n  };\n\n  var getSerializedContent = function (editor, args) {\n    var rng = editor.selection.getRng(),\n        tmpElm = editor.dom.create('body');\n    var sel = editor.selection.getSel();\n    var ranges = processRanges(editor, getRanges(sel));\n    var fragment = args.contextual ? read$3(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n\n    if (fragment) {\n      tmpElm.appendChild(fragment);\n    }\n\n    return editor.selection.serializer.serialize(tmpElm, args);\n  };\n\n  var setupArgs$1 = function (args, format) {\n    return __assign(__assign({}, args), {\n      format: format,\n      get: true,\n      selection: true\n    });\n  };\n\n  var getSelectedContentInternal = function (editor, format, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var defaultedArgs = setupArgs$1(args, format);\n    var updatedArgs = editor.fire('BeforeGetContent', defaultedArgs);\n\n    if (updatedArgs.isDefaultPrevented()) {\n      editor.fire('GetContent', updatedArgs);\n      return updatedArgs.content;\n    }\n\n    if (updatedArgs.format === 'text') {\n      return getTextContent(editor);\n    } else {\n      updatedArgs.getInner = true;\n      var content = getSerializedContent(editor, updatedArgs);\n\n      if (updatedArgs.format === 'tree') {\n        return content;\n      } else {\n        updatedArgs.content = editor.selection.isCollapsed() ? '' : content;\n        editor.fire('GetContent', updatedArgs);\n        return updatedArgs.content;\n      }\n    }\n  };\n\n  var KEEP = 0,\n      INSERT = 1,\n      DELETE = 2;\n\n  var diff = function (left, right) {\n    var size = left.length + right.length + 2;\n    var vDown = new Array(size);\n    var vUp = new Array(size);\n\n    var snake = function (start, end, diag) {\n      return {\n        start: start,\n        end: end,\n        diag: diag\n      };\n    };\n\n    var buildScript = function (start1, end1, start2, end2, script) {\n      var middle = getMiddleSnake(start1, end1, start2, end2);\n\n      if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n        var i = start1;\n        var j = start2;\n\n        while (i < end1 || j < end2) {\n          if (i < end1 && j < end2 && left[i] === right[j]) {\n            script.push([KEEP, left[i]]);\n            ++i;\n            ++j;\n          } else {\n            if (end1 - start1 > end2 - start2) {\n              script.push([DELETE, left[i]]);\n              ++i;\n            } else {\n              script.push([INSERT, right[j]]);\n              ++j;\n            }\n          }\n        }\n      } else {\n        buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n\n        for (var i2 = middle.start; i2 < middle.end; ++i2) {\n          script.push([KEEP, left[i2]]);\n        }\n\n        buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n      }\n    };\n\n    var buildSnake = function (start, diag, end1, end2) {\n      var end = start;\n\n      while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n        ++end;\n      }\n\n      return snake(start, end, diag);\n    };\n\n    var getMiddleSnake = function (start1, end1, start2, end2) {\n      var m = end1 - start1;\n      var n = end2 - start2;\n\n      if (m === 0 || n === 0) {\n        return null;\n      }\n\n      var delta = m - n;\n      var sum = n + m;\n      var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n      vDown[1 + offset] = start1;\n      vUp[1 + offset] = end1 + 1;\n      var d, k, i, x, y;\n\n      for (d = 0; d <= offset; ++d) {\n        for (k = -d; k <= d; k += 2) {\n          i = k + offset;\n\n          if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n            vDown[i] = vDown[i + 1];\n          } else {\n            vDown[i] = vDown[i - 1] + 1;\n          }\n\n          x = vDown[i];\n          y = x - start1 + start2 - k;\n\n          while (x < end1 && y < end2 && left[x] === right[y]) {\n            vDown[i] = ++x;\n            ++y;\n          }\n\n          if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n            if (vUp[i - delta] <= vDown[i]) {\n              return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n\n        for (k = delta - d; k <= delta + d; k += 2) {\n          i = k + offset - delta;\n\n          if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n            vUp[i] = vUp[i + 1] - 1;\n          } else {\n            vUp[i] = vUp[i - 1];\n          }\n\n          x = vUp[i] - 1;\n          y = x - start1 + start2 - k;\n\n          while (x >= start1 && y >= start2 && left[x] === right[y]) {\n            vUp[i] = x--;\n            y--;\n          }\n\n          if (delta % 2 === 0 && -d <= k && k <= d) {\n            if (vUp[i] <= vDown[i + delta]) {\n              return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n            }\n          }\n        }\n      }\n    };\n\n    var script = [];\n    buildScript(0, left.length, 0, right.length, script);\n    return script;\n  };\n\n  var getOuterHtml = function (elm) {\n    if (isElement$5(elm)) {\n      return elm.outerHTML;\n    } else if (isText$7(elm)) {\n      return Entities.encodeRaw(elm.data, false);\n    } else if (isComment(elm)) {\n      return '<!--' + elm.data + '-->';\n    }\n\n    return '';\n  };\n\n  var createFragment = function (html) {\n    var node;\n    var container = document.createElement('div');\n    var frag = document.createDocumentFragment();\n\n    if (html) {\n      container.innerHTML = html;\n    }\n\n    while (node = container.firstChild) {\n      frag.appendChild(node);\n    }\n\n    return frag;\n  };\n\n  var insertAt = function (elm, html, index) {\n    var fragment = createFragment(html);\n\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.insertBefore(fragment, target);\n    } else {\n      elm.appendChild(fragment);\n    }\n  };\n\n  var removeAt = function (elm, index) {\n    if (elm.hasChildNodes() && index < elm.childNodes.length) {\n      var target = elm.childNodes[index];\n      target.parentNode.removeChild(target);\n    }\n  };\n\n  var applyDiff = function (diff, elm) {\n    var index = 0;\n    each$k(diff, function (action) {\n      if (action[0] === KEEP) {\n        index++;\n      } else if (action[0] === INSERT) {\n        insertAt(elm, action[1], index);\n        index++;\n      } else if (action[0] === DELETE) {\n        removeAt(elm, index);\n      }\n    });\n  };\n\n  var read$2 = function (elm) {\n    return filter$4(map$3(from(elm.childNodes), getOuterHtml), function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var write = function (fragments, elm) {\n    var currentFragments = map$3(from(elm.childNodes), getOuterHtml);\n    applyDiff(diff(currentFragments, fragments), elm);\n    return elm;\n  };\n\n  var lazyTempDocument = cached(function () {\n    return document.implementation.createHTMLDocument('undo');\n  });\n\n  var hasIframes = function (html) {\n    return html.indexOf('</iframe>') !== -1;\n  };\n\n  var createFragmentedLevel = function (fragments) {\n    return {\n      type: 'fragmented',\n      fragments: fragments,\n      content: '',\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createCompleteLevel = function (content) {\n    return {\n      type: 'complete',\n      fragments: null,\n      content: content,\n      bookmark: null,\n      beforeBookmark: null\n    };\n  };\n\n  var createFromEditor = function (editor) {\n    var fragments = read$2(editor.getBody());\n    var trimmedFragments = bind(fragments, function (html) {\n      var trimmed = trimInternal(editor.serializer, html);\n      return trimmed.length > 0 ? [trimmed] : [];\n    });\n    var content = trimmedFragments.join('');\n    return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n  };\n\n  var applyToEditor = function (editor, level, before) {\n    var bookmark = before ? level.beforeBookmark : level.bookmark;\n\n    if (level.type === 'fragmented') {\n      write(level.fragments, editor.getBody());\n    } else {\n      editor.setContent(level.content, {\n        format: 'raw',\n        no_selection: isNonNullable(bookmark) && isPathBookmark(bookmark) ? !bookmark.isFakeCaret : true\n      });\n    }\n\n    editor.selection.moveToBookmark(bookmark);\n  };\n\n  var getLevelContent = function (level) {\n    return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n  };\n\n  var getCleanLevelContent = function (level) {\n    var elm = SugarElement.fromTag('body', lazyTempDocument());\n    set(elm, getLevelContent(level));\n    each$k(descendants(elm, '*[data-mce-bogus]'), unwrap);\n    return get$3(elm);\n  };\n\n  var hasEqualContent = function (level1, level2) {\n    return getLevelContent(level1) === getLevelContent(level2);\n  };\n\n  var hasEqualCleanedContent = function (level1, level2) {\n    return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n  };\n\n  var isEq$1 = function (level1, level2) {\n    if (!level1 || !level2) {\n      return false;\n    } else if (hasEqualContent(level1, level2)) {\n      return true;\n    } else {\n      return hasEqualCleanedContent(level1, level2);\n    }\n  };\n\n  var isUnlocked = function (locks) {\n    return locks.get() === 0;\n  };\n\n  var setTyping = function (undoManager, typing, locks) {\n    if (isUnlocked(locks)) {\n      undoManager.typing = typing;\n    }\n  };\n\n  var endTyping = function (undoManager, locks) {\n    if (undoManager.typing) {\n      setTyping(undoManager, false, locks);\n      undoManager.add();\n    }\n  };\n\n  var endTypingLevelIgnoreLocks = function (undoManager) {\n    if (undoManager.typing) {\n      undoManager.typing = false;\n      undoManager.add();\n    }\n  };\n\n  var beforeChange$1 = function (editor, locks, beforeBookmark) {\n    if (isUnlocked(locks)) {\n      beforeBookmark.set(getUndoBookmark(editor.selection));\n    }\n  };\n\n  var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    var currentLevel = createFromEditor(editor);\n    level = level || {};\n    level = Tools.extend(level, currentLevel);\n\n    if (isUnlocked(locks) === false || editor.removed) {\n      return null;\n    }\n\n    var lastLevel = undoManager.data[index.get()];\n\n    if (editor.fire('BeforeAddUndo', {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    }).isDefaultPrevented()) {\n      return null;\n    }\n\n    if (lastLevel && isEq$1(lastLevel, level)) {\n      return null;\n    }\n\n    if (undoManager.data[index.get()]) {\n      beforeBookmark.get().each(function (bm) {\n        undoManager.data[index.get()].beforeBookmark = bm;\n      });\n    }\n\n    var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n\n    if (customUndoRedoLevels) {\n      if (undoManager.data.length > customUndoRedoLevels) {\n        for (var i = 0; i < undoManager.data.length - 1; i++) {\n          undoManager.data[i] = undoManager.data[i + 1];\n        }\n\n        undoManager.data.length--;\n        index.set(undoManager.data.length);\n      }\n    }\n\n    level.bookmark = getUndoBookmark(editor.selection);\n\n    if (index.get() < undoManager.data.length - 1) {\n      undoManager.data.length = index.get() + 1;\n    }\n\n    undoManager.data.push(level);\n    index.set(undoManager.data.length - 1);\n    var args = {\n      level: level,\n      lastLevel: lastLevel,\n      originalEvent: event\n    };\n\n    if (index.get() > 0) {\n      editor.setDirty(true);\n      editor.fire('AddUndo', args);\n      editor.fire('change', args);\n    } else {\n      editor.fire('AddUndo', args);\n    }\n\n    return level;\n  };\n\n  var clear$1 = function (editor, undoManager, index) {\n    undoManager.data = [];\n    index.set(0);\n    undoManager.typing = false;\n    editor.fire('ClearUndos');\n  };\n\n  var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n    if (undoManager.transact(callback1)) {\n      var bookmark = undoManager.data[index.get()].bookmark;\n      var lastLevel = undoManager.data[index.get() - 1];\n      applyToEditor(editor, lastLevel, true);\n\n      if (undoManager.transact(callback2)) {\n        undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n      }\n    }\n  };\n\n  var redo$1 = function (editor, index, data) {\n    var level;\n\n    if (index.get() < data.length - 1) {\n      index.set(index.get() + 1);\n      level = data[index.get()];\n      applyToEditor(editor, level, false);\n      editor.setDirty(true);\n      editor.fire('Redo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var undo$1 = function (editor, undoManager, locks, index) {\n    var level;\n\n    if (undoManager.typing) {\n      undoManager.add();\n      undoManager.typing = false;\n      setTyping(undoManager, false, locks);\n    }\n\n    if (index.get() > 0) {\n      index.set(index.get() - 1);\n      level = undoManager.data[index.get()];\n      applyToEditor(editor, level, true);\n      editor.setDirty(true);\n      editor.fire('Undo', {\n        level: level\n      });\n    }\n\n    return level;\n  };\n\n  var reset$1 = function (undoManager) {\n    undoManager.clear();\n    undoManager.add();\n  };\n\n  var hasUndo$1 = function (editor, undoManager, index) {\n    return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$1(createFromEditor(editor), undoManager.data[0]);\n  };\n\n  var hasRedo$1 = function (undoManager, index) {\n    return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n  };\n\n  var transact$1 = function (undoManager, locks, callback) {\n    endTyping(undoManager, locks);\n    undoManager.beforeChange();\n    undoManager.ignore(callback);\n    return undoManager.add();\n  };\n\n  var ignore$1 = function (locks, callback) {\n    try {\n      locks.set(locks.get() + 1);\n      callback();\n    } finally {\n      locks.set(locks.get() - 1);\n    }\n  };\n\n  var addVisualInternal = function (editor, elm) {\n    var dom = editor.dom;\n    var scope = isNonNullable(elm) ? elm : editor.getBody();\n\n    if (isUndefined(editor.hasVisual)) {\n      editor.hasVisual = isVisualAidsEnabled(editor);\n    }\n\n    each$k(dom.select('table,a', scope), function (matchedElm) {\n      switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n\n          break;\n\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n\n          break;\n      }\n    });\n    editor.fire('VisualAid', {\n      element: elm,\n      hasVisual: editor.hasVisual\n    });\n  };\n\n  var makePlainAdaptor = function (editor) {\n    return {\n      undoManager: {\n        beforeChange: function (locks, beforeBookmark) {\n          return beforeChange$1(editor, locks, beforeBookmark);\n        },\n        add: function (undoManager, index, locks, beforeBookmark, level, event) {\n          return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function (undoManager, locks, index) {\n          return undo$1(editor, undoManager, locks, index);\n        },\n        redo: function (index, data) {\n          return redo$1(editor, index, data);\n        },\n        clear: function (undoManager, index) {\n          return clear$1(editor, undoManager, index);\n        },\n        reset: function (undoManager) {\n          return reset$1(undoManager);\n        },\n        hasUndo: function (undoManager, index) {\n          return hasUndo$1(editor, undoManager, index);\n        },\n        hasRedo: function (undoManager, index) {\n          return hasRedo$1(undoManager, index);\n        },\n        transact: function (undoManager, locks, callback) {\n          return transact$1(undoManager, locks, callback);\n        },\n        ignore: function (locks, callback) {\n          return ignore$1(locks, callback);\n        },\n        extra: function (undoManager, index, callback1, callback2) {\n          return extra$1(editor, undoManager, index, callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, node, similar) {\n          return match$2(editor, name, vars, node, similar);\n        },\n        matchAll: function (names, vars) {\n          return matchAll(editor, names, vars);\n        },\n        matchNode: function (node, name, vars, similar) {\n          return matchNode(editor, node, name, vars, similar);\n        },\n        canApply: function (name) {\n          return canApply(editor, name);\n        },\n        closest: function (names) {\n          return closest(editor, names);\n        },\n        apply: function (name, vars, node) {\n          return applyFormat$1(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          return remove$1(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          return toggle(editor, name, vars, node);\n        },\n        formatChanged: function (registeredFormatListeners, formats, callback, similar, vars) {\n          return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar, vars);\n        }\n      },\n      editor: {\n        getContent: function (args, format) {\n          return getContentInternal(editor, args, format);\n        },\n        setContent: function (content, args) {\n          return setContentInternal(editor, content, args);\n        },\n        insertContent: function (value, details) {\n          return insertHtmlAtCaret(editor, value, details);\n        },\n        addVisual: function (elm) {\n          return addVisualInternal(editor, elm);\n        }\n      },\n      selection: {\n        getContent: function (format, args) {\n          return getSelectedContentInternal(editor, format, args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.none();\n        }\n      }\n    };\n  };\n\n  var makeRtcAdaptor = function (rtcEditor) {\n    var defaultVars = function (vars) {\n      return isObject(vars) ? vars : {};\n    };\n\n    var undoManager = rtcEditor.undoManager,\n        formatter = rtcEditor.formatter,\n        editor = rtcEditor.editor,\n        selection = rtcEditor.selection,\n        raw = rtcEditor.raw;\n    return {\n      undoManager: {\n        beforeChange: undoManager.beforeChange,\n        add: undoManager.add,\n        undo: undoManager.undo,\n        redo: undoManager.redo,\n        clear: undoManager.clear,\n        reset: undoManager.reset,\n        hasUndo: undoManager.hasUndo,\n        hasRedo: undoManager.hasRedo,\n        transact: function (_undoManager, _locks, fn) {\n          return undoManager.transact(fn);\n        },\n        ignore: function (_locks, callback) {\n          return undoManager.ignore(callback);\n        },\n        extra: function (_undoManager, _index, callback1, callback2) {\n          return undoManager.extra(callback1, callback2);\n        }\n      },\n      formatter: {\n        match: function (name, vars, _node, similar) {\n          return formatter.match(name, defaultVars(vars), similar);\n        },\n        matchAll: formatter.matchAll,\n        matchNode: formatter.matchNode,\n        canApply: function (name) {\n          return formatter.canApply(name);\n        },\n        closest: function (names) {\n          return formatter.closest(names);\n        },\n        apply: function (name, vars, _node) {\n          return formatter.apply(name, defaultVars(vars));\n        },\n        remove: function (name, vars, _node, _similar) {\n          return formatter.remove(name, defaultVars(vars));\n        },\n        toggle: function (name, vars, _node) {\n          return formatter.toggle(name, defaultVars(vars));\n        },\n        formatChanged: function (_rfl, formats, callback, similar, vars) {\n          return formatter.formatChanged(formats, callback, similar, vars);\n        }\n      },\n      editor: {\n        getContent: function (args, _format) {\n          return editor.getContent(args);\n        },\n        setContent: function (content, args) {\n          return editor.setContent(content, args);\n        },\n        insertContent: function (content, _details) {\n          return editor.insertContent(content);\n        },\n        addVisual: editor.addVisual\n      },\n      selection: {\n        getContent: function (_format, args) {\n          return selection.getContent(args);\n        }\n      },\n      raw: {\n        getModel: function () {\n          return Optional.some(raw.getRawModel());\n        }\n      }\n    };\n  };\n\n  var makeNoopAdaptor = function () {\n    var nul = constant(null);\n    var empty = constant('');\n    return {\n      undoManager: {\n        beforeChange: noop,\n        add: nul,\n        undo: nul,\n        redo: nul,\n        clear: noop,\n        reset: noop,\n        hasUndo: never,\n        hasRedo: never,\n        transact: nul,\n        ignore: noop,\n        extra: noop\n      },\n      formatter: {\n        match: never,\n        matchAll: constant([]),\n        matchNode: constant(undefined),\n        canApply: never,\n        closest: empty,\n        apply: noop,\n        remove: noop,\n        toggle: noop,\n        formatChanged: constant({\n          unbind: noop\n        })\n      },\n      editor: {\n        getContent: empty,\n        setContent: empty,\n        insertContent: noop,\n        addVisual: noop\n      },\n      selection: {\n        getContent: empty\n      },\n      raw: {\n        getModel: constant(Optional.none())\n      }\n    };\n  };\n\n  var isRtc = function (editor) {\n    return has$2(editor.plugins, 'rtc');\n  };\n\n  var getRtcSetup = function (editor) {\n    return get$9(editor.plugins, 'rtc').bind(function (rtcPlugin) {\n      return Optional.from(rtcPlugin.setup);\n    });\n  };\n\n  var setup$i = function (editor) {\n    var editorCast = editor;\n    return getRtcSetup(editor).fold(function () {\n      editorCast.rtcInstance = makePlainAdaptor(editor);\n      return Optional.none();\n    }, function (setup) {\n      editorCast.rtcInstance = makeNoopAdaptor();\n      return Optional.some(function () {\n        return setup().then(function (rtcEditor) {\n          editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n          return rtcEditor.rtc.isRemote;\n        });\n      });\n    });\n  };\n\n  var getRtcInstanceWithFallback = function (editor) {\n    return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n  };\n\n  var getRtcInstanceWithError = function (editor) {\n    var rtcInstance = editor.rtcInstance;\n\n    if (!rtcInstance) {\n      throw new Error('Failed to get RTC instance not yet initialized.');\n    } else {\n      return rtcInstance;\n    }\n  };\n\n  var beforeChange = function (editor, locks, beforeBookmark) {\n    getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n  };\n\n  var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n    return getRtcInstanceWithError(editor).undoManager.add(undoManager, index, locks, beforeBookmark, level, event);\n  };\n\n  var undo = function (editor, undoManager, locks, index) {\n    return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n  };\n\n  var redo = function (editor, index, data) {\n    return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n  };\n\n  var clear = function (editor, undoManager, index) {\n    getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n  };\n\n  var reset = function (editor, undoManager) {\n    getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n  };\n\n  var hasUndo = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n  };\n\n  var hasRedo = function (editor, undoManager, index) {\n    return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n  };\n\n  var transact = function (editor, undoManager, locks, callback) {\n    return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n  };\n\n  var ignore = function (editor, locks, callback) {\n    getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n  };\n\n  var extra = function (editor, undoManager, index, callback1, callback2) {\n    getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n  };\n\n  var matchFormat = function (editor, name, vars, node, similar) {\n    return getRtcInstanceWithError(editor).formatter.match(name, vars, node, similar);\n  };\n\n  var matchAllFormats = function (editor, names, vars) {\n    return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n  };\n\n  var matchNodeFormat = function (editor, node, name, vars, similar) {\n    return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n  };\n\n  var canApplyFormat = function (editor, name) {\n    return getRtcInstanceWithError(editor).formatter.canApply(name);\n  };\n\n  var closestFormat = function (editor, names) {\n    return getRtcInstanceWithError(editor).formatter.closest(names);\n  };\n\n  var applyFormat = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n  };\n\n  var removeFormat = function (editor, name, vars, node, similar) {\n    getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n  };\n\n  var toggleFormat = function (editor, name, vars, node) {\n    getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n  };\n\n  var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n    return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar, vars);\n  };\n\n  var getContent$2 = function (editor, args, format) {\n    return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n  };\n\n  var setContent$2 = function (editor, content, args) {\n    return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n  };\n\n  var insertContent = function (editor, value, details) {\n    return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n  };\n\n  var getSelectedContent = function (editor, format, args) {\n    return getRtcInstanceWithError(editor).selection.getContent(format, args);\n  };\n\n  var addVisual$1 = function (editor, elm) {\n    return getRtcInstanceWithError(editor).editor.addVisual(elm);\n  };\n\n  var getContent$1 = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : 'html';\n    return getSelectedContent(editor, format, args);\n  };\n\n  var removeEmpty = function (text) {\n    if (text.dom.length === 0) {\n      remove$7(text);\n      return Optional.none();\n    } else {\n      return Optional.some(text);\n    }\n  };\n\n  var walkPastBookmark = function (node, start) {\n    return node.filter(function (elm) {\n      return BookmarkManager.isBookmarkNode(elm.dom);\n    }).bind(start ? nextSibling : prevSibling);\n  };\n\n  var merge = function (outer, inner, rng, start) {\n    var outerElm = outer.dom;\n    var innerElm = inner.dom;\n    var oldLength = start ? outerElm.length : innerElm.length;\n\n    if (start) {\n      mergeTextNodes(outerElm, innerElm, false, !start);\n      rng.setStart(innerElm, oldLength);\n    } else {\n      mergeTextNodes(innerElm, outerElm, false, !start);\n      rng.setEnd(innerElm, oldLength);\n    }\n  };\n\n  var normalizeTextIfRequired = function (inner, start) {\n    parent(inner).each(function (root) {\n      var text = inner.dom;\n\n      if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n        normalizeWhitespaceAfter(text, 0);\n      } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n        normalizeWhitespaceBefore(text, text.length);\n      }\n    });\n  };\n\n  var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n    outerNode.bind(function (outer) {\n      var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n      normalizer(outer.dom, start ? outer.dom.length : 0);\n      return innerNode.filter(isText$8).map(function (inner) {\n        return merge(outer, inner, rng, start);\n      });\n    }).orThunk(function () {\n      var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText$8);\n      return innerTextNode.map(function (inner) {\n        return normalizeTextIfRequired(inner, start);\n      });\n    });\n  };\n\n  var rngSetContent = function (rng, fragment) {\n    var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n    var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n    rng.deleteContents();\n    rng.insertNode(fragment);\n    var prevText = firstChild.bind(prevSibling).filter(isText$8).bind(removeEmpty);\n    var nextText = lastChild.bind(nextSibling).filter(isText$8).bind(removeEmpty);\n    mergeAndNormalizeText(prevText, firstChild, rng, true);\n    mergeAndNormalizeText(nextText, lastChild, rng, false);\n    rng.collapse(false);\n  };\n\n  var setupArgs = function (args, content) {\n    return __assign(__assign({\n      format: 'html'\n    }, args), {\n      set: true,\n      selection: true,\n      content: content\n    });\n  };\n\n  var cleanContent = function (editor, args) {\n    if (args.format !== 'raw') {\n      var rng = editor.selection.getRng();\n      var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n      var contextArgs = contextBlock ? {\n        context: contextBlock.nodeName.toLowerCase()\n      } : {};\n      var node = editor.parser.parse(args.content, __assign(__assign({\n        isRootContent: true,\n        forced_root_block: false\n      }, contextArgs), args));\n      return HtmlSerializer({\n        validate: editor.validate\n      }, editor.schema).serialize(node);\n    } else {\n      return args.content;\n    }\n  };\n\n  var setContent$1 = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var defaultedArgs = setupArgs(args, content);\n    var updatedArgs = defaultedArgs;\n\n    if (!defaultedArgs.no_events) {\n      var eventArgs = editor.fire('BeforeSetContent', defaultedArgs);\n\n      if (eventArgs.isDefaultPrevented()) {\n        editor.fire('SetContent', eventArgs);\n        return;\n      } else {\n        updatedArgs = eventArgs;\n      }\n    }\n\n    updatedArgs.content = cleanContent(editor, updatedArgs);\n    var rng = editor.selection.getRng();\n    rngSetContent(rng, rng.createContextualFragment(updatedArgs.content));\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n\n    if (!updatedArgs.no_events) {\n      editor.fire('SetContent', updatedArgs);\n    }\n  };\n\n  var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n    if (callbackMap && has$2(callbackMap, selector)) {\n      var newCallbacks = filter$4(callbackMap[selector], function (cb) {\n        return cb !== callback;\n      });\n\n      if (newCallbacks.length === 0) {\n        delete callbackMap[selector];\n      } else {\n        callbackMap[selector] = newCallbacks;\n      }\n    }\n  };\n\n  function SelectorChanged(dom, editor) {\n    var selectorChangedData;\n    var currentSelectors;\n\n    var findMatchingNode = function (selector, nodes) {\n      return find$3(nodes, function (node) {\n        return dom.is(node, selector);\n      });\n    };\n\n    var getParents = function (elem) {\n      return dom.getParents(elem, null, dom.getRoot());\n    };\n\n    return {\n      selectorChangedWithUnbind: function (selector, callback) {\n        if (!selectorChangedData) {\n          selectorChangedData = {};\n          currentSelectors = {};\n          editor.on('NodeChange', function (e) {\n            var node = e.element;\n            var parents = getParents(node);\n            var matchedSelectors = {};\n            Tools.each(selectorChangedData, function (callbacks, selector) {\n              findMatchingNode(selector, parents).each(function (node) {\n                if (!currentSelectors[selector]) {\n                  each$k(callbacks, function (callback) {\n                    callback(true, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                  currentSelectors[selector] = callbacks;\n                }\n\n                matchedSelectors[selector] = callbacks;\n              });\n            });\n            Tools.each(currentSelectors, function (callbacks, selector) {\n              if (!matchedSelectors[selector]) {\n                delete currentSelectors[selector];\n                Tools.each(callbacks, function (callback) {\n                  callback(false, {\n                    node: node,\n                    selector: selector,\n                    parents: parents\n                  });\n                });\n              }\n            });\n          });\n        }\n\n        if (!selectorChangedData[selector]) {\n          selectorChangedData[selector] = [];\n        }\n\n        selectorChangedData[selector].push(callback);\n        findMatchingNode(selector, getParents(editor.selection.getStart())).each(function () {\n          currentSelectors[selector] = selectorChangedData[selector];\n        });\n        return {\n          unbind: function () {\n            deleteFromCallbackMap(selectorChangedData, selector, callback);\n            deleteFromCallbackMap(currentSelectors, selector, callback);\n          }\n        };\n      }\n    };\n  }\n\n  var isNativeIeSelection = function (rng) {\n    return !!rng.select;\n  };\n\n  var isAttachedToDom = function (node) {\n    return !!(node && node.ownerDocument) && contains$1(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n  };\n\n  var isValidRange = function (rng) {\n    if (!rng) {\n      return false;\n    } else if (isNativeIeSelection(rng)) {\n      return true;\n    } else {\n      return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n    }\n  };\n\n  var EditorSelection = function (dom, win, serializer, editor) {\n    var selectedRange;\n    var explicitRange;\n    var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n\n    var setCursorLocation = function (node, offset) {\n      var rng = dom.createRng();\n\n      if (isNonNullable(node) && isNonNullable(offset)) {\n        rng.setStart(node, offset);\n        rng.setEnd(node, offset);\n        setRng(rng);\n        collapse(false);\n      } else {\n        moveEndPoint(dom, rng, editor.getBody(), true);\n        setRng(rng);\n      }\n    };\n\n    var getContent = function (args) {\n      return getContent$1(editor, args);\n    };\n\n    var setContent = function (content, args) {\n      return setContent$1(editor, content, args);\n    };\n\n    var getStart$1 = function (real) {\n      return getStart(editor.getBody(), getRng$1(), real);\n    };\n\n    var getEnd$1 = function (real) {\n      return getEnd(editor.getBody(), getRng$1(), real);\n    };\n\n    var getBookmark = function (type, normalized) {\n      return bookmarkManager.getBookmark(type, normalized);\n    };\n\n    var moveToBookmark = function (bookmark) {\n      return bookmarkManager.moveToBookmark(bookmark);\n    };\n\n    var select$1 = function (node, content) {\n      select(dom, node, content).each(setRng);\n      return node;\n    };\n\n    var isCollapsed = function () {\n      var rng = getRng$1(),\n          sel = getSel();\n\n      if (!rng || rng.item) {\n        return false;\n      }\n\n      if (rng.compareEndPoints) {\n        return rng.compareEndPoints('StartToEnd', rng) === 0;\n      }\n\n      return !sel || rng.collapsed;\n    };\n\n    var collapse = function (toStart) {\n      var rng = getRng$1();\n      rng.collapse(!!toStart);\n      setRng(rng);\n    };\n\n    var getSel = function () {\n      return win.getSelection ? win.getSelection() : win.document.selection;\n    };\n\n    var getRng$1 = function () {\n      var selection, rng, elm;\n\n      var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n        try {\n          return sourceRange.compareBoundaryPoints(how, destinationRange);\n        } catch (ex) {\n          return -1;\n        }\n      };\n\n      var doc = win.document;\n\n      if (editor.bookmark !== undefined && hasFocus(editor) === false) {\n        var bookmark = getRng(editor);\n\n        if (bookmark.isSome()) {\n          return bookmark.map(function (r) {\n            return processRanges(editor, [r])[0];\n          }).getOr(doc.createRange());\n        }\n      }\n\n      try {\n        if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n          if (selection.rangeCount > 0) {\n            rng = selection.getRangeAt(0);\n          } else {\n            rng = selection.createRange ? selection.createRange() : doc.createRange();\n          }\n\n          rng = processRanges(editor, [rng])[0];\n        }\n      } catch (ex) {}\n\n      if (!rng) {\n        rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n      }\n\n      if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n        elm = dom.getRoot();\n        rng.setStart(elm, 0);\n        rng.setEnd(elm, 0);\n      }\n\n      if (selectedRange && explicitRange) {\n        if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n          rng = explicitRange;\n        } else {\n          selectedRange = null;\n          explicitRange = null;\n        }\n      }\n\n      return rng;\n    };\n\n    var setRng = function (rng, forward) {\n      var node;\n\n      if (!isValidRange(rng)) {\n        return;\n      }\n\n      var ieRange = isNativeIeSelection(rng) ? rng : null;\n\n      if (ieRange) {\n        explicitRange = null;\n\n        try {\n          ieRange.select();\n        } catch (ex) {}\n\n        return;\n      }\n\n      var sel = getSel();\n      var evt = editor.fire('SetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n      rng = evt.range;\n\n      if (sel) {\n        explicitRange = rng;\n\n        try {\n          sel.removeAllRanges();\n          sel.addRange(rng);\n        } catch (ex) {}\n\n        if (forward === false && sel.extend) {\n          sel.collapse(rng.endContainer, rng.endOffset);\n          sel.extend(rng.startContainer, rng.startOffset);\n        }\n\n        selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n      }\n\n      if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n        if (rng.endOffset - rng.startOffset < 2) {\n          if (rng.startContainer.hasChildNodes()) {\n            node = rng.startContainer.childNodes[rng.startOffset];\n\n            if (node && node.tagName === 'IMG') {\n              sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n\n              if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                sel.setBaseAndExtent(node, 0, node, 1);\n              }\n            }\n          }\n        }\n      }\n\n      editor.fire('AfterSetSelectionRange', {\n        range: rng,\n        forward: forward\n      });\n    };\n\n    var setNode = function (elm) {\n      setContent(dom.getOuterHTML(elm));\n      return elm;\n    };\n\n    var getNode$1 = function () {\n      return getNode(editor.getBody(), getRng$1());\n    };\n\n    var getSelectedBlocks$1 = function (startElm, endElm) {\n      return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n    };\n\n    var isForward = function () {\n      var sel = getSel();\n      var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n      var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n\n      if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n        return true;\n      }\n\n      var anchorRange = dom.createRng();\n      anchorRange.setStart(anchorNode, sel.anchorOffset);\n      anchorRange.collapse(true);\n      var focusRange = dom.createRng();\n      focusRange.setStart(focusNode, sel.focusOffset);\n      focusRange.collapse(true);\n      return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n    };\n\n    var normalize = function () {\n      var rng = getRng$1();\n      var sel = getSel();\n\n      if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n        var normRng = normalize$2(dom, rng);\n        normRng.each(function (normRng) {\n          setRng(normRng, isForward());\n        });\n        return normRng.getOr(rng);\n      }\n\n      return rng;\n    };\n\n    var selectorChanged = function (selector, callback) {\n      selectorChangedWithUnbind(selector, callback);\n      return exports;\n    };\n\n    var getScrollContainer = function () {\n      var scrollContainer;\n      var node = dom.getRoot();\n\n      while (node && node.nodeName !== 'BODY') {\n        if (node.scrollHeight > node.clientHeight) {\n          scrollContainer = node;\n          break;\n        }\n\n        node = node.parentNode;\n      }\n\n      return scrollContainer;\n    };\n\n    var scrollIntoView = function (elm, alignToTop) {\n      if (isNonNullable(elm)) {\n        scrollElementIntoView(editor, elm, alignToTop);\n      } else {\n        scrollRangeIntoView(editor, getRng$1(), alignToTop);\n      }\n    };\n\n    var placeCaretAt = function (clientX, clientY) {\n      return setRng(fromPoint(clientX, clientY, editor.getDoc()));\n    };\n\n    var getBoundingClientRect = function () {\n      var rng = getRng$1();\n      return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n    };\n\n    var destroy = function () {\n      win = selectedRange = explicitRange = null;\n      controlSelection.destroy();\n    };\n\n    var exports = {\n      bookmarkManager: null,\n      controlSelection: null,\n      dom: dom,\n      win: win,\n      serializer: serializer,\n      editor: editor,\n      collapse: collapse,\n      setCursorLocation: setCursorLocation,\n      getContent: getContent,\n      setContent: setContent,\n      getBookmark: getBookmark,\n      moveToBookmark: moveToBookmark,\n      select: select$1,\n      isCollapsed: isCollapsed,\n      isForward: isForward,\n      setNode: setNode,\n      getNode: getNode$1,\n      getSel: getSel,\n      setRng: setRng,\n      getRng: getRng$1,\n      getStart: getStart$1,\n      getEnd: getEnd$1,\n      getSelectedBlocks: getSelectedBlocks$1,\n      normalize: normalize,\n      selectorChanged: selectorChanged,\n      selectorChangedWithUnbind: selectorChangedWithUnbind,\n      getScrollContainer: getScrollContainer,\n      scrollIntoView: scrollIntoView,\n      placeCaretAt: placeCaretAt,\n      getBoundingClientRect: getBoundingClientRect,\n      destroy: destroy\n    };\n    var bookmarkManager = BookmarkManager(exports);\n    var controlSelection = ControlSelection(exports, editor);\n    exports.bookmarkManager = bookmarkManager;\n    exports.controlSelection = controlSelection;\n    return exports;\n  };\n\n  var removeAttrs = function (node, names) {\n    each$k(names, function (name) {\n      node.attr(name, null);\n    });\n  };\n\n  var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n    domParser.addNodeFilter('font', function (nodes) {\n      each$k(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        var color = node.attr('color');\n        var face = node.attr('face');\n        var size = node.attr('size');\n\n        if (color) {\n          props.color = color;\n        }\n\n        if (face) {\n          props['font-family'] = face;\n        }\n\n        if (size) {\n          props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n        }\n\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n        removeAttrs(node, ['color', 'face', 'size']);\n      });\n    });\n  };\n\n  var addStrikeToSpanFilter = function (domParser, styles) {\n    domParser.addNodeFilter('strike', function (nodes) {\n      each$k(nodes, function (node) {\n        var props = styles.parse(node.attr('style'));\n        props['text-decoration'] = 'line-through';\n        node.name = 'span';\n        node.attr('style', styles.serialize(props));\n      });\n    });\n  };\n\n  var addFilters = function (domParser, settings) {\n    var styles = Styles();\n\n    if (settings.convert_fonts_to_spans) {\n      addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n    }\n\n    addStrikeToSpanFilter(domParser, styles);\n  };\n\n  var register$2 = function (domParser, settings) {\n    if (settings.inline_styles) {\n      addFilters(domParser, settings);\n    }\n  };\n\n  var blobUriToBlob = function (url) {\n    return new promiseObj(function (resolve, reject) {\n      var rejectWithError = function () {\n        reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n      };\n\n      try {\n        var xhr_1 = new XMLHttpRequest();\n        xhr_1.open('GET', url, true);\n        xhr_1.responseType = 'blob';\n\n        xhr_1.onload = function () {\n          if (xhr_1.status === 200) {\n            resolve(xhr_1.response);\n          } else {\n            rejectWithError();\n          }\n        };\n\n        xhr_1.onerror = rejectWithError;\n        xhr_1.send();\n      } catch (ex) {\n        rejectWithError();\n      }\n    });\n  };\n\n  var parseDataUri = function (uri) {\n    var type;\n    var uriParts = decodeURIComponent(uri).split(',');\n    var matches = /data:([^;]+)/.exec(uriParts[0]);\n\n    if (matches) {\n      type = matches[1];\n    }\n\n    return {\n      type: type,\n      data: uriParts[1]\n    };\n  };\n\n  var buildBlob = function (type, data) {\n    var str;\n\n    try {\n      str = atob(data);\n    } catch (e) {\n      return Optional.none();\n    }\n\n    var arr = new Uint8Array(str.length);\n\n    for (var i = 0; i < arr.length; i++) {\n      arr[i] = str.charCodeAt(i);\n    }\n\n    return Optional.some(new Blob([arr], {\n      type: type\n    }));\n  };\n\n  var dataUriToBlob = function (uri) {\n    return new promiseObj(function (resolve) {\n      var _a = parseDataUri(uri),\n          type = _a.type,\n          data = _a.data;\n\n      buildBlob(type, data).fold(function () {\n        return resolve(new Blob([]));\n      }, resolve);\n    });\n  };\n\n  var uriToBlob = function (url) {\n    if (url.indexOf('blob:') === 0) {\n      return blobUriToBlob(url);\n    }\n\n    if (url.indexOf('data:') === 0) {\n      return dataUriToBlob(url);\n    }\n\n    return null;\n  };\n\n  var blobToDataUri = function (blob) {\n    return new promiseObj(function (resolve) {\n      var reader = new FileReader();\n\n      reader.onloadend = function () {\n        resolve(reader.result);\n      };\n\n      reader.readAsDataURL(blob);\n    });\n  };\n\n  var count$1 = 0;\n\n  var uniqueId = function (prefix) {\n    return (prefix || 'blobid') + count$1++;\n  };\n\n  var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n    var base64, blobInfo;\n\n    if (img.src.indexOf('blob:') === 0) {\n      blobInfo = blobCache.getByUri(img.src);\n\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobToDataUri(blob).then(function (dataUri) {\n            base64 = parseDataUri(dataUri).data;\n            blobInfo = blobCache.create(uniqueId(), blob, base64);\n            blobCache.add(blobInfo);\n            resolve({\n              image: img,\n              blobInfo: blobInfo\n            });\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n\n      return;\n    }\n\n    var _a = parseDataUri(img.src),\n        data = _a.data,\n        type = _a.type;\n\n    base64 = data;\n    blobInfo = blobCache.getByData(base64, type);\n\n    if (blobInfo) {\n      resolve({\n        image: img,\n        blobInfo: blobInfo\n      });\n    } else {\n      uriToBlob(img.src).then(function (blob) {\n        blobInfo = blobCache.create(uniqueId(), blob, base64);\n        blobCache.add(blobInfo);\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      }, function (err) {\n        reject(err);\n      });\n    }\n  };\n\n  var getAllImages = function (elm) {\n    return elm ? from(elm.getElementsByTagName('img')) : [];\n  };\n\n  var ImageScanner = function (uploadStatus, blobCache) {\n    var cachedPromises = {};\n\n    var findAll = function (elm, predicate) {\n      if (!predicate) {\n        predicate = always;\n      }\n\n      var images = filter$4(getAllImages(elm), function (img) {\n        var src = img.src;\n\n        if (!Env.fileApi) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-bogus')) {\n          return false;\n        }\n\n        if (img.hasAttribute('data-mce-placeholder')) {\n          return false;\n        }\n\n        if (!src || src === Env.transparentSrc) {\n          return false;\n        }\n\n        if (src.indexOf('blob:') === 0) {\n          return !uploadStatus.isUploaded(src) && predicate(img);\n        }\n\n        if (src.indexOf('data:') === 0) {\n          return predicate(img);\n        }\n\n        return false;\n      });\n      var promises = map$3(images, function (img) {\n        if (cachedPromises[img.src] !== undefined) {\n          return new promiseObj(function (resolve) {\n            cachedPromises[img.src].then(function (imageInfo) {\n              if (typeof imageInfo === 'string') {\n                return imageInfo;\n              }\n\n              resolve({\n                image: img,\n                blobInfo: imageInfo.blobInfo\n              });\n            });\n          });\n        }\n\n        var newPromise = new promiseObj(function (resolve, reject) {\n          imageToBlobInfo(blobCache, img, resolve, reject);\n        }).then(function (result) {\n          delete cachedPromises[result.image.src];\n          return result;\n        }).catch(function (error) {\n          delete cachedPromises[img.src];\n          return error;\n        });\n        cachedPromises[img.src] = newPromise;\n        return newPromise;\n      });\n      return promiseObj.all(promises);\n    };\n\n    return {\n      findAll: findAll\n    };\n  };\n\n  var paddEmptyNode = function (settings, args, blockElements, node) {\n    var brPreferred = settings.padd_empty_with_br || args.insert;\n\n    if (brPreferred && blockElements[node.name]) {\n      node.empty().append(new AstNode('br', 1)).shortEnded = true;\n    } else {\n      node.empty().append(new AstNode('#text', 3)).value = nbsp;\n    }\n  };\n\n  var isPaddedWithNbsp = function (node) {\n    return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n  };\n\n  var hasOnlyChild = function (node, name) {\n    return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n  };\n\n  var isPadded = function (schema, node) {\n    var rule = schema.getElementRule(node.name);\n    return rule && rule.paddEmpty;\n  };\n\n  var isEmpty = function (schema, nonEmptyElements, whitespaceElements, node) {\n    return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n      return isPadded(schema, node);\n    });\n  };\n\n  var isLineBreakNode = function (node, blockElements) {\n    return node && (has$2(blockElements, node.name) || node.name === 'br');\n  };\n\n  var isBogusImage = function (img) {\n    return isNonNullable(img.attr('data-mce-bogus'));\n  };\n\n  var isInternalImageSource = function (img) {\n    return img.attr('src') === Env.transparentSrc || isNonNullable(img.attr('data-mce-placeholder'));\n  };\n\n  var isValidDataImg = function (img, settings) {\n    if (settings.images_dataimg_filter) {\n      var imgElem_1 = new Image();\n      imgElem_1.src = img.attr('src');\n      each$j(img.attributes.map, function (value, key) {\n        imgElem_1.setAttribute(key, value);\n      });\n      return settings.images_dataimg_filter(imgElem_1);\n    } else {\n      return true;\n    }\n  };\n\n  var registerBase64ImageFilter = function (parser, settings) {\n    var blobCache = settings.blob_cache;\n\n    var processImage = function (img) {\n      var inputSrc = img.attr('src');\n\n      if (isInternalImageSource(img) || isBogusImage(img)) {\n        return;\n      }\n\n      parseDataUri$1(inputSrc).filter(function () {\n        return isValidDataImg(img, settings);\n      }).bind(function (_a) {\n        var type = _a.type,\n            data = _a.data;\n        return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n          return buildBlob(type, data).map(function (blob) {\n            var blobInfo = blobCache.create(uniqueId(), blob, data);\n            blobCache.add(blobInfo);\n            return blobInfo;\n          });\n        });\n      }).each(function (blobInfo) {\n        img.attr('src', blobInfo.blobUri());\n      });\n    };\n\n    if (blobCache) {\n      parser.addAttributeFilter('src', function (nodes) {\n        return each$k(nodes, processImage);\n      });\n    }\n  };\n\n  var register$1 = function (parser, settings) {\n    var schema = parser.schema;\n\n    if (settings.remove_trailing_brs) {\n      parser.addNodeFilter('br', function (nodes, _, args) {\n        var i;\n        var l = nodes.length;\n        var node;\n        var blockElements = Tools.extend({}, schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var parent, lastParent, prev, prevName;\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var elementRule, textNode;\n        blockElements.body = 1;\n\n        for (i = 0; i < l; i++) {\n          node = nodes[i];\n          parent = node.parent;\n\n          if (blockElements[node.parent.name] && node === parent.lastChild) {\n            prev = node.prev;\n\n            while (prev) {\n              prevName = prev.name;\n\n              if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                if (prevName === 'br') {\n                  node = null;\n                }\n\n                break;\n              }\n\n              prev = prev.prev;\n            }\n\n            if (node) {\n              node.remove();\n\n              if (isEmpty(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                elementRule = schema.getElementRule(parent.name);\n\n                if (elementRule) {\n                  if (elementRule.removeEmpty) {\n                    parent.remove();\n                  } else if (elementRule.paddEmpty) {\n                    paddEmptyNode(settings, args, blockElements, parent);\n                  }\n                }\n              }\n            }\n          } else {\n            lastParent = node;\n\n            while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n              lastParent = parent;\n\n              if (blockElements[parent.name]) {\n                break;\n              }\n\n              parent = parent.parent;\n            }\n\n            if (lastParent === parent && settings.padd_empty_with_br !== true) {\n              textNode = new AstNode('#text', 3);\n              textNode.value = nbsp;\n              node.replace(textNode);\n            }\n          }\n        }\n      });\n    }\n\n    parser.addAttributeFilter('href', function (nodes) {\n      var i = nodes.length;\n\n      var appendRel = function (rel) {\n        var parts = rel.split(' ').filter(function (p) {\n          return p.length > 0;\n        });\n        return parts.concat(['noopener']).sort().join(' ');\n      };\n\n      var addNoOpener = function (rel) {\n        var newRel = rel ? Tools.trim(rel) : '';\n\n        if (!/\\b(noopener)\\b/g.test(newRel)) {\n          return appendRel(newRel);\n        } else {\n          return newRel;\n        }\n      };\n\n      if (!settings.allow_unsafe_link_target) {\n        while (i--) {\n          var node = nodes[i];\n\n          if (node.name === 'a' && node.attr('target') === '_blank') {\n            node.attr('rel', addNoOpener(node.attr('rel')));\n          }\n        }\n      }\n    });\n\n    if (!settings.allow_html_in_named_anchor) {\n      parser.addAttributeFilter('id,name', function (nodes) {\n        var i = nodes.length,\n            sibling,\n            prevSibling,\n            parent,\n            node;\n\n        while (i--) {\n          node = nodes[i];\n\n          if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n            parent = node.parent;\n            sibling = node.lastChild;\n\n            do {\n              prevSibling = sibling.prev;\n              parent.insert(sibling, node);\n              sibling = prevSibling;\n            } while (sibling);\n          }\n        }\n      });\n    }\n\n    if (settings.fix_list_elements) {\n      parser.addNodeFilter('ul,ol', function (nodes) {\n        var i = nodes.length,\n            node,\n            parentNode;\n\n        while (i--) {\n          node = nodes[i];\n          parentNode = node.parent;\n\n          if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n            if (node.prev && node.prev.name === 'li') {\n              node.prev.append(node);\n            } else {\n              var li = new AstNode('li', 1);\n              li.attr('style', 'list-style-type: none');\n              node.wrap(li);\n            }\n          }\n        }\n      });\n    }\n\n    if (settings.validate && schema.getValidClasses()) {\n      parser.addAttributeFilter('class', function (nodes) {\n        var validClasses = schema.getValidClasses();\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          var classList = node.attr('class').split(' ');\n          var classValue = '';\n\n          for (var ci = 0; ci < classList.length; ci++) {\n            var className = classList[ci];\n            var valid = false;\n            var validClassesMap = validClasses['*'];\n\n            if (validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            validClassesMap = validClasses[node.name];\n\n            if (!valid && validClassesMap && validClassesMap[className]) {\n              valid = true;\n            }\n\n            if (valid) {\n              if (classValue) {\n                classValue += ' ';\n              }\n\n              classValue += className;\n            }\n          }\n\n          if (!classValue.length) {\n            classValue = null;\n          }\n\n          node.attr('class', classValue);\n        }\n      });\n    }\n\n    registerBase64ImageFilter(parser, settings);\n  };\n\n  var makeMap = Tools.makeMap,\n      each$6 = Tools.each,\n      explode$2 = Tools.explode,\n      extend$4 = Tools.extend;\n\n  var DomParser = function (settings, schema) {\n    if (schema === void 0) {\n      schema = Schema();\n    }\n\n    var nodeFilters = {};\n    var attributeFilters = [];\n    var matchedNodes = {};\n    var matchedAttributes = {};\n    settings = settings || {};\n    settings.validate = 'validate' in settings ? settings.validate : true;\n    settings.root_name = settings.root_name || 'body';\n\n    var fixInvalidChildren = function (nodes) {\n      var nonSplitableElements = makeMap('tr,td,th,tbody,thead,tfoot,table');\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var whitespaceElements = schema.getWhiteSpaceElements();\n      var textBlockElements = schema.getTextBlockElements();\n      var specialElements = schema.getSpecialElements();\n\n      var removeOrUnwrapInvalidNode = function (node, originalNodeParent) {\n        if (originalNodeParent === void 0) {\n          originalNodeParent = node.parent;\n        }\n\n        if (specialElements[node.name]) {\n          node.empty().remove();\n        } else {\n          var children = node.children();\n\n          for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n            var childNode = children_1[_i];\n\n            if (!schema.isValidChild(originalNodeParent.name, childNode.name)) {\n              removeOrUnwrapInvalidNode(childNode, originalNodeParent);\n            }\n          }\n\n          node.unwrap();\n        }\n      };\n\n      for (var ni = 0; ni < nodes.length; ni++) {\n        var node = nodes[ni];\n        var parent_1 = void 0,\n            newParent = void 0,\n            tempNode = void 0;\n\n        if (!node.parent || node.fixed) {\n          continue;\n        }\n\n        if (textBlockElements[node.name] && node.parent.name === 'li') {\n          var sibling = node.next;\n\n          while (sibling) {\n            if (textBlockElements[sibling.name]) {\n              sibling.name = 'li';\n              sibling.fixed = true;\n              node.parent.insert(sibling, node.parent);\n            } else {\n              break;\n            }\n\n            sibling = sibling.next;\n          }\n\n          node.unwrap();\n          continue;\n        }\n\n        var parents = [node];\n\n        for (parent_1 = node.parent; parent_1 && !schema.isValidChild(parent_1.name, node.name) && !nonSplitableElements[parent_1.name]; parent_1 = parent_1.parent) {\n          parents.push(parent_1);\n        }\n\n        if (parent_1 && parents.length > 1) {\n          if (schema.isValidChild(parent_1.name, node.name)) {\n            parents.reverse();\n            newParent = filterNode(parents[0].clone());\n            var currentNode = newParent;\n\n            for (var i = 0; i < parents.length - 1; i++) {\n              if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                tempNode = filterNode(parents[i].clone());\n                currentNode.append(tempNode);\n              } else {\n                tempNode = currentNode;\n              }\n\n              for (var childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                var nextNode = childNode.next;\n                tempNode.append(childNode);\n                childNode = nextNode;\n              }\n\n              currentNode = tempNode;\n            }\n\n            if (!isEmpty(schema, nonEmptyElements, whitespaceElements, newParent)) {\n              parent_1.insert(newParent, parents[0], true);\n              parent_1.insert(node, newParent);\n            } else {\n              parent_1.insert(node, parents[0], true);\n            }\n\n            parent_1 = parents[0];\n\n            if (isEmpty(schema, nonEmptyElements, whitespaceElements, parent_1) || hasOnlyChild(parent_1, 'br')) {\n              parent_1.empty().remove();\n            }\n          } else {\n            removeOrUnwrapInvalidNode(node);\n          }\n        } else if (node.parent) {\n          if (node.name === 'li') {\n            var sibling = node.prev;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.append(node);\n              continue;\n            }\n\n            sibling = node.next;\n\n            if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n              sibling.insert(node, sibling.firstChild, true);\n              continue;\n            }\n\n            node.wrap(filterNode(new AstNode('ul', 1)));\n            continue;\n          }\n\n          if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n            node.wrap(filterNode(new AstNode('div', 1)));\n          } else {\n            removeOrUnwrapInvalidNode(node);\n          }\n        }\n      }\n    };\n\n    var filterNode = function (node) {\n      var name = node.name;\n\n      if (name in nodeFilters) {\n        var list = matchedNodes[name];\n\n        if (list) {\n          list.push(node);\n        } else {\n          matchedNodes[name] = [node];\n        }\n      }\n\n      var i = attributeFilters.length;\n\n      while (i--) {\n        var attrName = attributeFilters[i].name;\n\n        if (attrName in node.attributes.map) {\n          var list = matchedAttributes[attrName];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedAttributes[attrName] = [node];\n          }\n        }\n      }\n\n      return node;\n    };\n\n    var addNodeFilter = function (name, callback) {\n      each$6(explode$2(name), function (name) {\n        var list = nodeFilters[name];\n\n        if (!list) {\n          nodeFilters[name] = list = [];\n        }\n\n        list.push(callback);\n      });\n    };\n\n    var getNodeFilters = function () {\n      var out = [];\n\n      for (var name_1 in nodeFilters) {\n        if (has$2(nodeFilters, name_1)) {\n          out.push({\n            name: name_1,\n            callbacks: nodeFilters[name_1]\n          });\n        }\n      }\n\n      return out;\n    };\n\n    var addAttributeFilter = function (name, callback) {\n      each$6(explode$2(name), function (name) {\n        var i;\n\n        for (i = 0; i < attributeFilters.length; i++) {\n          if (attributeFilters[i].name === name) {\n            attributeFilters[i].callbacks.push(callback);\n            return;\n          }\n        }\n\n        attributeFilters.push({\n          name: name,\n          callbacks: [callback]\n        });\n      });\n    };\n\n    var getAttributeFilters = function () {\n      return [].concat(attributeFilters);\n    };\n\n    var parse = function (html, args) {\n      var nodes, i, l, fi, fl, list, name;\n      var invalidChildren = [];\n      var node;\n\n      var getRootBlockName = function (name) {\n        if (name === false) {\n          return '';\n        } else if (name === true) {\n          return 'p';\n        } else {\n          return name;\n        }\n      };\n\n      args = args || {};\n      matchedNodes = {};\n      matchedAttributes = {};\n      var blockElements = extend$4(makeMap('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n      var nonEmptyElements = schema.getNonEmptyElements();\n      var children = schema.children;\n      var validate = settings.validate;\n      var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n      var rootBlockName = getRootBlockName(forcedRootBlockName);\n      var whiteSpaceElements = schema.getWhiteSpaceElements();\n      var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n      var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n      var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n      var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n      var isInWhiteSpacePreservedElement = has$2(whiteSpaceElements, args.context) || has$2(whiteSpaceElements, settings.root_name);\n\n      var addRootBlocks = function () {\n        var node = rootNode.firstChild,\n            rootBlockNode = null;\n\n        var trim = function (rootBlock) {\n          if (rootBlock) {\n            node = rootBlock.firstChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(startWhiteSpaceRegExp, '');\n            }\n\n            node = rootBlock.lastChild;\n\n            if (node && node.type === 3) {\n              node.value = node.value.replace(endWhiteSpaceRegExp, '');\n            }\n          }\n        };\n\n        if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n          return;\n        }\n\n        while (node) {\n          var next = node.next;\n\n          if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n            if (!rootBlockNode) {\n              rootBlockNode = createNode(rootBlockName, 1);\n              rootBlockNode.attr(settings.forced_root_block_attrs);\n              rootNode.insert(rootBlockNode, node);\n              rootBlockNode.append(node);\n            } else {\n              rootBlockNode.append(node);\n            }\n          } else {\n            trim(rootBlockNode);\n            rootBlockNode = null;\n          }\n\n          node = next;\n        }\n\n        trim(rootBlockNode);\n      };\n\n      var createNode = function (name, type) {\n        var node = new AstNode(name, type);\n        var list;\n\n        if (name in nodeFilters) {\n          list = matchedNodes[name];\n\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n\n        return node;\n      };\n\n      var removeWhitespaceBefore = function (node) {\n        var blockElements = schema.getBlockElements();\n\n        for (var textNode = node.prev; textNode && textNode.type === 3;) {\n          var textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n          if (textVal.length > 0) {\n            textNode.value = textVal;\n            return;\n          }\n\n          var textNodeNext = textNode.next;\n\n          if (textNodeNext) {\n            if (textNodeNext.type === 3 && textNodeNext.value.length) {\n              textNode = textNode.prev;\n              continue;\n            }\n\n            if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n              textNode = textNode.prev;\n              continue;\n            }\n          }\n\n          var sibling = textNode.prev;\n          textNode.remove();\n          textNode = sibling;\n        }\n      };\n\n      var cloneAndExcludeBlocks = function (input) {\n        var output = {};\n\n        for (var name_2 in input) {\n          if (name_2 !== 'li' && name_2 !== 'p') {\n            output[name_2] = input[name_2];\n          }\n        }\n\n        return output;\n      };\n\n      var parser = SaxParser({\n        validate: validate,\n        document: settings.document,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_script_urls: settings.allow_script_urls,\n        allow_conditional_comments: settings.allow_conditional_comments,\n        preserve_cdata: settings.preserve_cdata,\n        self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n        cdata: function (text) {\n          node.append(createNode('#cdata', 4)).value = text;\n        },\n        text: function (text, raw) {\n          var textNode;\n\n          if (!isInWhiteSpacePreservedElement) {\n            text = text.replace(allWhiteSpaceRegExp, ' ');\n\n            if (isLineBreakNode(node.lastChild, blockElements)) {\n              text = text.replace(startWhiteSpaceRegExp, '');\n            }\n          }\n\n          if (text.length !== 0) {\n            textNode = createNode('#text', 3);\n            textNode.raw = !!raw;\n            node.append(textNode).value = text;\n          }\n        },\n        comment: function (text) {\n          node.append(createNode('#comment', 8)).value = text;\n        },\n        pi: function (name, text) {\n          node.append(createNode(name, 7)).value = text;\n          removeWhitespaceBefore(node);\n        },\n        doctype: function (text) {\n          var newNode = node.append(createNode('#doctype', 10));\n          newNode.value = text;\n          removeWhitespaceBefore(node);\n        },\n        start: function (name, attrs, empty) {\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            var newNode = createNode(elementRule.outputName || name, 1);\n            newNode.attributes = attrs;\n            newNode.shortEnded = empty;\n            node.append(newNode);\n            var parent_2 = children[node.name];\n\n            if (parent_2 && children[newNode.name] && !parent_2[newNode.name]) {\n              invalidChildren.push(newNode);\n            }\n\n            var attrFiltersLen = attributeFilters.length;\n\n            while (attrFiltersLen--) {\n              var attrName = attributeFilters[attrFiltersLen].name;\n\n              if (attrName in attrs.map) {\n                list = matchedAttributes[attrName];\n\n                if (list) {\n                  list.push(newNode);\n                } else {\n                  matchedAttributes[attrName] = [newNode];\n                }\n              }\n            }\n\n            if (blockElements[name]) {\n              removeWhitespaceBefore(newNode);\n            }\n\n            if (!empty) {\n              node = newNode;\n            }\n\n            if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = true;\n            }\n          }\n        },\n        end: function (name) {\n          var textNode, text, sibling, tempNode;\n          var elementRule = validate ? schema.getElementRule(name) : {};\n\n          if (elementRule) {\n            if (blockElements[name]) {\n              if (!isInWhiteSpacePreservedElement) {\n                textNode = node.firstChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(startWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.next;\n                  } else {\n                    sibling = textNode.next;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.next;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n\n                textNode = node.lastChild;\n\n                if (textNode && textNode.type === 3) {\n                  text = textNode.value.replace(endWhiteSpaceRegExp, '');\n\n                  if (text.length > 0) {\n                    textNode.value = text;\n                    textNode = textNode.prev;\n                  } else {\n                    sibling = textNode.prev;\n                    textNode.remove();\n                    textNode = sibling;\n\n                    while (textNode && textNode.type === 3) {\n                      text = textNode.value;\n                      sibling = textNode.prev;\n\n                      if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                        textNode.remove();\n                        textNode = sibling;\n                      }\n\n                      textNode = sibling;\n                    }\n                  }\n                }\n              }\n            }\n\n            if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n              isInWhiteSpacePreservedElement = false;\n            }\n\n            if (elementRule.removeEmpty && isEmpty(schema, nonEmptyElements, whiteSpaceElements, node)) {\n              tempNode = node.parent;\n\n              if (blockElements[node.name]) {\n                node.empty().remove();\n              } else {\n                node.unwrap();\n              }\n\n              node = tempNode;\n              return;\n            }\n\n            if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty(schema, nonEmptyElements, whiteSpaceElements, node))) {\n              paddEmptyNode(settings, args, blockElements, node);\n            }\n\n            node = node.parent;\n          }\n        }\n      }, schema);\n      var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n      parser.parse(html, args.format);\n\n      if (validate && invalidChildren.length) {\n        if (!args.context) {\n          fixInvalidChildren(invalidChildren);\n        } else {\n          args.invalid = true;\n        }\n      }\n\n      if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n        addRootBlocks();\n      }\n\n      if (!args.invalid) {\n        for (name in matchedNodes) {\n          if (!has$2(matchedNodes, name)) {\n            continue;\n          }\n\n          list = nodeFilters[name];\n          nodes = matchedNodes[name];\n          fi = nodes.length;\n\n          while (fi--) {\n            if (!nodes[fi].parent) {\n              nodes.splice(fi, 1);\n            }\n          }\n\n          for (i = 0, l = list.length; i < l; i++) {\n            list[i](nodes, name, args);\n          }\n        }\n\n        for (i = 0, l = attributeFilters.length; i < l; i++) {\n          list = attributeFilters[i];\n\n          if (list.name in matchedAttributes) {\n            nodes = matchedAttributes[list.name];\n            fi = nodes.length;\n\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n\n            for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n              list.callbacks[fi](nodes, list.name, args);\n            }\n          }\n        }\n      }\n\n      return rootNode;\n    };\n\n    var exports = {\n      schema: schema,\n      addAttributeFilter: addAttributeFilter,\n      getAttributeFilters: getAttributeFilters,\n      addNodeFilter: addNodeFilter,\n      getNodeFilters: getNodeFilters,\n      filterNode: filterNode,\n      parse: parse\n    };\n    register$1(exports, settings);\n    register$2(exports, settings);\n    return exports;\n  };\n\n  var register = function (htmlParser, settings, dom) {\n    htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        node.attr('tabindex', node.attr('data-mce-tabindex'));\n        node.attr(name, null);\n      }\n    });\n    htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n      var internalName = 'data-mce-' + name;\n      var urlConverter = settings.url_converter;\n      var urlConverterScope = settings.url_converter_scope;\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var value = node.attr(internalName);\n\n        if (value !== undefined) {\n          node.attr(name, value.length > 0 ? value : null);\n          node.attr(internalName, null);\n        } else {\n          value = node.attr(name);\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n          } else if (urlConverter) {\n            value = urlConverter.call(urlConverterScope, value, name, node.name);\n          }\n\n          node.attr(name, value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('class', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var value = node.attr('class');\n\n        if (value) {\n          value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n          node.attr('class', value.length > 0 ? value : null);\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n          var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n            return !isZwsp(firstChild.value);\n          });\n\n          if (hasChildren) {\n            node.unwrap();\n          } else {\n            node.remove();\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('noscript', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i].firstChild;\n\n        if (node) {\n          node.value = Entities.decode(node.value);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('script,style', function (nodes, name) {\n      var trim = function (value) {\n        return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n      };\n\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var value = node.firstChild ? node.firstChild.value : '';\n\n        if (name === 'script') {\n          var type = node.attr('type');\n\n          if (type) {\n            node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n          }\n\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n          }\n        } else {\n          if (settings.element_format === 'xhtml' && value.length > 0) {\n            node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n          }\n        }\n      }\n    });\n    htmlParser.addNodeFilter('#comment', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n          node.name = '#cdata';\n          node.type = 4;\n          node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n        } else if (node.value.indexOf('mce:protected ') === 0) {\n          node.name = '#text';\n          node.type = 3;\n          node.raw = true;\n          node.value = unescape(node.value).substr(14);\n        }\n      }\n    });\n    htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (node.type === 7) {\n          node.remove();\n        } else if (node.type === 1) {\n          if (name === 'input' && !node.attr('type')) {\n            node.attr('type', 'text');\n          }\n        }\n      }\n    });\n    htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n      each$k(nodes, function (node) {\n        if (node.attr('data-mce-type') === 'format-caret') {\n          if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n            node.remove();\n          } else {\n            node.unwrap();\n          }\n        }\n      });\n    });\n    htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n      var i = nodes.length;\n\n      while (i--) {\n        nodes[i].attr(name, null);\n      }\n    });\n  };\n\n  var trimTrailingBr = function (rootNode) {\n    var isBr = function (node) {\n      return node && node.name === 'br';\n    };\n\n    var brNode1 = rootNode.lastChild;\n\n    if (isBr(brNode1)) {\n      var brNode2 = brNode1.prev;\n\n      if (isBr(brNode2)) {\n        brNode1.remove();\n        brNode2.remove();\n      }\n    }\n  };\n\n  var preProcess = function (editor, node, args) {\n    var oldDoc;\n    var dom = editor.dom;\n    var clonedNode = node.cloneNode(true);\n    var impl = document.implementation;\n\n    if (impl.createHTMLDocument) {\n      var doc_1 = impl.createHTMLDocument('');\n      Tools.each(clonedNode.nodeName === 'BODY' ? clonedNode.childNodes : [clonedNode], function (node) {\n        doc_1.body.appendChild(doc_1.importNode(node, true));\n      });\n\n      if (clonedNode.nodeName !== 'BODY') {\n        clonedNode = doc_1.body.firstChild;\n      } else {\n        clonedNode = doc_1.body;\n      }\n\n      oldDoc = dom.doc;\n      dom.doc = doc_1;\n    }\n\n    firePreProcess(editor, __assign(__assign({}, args), {\n      node: clonedNode\n    }));\n\n    if (oldDoc) {\n      dom.doc = oldDoc;\n    }\n\n    return clonedNode;\n  };\n\n  var shouldFireEvent = function (editor, args) {\n    return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n  };\n\n  var process = function (editor, node, args) {\n    return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n  };\n\n  var addTempAttr = function (htmlParser, tempAttrs, name) {\n    if (Tools.inArray(tempAttrs, name) === -1) {\n      htmlParser.addAttributeFilter(name, function (nodes, name) {\n        var i = nodes.length;\n\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n      tempAttrs.push(name);\n    }\n  };\n\n  var postProcess = function (editor, args, content) {\n    if (!args.no_events && editor) {\n      var outArgs = firePostProcess(editor, __assign(__assign({}, args), {\n        content: content\n      }));\n      return outArgs.content;\n    } else {\n      return content;\n    }\n  };\n\n  var getHtmlFromNode = function (dom, node, args) {\n    var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n    return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n  };\n\n  var parseHtml = function (htmlParser, html, args) {\n    var parserArgs = args.selection ? __assign({\n      forced_root_block: false\n    }, args) : args;\n    var rootNode = htmlParser.parse(html, parserArgs);\n    trimTrailingBr(rootNode);\n    return rootNode;\n  };\n\n  var serializeNode = function (settings, schema, node) {\n    var htmlSerializer = HtmlSerializer(settings, schema);\n    return htmlSerializer.serialize(node);\n  };\n\n  var toHtml = function (editor, settings, schema, rootNode, args) {\n    var content = serializeNode(settings, schema, rootNode);\n    return postProcess(editor, args, content);\n  };\n\n  var DomSerializerImpl = function (settings, editor) {\n    var tempAttrs = ['data-mce-selected'];\n    var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n    var schema = editor && editor.schema ? editor.schema : Schema(settings);\n    settings.entity_encoding = settings.entity_encoding || 'named';\n    settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n    var htmlParser = DomParser(settings, schema);\n    register(htmlParser, settings, dom);\n\n    var serialize = function (node, parserArgs) {\n      if (parserArgs === void 0) {\n        parserArgs = {};\n      }\n\n      var args = __assign({\n        format: 'html'\n      }, parserArgs);\n\n      var targetNode = process(editor, node, args);\n      var html = getHtmlFromNode(dom, targetNode, args);\n      var rootNode = parseHtml(htmlParser, html, args);\n      return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n    };\n\n    return {\n      schema: schema,\n      addNodeFilter: htmlParser.addNodeFilter,\n      addAttributeFilter: htmlParser.addAttributeFilter,\n      serialize: serialize,\n      addRules: schema.addValidElements,\n      setRules: schema.setValidElements,\n      addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n      getTempAttrs: constant(tempAttrs),\n      getNodeFilters: htmlParser.getNodeFilters,\n      getAttributeFilters: htmlParser.getAttributeFilters\n    };\n  };\n\n  var DomSerializer = function (settings, editor) {\n    var domSerializer = DomSerializerImpl(settings, editor);\n    return {\n      schema: domSerializer.schema,\n      addNodeFilter: domSerializer.addNodeFilter,\n      addAttributeFilter: domSerializer.addAttributeFilter,\n      serialize: domSerializer.serialize,\n      addRules: domSerializer.addRules,\n      setRules: domSerializer.setRules,\n      addTempAttr: domSerializer.addTempAttr,\n      getTempAttrs: domSerializer.getTempAttrs,\n      getNodeFilters: domSerializer.getNodeFilters,\n      getAttributeFilters: domSerializer.getAttributeFilters\n    };\n  };\n\n  var defaultFormat = 'html';\n\n  var getContent = function (editor, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    var format = args.format ? args.format : defaultFormat;\n    return getContent$2(editor, args, format);\n  };\n\n  var setContent = function (editor, content, args) {\n    if (args === void 0) {\n      args = {};\n    }\n\n    return setContent$2(editor, content, args);\n  };\n\n  var DOM$7 = DOMUtils.DOM;\n\n  var restoreOriginalStyles = function (editor) {\n    DOM$7.setStyle(editor.id, 'display', editor.orgDisplay);\n  };\n\n  var safeDestroy = function (x) {\n    return Optional.from(x).each(function (x) {\n      return x.destroy();\n    });\n  };\n\n  var clearDomReferences = function (editor) {\n    editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n    editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n    editor.iframeElement = editor.targetElm = null;\n\n    if (editor.selection) {\n      editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n    }\n  };\n\n  var restoreForm = function (editor) {\n    var form = editor.formElement;\n\n    if (form) {\n      if (form._mceOldSubmit) {\n        form.submit = form._mceOldSubmit;\n        form._mceOldSubmit = null;\n      }\n\n      DOM$7.unbind(form, 'submit reset', editor.formEventDelegate);\n    }\n  };\n\n  var remove = function (editor) {\n    if (!editor.removed) {\n      var _selectionOverrides = editor._selectionOverrides,\n          editorUpload = editor.editorUpload;\n      var body = editor.getBody();\n      var element = editor.getElement();\n\n      if (body) {\n        editor.save({\n          is_removing: true\n        });\n      }\n\n      editor.removed = true;\n      editor.unbindAllNativeEvents();\n\n      if (editor.hasHiddenInput && element) {\n        DOM$7.remove(element.nextSibling);\n      }\n\n      fireRemove(editor);\n      editor.editorManager.remove(editor);\n\n      if (!editor.inline && body) {\n        restoreOriginalStyles(editor);\n      }\n\n      fireDetach(editor);\n      DOM$7.remove(editor.getContainer());\n      safeDestroy(_selectionOverrides);\n      safeDestroy(editorUpload);\n      editor.destroy();\n    }\n  };\n\n  var destroy = function (editor, automatic) {\n    var selection = editor.selection,\n        dom = editor.dom;\n\n    if (editor.destroyed) {\n      return;\n    }\n\n    if (!automatic && !editor.removed) {\n      editor.remove();\n      return;\n    }\n\n    if (!automatic) {\n      editor.editorManager.off('beforeunload', editor._beforeUnload);\n\n      if (editor.theme && editor.theme.destroy) {\n        editor.theme.destroy();\n      }\n\n      safeDestroy(selection);\n      safeDestroy(dom);\n    }\n\n    restoreForm(editor);\n    clearDomReferences(editor);\n    editor.destroyed = true;\n  };\n\n  var deep = function (old, nu) {\n    var bothObjects = isObject(old) && isObject(nu);\n    return bothObjects ? deepMerge(old, nu) : nu;\n  };\n\n  var baseMerge = function (merger) {\n    return function () {\n      var objects = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        objects[_i] = arguments[_i];\n      }\n\n      if (objects.length === 0) {\n        throw new Error('Can\\'t merge zero objects');\n      }\n\n      var ret = {};\n\n      for (var j = 0; j < objects.length; j++) {\n        var curObject = objects[j];\n\n        for (var key in curObject) {\n          if (has$2(curObject, key)) {\n            ret[key] = merger(ret[key], curObject[key]);\n          }\n        }\n      }\n\n      return ret;\n    };\n  };\n\n  var deepMerge = baseMerge(deep);\n  var deprecatedSettings = ('autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,' + 'boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,' + 'force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,' + 'non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,' + 'tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,' + 'paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists').split(',');\n  var deprecatedPlugins = 'bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor'.split(',');\n  var movedToPremiumPlugins = 'imagetools,toc'.split(',');\n\n  var getDeprecatedSettings = function (settings) {\n    var settingNames = filter$4(deprecatedSettings, function (setting) {\n      return has$2(settings, setting);\n    });\n    var forcedRootBlock = settings.forced_root_block;\n\n    if (forcedRootBlock === false || forcedRootBlock === '') {\n      settingNames.push('forced_root_block (false only)');\n    }\n\n    return sort(settingNames);\n  };\n\n  var getDeprecatedPlugins = function (settings) {\n    var plugins = Tools.makeMap(settings.plugins, ' ');\n\n    var hasPlugin = function (plugin) {\n      return has$2(plugins, plugin);\n    };\n\n    var pluginNames = __spreadArray(__spreadArray([], filter$4(deprecatedPlugins, hasPlugin), true), bind(movedToPremiumPlugins, function (plugin) {\n      return hasPlugin(plugin) ? [plugin + ' (moving to premium)'] : [];\n    }), true);\n\n    return sort(pluginNames);\n  };\n\n  var logDeprecationsWarning = function (rawSettings, finalSettings) {\n    var deprecatedSettings = getDeprecatedSettings(rawSettings);\n    var deprecatedPlugins = getDeprecatedPlugins(finalSettings);\n    var hasDeprecatedPlugins = deprecatedPlugins.length > 0;\n    var hasDeprecatedSettings = deprecatedSettings.length > 0;\n    var isLegacyMobileTheme = finalSettings.theme === 'mobile';\n\n    if (hasDeprecatedPlugins || hasDeprecatedSettings || isLegacyMobileTheme) {\n      var listJoiner = '\\n- ';\n      var themesMessage = isLegacyMobileTheme ? '\\n\\nThemes:' + listJoiner + 'mobile' : '';\n      var pluginsMessage = hasDeprecatedPlugins ? '\\n\\nPlugins:' + listJoiner + deprecatedPlugins.join(listJoiner) : '';\n      var settingsMessage = hasDeprecatedSettings ? '\\n\\nSettings:' + listJoiner + deprecatedSettings.join(listJoiner) : '';\n      console.warn('The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. ' + 'See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information.' + themesMessage + pluginsMessage + settingsMessage);\n    }\n  };\n\n  var sectionResult = function (sections, settings) {\n    return {\n      sections: constant(sections),\n      settings: constant(settings)\n    };\n  };\n\n  var deviceDetection = detect().deviceType;\n  var isTouch = deviceDetection.isTouch();\n  var isPhone = deviceDetection.isPhone();\n  var isTablet = deviceDetection.isTablet();\n  var legacyMobilePlugins = ['lists', 'autolink', 'autosave'];\n  var defaultTouchSettings = {\n    table_grid: false,\n    object_resizing: false,\n    resize: false\n  };\n\n  var normalizePlugins = function (plugins) {\n    var pluginNames = isArray$1(plugins) ? plugins.join(' ') : plugins;\n    var trimmedPlugins = map$3(isString$1(pluginNames) ? pluginNames.split(' ') : [], trim$4);\n    return filter$4(trimmedPlugins, function (item) {\n      return item.length > 0;\n    });\n  };\n\n  var filterLegacyMobilePlugins = function (plugins) {\n    return filter$4(plugins, curry(contains$3, legacyMobilePlugins));\n  };\n\n  var extractSections = function (keys, settings) {\n    var result = bifilter(settings, function (value, key) {\n      return contains$3(keys, key);\n    });\n    return sectionResult(result.t, result.f);\n  };\n\n  var getSection = function (sectionResult, name, defaults) {\n    if (defaults === void 0) {\n      defaults = {};\n    }\n\n    var sections = sectionResult.sections();\n    var sectionSettings = get$9(sections, name).getOr({});\n    return Tools.extend({}, defaults, sectionSettings);\n  };\n\n  var hasSection = function (sectionResult, name) {\n    return has$2(sectionResult.sections(), name);\n  };\n\n  var isSectionTheme = function (sectionResult, name, theme) {\n    var section = sectionResult.sections();\n    return hasSection(sectionResult, name) && section[name].theme === theme;\n  };\n\n  var getSectionConfig = function (sectionResult, name) {\n    return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n  };\n\n  var getToolbarMode = function (settings, defaultVal) {\n    return get$9(settings, 'toolbar_mode').orThunk(function () {\n      return get$9(settings, 'toolbar_drawer').map(function (val) {\n        return val === false ? 'wrap' : val;\n      });\n    }).getOr(defaultVal);\n  };\n\n  var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n    var baseDefaults = {\n      id: id,\n      theme: 'silver',\n      toolbar_mode: getToolbarMode(settings, 'floating'),\n      plugins: '',\n      document_base_url: documentBaseUrl,\n      add_form_submit_trigger: true,\n      submit_patch: true,\n      add_unload_trigger: true,\n      convert_urls: true,\n      relative_urls: true,\n      remove_script_host: true,\n      object_resizing: true,\n      doctype: '<!DOCTYPE html>',\n      visual: true,\n      font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n      forced_root_block: 'p',\n      hidden_input: true,\n      inline_styles: true,\n      convert_fonts_to_spans: true,\n      indent: true,\n      indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n      entity_encoding: 'named',\n      url_converter: editor.convertURL,\n      url_converter_scope: editor\n    };\n    return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n  };\n\n  var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n    var defaultMobileSettings = {\n      resize: false,\n      toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n      toolbar_sticky: false\n    };\n    var defaultPhoneSettings = {\n      menubar: false\n    };\n    return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n  };\n\n  var getExternalPlugins = function (overrideSettings, settings) {\n    var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n\n    if (overrideSettings && overrideSettings.external_plugins) {\n      return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n    } else {\n      return userDefinedExternalPlugins;\n    }\n  };\n\n  var combinePlugins = function (forcedPlugins, plugins) {\n    return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n  };\n\n  var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n    if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n      return filterLegacyMobilePlugins(mobilePlugins);\n    } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n      return mobilePlugins;\n    } else {\n      return desktopPlugins;\n    }\n  };\n\n  var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n    var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n    var desktopPlugins = normalizePlugins(settings.plugins);\n    var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n    var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n    var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n    var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n\n    if (Env.browser.isIE() && contains$3(combinedPlugins, 'rtc')) {\n      throw new Error('RTC plugin is not supported on IE 11.');\n    }\n\n    return Tools.extend(settings, {\n      plugins: combinedPlugins.join(' ')\n    });\n  };\n\n  var isOnMobile = function (isMobileDevice, sectionResult) {\n    return isMobileDevice && hasSection(sectionResult, 'mobile');\n  };\n\n  var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n    var defaultDeviceSettings = isMobileDevice ? {\n      mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone)\n    } : {};\n    var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n    var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n      validate: true,\n      external_plugins: getExternalPlugins(defaultOverrideSettings, sectionResult.settings())\n    });\n    return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n  };\n\n  var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n    var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n    var finalSettings = combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n\n    if (finalSettings.deprecation_warnings !== false) {\n      logDeprecationsWarning(settings, finalSettings);\n    }\n\n    return finalSettings;\n  };\n\n  var getFiltered = function (predicate, editor, name) {\n    return Optional.from(editor.settings[name]).filter(predicate);\n  };\n\n  var getParamObject = function (value) {\n    var output = {};\n\n    if (typeof value === 'string') {\n      each$k(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n        var arr = val.split('=');\n\n        if (arr.length > 1) {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n        } else {\n          output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n        }\n      });\n    } else {\n      output = value;\n    }\n\n    return output;\n  };\n\n  var isArrayOf = function (p) {\n    return function (a) {\n      return isArray$1(a) && forall(a, p);\n    };\n  };\n\n  var getParam = function (editor, name, defaultVal, type) {\n    var value = name in editor.settings ? editor.settings[name] : defaultVal;\n\n    if (type === 'hash') {\n      return getParamObject(value);\n    } else if (type === 'string') {\n      return getFiltered(isString$1, editor, name).getOr(defaultVal);\n    } else if (type === 'number') {\n      return getFiltered(isNumber, editor, name).getOr(defaultVal);\n    } else if (type === 'boolean') {\n      return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n    } else if (type === 'object') {\n      return getFiltered(isObject, editor, name).getOr(defaultVal);\n    } else if (type === 'array') {\n      return getFiltered(isArray$1, editor, name).getOr(defaultVal);\n    } else if (type === 'string[]') {\n      return getFiltered(isArrayOf(isString$1), editor, name).getOr(defaultVal);\n    } else if (type === 'function') {\n      return getFiltered(isFunction, editor, name).getOr(defaultVal);\n    } else {\n      return value;\n    }\n  };\n\n  var CreateIconManager = function () {\n    var lookup = {};\n\n    var add = function (id, iconPack) {\n      lookup[id] = iconPack;\n    };\n\n    var get = function (id) {\n      if (lookup[id]) {\n        return lookup[id];\n      }\n\n      return {\n        icons: {}\n      };\n    };\n\n    var has = function (id) {\n      return has$2(lookup, id);\n    };\n\n    return {\n      add: add,\n      get: get,\n      has: has\n    };\n  };\n\n  var IconManager = CreateIconManager();\n\n  var getProp = function (propName, elm) {\n    var rawElm = elm.dom;\n    return rawElm[propName];\n  };\n\n  var getComputedSizeProp = function (propName, elm) {\n    return parseInt(get$5(elm, propName), 10);\n  };\n\n  var getClientWidth = curry(getProp, 'clientWidth');\n  var getClientHeight = curry(getProp, 'clientHeight');\n  var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n  var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n\n  var getBoundingClientRect = function (elm) {\n    return elm.dom.getBoundingClientRect();\n  };\n\n  var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n    var clientWidth = getClientWidth(bodyElm);\n    var clientHeight = getClientHeight(bodyElm);\n    return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n  };\n\n  var transpose = function (inline, elm, clientX, clientY) {\n    var clientRect = getBoundingClientRect(elm);\n    var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n    var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n    var x = clientX - deltaX;\n    var y = clientY - deltaY;\n    return {\n      x: x,\n      y: y\n    };\n  };\n\n  var isXYInContentArea = function (editor, clientX, clientY) {\n    var bodyElm = SugarElement.fromDom(editor.getBody());\n    var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n    var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n    return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n  };\n\n  var fromDomSafe = function (node) {\n    return Optional.from(node).map(SugarElement.fromDom);\n  };\n\n  var isEditorAttachedToDom = function (editor) {\n    var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n    return fromDomSafe(rawContainer).map(inBody).getOr(false);\n  };\n\n  var NotificationManagerImpl = function () {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a NotificationManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      close: unimplemented,\n      reposition: unimplemented,\n      getArgs: unimplemented\n    };\n  };\n\n  var NotificationManager = function (editor) {\n    var notifications = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n    };\n\n    var getTopNotification = function () {\n      return Optional.from(notifications[0]);\n    };\n\n    var isEqual = function (a, b) {\n      return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n    };\n\n    var reposition = function () {\n      if (notifications.length > 0) {\n        getImplementation().reposition(notifications);\n      }\n    };\n\n    var addNotification = function (notification) {\n      notifications.push(notification);\n    };\n\n    var closeNotification = function (notification) {\n      findIndex$2(notifications, function (otherNotification) {\n        return otherNotification === notification;\n      }).each(function (index) {\n        notifications.splice(index, 1);\n      });\n    };\n\n    var open = function (spec, fireEvent) {\n      if (fireEvent === void 0) {\n        fireEvent = true;\n      }\n\n      if (editor.removed || !isEditorAttachedToDom(editor)) {\n        return;\n      }\n\n      if (fireEvent) {\n        editor.fire('BeforeOpenNotification', {\n          notification: spec\n        });\n      }\n\n      return find$3(notifications, function (notification) {\n        return isEqual(getImplementation().getArgs(notification), spec);\n      }).getOrThunk(function () {\n        editor.editorManager.setActive(editor);\n        var notification = getImplementation().open(spec, function () {\n          closeNotification(notification);\n          reposition();\n          getTopNotification().fold(function () {\n            return editor.focus();\n          }, function (top) {\n            return focus$1(SugarElement.fromDom(top.getEl()));\n          });\n        });\n        addNotification(notification);\n        reposition();\n        editor.fire('OpenNotification', {\n          notification: __assign({}, notification)\n        });\n        return notification;\n      });\n    };\n\n    var close = function () {\n      getTopNotification().each(function (notification) {\n        getImplementation().close(notification);\n        closeNotification(notification);\n        reposition();\n      });\n    };\n\n    var getNotifications = constant(notifications);\n\n    var registerEvents = function (editor) {\n      editor.on('SkinLoaded', function () {\n        var serviceMessage = getServiceMessage(editor);\n\n        if (serviceMessage) {\n          open({\n            text: serviceMessage,\n            type: 'warning',\n            timeout: 0\n          }, false);\n        }\n\n        reposition();\n      });\n      editor.on('show ResizeEditor ResizeWindow NodeChange', function () {\n        Delay.requestAnimationFrame(reposition);\n      });\n      editor.on('remove', function () {\n        each$k(notifications.slice(), function (notification) {\n          getImplementation().close(notification);\n        });\n      });\n    };\n\n    registerEvents(editor);\n    return {\n      open: open,\n      close: close,\n      getNotifications: getNotifications\n    };\n  };\n\n  var PluginManager = AddOnManager.PluginManager;\n  var ThemeManager = AddOnManager.ThemeManager;\n\n  function WindowManagerImpl() {\n    var unimplemented = function () {\n      throw new Error('Theme did not provide a WindowManager implementation.');\n    };\n\n    return {\n      open: unimplemented,\n      openUrl: unimplemented,\n      alert: unimplemented,\n      confirm: unimplemented,\n      close: unimplemented,\n      getParams: unimplemented,\n      setParams: unimplemented\n    };\n  }\n\n  var WindowManager = function (editor) {\n    var dialogs = [];\n\n    var getImplementation = function () {\n      var theme = editor.theme;\n      return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n    };\n\n    var funcBind = function (scope, f) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        return f ? f.apply(scope, args) : undefined;\n      };\n    };\n\n    var fireOpenEvent = function (dialog) {\n      editor.fire('OpenWindow', {\n        dialog: dialog\n      });\n    };\n\n    var fireCloseEvent = function (dialog) {\n      editor.fire('CloseWindow', {\n        dialog: dialog\n      });\n    };\n\n    var addDialog = function (dialog) {\n      dialogs.push(dialog);\n      fireOpenEvent(dialog);\n    };\n\n    var closeDialog = function (dialog) {\n      fireCloseEvent(dialog);\n      dialogs = filter$4(dialogs, function (otherDialog) {\n        return otherDialog !== dialog;\n      });\n\n      if (dialogs.length === 0) {\n        editor.focus();\n      }\n    };\n\n    var getTopDialog = function () {\n      return Optional.from(dialogs[dialogs.length - 1]);\n    };\n\n    var storeSelectionAndOpenDialog = function (openDialog) {\n      editor.editorManager.setActive(editor);\n      store(editor);\n      var dialog = openDialog();\n      addDialog(dialog);\n      return dialog;\n    };\n\n    var open = function (args, params) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().open(args, params, closeDialog);\n      });\n    };\n\n    var openUrl = function (args) {\n      return storeSelectionAndOpenDialog(function () {\n        return getImplementation().openUrl(args, closeDialog);\n      });\n    };\n\n    var alert = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var confirm = function (message, callback, scope) {\n      var windowManagerImpl = getImplementation();\n      windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n    };\n\n    var close = function () {\n      getTopDialog().each(function (dialog) {\n        getImplementation().close(dialog);\n        closeDialog(dialog);\n      });\n    };\n\n    editor.on('remove', function () {\n      each$k(dialogs, function (dialog) {\n        getImplementation().close(dialog);\n      });\n    });\n    return {\n      open: open,\n      openUrl: openUrl,\n      alert: alert,\n      confirm: confirm,\n      close: close\n    };\n  };\n\n  var displayNotification = function (editor, message) {\n    editor.notificationManager.open({\n      type: 'error',\n      text: message\n    });\n  };\n\n  var displayError = function (editor, message) {\n    if (editor._skinLoaded) {\n      displayNotification(editor, message);\n    } else {\n      editor.on('SkinLoaded', function () {\n        displayNotification(editor, message);\n      });\n    }\n  };\n\n  var uploadError = function (editor, message) {\n    displayError(editor, I18n.translate(['Failed to upload image: {0}', message]));\n  };\n\n  var logError = function (editor, errorType, msg) {\n    fireError(editor, errorType, {\n      message: msg\n    });\n    console.error(msg);\n  };\n\n  var createLoadError = function (type, url, name) {\n    return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n  };\n\n  var pluginLoadError = function (editor, url, name) {\n    logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n  };\n\n  var iconsLoadError = function (editor, url, name) {\n    logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n  };\n\n  var languageLoadError = function (editor, url, name) {\n    logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n  };\n\n  var pluginInitError = function (editor, name, err) {\n    var message = I18n.translate(['Failed to initialize plugin: {0}', name]);\n    fireError(editor, 'PluginLoadError', {\n      message: message\n    });\n    initError(message, err);\n    displayError(editor, message);\n  };\n\n  var initError = function (message) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    var console = window.console;\n\n    if (console) {\n      if (console.error) {\n        console.error.apply(console, __spreadArray([message], x, false));\n      } else {\n        console.log.apply(console, __spreadArray([message], x, false));\n      }\n    }\n  };\n\n  var isContentCssSkinName = function (url) {\n    return /^[a-z0-9\\-]+$/i.test(url);\n  };\n\n  var getContentCssUrls = function (editor) {\n    return transformToUrls(editor, getContentCss(editor));\n  };\n\n  var getFontCssUrls = function (editor) {\n    return transformToUrls(editor, getFontCss(editor));\n  };\n\n  var transformToUrls = function (editor, cssLinks) {\n    var skinUrl = editor.editorManager.baseURL + '/skins/content';\n    var suffix = editor.editorManager.suffix;\n    var contentCssFile = 'content' + suffix + '.css';\n    var inline = editor.inline === true;\n    return map$3(cssLinks, function (url) {\n      if (isContentCssSkinName(url) && !inline) {\n        return skinUrl + '/' + url + '/' + contentCssFile;\n      } else {\n        return editor.documentBaseURI.toAbsolute(url);\n      }\n    });\n  };\n\n  var appendContentCssFromSettings = function (editor) {\n    editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n  };\n\n  var UploadStatus = function () {\n    var PENDING = 1,\n        UPLOADED = 2;\n    var blobUriStatuses = {};\n\n    var createStatus = function (status, resultUri) {\n      return {\n        status: status,\n        resultUri: resultUri\n      };\n    };\n\n    var hasBlobUri = function (blobUri) {\n      return blobUri in blobUriStatuses;\n    };\n\n    var getResultUri = function (blobUri) {\n      var result = blobUriStatuses[blobUri];\n      return result ? result.resultUri : null;\n    };\n\n    var isPending = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n    };\n\n    var isUploaded = function (blobUri) {\n      return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n    };\n\n    var markPending = function (blobUri) {\n      blobUriStatuses[blobUri] = createStatus(PENDING, null);\n    };\n\n    var markUploaded = function (blobUri, resultUri) {\n      blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n    };\n\n    var removeFailed = function (blobUri) {\n      delete blobUriStatuses[blobUri];\n    };\n\n    var destroy = function () {\n      blobUriStatuses = {};\n    };\n\n    return {\n      hasBlobUri: hasBlobUri,\n      getResultUri: getResultUri,\n      isPending: isPending,\n      isUploaded: isUploaded,\n      markPending: markPending,\n      markUploaded: markUploaded,\n      removeFailed: removeFailed,\n      destroy: destroy\n    };\n  };\n\n  var count = 0;\n\n  var seed = function () {\n    var rnd = function () {\n      return Math.round(Math.random() * 4294967295).toString(36);\n    };\n\n    var now = new Date().getTime();\n    return 's' + now.toString(36) + rnd() + rnd() + rnd();\n  };\n\n  var uuid = function (prefix) {\n    return prefix + count++ + seed();\n  };\n\n  var BlobCache = function () {\n    var cache = [];\n\n    var mimeToExt = function (mime) {\n      var mimes = {\n        'image/jpeg': 'jpg',\n        'image/jpg': 'jpg',\n        'image/gif': 'gif',\n        'image/png': 'png',\n        'image/apng': 'apng',\n        'image/avif': 'avif',\n        'image/svg+xml': 'svg',\n        'image/webp': 'webp',\n        'image/bmp': 'bmp',\n        'image/tiff': 'tiff'\n      };\n      return mimes[mime.toLowerCase()] || 'dat';\n    };\n\n    var create = function (o, blob, base64, name, filename) {\n      if (isString$1(o)) {\n        var id = o;\n        return toBlobInfo({\n          id: id,\n          name: name,\n          filename: filename,\n          blob: blob,\n          base64: base64\n        });\n      } else if (isObject(o)) {\n        return toBlobInfo(o);\n      } else {\n        throw new Error('Unknown input type');\n      }\n    };\n\n    var toBlobInfo = function (o) {\n      if (!o.blob || !o.base64) {\n        throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n      }\n\n      var id = o.id || uuid('blobid');\n      var name = o.name || id;\n      var blob = o.blob;\n      return {\n        id: constant(id),\n        name: constant(name),\n        filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n        blob: constant(blob),\n        base64: constant(o.base64),\n        blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n        uri: constant(o.uri)\n      };\n    };\n\n    var add = function (blobInfo) {\n      if (!get(blobInfo.id())) {\n        cache.push(blobInfo);\n      }\n    };\n\n    var findFirst = function (predicate) {\n      return find$3(cache, predicate).getOrUndefined();\n    };\n\n    var get = function (id) {\n      return findFirst(function (cachedBlobInfo) {\n        return cachedBlobInfo.id() === id;\n      });\n    };\n\n    var getByUri = function (blobUri) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.blobUri() === blobUri;\n      });\n    };\n\n    var getByData = function (base64, type) {\n      return findFirst(function (blobInfo) {\n        return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n      });\n    };\n\n    var removeByUri = function (blobUri) {\n      cache = filter$4(cache, function (blobInfo) {\n        if (blobInfo.blobUri() === blobUri) {\n          URL.revokeObjectURL(blobInfo.blobUri());\n          return false;\n        }\n\n        return true;\n      });\n    };\n\n    var destroy = function () {\n      each$k(cache, function (cachedBlobInfo) {\n        URL.revokeObjectURL(cachedBlobInfo.blobUri());\n      });\n      cache = [];\n    };\n\n    return {\n      create: create,\n      add: add,\n      get: get,\n      getByUri: getByUri,\n      getByData: getByData,\n      findFirst: findFirst,\n      removeByUri: removeByUri,\n      destroy: destroy\n    };\n  };\n\n  var Uploader = function (uploadStatus, settings) {\n    var pendingPromises = {};\n\n    var pathJoin = function (path1, path2) {\n      if (path1) {\n        return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n      }\n\n      return path2;\n    };\n\n    var defaultHandler = function (blobInfo, success, failure, progress) {\n      var xhr = new XMLHttpRequest();\n      xhr.open('POST', settings.url);\n      xhr.withCredentials = settings.credentials;\n\n      xhr.upload.onprogress = function (e) {\n        progress(e.loaded / e.total * 100);\n      };\n\n      xhr.onerror = function () {\n        failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n      };\n\n      xhr.onload = function () {\n        if (xhr.status < 200 || xhr.status >= 300) {\n          failure('HTTP Error: ' + xhr.status);\n          return;\n        }\n\n        var json = JSON.parse(xhr.responseText);\n\n        if (!json || typeof json.location !== 'string') {\n          failure('Invalid JSON: ' + xhr.responseText);\n          return;\n        }\n\n        success(pathJoin(settings.basePath, json.location));\n      };\n\n      var formData = new FormData();\n      formData.append('file', blobInfo.blob(), blobInfo.filename());\n      xhr.send(formData);\n    };\n\n    var noUpload = function () {\n      return new promiseObj(function (resolve) {\n        resolve([]);\n      });\n    };\n\n    var handlerSuccess = function (blobInfo, url) {\n      return {\n        url: url,\n        blobInfo: blobInfo,\n        status: true\n      };\n    };\n\n    var handlerFailure = function (blobInfo, message, options) {\n      return {\n        url: '',\n        blobInfo: blobInfo,\n        status: false,\n        error: {\n          message: message,\n          options: options\n        }\n      };\n    };\n\n    var resolvePending = function (blobUri, result) {\n      Tools.each(pendingPromises[blobUri], function (resolve) {\n        resolve(result);\n      });\n      delete pendingPromises[blobUri];\n    };\n\n    var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n      uploadStatus.markPending(blobInfo.blobUri());\n      return new promiseObj(function (resolve) {\n        var notification, progress;\n\n        try {\n          var closeNotification_1 = function () {\n            if (notification) {\n              notification.close();\n              progress = noop;\n            }\n          };\n\n          var success = function (url) {\n            closeNotification_1();\n            uploadStatus.markUploaded(blobInfo.blobUri(), url);\n            resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n            resolve(handlerSuccess(blobInfo, url));\n          };\n\n          var failure = function (error, options) {\n            var failureOptions = options ? options : {};\n            closeNotification_1();\n            uploadStatus.removeFailed(blobInfo.blobUri());\n            resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n            resolve(handlerFailure(blobInfo, error, failureOptions));\n          };\n\n          progress = function (percent) {\n            if (percent < 0 || percent > 100) {\n              return;\n            }\n\n            Optional.from(notification).orThunk(function () {\n              return Optional.from(openNotification).map(apply);\n            }).each(function (n) {\n              notification = n;\n              n.progressBar.value(percent);\n            });\n          };\n\n          handler(blobInfo, success, failure, progress);\n        } catch (ex) {\n          resolve(handlerFailure(blobInfo, ex.message, {}));\n        }\n      });\n    };\n\n    var isDefaultHandler = function (handler) {\n      return handler === defaultHandler;\n    };\n\n    var pendingUploadBlobInfo = function (blobInfo) {\n      var blobUri = blobInfo.blobUri();\n      return new promiseObj(function (resolve) {\n        pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n        pendingPromises[blobUri].push(resolve);\n      });\n    };\n\n    var uploadBlobs = function (blobInfos, openNotification) {\n      blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n        return !uploadStatus.isUploaded(blobInfo.blobUri());\n      });\n      return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n        return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n      }));\n    };\n\n    var upload = function (blobInfos, openNotification) {\n      return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n    };\n\n    if (isFunction(settings.handler) === false) {\n      settings.handler = defaultHandler;\n    }\n\n    return {\n      upload: upload\n    };\n  };\n\n  var openNotification = function (editor) {\n    return function () {\n      return editor.notificationManager.open({\n        text: editor.translate('Image uploading...'),\n        type: 'info',\n        timeout: -1,\n        progressBar: true\n      });\n    };\n  };\n\n  var createUploader = function (editor, uploadStatus) {\n    return Uploader(uploadStatus, {\n      url: getImageUploadUrl(editor),\n      basePath: getImageUploadBasePath(editor),\n      credentials: getImagesUploadCredentials(editor),\n      handler: getImagesUploadHandler(editor)\n    });\n  };\n\n  var ImageUploader = function (editor) {\n    var uploadStatus = UploadStatus();\n    var uploader = createUploader(editor, uploadStatus);\n    return {\n      upload: function (blobInfos, showNotification) {\n        if (showNotification === void 0) {\n          showNotification = true;\n        }\n\n        return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n      }\n    };\n  };\n\n  var UploadChangeHandler = function (editor) {\n    var lastChangedLevel = Cell(null);\n    editor.on('change AddUndo', function (e) {\n      lastChangedLevel.set(__assign({}, e.level));\n    });\n\n    var fireIfChanged = function () {\n      var data = editor.undoManager.data;\n      last$2(data).filter(function (level) {\n        return !isEq$1(lastChangedLevel.get(), level);\n      }).each(function (level) {\n        editor.setDirty(true);\n        editor.fire('change', {\n          level: level,\n          lastLevel: get$a(data, data.length - 2).getOrNull()\n        });\n      });\n    };\n\n    return {\n      fireIfChanged: fireIfChanged\n    };\n  };\n\n  var EditorUpload = function (editor) {\n    var blobCache = BlobCache();\n    var uploader, imageScanner;\n    var uploadStatus = UploadStatus();\n    var urlFilters = [];\n    var changeHandler = UploadChangeHandler(editor);\n\n    var aliveGuard = function (callback) {\n      return function (result) {\n        if (editor.selection) {\n          return callback(result);\n        }\n\n        return [];\n      };\n    };\n\n    var cacheInvalidator = function (url) {\n      return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n    };\n\n    var replaceString = function (content, search, replace) {\n      var index = 0;\n\n      do {\n        index = content.indexOf(search, index);\n\n        if (index !== -1) {\n          content = content.substring(0, index) + replace + content.substr(index + search.length);\n          index += replace.length - search.length + 1;\n        }\n      } while (index !== -1);\n\n      return content;\n    };\n\n    var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n      var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n      content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n      content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n      return content;\n    };\n\n    var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n      each$k(editor.undoManager.data, function (level) {\n        if (level.type === 'fragmented') {\n          level.fragments = map$3(level.fragments, function (fragment) {\n            return replaceImageUrl(fragment, targetUrl, replacementUrl);\n          });\n        } else {\n          level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n        }\n      });\n    };\n\n    var replaceImageUriInView = function (image, resultUri) {\n      var src = editor.convertURL(resultUri, 'src');\n      replaceUrlInUndoStack(image.src, resultUri);\n      editor.$(image).attr({\n        'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n        'data-mce-src': src\n      });\n    };\n\n    var uploadImages = function (callback) {\n      if (!uploader) {\n        uploader = createUploader(editor, uploadStatus);\n      }\n\n      return scanForImages().then(aliveGuard(function (imageInfos) {\n        var blobInfos = map$3(imageInfos, function (imageInfo) {\n          return imageInfo.blobInfo;\n        });\n        return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n          var imagesToRemove = [];\n          var filteredResult = map$3(result, function (uploadInfo, index) {\n            var blobInfo = imageInfos[index].blobInfo;\n            var image = imageInfos[index].image;\n\n            if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n              blobCache.removeByUri(image.src);\n              if (isRtc(editor)) ;else {\n                replaceImageUriInView(image, uploadInfo.url);\n              }\n            } else if (uploadInfo.error) {\n              if (uploadInfo.error.options.remove) {\n                replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                imagesToRemove.push(image);\n              }\n\n              uploadError(editor, uploadInfo.error.message);\n            }\n\n            return {\n              element: image,\n              status: uploadInfo.status,\n              uploadUri: uploadInfo.url,\n              blobInfo: blobInfo\n            };\n          });\n\n          if (filteredResult.length > 0) {\n            changeHandler.fireIfChanged();\n          }\n\n          if (imagesToRemove.length > 0) {\n            if (isRtc(editor)) {\n              console.error('Removing images on failed uploads is currently unsupported for RTC');\n            } else {\n              editor.undoManager.transact(function () {\n                each$k(imagesToRemove, function (element) {\n                  editor.dom.remove(element);\n                  blobCache.removeByUri(element.src);\n                });\n              });\n            }\n          }\n\n          if (callback) {\n            callback(filteredResult);\n          }\n\n          return filteredResult;\n        }));\n      }));\n    };\n\n    var uploadImagesAuto = function (callback) {\n      if (isAutomaticUploadsEnabled(editor)) {\n        return uploadImages(callback);\n      }\n    };\n\n    var isValidDataUriImage = function (imgElm) {\n      if (forall(urlFilters, function (filter) {\n        return filter(imgElm);\n      }) === false) {\n        return false;\n      }\n\n      if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n        var dataImgFilter = getImagesDataImgFilter(editor);\n        return dataImgFilter(imgElm);\n      }\n\n      return true;\n    };\n\n    var addFilter = function (filter) {\n      urlFilters.push(filter);\n    };\n\n    var scanForImages = function () {\n      if (!imageScanner) {\n        imageScanner = ImageScanner(uploadStatus, blobCache);\n      }\n\n      return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n        result = filter$4(result, function (resultItem) {\n          if (typeof resultItem === 'string') {\n            displayError(editor, resultItem);\n            return false;\n          }\n\n          return true;\n        });\n        if (isRtc(editor)) ;else {\n          each$k(result, function (resultItem) {\n            replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n            resultItem.image.src = resultItem.blobInfo.blobUri();\n            resultItem.image.removeAttribute('data-mce-src');\n          });\n        }\n        return result;\n      }));\n    };\n\n    var destroy = function () {\n      blobCache.destroy();\n      uploadStatus.destroy();\n      imageScanner = uploader = null;\n    };\n\n    var replaceBlobUris = function (content) {\n      return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n        var resultUri = uploadStatus.getResultUri(blobUri);\n\n        if (resultUri) {\n          return 'src=\"' + resultUri + '\"';\n        }\n\n        var blobInfo = blobCache.getByUri(blobUri);\n\n        if (!blobInfo) {\n          blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n            return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n          }, null);\n        }\n\n        if (blobInfo) {\n          var blob = blobInfo.blob();\n          return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n        }\n\n        return match;\n      });\n    };\n\n    editor.on('SetContent', function () {\n      if (isAutomaticUploadsEnabled(editor)) {\n        uploadImagesAuto();\n      } else {\n        scanForImages();\n      }\n    });\n    editor.on('RawSaveContent', function (e) {\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('GetContent', function (e) {\n      if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n        return;\n      }\n\n      e.content = replaceBlobUris(e.content);\n    });\n    editor.on('PostRender', function () {\n      editor.parser.addNodeFilter('img', function (images) {\n        each$k(images, function (img) {\n          var src = img.attr('src');\n\n          if (blobCache.getByUri(src)) {\n            return;\n          }\n\n          var resultUri = uploadStatus.getResultUri(src);\n\n          if (resultUri) {\n            img.attr('src', resultUri);\n          }\n        });\n      });\n    });\n    return {\n      blobCache: blobCache,\n      addFilter: addFilter,\n      uploadImages: uploadImages,\n      uploadImagesAuto: uploadImagesAuto,\n      scanForImages: scanForImages,\n      destroy: destroy\n    };\n  };\n\n  var get = function (dom) {\n    var formats = {\n      valigntop: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'top'\n        }\n      }],\n      valignmiddle: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'middle'\n        }\n      }],\n      valignbottom: [{\n        selector: 'td,th',\n        styles: {\n          verticalAlign: 'bottom'\n        }\n      }],\n      alignleft: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-left',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'left'\n        },\n        inherit: false,\n        preview: false,\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table,audio,video',\n        collapsed: false,\n        styles: {\n          float: 'left'\n        },\n        preview: 'font-family font-size'\n      }],\n      aligncenter: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'center'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-center',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'img,audio,video',\n        collapsed: false,\n        styles: {\n          display: 'block',\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: false\n      }, {\n        selector: 'table',\n        collapsed: false,\n        styles: {\n          marginLeft: 'auto',\n          marginRight: 'auto'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignright: [{\n        selector: 'figure.image',\n        collapsed: false,\n        classes: 'align-right',\n        ceFalseOverride: true,\n        preview: 'font-family font-size'\n      }, {\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'right'\n        },\n        inherit: false,\n        preview: 'font-family font-size',\n        defaultBlock: 'div'\n      }, {\n        selector: 'img,table,audio,video',\n        collapsed: false,\n        styles: {\n          float: 'right'\n        },\n        preview: 'font-family font-size'\n      }],\n      alignjustify: [{\n        selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n        styles: {\n          textAlign: 'justify'\n        },\n        inherit: false,\n        defaultBlock: 'div',\n        preview: 'font-family font-size'\n      }],\n      bold: [{\n        inline: 'strong',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontWeight: 'bold'\n        }\n      }, {\n        inline: 'b',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      italic: [{\n        inline: 'em',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 'span',\n        styles: {\n          fontStyle: 'italic'\n        }\n      }, {\n        inline: 'i',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      underline: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'underline'\n        },\n        exact: true\n      }, {\n        inline: 'u',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      strikethrough: [{\n        inline: 'span',\n        styles: {\n          textDecoration: 'line-through'\n        },\n        exact: true\n      }, {\n        inline: 'strike',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }, {\n        inline: 's',\n        remove: 'all',\n        preserve_attributes: ['class', 'style']\n      }],\n      forecolor: {\n        inline: 'span',\n        styles: {\n          color: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      hilitecolor: {\n        inline: 'span',\n        styles: {\n          backgroundColor: '%value'\n        },\n        links: true,\n        remove_similar: true,\n        clear_child_styles: true\n      },\n      fontname: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontFamily: '%value'\n        },\n        clear_child_styles: true\n      },\n      fontsize: {\n        inline: 'span',\n        toggle: false,\n        styles: {\n          fontSize: '%value'\n        },\n        clear_child_styles: true\n      },\n      lineheight: {\n        selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n        defaultBlock: 'p',\n        styles: {\n          lineHeight: '%value'\n        }\n      },\n      fontsize_class: {\n        inline: 'span',\n        attributes: {\n          class: '%value'\n        }\n      },\n      blockquote: {\n        block: 'blockquote',\n        wrapper: true,\n        remove: 'all'\n      },\n      subscript: {\n        inline: 'sub'\n      },\n      superscript: {\n        inline: 'sup'\n      },\n      code: {\n        inline: 'code'\n      },\n      link: {\n        inline: 'a',\n        selector: 'a',\n        remove: 'all',\n        split: true,\n        deep: true,\n        onmatch: function (node, _fmt, _itemName) {\n          return isElement$5(node) && node.hasAttribute('href');\n        },\n        onformat: function (elm, _fmt, vars) {\n          Tools.each(vars, function (value, key) {\n            dom.setAttrib(elm, key, value);\n          });\n        }\n      },\n      lang: {\n        inline: 'span',\n        clear_child_styles: true,\n        remove_similar: true,\n        attributes: {\n          'lang': '%value',\n          'data-mce-lang': function (vars) {\n            var _a;\n\n            return (_a = vars === null || vars === void 0 ? void 0 : vars.customValue) !== null && _a !== void 0 ? _a : null;\n          }\n        }\n      },\n      removeformat: [{\n        selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small',\n        remove: 'all',\n        split: true,\n        expand: false,\n        block_expand: true,\n        deep: true\n      }, {\n        selector: 'span',\n        attributes: ['style', 'class'],\n        remove: 'empty',\n        split: true,\n        expand: false,\n        deep: true\n      }, {\n        selector: '*',\n        attributes: ['style', 'class'],\n        split: false,\n        expand: false,\n        deep: true\n      }]\n    };\n    Tools.each('p h1 h2 h3 h4 h5 h6 div address pre dt dd samp'.split(/\\s/), function (name) {\n      formats[name] = {\n        block: name,\n        remove: 'all'\n      };\n    });\n    return formats;\n  };\n\n  var FormatRegistry = function (editor) {\n    var formats = {};\n\n    var get$1 = function (name) {\n      return isNonNullable(name) ? formats[name] : formats;\n    };\n\n    var has = function (name) {\n      return has$2(formats, name);\n    };\n\n    var register = function (name, format) {\n      if (name) {\n        if (!isString$1(name)) {\n          each$j(name, function (format, name) {\n            register(name, format);\n          });\n        } else {\n          if (!isArray$1(format)) {\n            format = [format];\n          }\n\n          each$k(format, function (format) {\n            if (isUndefined(format.deep)) {\n              format.deep = !isSelectorFormat(format);\n            }\n\n            if (isUndefined(format.split)) {\n              format.split = !isSelectorFormat(format) || isInlineFormat(format);\n            }\n\n            if (isUndefined(format.remove) && isSelectorFormat(format) && !isInlineFormat(format)) {\n              format.remove = 'none';\n            }\n\n            if (isSelectorFormat(format) && isInlineFormat(format)) {\n              format.mixed = true;\n              format.block_expand = true;\n            }\n\n            if (isString$1(format.classes)) {\n              format.classes = format.classes.split(/\\s+/);\n            }\n          });\n          formats[name] = format;\n        }\n      }\n    };\n\n    var unregister = function (name) {\n      if (name && formats[name]) {\n        delete formats[name];\n      }\n\n      return formats;\n    };\n\n    register(get(editor.dom));\n    register(getFormats(editor));\n    return {\n      get: get$1,\n      has: has,\n      register: register,\n      unregister: unregister\n    };\n  };\n\n  var each$5 = Tools.each;\n  var dom = DOMUtils.DOM;\n\n  var parsedSelectorToHtml = function (ancestry, editor) {\n    var elm, item, fragment;\n    var schema = editor && editor.schema || Schema({});\n\n    var decorate = function (elm, item) {\n      if (item.classes.length) {\n        dom.addClass(elm, item.classes.join(' '));\n      }\n\n      dom.setAttribs(elm, item.attrs);\n    };\n\n    var createElement = function (sItem) {\n      item = typeof sItem === 'string' ? {\n        name: sItem,\n        classes: [],\n        attrs: {}\n      } : sItem;\n      var elm = dom.create(item.name);\n      decorate(elm, item);\n      return elm;\n    };\n\n    var getRequiredParent = function (elm, candidate) {\n      var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n      var elmRule = schema.getElementRule(name);\n      var parentsRequired = elmRule && elmRule.parentsRequired;\n\n      if (parentsRequired && parentsRequired.length) {\n        return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n      } else {\n        return false;\n      }\n    };\n\n    var wrapInHtml = function (elm, ancestry, siblings) {\n      var parent, parentCandidate;\n      var ancestor = ancestry.length > 0 && ancestry[0];\n      var ancestorName = ancestor && ancestor.name;\n      var parentRequired = getRequiredParent(elm, ancestorName);\n\n      if (parentRequired) {\n        if (ancestorName === parentRequired) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else {\n          parentCandidate = parentRequired;\n        }\n      } else if (ancestor) {\n        parentCandidate = ancestry[0];\n        ancestry = ancestry.slice(1);\n      } else if (!siblings) {\n        return elm;\n      }\n\n      if (parentCandidate) {\n        parent = createElement(parentCandidate);\n        parent.appendChild(elm);\n      }\n\n      if (siblings) {\n        if (!parent) {\n          parent = dom.create('div');\n          parent.appendChild(elm);\n        }\n\n        Tools.each(siblings, function (sibling) {\n          var siblingElm = createElement(sibling);\n          parent.insertBefore(siblingElm, elm);\n        });\n      }\n\n      return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n    };\n\n    if (ancestry && ancestry.length) {\n      item = ancestry[0];\n      elm = createElement(item);\n      fragment = dom.create('div');\n      fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n      return fragment;\n    } else {\n      return '';\n    }\n  };\n\n  var parseSelectorItem = function (item) {\n    var tagName;\n    var obj = {\n      classes: [],\n      attrs: {}\n    };\n    item = obj.selector = Tools.trim(item);\n\n    if (item !== '*') {\n      tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n        switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n\n          case '.':\n            obj.classes.push($2);\n            break;\n\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n\n            break;\n        }\n\n        if ($3 === '[') {\n          var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n\n          if (m) {\n            obj.attrs[m[1]] = m[2];\n          }\n        }\n\n        return '';\n      });\n    }\n\n    obj.name = tagName || 'div';\n    return obj;\n  };\n\n  var parseSelector = function (selector) {\n    if (!selector || typeof selector !== 'string') {\n      return [];\n    }\n\n    selector = selector.split(/\\s*,\\s*/)[0];\n    selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n    return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n      var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n      var obj = siblings.pop();\n\n      if (siblings.length) {\n        obj.siblings = siblings;\n      }\n\n      return obj;\n    }).reverse();\n  };\n\n  var getCssText = function (editor, format) {\n    var name, previewFrag;\n    var previewCss = '',\n        parentFontSize;\n    var previewStyles = getPreviewStyles(editor);\n\n    if (previewStyles === '') {\n      return '';\n    }\n\n    var removeVars = function (val) {\n      return val.replace(/%(\\w+)/g, '');\n    };\n\n    if (typeof format === 'string') {\n      format = editor.formatter.get(format);\n\n      if (!format) {\n        return;\n      }\n\n      format = format[0];\n    }\n\n    if ('preview' in format) {\n      var previewOpt = get$9(format, 'preview');\n\n      if (is$1(previewOpt, false)) {\n        return '';\n      } else {\n        previewStyles = previewOpt.getOr(previewStyles);\n      }\n    }\n\n    name = format.block || format.inline || 'span';\n    var items = parseSelector(format.selector);\n\n    if (items.length) {\n      if (!items[0].name) {\n        items[0].name = name;\n      }\n\n      name = format.selector;\n      previewFrag = parsedSelectorToHtml(items, editor);\n    } else {\n      previewFrag = parsedSelectorToHtml([name], editor);\n    }\n\n    var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n    each$5(format.styles, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setStyle(previewElm, name, newValue);\n      }\n    });\n    each$5(format.attributes, function (value, name) {\n      var newValue = removeVars(value);\n\n      if (newValue) {\n        dom.setAttrib(previewElm, name, newValue);\n      }\n    });\n    each$5(format.classes, function (value) {\n      var newValue = removeVars(value);\n\n      if (!dom.hasClass(previewElm, newValue)) {\n        dom.addClass(previewElm, newValue);\n      }\n    });\n    editor.fire('PreviewFormats');\n    dom.setStyles(previewFrag, {\n      position: 'absolute',\n      left: -65535\n    });\n    editor.getBody().appendChild(previewFrag);\n    parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n    parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n    each$5(previewStyles.split(' '), function (name) {\n      var value = dom.getStyle(previewElm, name, true);\n\n      if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n        value = dom.getStyle(editor.getBody(), name, true);\n\n        if (dom.toHex(value).toLowerCase() === '#ffffff') {\n          return;\n        }\n      }\n\n      if (name === 'color') {\n        if (dom.toHex(value).toLowerCase() === '#000000') {\n          return;\n        }\n      }\n\n      if (name === 'font-size') {\n        if (/em|%$/.test(value)) {\n          if (parentFontSize === 0) {\n            return;\n          }\n\n          var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n          value = numValue * parentFontSize + 'px';\n        }\n      }\n\n      if (name === 'border' && value) {\n        previewCss += 'padding:0 2px;';\n      }\n\n      previewCss += name + ':' + value + ';';\n    });\n    editor.fire('AfterPreviewFormats');\n    dom.remove(previewFrag);\n    return previewCss;\n  };\n\n  var setup$h = function (editor) {\n    editor.addShortcut('meta+b', '', 'Bold');\n    editor.addShortcut('meta+i', '', 'Italic');\n    editor.addShortcut('meta+u', '', 'Underline');\n\n    for (var i = 1; i <= 6; i++) {\n      editor.addShortcut('access+' + i, '', ['FormatBlock', false, 'h' + i]);\n    }\n\n    editor.addShortcut('access+7', '', ['FormatBlock', false, 'p']);\n    editor.addShortcut('access+8', '', ['FormatBlock', false, 'div']);\n    editor.addShortcut('access+9', '', ['FormatBlock', false, 'address']);\n  };\n\n  var Formatter = function (editor) {\n    var formats = FormatRegistry(editor);\n    var formatChangeState = Cell(null);\n    setup$h(editor);\n    setup$k(editor);\n    return {\n      get: formats.get,\n      has: formats.has,\n      register: formats.register,\n      unregister: formats.unregister,\n      apply: function (name, vars, node) {\n        applyFormat(editor, name, vars, node);\n      },\n      remove: function (name, vars, node, similar) {\n        removeFormat(editor, name, vars, node, similar);\n      },\n      toggle: function (name, vars, node) {\n        toggleFormat(editor, name, vars, node);\n      },\n      match: function (name, vars, node, similar) {\n        return matchFormat(editor, name, vars, node, similar);\n      },\n      closest: function (names) {\n        return closestFormat(editor, names);\n      },\n      matchAll: function (names, vars) {\n        return matchAllFormats(editor, names, vars);\n      },\n      matchNode: function (node, name, vars, similar) {\n        return matchNodeFormat(editor, node, name, vars, similar);\n      },\n      canApply: function (name) {\n        return canApplyFormat(editor, name);\n      },\n      formatChanged: function (formats, callback, similar, vars) {\n        return formatChanged(editor, formatChangeState, formats, callback, similar, vars);\n      },\n      getCssText: curry(getCssText, editor)\n    };\n  };\n\n  var shouldIgnoreCommand = function (cmd) {\n    switch (cmd.toLowerCase()) {\n      case 'undo':\n      case 'redo':\n      case 'mcerepaint':\n      case 'mcefocus':\n        return true;\n\n      default:\n        return false;\n    }\n  };\n\n  var registerEvents = function (editor, undoManager, locks) {\n    var isFirstTypedCharacter = Cell(false);\n\n    var addNonTypingUndoLevel = function (e) {\n      setTyping(undoManager, false, locks);\n      undoManager.add({}, e);\n    };\n\n    editor.on('init', function () {\n      undoManager.add();\n    });\n    editor.on('BeforeExecCommand', function (e) {\n      var cmd = e.command;\n\n      if (!shouldIgnoreCommand(cmd)) {\n        endTyping(undoManager, locks);\n        undoManager.beforeChange();\n      }\n    });\n    editor.on('ExecCommand', function (e) {\n      var cmd = e.command;\n\n      if (!shouldIgnoreCommand(cmd)) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('ObjectResizeStart cut', function () {\n      undoManager.beforeChange();\n    });\n    editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n    editor.on('dragend', addNonTypingUndoLevel);\n    editor.on('keyup', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n        addNonTypingUndoLevel();\n        editor.nodeChanged();\n      }\n\n      if (keyCode === 46 || keyCode === 8) {\n        editor.nodeChanged();\n      }\n\n      if (isFirstTypedCharacter.get() && undoManager.typing && isEq$1(createFromEditor(editor), undoManager.data[0]) === false) {\n        if (editor.isDirty() === false) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: undoManager.data[0],\n            lastLevel: null\n          });\n        }\n\n        editor.fire('TypingUndo');\n        isFirstTypedCharacter.set(false);\n        editor.nodeChanged();\n      }\n    });\n    editor.on('keydown', function (e) {\n      var keyCode = e.keyCode;\n\n      if (e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n\n        return;\n      }\n\n      var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n\n      if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n        undoManager.beforeChange();\n        setTyping(undoManager, true, locks);\n        undoManager.add({}, e);\n        isFirstTypedCharacter.set(true);\n      }\n    });\n    editor.on('mousedown', function (e) {\n      if (undoManager.typing) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n\n    var isInsertReplacementText = function (event) {\n      return event.inputType === 'insertReplacementText';\n    };\n\n    var isInsertTextDataNull = function (event) {\n      return event.inputType === 'insertText' && event.data === null;\n    };\n\n    var isInsertFromPasteOrDrop = function (event) {\n      return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n    };\n\n    editor.on('input', function (e) {\n      if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n        addNonTypingUndoLevel(e);\n      }\n    });\n    editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n      if (!e.isDefaultPrevented()) {\n        editor.nodeChanged();\n      }\n    });\n  };\n\n  var addKeyboardShortcuts = function (editor) {\n    editor.addShortcut('meta+z', '', 'Undo');\n    editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n  };\n\n  var UndoManager = function (editor) {\n    var beforeBookmark = value();\n    var locks = Cell(0);\n    var index = Cell(0);\n    var undoManager = {\n      data: [],\n      typing: false,\n      beforeChange: function () {\n        beforeChange(editor, locks, beforeBookmark);\n      },\n      add: function (level, event) {\n        return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n      },\n      undo: function () {\n        return undo(editor, undoManager, locks, index);\n      },\n      redo: function () {\n        return redo(editor, index, undoManager.data);\n      },\n      clear: function () {\n        clear(editor, undoManager, index);\n      },\n      reset: function () {\n        reset(editor, undoManager);\n      },\n      hasUndo: function () {\n        return hasUndo(editor, undoManager, index);\n      },\n      hasRedo: function () {\n        return hasRedo(editor, undoManager, index);\n      },\n      transact: function (callback) {\n        return transact(editor, undoManager, locks, callback);\n      },\n      ignore: function (callback) {\n        ignore(editor, locks, callback);\n      },\n      extra: function (callback1, callback2) {\n        extra(editor, undoManager, index, callback1, callback2);\n      }\n    };\n\n    if (!isRtc(editor)) {\n      registerEvents(editor, undoManager, locks);\n    }\n\n    addKeyboardShortcuts(editor);\n    return undoManager;\n  };\n\n  var nonTypingKeycodes = [9, 27, VK.HOME, VK.END, 19, 20, 44, 144, 145, 33, 34, 45, 16, 17, 18, 91, 92, 93, VK.DOWN, VK.UP, VK.LEFT, VK.RIGHT].concat(Env.browser.isFirefox() ? [224] : []);\n  var placeholderAttr = 'data-mce-placeholder';\n\n  var isKeyboardEvent = function (e) {\n    return e.type === 'keydown' || e.type === 'keyup';\n  };\n\n  var isDeleteEvent = function (e) {\n    var keyCode = e.keyCode;\n    return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n  };\n\n  var isNonTypingKeyboardEvent = function (e) {\n    if (isKeyboardEvent(e)) {\n      var keyCode = e.keyCode;\n      return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains$3(nonTypingKeycodes, keyCode));\n    } else {\n      return false;\n    }\n  };\n\n  var isTypingKeyboardEvent = function (e) {\n    return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n  };\n\n  var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n    if (isEmpty$2(SugarElement.fromDom(rootElm), false)) {\n      var isForcedRootBlockFalse = forcedRootBlock === '';\n      var firstElement = rootElm.firstElementChild;\n\n      if (!firstElement) {\n        return true;\n      } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n        return false;\n      } else {\n        return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n      }\n    } else {\n      return false;\n    }\n  };\n\n  var setup$g = function (editor) {\n    var dom = editor.dom;\n    var rootBlock = getForcedRootBlock(editor);\n    var placeholder = getPlaceholder(editor);\n\n    var updatePlaceholder = function (e, initial) {\n      if (isNonTypingKeyboardEvent(e)) {\n        return;\n      }\n\n      var body = editor.getBody();\n      var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n      var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n\n      if (isPlaceholderShown !== showPlaceholder || initial) {\n        dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n        dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n        firePlaceholderToggle(editor, showPlaceholder);\n        editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n        editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n      }\n    };\n\n    if (placeholder) {\n      editor.on('init', function (e) {\n        updatePlaceholder(e, true);\n        editor.on('change SetContent ExecCommand', updatePlaceholder);\n        editor.on('paste', function (e) {\n          return Delay.setEditorTimeout(editor, function () {\n            return updatePlaceholder(e);\n          });\n        });\n      });\n    }\n  };\n\n  var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n\n  var hasStrongRtl = function (text) {\n    return strongRtl.test(text);\n  };\n\n  var isInlineTarget = function (editor, elm) {\n    return is$2(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n  };\n\n  var isRtl = function (element) {\n    return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n  };\n\n  var findInlineParents = function (isInlineTarget, rootNode, pos) {\n    return filter$4(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n  };\n\n  var findRootInline = function (isInlineTarget, rootNode, pos) {\n    var parents = findInlineParents(isInlineTarget, rootNode, pos);\n    return Optional.from(parents[parents.length - 1]);\n  };\n\n  var hasSameParentBlock = function (rootNode, node1, node2) {\n    var block1 = getParentBlock$2(node1, rootNode);\n    var block2 = getParentBlock$2(node2, rootNode);\n    return block1 && block1 === block2;\n  };\n\n  var isAtZwsp = function (pos) {\n    return isBeforeInline(pos) || isAfterInline(pos);\n  };\n\n  var normalizePosition = function (forward, pos) {\n    if (!pos) {\n      return pos;\n    }\n\n    var container = pos.container(),\n        offset = pos.offset();\n\n    if (forward) {\n      if (isCaretContainerInline(container)) {\n        if (isText$7(container.nextSibling)) {\n          return CaretPosition(container.nextSibling, 0);\n        } else {\n          return CaretPosition.after(container);\n        }\n      } else {\n        return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n      }\n    } else {\n      if (isCaretContainerInline(container)) {\n        if (isText$7(container.previousSibling)) {\n          return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n        } else {\n          return CaretPosition.before(container);\n        }\n      } else {\n        return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n      }\n    }\n  };\n\n  var normalizeForwards = curry(normalizePosition, true);\n  var normalizeBackwards = curry(normalizePosition, false);\n\n  var isBeforeRoot = function (rootNode) {\n    return function (elm) {\n      return eq(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n    };\n  };\n\n  var isTextBlockOrListItem = function (element) {\n    return isTextBlock$2(element) || isListItem(element);\n  };\n\n  var getParentBlock$1 = function (rootNode, elm) {\n    if (contains$1(rootNode, elm)) {\n      return closest$3(elm, isTextBlockOrListItem, isBeforeRoot(rootNode));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var placeCaretInEmptyBody = function (editor) {\n    var body = editor.getBody();\n    var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n    editor.selection.setCursorLocation(node, 0);\n  };\n\n  var paddEmptyBody = function (editor) {\n    if (editor.dom.isEmpty(editor.getBody())) {\n      editor.setContent('');\n      placeCaretInEmptyBody(editor);\n    }\n  };\n\n  var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      var normalizedFromPos = normalizePosition(false, fromPos);\n\n      if (forward) {\n        return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n          return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n        });\n      } else {\n        return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n          return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n        });\n      }\n    }).getOr(true);\n  };\n\n  var blockPosition = function (block, position) {\n    return {\n      block: block,\n      position: position\n    };\n  };\n\n  var blockBoundary = function (from, to) {\n    return {\n      from: from,\n      to: to\n    };\n  };\n\n  var getBlockPosition = function (rootNode, pos) {\n    var rootElm = SugarElement.fromDom(rootNode);\n    var containerElm = SugarElement.fromDom(pos.container());\n    return getParentBlock$1(rootElm, containerElm).map(function (block) {\n      return blockPosition(block, pos);\n    });\n  };\n\n  var isDifferentBlocks = function (blockBoundary) {\n    return eq(blockBoundary.from.block, blockBoundary.to.block) === false;\n  };\n\n  var hasSameParent = function (blockBoundary) {\n    return parent(blockBoundary.from.block).bind(function (parent1) {\n      return parent(blockBoundary.to.block).filter(function (parent2) {\n        return eq(parent1, parent2);\n      });\n    }).isSome();\n  };\n\n  var isEditable$1 = function (blockBoundary) {\n    return isContentEditableFalse$b(blockBoundary.from.block.dom) === false && isContentEditableFalse$b(blockBoundary.to.block.dom) === false;\n  };\n\n  var skipLastBr = function (rootNode, forward, blockPosition) {\n    if (isBr$5(blockPosition.position.getNode()) && isEmpty$2(blockPosition.block) === false) {\n      return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n        if (lastPositionInBlock.isEqual(blockPosition.position)) {\n          return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n            return getBlockPosition(rootNode, to);\n          });\n        } else {\n          return Optional.some(blockPosition);\n        }\n      }).getOr(blockPosition);\n    } else {\n      return blockPosition;\n    }\n  };\n\n  var readFromRange = function (rootNode, forward, rng) {\n    var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n    var toBlockPos = fromBlockPos.bind(function (blockPos) {\n      return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n        return getBlockPosition(rootNode, to).map(function (blockPos) {\n          return skipLastBr(rootNode, forward, blockPos);\n        });\n      });\n    });\n    return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n      return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable$1(blockBoundary);\n    });\n  };\n\n  var read$1 = function (rootNode, forward, rng) {\n    return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n  };\n\n  var getChildrenUntilBlockBoundary = function (block) {\n    var children$1 = children(block);\n    return findIndex$2(children$1, isBlock$2).fold(constant(children$1), function (index) {\n      return children$1.slice(0, index);\n    });\n  };\n\n  var extractChildren = function (block) {\n    var children = getChildrenUntilBlockBoundary(block);\n    each$k(children, remove$7);\n    return children;\n  };\n\n  var removeEmptyRoot = function (rootNode, block) {\n    var parents = parentsAndSelf(block, rootNode);\n    return find$3(parents.reverse(), function (element) {\n      return isEmpty$2(element);\n    }).each(remove$7);\n  };\n\n  var isEmptyBefore = function (el) {\n    return filter$4(prevSiblings(el), function (el) {\n      return !isEmpty$2(el);\n    }).length === 0;\n  };\n\n  var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n    if (isEmpty$2(toBlock)) {\n      fillWithPaddingBr(toBlock);\n      return firstPositionIn(toBlock.dom);\n    }\n\n    if (isEmptyBefore(insertionPoint) && isEmpty$2(fromBlock)) {\n      before$4(insertionPoint, SugarElement.fromTag('br'));\n    }\n\n    var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n    each$k(extractChildren(fromBlock), function (child) {\n      before$4(insertionPoint, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n    if (isEmpty$2(toBlock)) {\n      remove$7(toBlock);\n\n      if (isEmpty$2(fromBlock)) {\n        fillWithPaddingBr(fromBlock);\n      }\n\n      return firstPositionIn(fromBlock.dom);\n    }\n\n    var position = lastPositionIn(toBlock.dom);\n    each$k(extractChildren(fromBlock), function (child) {\n      append$1(toBlock, child);\n    });\n    removeEmptyRoot(rootNode, fromBlock);\n    return position;\n  };\n\n  var findInsertionPoint = function (toBlock, block) {\n    var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n    return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n  };\n\n  var getInsertionPoint = function (fromBlock, toBlock) {\n    return contains$1(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n  };\n\n  var trimBr = function (first, block) {\n    positionIn(first, block.dom).map(function (position) {\n      return position.getNode();\n    }).map(SugarElement.fromDom).filter(isBr$4).each(remove$7);\n  };\n\n  var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n    trimBr(true, fromBlock);\n    trimBr(false, toBlock);\n    return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n  };\n\n  var mergeBlocks = function (rootNode, forward, block1, block2) {\n    return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n  };\n\n  var backspaceDelete$8 = function (editor, forward) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var position = read$1(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n      return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n    });\n    position.each(function (pos) {\n      editor.selection.setRng(pos.toRange());\n    });\n    return position.isSome();\n  };\n\n  var deleteRangeMergeBlocks = function (rootNode, selection) {\n    var rng = selection.getRng();\n    return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n      if (eq(block1, block2) === false) {\n        rng.deleteContents();\n        mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n          selection.setRng(pos.toRange());\n        });\n        return true;\n      } else {\n        return false;\n      }\n    }).getOr(false);\n  };\n\n  var isRawNodeInTable = function (root, rawNode) {\n    var node = SugarElement.fromDom(rawNode);\n    var isRoot = curry(eq, root);\n    return ancestor$3(node, isTableCell$4, isRoot).isSome();\n  };\n\n  var isSelectionInTable = function (root, rng) {\n    return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n  };\n\n  var isEverythingSelected = function (root, rng) {\n    var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n    var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n    return !isSelectionInTable(root, rng) && noPrevious && noNext;\n  };\n\n  var emptyEditor = function (editor) {\n    editor.setContent('');\n    editor.selection.setCursorLocation();\n    return true;\n  };\n\n  var deleteRange$1 = function (editor) {\n    var rootNode = SugarElement.fromDom(editor.getBody());\n    var rng = editor.selection.getRng();\n    return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n  };\n\n  var backspaceDelete$7 = function (editor, _forward) {\n    return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n  };\n\n  var isContentEditableTrue$2 = isContentEditableTrue$4;\n  var isContentEditableFalse$4 = isContentEditableFalse$b;\n\n  var showCaret = function (direction, editor, node, before, scrollIntoView) {\n    return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n  };\n\n  var getNodeRange = function (node) {\n    var rng = node.ownerDocument.createRange();\n    rng.selectNode(node);\n    return rng;\n  };\n\n  var selectNode = function (editor, node) {\n    var e = editor.fire('BeforeObjectSelected', {\n      target: node\n    });\n\n    if (e.isDefaultPrevented()) {\n      return Optional.none();\n    }\n\n    return Optional.some(getNodeRange(node));\n  };\n\n  var renderCaretAtRange = function (editor, range, scrollIntoView) {\n    var normalizedRange = normalizeRange(1, editor.getBody(), range);\n    var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n    var caretPositionNode = caretPosition.getNode();\n\n    if (isInlineFakeCaretTarget(caretPositionNode)) {\n      return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n    }\n\n    var caretPositionBeforeNode = caretPosition.getNode(true);\n\n    if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n      return showCaret(1, editor, caretPositionBeforeNode, false, false);\n    }\n\n    var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n      return isContentEditableFalse$4(node) || isContentEditableTrue$2(node);\n    });\n\n    if (isInlineFakeCaretTarget(ceRoot)) {\n      return showCaret(1, editor, ceRoot, false, scrollIntoView);\n    }\n\n    return Optional.none();\n  };\n\n  var renderRangeCaret = function (editor, range, scrollIntoView) {\n    return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n  };\n\n  var isBeforeBoundary = function (pos) {\n    return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n  };\n\n  var isAfterBoundary = function (pos) {\n    return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n  };\n\n  var trimEmptyTextNode = function (dom, node) {\n    if (isText$7(node) && node.data.length === 0) {\n      dom.remove(node);\n    }\n  };\n\n  var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n    showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n      if (range.collapsed) {\n        var deleteRange = range.cloneRange();\n\n        if (forward) {\n          deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n        } else {\n          deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n        }\n\n        deleteRange.deleteContents();\n      } else {\n        range.deleteContents();\n      }\n\n      editor.selection.setRng(caretRange);\n    });\n    trimEmptyTextNode(editor.dom, node);\n    return true;\n  };\n\n  var deleteBoundaryText = function (editor, forward) {\n    var range = editor.selection.getRng();\n\n    if (!isText$7(range.commonAncestorContainer)) {\n      return false;\n    }\n\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n\n    if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n      return false;\n    } else if (isBeforeFn(nextCaretPosition)) {\n      return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n      }\n    }\n\n    return false;\n  };\n\n  var backspaceDelete$6 = function (editor, forward) {\n    return deleteBoundaryText(editor, forward);\n  };\n\n  var isCompoundElement = function (node) {\n    return isTableCell$4(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n  };\n\n  var DeleteAction = Adt.generate([{\n    remove: ['element']\n  }, {\n    moveToElement: ['element']\n  }, {\n    moveToPosition: ['position']\n  }]);\n\n  var isAtContentEditableBlockCaret = function (forward, from) {\n    var elm = from.getNode(forward === false);\n    var caretLocation = forward ? 'after' : 'before';\n    return isElement$5(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n  };\n\n  var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n    var inSameBlock = function (elm) {\n      return isInline$1(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n    };\n\n    return getRelativeCefElm(!forward, from).fold(function () {\n      return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n    }, inSameBlock);\n  };\n\n  var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n    var toCefElm = to.getNode(forward === false);\n    return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n      return isEmpty$2(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n    }).orThunk(function () {\n      return Optional.some(DeleteAction.moveToElement(toCefElm));\n    });\n  };\n\n  var findCefPosition = function (root, forward, from) {\n    return fromPosition(forward, root, from).bind(function (to) {\n      if (isCompoundElement(to.getNode())) {\n        return Optional.none();\n      } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n        return Optional.none();\n      } else if (forward && isContentEditableFalse$b(to.getNode())) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward === false && isContentEditableFalse$b(to.getNode(true))) {\n        return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n      } else if (forward && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else if (forward === false && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      } else {\n        return Optional.none();\n      }\n    });\n  };\n\n  var getContentEditableBlockAction = function (forward, elm) {\n    if (forward && isContentEditableFalse$b(elm.nextSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n    } else if (forward === false && isContentEditableFalse$b(elm.previousSibling)) {\n      return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n    } else {\n      return Optional.none();\n    }\n  };\n\n  var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n    return deleteAction.fold(function (elm) {\n      return Optional.some(DeleteAction.remove(elm));\n    }, function (elm) {\n      return Optional.some(DeleteAction.moveToElement(elm));\n    }, function (to) {\n      if (isInSameBlock(from, to, root)) {\n        return Optional.none();\n      } else {\n        return Optional.some(DeleteAction.moveToPosition(to));\n      }\n    });\n  };\n\n  var getContentEditableAction = function (root, forward, from) {\n    if (isAtContentEditableBlockCaret(forward, from)) {\n      return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n        return findCefPosition(root, forward, from);\n      }, Optional.some);\n    } else {\n      return findCefPosition(root, forward, from).bind(function (deleteAction) {\n        return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n      });\n    }\n  };\n\n  var read = function (root, forward, rng) {\n    var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n    var from = CaretPosition.fromRangeStart(normalizedRange);\n    var rootElement = SugarElement.fromDom(root);\n\n    if (forward === false && isAfterContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode(true)));\n    } else if (forward && isBeforeContentEditableFalse(from)) {\n      return Optional.some(DeleteAction.remove(from.getNode()));\n    } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n      return findPreviousBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr$1(rootElement, from)) {\n      return findNextBr(rootElement, from).map(function (br) {\n        return DeleteAction.remove(br.getNode());\n      });\n    } else {\n      return getContentEditableAction(root, forward, from);\n    }\n  };\n\n  var deleteElement$1 = function (editor, forward) {\n    return function (element) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      deleteElement$2(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n  };\n\n  var moveToElement = function (editor, forward) {\n    return function (element) {\n      var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var moveToPosition = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    };\n  };\n\n  var getAncestorCe = function (editor, node) {\n    return Optional.from(getContentEditableRoot$1(editor.getBody(), node));\n  };\n\n  var backspaceDeleteCaret = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse$b).fold(function () {\n      return read(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n        return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n      });\n    }, always);\n  };\n\n  var deleteOffscreenSelection = function (rootElement) {\n    each$k(descendants(rootElement, '.mce-offscreen-selection'), remove$7);\n  };\n\n  var backspaceDeleteRange = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n\n    if (isContentEditableFalse$b(selectedNode) && !isTableCell$5(selectedNode)) {\n      var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse$b);\n      return hasCefAncestor.fold(function () {\n        deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n        deleteElement$2(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n        paddEmptyBody(editor);\n        return true;\n      }, always);\n    }\n\n    return false;\n  };\n\n  var paddEmptyElement = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var ceRoot = getContentEditableRoot$1(editor.getBody(), selection.getNode());\n\n    if (isContentEditableTrue$4(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n      var br = dom.create('br', {\n        'data-mce-bogus': '1'\n      });\n      dom.setHTML(ceRoot, '');\n      ceRoot.appendChild(br);\n      selection.setRng(CaretPosition.before(br).toRange());\n    }\n\n    return true;\n  };\n\n  var backspaceDelete$5 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return backspaceDeleteCaret(editor, forward);\n    } else {\n      return backspaceDeleteRange(editor, forward);\n    }\n  };\n\n  var deleteCaret$2 = function (editor, forward) {\n    var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n      return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n    }).bind(function (pos) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n    }).exists(function (elm) {\n      editor.selection.select(elm);\n      return true;\n    });\n  };\n\n  var backspaceDelete$4 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n  };\n\n  var isText = isText$7;\n\n  var startsWithCaretContainer = function (node) {\n    return isText(node) && node.data[0] === ZWSP$1;\n  };\n\n  var endsWithCaretContainer = function (node) {\n    return isText(node) && node.data[node.data.length - 1] === ZWSP$1;\n  };\n\n  var createZwsp = function (node) {\n    return node.ownerDocument.createTextNode(ZWSP$1);\n  };\n\n  var insertBefore = function (node) {\n    if (isText(node.previousSibling)) {\n      if (endsWithCaretContainer(node.previousSibling)) {\n        return node.previousSibling;\n      } else {\n        node.previousSibling.appendData(ZWSP$1);\n        return node.previousSibling;\n      }\n    } else if (isText(node)) {\n      if (startsWithCaretContainer(node)) {\n        return node;\n      } else {\n        node.insertData(0, ZWSP$1);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n      node.parentNode.insertBefore(newNode, node);\n      return newNode;\n    }\n  };\n\n  var insertAfter = function (node) {\n    if (isText(node.nextSibling)) {\n      if (startsWithCaretContainer(node.nextSibling)) {\n        return node.nextSibling;\n      } else {\n        node.nextSibling.insertData(0, ZWSP$1);\n        return node.nextSibling;\n      }\n    } else if (isText(node)) {\n      if (endsWithCaretContainer(node)) {\n        return node;\n      } else {\n        node.appendData(ZWSP$1);\n        return node;\n      }\n    } else {\n      var newNode = createZwsp(node);\n\n      if (node.nextSibling) {\n        node.parentNode.insertBefore(newNode, node.nextSibling);\n      } else {\n        node.parentNode.appendChild(newNode);\n      }\n\n      return newNode;\n    }\n  };\n\n  var insertInline = function (before, node) {\n    return before ? insertBefore(node) : insertAfter(node);\n  };\n\n  var insertInlineBefore = curry(insertInline, true);\n  var insertInlineAfter = curry(insertInline, false);\n\n  var insertInlinePos = function (pos, before) {\n    if (isText$7(pos.container())) {\n      return insertInline(before, pos.container());\n    } else {\n      return insertInline(before, pos.getNode());\n    }\n  };\n\n  var isPosCaretContainer = function (pos, caret) {\n    var caretNode = caret.get();\n    return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n  };\n\n  var renderCaret = function (caret, location) {\n    return location.fold(function (element) {\n      remove$2(caret.get());\n      var text = insertInlineBefore(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, text.length - 1));\n    }, function (element) {\n      return firstPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$2(caret.get());\n          var text = insertInlinePos(pos, true);\n          caret.set(text);\n          return CaretPosition(text, 1);\n        } else {\n          return CaretPosition(caret.get(), 1);\n        }\n      });\n    }, function (element) {\n      return lastPositionIn(element).map(function (pos) {\n        if (!isPosCaretContainer(pos, caret)) {\n          remove$2(caret.get());\n          var text = insertInlinePos(pos, false);\n          caret.set(text);\n          return CaretPosition(text, text.length - 1);\n        } else {\n          return CaretPosition(caret.get(), caret.get().length - 1);\n        }\n      });\n    }, function (element) {\n      remove$2(caret.get());\n      var text = insertInlineAfter(element);\n      caret.set(text);\n      return Optional.some(CaretPosition(text, 1));\n    });\n  };\n\n  var evaluateUntil = function (fns, args) {\n    for (var i = 0; i < fns.length; i++) {\n      var result = fns[i].apply(null, args);\n\n      if (result.isSome()) {\n        return result;\n      }\n    }\n\n    return Optional.none();\n  };\n\n  var Location = Adt.generate([{\n    before: ['element']\n  }, {\n    start: ['element']\n  }, {\n    end: ['element']\n  }, {\n    after: ['element']\n  }]);\n\n  var rescope$1 = function (rootNode, node) {\n    var parentBlock = getParentBlock$2(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var before = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    var scope = rescope$1(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.before(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n    return getParentCaretContainer(rootNode, elm) === null;\n  };\n\n  var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n    return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n  };\n\n  var start$1 = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var prevPos = prevPosition(inline, nPos);\n      return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n    });\n  };\n\n  var end = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeForwards(pos);\n    return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n      var nextPos = nextPosition(inline, nPos);\n      return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n    });\n  };\n\n  var after = function (isInlineTarget, rootNode, pos) {\n    var nPos = normalizeBackwards(pos);\n    var scope = rescope$1(rootNode, nPos.container());\n    return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n      return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n        return Location.after(inline);\n      });\n    }, Optional.none);\n  };\n\n  var isValidLocation = function (location) {\n    return isRtl(getElement(location)) === false;\n  };\n\n  var readLocation = function (isInlineTarget, rootNode, pos) {\n    var location = evaluateUntil([before, start$1, end, after], [isInlineTarget, rootNode, pos]);\n    return location.filter(isValidLocation);\n  };\n\n  var getElement = function (location) {\n    return location.fold(identity, identity, identity, identity);\n  };\n\n  var getName = function (location) {\n    return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n  };\n\n  var outside = function (location) {\n    return location.fold(Location.before, Location.before, Location.after, Location.after);\n  };\n\n  var inside = function (location) {\n    return location.fold(Location.start, Location.start, Location.end, Location.end);\n  };\n\n  var isEq = function (location1, location2) {\n    return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n  };\n\n  var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n    return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n      if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n        return Location.after(forward ? fromInline : toInline);\n      } else {\n        return location;\n      }\n    }).getOr(location);\n  };\n\n  var skipNoMovement = function (fromLocation, toLocation) {\n    return fromLocation.fold(always, function (fromLocation) {\n      return !isEq(fromLocation, toLocation);\n    });\n  };\n\n  var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n    var from = normalizePosition(forward, pos);\n    var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n    var location = to.fold(function () {\n      return fromLocation.map(outside);\n    }, function (to) {\n      return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n    });\n    return location.filter(isValidLocation);\n  };\n\n  var findLocationSimple = function (forward, location) {\n    if (forward) {\n      return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n    } else {\n      return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n    }\n  };\n\n  var findLocation$1 = function (forward, isInlineTarget, rootNode, pos) {\n    var from = normalizePosition(forward, pos);\n    var fromLocation = readLocation(isInlineTarget, rootNode, from);\n    return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n      return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n    });\n  };\n\n  curry(findLocation$1, false);\n  curry(findLocation$1, true);\n\n  var hasSelectionModifyApi = function (editor) {\n    return isFunction(editor.selection.getSel().modify);\n  };\n\n  var moveRel = function (forward, selection, pos) {\n    var delta = forward ? 1 : -1;\n    selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n    selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n    return true;\n  };\n\n  var moveByWord = function (forward, editor) {\n    var rng = editor.selection.getRng();\n    var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n\n    if (!hasSelectionModifyApi(editor)) {\n      return false;\n    } else if (forward && isBeforeInline(pos)) {\n      return moveRel(true, editor.selection, pos);\n    } else if (!forward && isAfterInline(pos)) {\n      return moveRel(false, editor.selection, pos);\n    } else {\n      return false;\n    }\n  };\n\n  var BreakType;\n\n  (function (BreakType) {\n    BreakType[BreakType['Br'] = 0] = 'Br';\n    BreakType[BreakType['Block'] = 1] = 'Block';\n    BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n    BreakType[BreakType['Eol'] = 3] = 'Eol';\n  })(BreakType || (BreakType = {}));\n\n  var flip = function (direction, positions) {\n    return direction === HDirection.Backwards ? reverse(positions) : positions;\n  };\n\n  var walk = function (direction, caretWalker, pos) {\n    return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n  };\n\n  var getBreakType = function (scope, direction, currentPos, nextPos) {\n    if (isBr$5(nextPos.getNode(direction === HDirection.Forwards))) {\n      return BreakType.Br;\n    } else if (isInSameBlock(currentPos, nextPos) === false) {\n      return BreakType.Block;\n    } else {\n      return BreakType.Wrap;\n    }\n  };\n\n  var getPositionsUntil = function (predicate, direction, scope, start) {\n    var caretWalker = CaretWalker(scope);\n    var currentPos = start;\n    var positions = [];\n\n    while (currentPos) {\n      var nextPos = walk(direction, caretWalker, currentPos);\n\n      if (!nextPos) {\n        break;\n      }\n\n      if (isBr$5(nextPos.getNode(false))) {\n        if (direction === HDirection.Forwards) {\n          return {\n            positions: flip(direction, positions).concat([nextPos]),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        } else {\n          return {\n            positions: flip(direction, positions),\n            breakType: BreakType.Br,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n      }\n\n      if (!nextPos.isVisible()) {\n        currentPos = nextPos;\n        continue;\n      }\n\n      if (predicate(currentPos, nextPos)) {\n        var breakType = getBreakType(scope, direction, currentPos, nextPos);\n        return {\n          positions: flip(direction, positions),\n          breakType: breakType,\n          breakAt: Optional.some(nextPos)\n        };\n      }\n\n      positions.push(nextPos);\n      currentPos = nextPos;\n    }\n\n    return {\n      positions: flip(direction, positions),\n      breakType: BreakType.Eol,\n      breakAt: Optional.none()\n    };\n  };\n\n  var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n    return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n      var positions = getPositionsUntilBreak(scope, pos).positions;\n      return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n    }).getOr([]);\n  };\n\n  var findClosestHorizontalPositionFromPoint = function (positions, x) {\n    return foldl(positions, function (acc, newPos) {\n      return acc.fold(function () {\n        return Optional.some(newPos);\n      }, function (lastPos) {\n        return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n          var lastDist = Math.abs(x - lastRect.left);\n          var newDist = Math.abs(x - newRect.left);\n          return newDist <= lastDist ? newPos : lastPos;\n        }).or(acc);\n      });\n    }, Optional.none());\n  };\n\n  var findClosestHorizontalPosition = function (positions, pos) {\n    return head(pos.getClientRects()).bind(function (targetRect) {\n      return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n    });\n  };\n\n  var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n  var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n  var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n  var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n\n  var isAtFirstLine = function (scope, pos) {\n    return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n  };\n\n  var isAtLastLine = function (scope, pos) {\n    return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n  };\n\n  var getFirstLinePositions = function (scope) {\n    return firstPositionIn(scope).map(function (pos) {\n      return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n    }).getOr([]);\n  };\n\n  var getLastLinePositions = function (scope) {\n    return lastPositionIn(scope).map(function (pos) {\n      return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n    }).getOr([]);\n  };\n\n  var getNodeClientRects = function (node) {\n    var toArrayWithNode = function (clientRects) {\n      return map$3(clientRects, function (rect) {\n        var clientRect = clone(rect);\n        clientRect.node = node;\n        return clientRect;\n      });\n    };\n\n    if (isElement$5(node)) {\n      return toArrayWithNode(node.getClientRects());\n    }\n\n    if (isText$7(node)) {\n      var rng = node.ownerDocument.createRange();\n      rng.setStart(node, 0);\n      rng.setEnd(node, node.data.length);\n      return toArrayWithNode(rng.getClientRects());\n    }\n  };\n\n  var getClientRects = function (nodes) {\n    return bind(nodes, getNodeClientRects);\n  };\n\n  var VDirection;\n\n  (function (VDirection) {\n    VDirection[VDirection['Up'] = -1] = 'Up';\n    VDirection[VDirection['Down'] = 1] = 'Down';\n  })(VDirection || (VDirection = {}));\n\n  var findUntil = function (direction, root, predicateFn, node) {\n    while (node = findNode$1(node, direction, isEditableCaretCandidate$1, root)) {\n      if (predicateFn(node)) {\n        return;\n      }\n    }\n  };\n\n  var walkUntil$1 = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n    var line = 0;\n    var result = [];\n\n    var add = function (node) {\n      var clientRects = getClientRects([node]);\n\n      if (direction === -1) {\n        clientRects = clientRects.reverse();\n      }\n\n      for (var i = 0; i < clientRects.length; i++) {\n        var clientRect = clientRects[i];\n\n        if (isBeflowFn(clientRect, targetClientRect)) {\n          continue;\n        }\n\n        if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n          line++;\n        }\n\n        clientRect.line = line;\n\n        if (predicateFn(clientRect)) {\n          return true;\n        }\n\n        result.push(clientRect);\n      }\n    };\n\n    var targetClientRect = last$1(caretPosition.getClientRects());\n\n    if (!targetClientRect) {\n      return result;\n    }\n\n    var node = caretPosition.getNode();\n    add(node);\n    findUntil(direction, root, add, node);\n    return result;\n  };\n\n  var aboveLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line > lineNumber;\n  };\n\n  var isLineNumber = function (lineNumber, clientRect) {\n    return clientRect.line === lineNumber;\n  };\n\n  var upUntil = curry(walkUntil$1, VDirection.Up, isAbove$1, isBelow$1);\n  var downUntil = curry(walkUntil$1, VDirection.Down, isBelow$1, isAbove$1);\n\n  var positionsUntil = function (direction, root, predicateFn, node) {\n    var caretWalker = CaretWalker(root);\n    var walkFn;\n    var isBelowFn;\n    var isAboveFn;\n    var caretPosition;\n    var result = [];\n    var line = 0;\n\n    var getClientRect = function (caretPosition) {\n      if (direction === 1) {\n        return last$1(caretPosition.getClientRects());\n      }\n\n      return last$1(caretPosition.getClientRects());\n    };\n\n    if (direction === 1) {\n      walkFn = caretWalker.next;\n      isBelowFn = isBelow$1;\n      isAboveFn = isAbove$1;\n      caretPosition = CaretPosition.after(node);\n    } else {\n      walkFn = caretWalker.prev;\n      isBelowFn = isAbove$1;\n      isAboveFn = isBelow$1;\n      caretPosition = CaretPosition.before(node);\n    }\n\n    var targetClientRect = getClientRect(caretPosition);\n\n    do {\n      if (!caretPosition.isVisible()) {\n        continue;\n      }\n\n      var rect = getClientRect(caretPosition);\n\n      if (isAboveFn(rect, targetClientRect)) {\n        continue;\n      }\n\n      if (result.length > 0 && isBelowFn(rect, last$1(result))) {\n        line++;\n      }\n\n      var clientRect = clone(rect);\n      clientRect.position = caretPosition;\n      clientRect.line = line;\n\n      if (predicateFn(clientRect)) {\n        return result;\n      }\n\n      result.push(clientRect);\n    } while (caretPosition = walkFn(caretPosition));\n\n    return result;\n  };\n\n  var isAboveLine = function (lineNumber) {\n    return function (clientRect) {\n      return aboveLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isLine = function (lineNumber) {\n    return function (clientRect) {\n      return isLineNumber(lineNumber, clientRect);\n    };\n  };\n\n  var isContentEditableFalse$3 = isContentEditableFalse$b;\n  var findNode = findNode$1;\n\n  var distanceToRectLeft = function (clientRect, clientX) {\n    return Math.abs(clientRect.left - clientX);\n  };\n\n  var distanceToRectRight = function (clientRect, clientX) {\n    return Math.abs(clientRect.right - clientX);\n  };\n\n  var isInsideX = function (clientX, clientRect) {\n    return clientX >= clientRect.left && clientX <= clientRect.right;\n  };\n\n  var isInsideY = function (clientY, clientRect) {\n    return clientY >= clientRect.top && clientY <= clientRect.bottom;\n  };\n\n  var isNodeClientRect = function (rect) {\n    return hasNonNullableKey(rect, 'node');\n  };\n\n  var findClosestClientRect = function (clientRects, clientX, allowInside) {\n    if (allowInside === void 0) {\n      allowInside = always;\n    }\n\n    return reduce(clientRects, function (oldClientRect, clientRect) {\n      if (isInsideX(clientX, clientRect)) {\n        return allowInside(clientRect) ? clientRect : oldClientRect;\n      }\n\n      if (isInsideX(clientX, oldClientRect)) {\n        return allowInside(oldClientRect) ? oldClientRect : clientRect;\n      }\n\n      var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n      var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n\n      if (newDistance === oldDistance && isNodeClientRect(clientRect) && isContentEditableFalse$3(clientRect.node)) {\n        return clientRect;\n      }\n\n      if (newDistance < oldDistance) {\n        return clientRect;\n      }\n\n      return oldClientRect;\n    });\n  };\n\n  var walkUntil = function (direction, root, predicateFn, startNode, includeChildren) {\n    var node = findNode(startNode, direction, isEditableCaretCandidate$1, root, !includeChildren);\n\n    do {\n      if (!node || predicateFn(node)) {\n        return;\n      }\n    } while (node = findNode(node, direction, isEditableCaretCandidate$1, root));\n  };\n\n  var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n    if (includeChildren === void 0) {\n      includeChildren = true;\n    }\n\n    var clientRects = [];\n\n    var collect = function (checkPosFn, node) {\n      var lineRects = filter$4(getClientRects([node]), function (clientRect) {\n        return !checkPosFn(clientRect, targetNodeRect);\n      });\n      clientRects = clientRects.concat(lineRects);\n      return lineRects.length === 0;\n    };\n\n    clientRects.push(targetNodeRect);\n    walkUntil(VDirection.Up, root, curry(collect, isAbove$1), targetNodeRect.node, includeChildren);\n    walkUntil(VDirection.Down, root, curry(collect, isBelow$1), targetNodeRect.node, includeChildren);\n    return clientRects;\n  };\n\n  var getFakeCaretTargets = function (root) {\n    return filter$4(from(root.getElementsByTagName('*')), isFakeCaretTarget);\n  };\n\n  var caretInfo = function (clientRect, clientX) {\n    return {\n      node: clientRect.node,\n      before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n    };\n  };\n\n  var closestFakeCaret = function (root, clientX, clientY) {\n    var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n    var targetNodeRects = filter$4(fakeTargetNodeRects, curry(isInsideY, clientY));\n\n    var checkInside = function (clientRect) {\n      return !isTable$3(clientRect.node) && !isMedia$2(clientRect.node);\n    };\n\n    var closestNodeRect = findClosestClientRect(targetNodeRects, clientX, checkInside);\n\n    if (closestNodeRect) {\n      var includeChildren = checkInside(closestNodeRect);\n      closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX, checkInside);\n\n      if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n        return caretInfo(closestNodeRect, clientX);\n      }\n    }\n\n    return null;\n  };\n\n  var moveToRange = function (editor, rng) {\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, editor.selection.getRng());\n  };\n\n  var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n    return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n  };\n\n  var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var forwards = direction === HDirection.Forwards;\n    var caretWalker = CaretWalker(editor.getBody());\n    var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n    var isBeforeFn = forwards ? isBefore : isAfter;\n\n    if (!range.collapsed) {\n      var node = getSelectedNode(range);\n\n      if (isElement(node)) {\n        return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n      }\n    }\n\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n\n    if (isBeforeFn(caretPosition)) {\n      return selectNode(editor, caretPosition.getNode(!forwards));\n    }\n\n    var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n    var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n\n    if (!nextCaretPosition) {\n      return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n    }\n\n    if (isBeforeFn(nextCaretPosition)) {\n      return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n    }\n\n    var peekCaretPosition = getNextPosFn(nextCaretPosition);\n\n    if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n      if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n        return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n      }\n    }\n\n    if (rangeIsInContainerBlock) {\n      return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n    }\n\n    return Optional.none();\n  };\n\n  var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n    var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n    var caretClientRect = last$1(caretPosition.getClientRects());\n    var forwards = direction === VDirection.Down;\n\n    if (!caretClientRect) {\n      return Optional.none();\n    }\n\n    var walkerFn = forwards ? downUntil : upUntil;\n    var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n    var nextLinePositions = filter$4(linePositions, isLine(1));\n    var clientX = caretClientRect.left;\n    var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n\n    if (nextLineRect && isElement(nextLineRect.node)) {\n      var dist1 = Math.abs(clientX - nextLineRect.left);\n      var dist2 = Math.abs(clientX - nextLineRect.right);\n      return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n    }\n\n    var currentNode;\n\n    if (isBefore(caretPosition)) {\n      currentNode = caretPosition.getNode();\n    } else if (isAfter(caretPosition)) {\n      currentNode = caretPosition.getNode(true);\n    } else {\n      currentNode = getSelectedNode(range);\n    }\n\n    if (currentNode) {\n      var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n      var closestNextLineRect = findClosestClientRect(filter$4(caretPositions, isLine(1)), clientX);\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n\n      closestNextLineRect = last$1(filter$4(caretPositions, isLine(0)));\n\n      if (closestNextLineRect) {\n        return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n      }\n    }\n\n    if (nextLinePositions.length === 0) {\n      return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n        return renderRangeCaret(editor, pos.toRange(), false);\n      });\n    }\n\n    return Optional.none();\n  };\n\n  var getLineEndPoint = function (editor, forward) {\n    var rng = editor.selection.getRng();\n    var body = editor.getBody();\n\n    if (forward) {\n      var from = CaretPosition.fromRangeEnd(rng);\n      var result = getPositionsUntilNextLine(body, from);\n      return last$2(result.positions);\n    } else {\n      var from = CaretPosition.fromRangeStart(rng);\n      var result = getPositionsUntilPreviousLine(body, from);\n      return head(result.positions);\n    }\n  };\n\n  var moveToLineEndPoint$3 = function (editor, forward, isElementPosition) {\n    return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n      editor.selection.setRng(pos.toRange());\n      return true;\n    });\n  };\n\n  var setCaretPosition = function (editor, pos) {\n    var rng = editor.dom.createRng();\n    rng.setStart(pos.container(), pos.offset());\n    rng.setEnd(pos.container(), pos.offset());\n    editor.selection.setRng(rng);\n  };\n\n  var setSelected = function (state, elm) {\n    if (state) {\n      elm.setAttribute('data-mce-selected', 'inline-boundary');\n    } else {\n      elm.removeAttribute('data-mce-selected');\n    }\n  };\n\n  var renderCaretLocation = function (editor, caret, location) {\n    return renderCaret(caret, location).map(function (pos) {\n      setCaretPosition(editor, pos);\n      return location;\n    });\n  };\n\n  var findLocation = function (editor, caret, forward) {\n    var rootNode = editor.getBody();\n    var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var location = findLocation$1(forward, isInlineTarget$1, rootNode, from);\n    return location.bind(function (location) {\n      return renderCaretLocation(editor, caret, location);\n    });\n  };\n\n  var toggleInlines = function (isInlineTarget, dom, elms) {\n    var inlineBoundaries = map$3(descendants(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n      return e.dom;\n    });\n    var selectedInlines = filter$4(inlineBoundaries, isInlineTarget);\n    var targetInlines = filter$4(elms, isInlineTarget);\n    each$k(difference(selectedInlines, targetInlines), curry(setSelected, false));\n    each$k(difference(targetInlines, selectedInlines), curry(setSelected, true));\n  };\n\n  var safeRemoveCaretContainer = function (editor, caret) {\n    if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n        setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n        caret.set(null);\n      }\n    }\n  };\n\n  var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n    if (editor.selection.isCollapsed()) {\n      var inlines = filter$4(elms, isInlineTarget);\n      each$k(inlines, function (_inline) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n          return renderCaretLocation(editor, caret, location);\n        });\n      });\n    }\n  };\n\n  var move$2 = function (editor, caret, forward) {\n    return isInlineBoundariesEnabled(editor) ? findLocation(editor, caret, forward).isSome() : false;\n  };\n\n  var moveWord = function (forward, editor, _caret) {\n    return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n  };\n\n  var setupSelectedState = function (editor) {\n    var caret = Cell(null);\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.on('NodeChange', function (e) {\n      if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n        toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n        safeRemoveCaretContainer(editor, caret);\n        renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n      }\n    });\n    return caret;\n  };\n\n  var moveNextWord = curry(moveWord, true);\n  var movePrevWord = curry(moveWord, false);\n\n  var moveToLineEndPoint$2 = function (editor, forward, caret) {\n    if (isInlineBoundariesEnabled(editor)) {\n      var linePoint = getLineEndPoint(editor, forward).getOrThunk(function () {\n        var rng = editor.selection.getRng();\n        return forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n      });\n      return readLocation(curry(isInlineTarget, editor), editor.getBody(), linePoint).exists(function (loc) {\n        var outsideLoc = outside(loc);\n        return renderCaret(caret, outsideLoc).exists(function (pos) {\n          setCaretPosition(editor, pos);\n          return true;\n        });\n      });\n    } else {\n      return false;\n    }\n  };\n\n  var rangeFromPositions = function (from, to) {\n    var range = document.createRange();\n    range.setStart(from.container(), from.offset());\n    range.setEnd(to.container(), to.offset());\n    return range;\n  };\n\n  var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n    return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n      var normalizedFirstPos = normalizePosition(true, firstPos);\n      var normalizedLastPos = normalizePosition(false, lastPos);\n      return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n        return pos.isEqual(normalizedLastPos);\n      });\n    }).getOr(true);\n  };\n\n  var setCaretLocation = function (editor, caret) {\n    return function (location) {\n      return renderCaret(caret, location).exists(function (pos) {\n        setCaretPosition(editor, pos);\n        return true;\n      });\n    };\n  };\n\n  var deleteFromTo = function (editor, caret, from, to) {\n    var rootNode = editor.getBody();\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    editor.undoManager.ignore(function () {\n      editor.selection.setRng(rangeFromPositions(from, to));\n      editor.execCommand('Delete');\n      readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n    });\n    editor.nodeChanged();\n  };\n\n  var rescope = function (rootNode, node) {\n    var parentBlock = getParentBlock$2(node, rootNode);\n    return parentBlock ? parentBlock : rootNode;\n  };\n\n  var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n    var rootNode = rescope(editor.getBody(), from.container());\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n    return fromLocation.bind(function (location) {\n      if (forward) {\n        return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n      } else {\n        return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n      }\n    }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n      var toPosition = navigate(forward, rootNode, from);\n      var toLocation = toPosition.bind(function (pos) {\n        return readLocation(isInlineTarget$1, rootNode, pos);\n      });\n      return lift2(fromLocation, toLocation, function () {\n        return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n          if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n            deleteElement$2(editor, forward, SugarElement.fromDom(elm));\n            return true;\n          } else {\n            return false;\n          }\n        });\n      }).orThunk(function () {\n        return toLocation.bind(function (_) {\n          return toPosition.map(function (to) {\n            if (forward) {\n              deleteFromTo(editor, caret, from, to);\n            } else {\n              deleteFromTo(editor, caret, to, from);\n            }\n\n            return true;\n          });\n        });\n      }).getOr(false);\n    });\n  };\n\n  var backspaceDelete$3 = function (editor, caret, forward) {\n    if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return backspaceDeleteCollapsed(editor, caret, forward, from);\n    }\n\n    return false;\n  };\n\n  var getParentInlines = function (rootElm, startElm) {\n    var parents = parentsAndSelf(startElm, rootElm);\n    return findIndex$2(parents, isBlock$2).fold(constant(parents), function (index) {\n      return parents.slice(0, index);\n    });\n  };\n\n  var hasOnlyOneChild = function (elm) {\n    return childNodesCount(elm) === 1;\n  };\n\n  var deleteLastPosition = function (forward, editor, target, parentInlines) {\n    var isFormatElement$1 = curry(isFormatElement, editor);\n    var formatNodes = map$3(filter$4(parentInlines, isFormatElement$1), function (elm) {\n      return elm.dom;\n    });\n\n    if (formatNodes.length === 0) {\n      deleteElement$2(editor, forward, target);\n    } else {\n      var pos = replaceWithCaretFormat(target.dom, formatNodes);\n      editor.selection.setRng(pos.toRange());\n    }\n  };\n\n  var deleteCaret$1 = function (editor, forward) {\n    var rootElm = SugarElement.fromDom(editor.getBody());\n    var startElm = SugarElement.fromDom(editor.selection.getStart());\n    var parentInlines = filter$4(getParentInlines(rootElm, startElm), hasOnlyOneChild);\n    return last$2(parentInlines).exists(function (target) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n\n      if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n        deleteLastPosition(forward, editor, target, parentInlines);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var backspaceDelete$2 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n  };\n\n  var deleteElement = function (editor, forward, element) {\n    editor._selectionOverrides.hideFakeCaret();\n\n    deleteElement$2(editor, forward, SugarElement.fromDom(element));\n    return true;\n  };\n\n  var deleteCaret = function (editor, forward) {\n    var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n\n    if (isNearMedia(fromPos)) {\n      return deleteElement(editor, forward, fromPos.getNode(!forward));\n    } else {\n      return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n        return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n      }).exists(function (pos) {\n        return deleteElement(editor, forward, pos.getNode(!forward));\n      });\n    }\n  };\n\n  var deleteRange = function (editor, forward) {\n    var selectedNode = editor.selection.getNode();\n    return isMedia$2(selectedNode) ? deleteElement(editor, forward, selectedNode) : false;\n  };\n\n  var backspaceDelete$1 = function (editor, forward) {\n    return editor.selection.isCollapsed() ? deleteCaret(editor, forward) : deleteRange(editor, forward);\n  };\n\n  var isEditable = function (target) {\n    return closest$3(target, function (elm) {\n      return isContentEditableTrue$4(elm.dom) || isContentEditableFalse$b(elm.dom);\n    }).exists(function (elm) {\n      return isContentEditableTrue$4(elm.dom);\n    });\n  };\n\n  var parseIndentValue = function (value) {\n    var number = parseInt(value, 10);\n    return isNaN(number) ? 0 : number;\n  };\n\n  var getIndentStyleName = function (useMargin, element) {\n    var indentStyleName = useMargin || isTable$2(element) ? 'margin' : 'padding';\n    var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n    return indentStyleName + suffix;\n  };\n\n  var indentElement = function (dom, command, useMargin, value, unit, element) {\n    var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n\n    if (command === 'outdent') {\n      var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n      dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n    } else {\n      var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n      dom.setStyle(element, indentStyleName, styleValue);\n    }\n  };\n\n  var validateBlocks = function (editor, blocks) {\n    return forall(blocks, function (block) {\n      var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n      var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n      var contentEditable = editor.dom.getContentEditable(block.dom);\n      return contentEditable !== 'false' && intentValue > 0;\n    });\n  };\n\n  var canOutdent = function (editor) {\n    var blocks = getBlocksToIndent(editor);\n    return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n  };\n\n  var isListComponent = function (el) {\n    return isList(el) || isListItem(el);\n  };\n\n  var parentIsListComponent = function (el) {\n    return parent(el).exists(isListComponent);\n  };\n\n  var getBlocksToIndent = function (editor) {\n    return filter$4(fromDom$1(editor.selection.getSelectedBlocks()), function (el) {\n      return !isListComponent(el) && !parentIsListComponent(el) && isEditable(el);\n    });\n  };\n\n  var handle = function (editor, command) {\n    var dom = editor.dom,\n        selection = editor.selection,\n        formatter = editor.formatter;\n    var indentation = getIndentation(editor);\n    var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n    var indentValue = parseInt(indentation, 10);\n    var useMargin = shouldIndentUseMargin(editor);\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n      if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n        formatter.apply('div');\n      }\n    }\n\n    each$k(getBlocksToIndent(editor), function (block) {\n      indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n    });\n  };\n\n  var backspaceDelete = function (editor, _forward) {\n    if (editor.selection.isCollapsed() && canOutdent(editor)) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var block = dom.getParent(rng.startContainer, dom.isBlock);\n\n      if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n        handle(editor, 'outdent');\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var nativeCommand = function (editor, command) {\n    editor.getDoc().execCommand(command, false, null);\n  };\n\n  var deleteCommand = function (editor, caret) {\n    if (backspaceDelete(editor)) {\n      return;\n    } else if (backspaceDelete$5(editor, false)) {\n      return;\n    } else if (backspaceDelete$6(editor, false)) {\n      return;\n    } else if (backspaceDelete$3(editor, caret, false)) {\n      return;\n    } else if (backspaceDelete$8(editor, false)) {\n      return;\n    } else if (backspaceDelete$9(editor)) {\n      return;\n    } else if (backspaceDelete$4(editor, false)) {\n      return;\n    } else if (backspaceDelete$1(editor, false)) {\n      return;\n    } else if (backspaceDelete$7(editor)) {\n      return;\n    } else if (backspaceDelete$2(editor, false)) {\n      return;\n    } else {\n      nativeCommand(editor, 'Delete');\n      paddEmptyBody(editor);\n    }\n  };\n\n  var forwardDeleteCommand = function (editor, caret) {\n    if (backspaceDelete$5(editor, true)) {\n      return;\n    } else if (backspaceDelete$6(editor, true)) {\n      return;\n    } else if (backspaceDelete$3(editor, caret, true)) {\n      return;\n    } else if (backspaceDelete$8(editor, true)) {\n      return;\n    } else if (backspaceDelete$9(editor)) {\n      return;\n    } else if (backspaceDelete$4(editor, true)) {\n      return;\n    } else if (backspaceDelete$1(editor, true)) {\n      return;\n    } else if (backspaceDelete$7(editor)) {\n      return;\n    } else if (backspaceDelete$2(editor, true)) {\n      return;\n    } else {\n      nativeCommand(editor, 'ForwardDelete');\n    }\n  };\n\n  var setup$f = function (editor, caret) {\n    editor.addCommand('delete', function () {\n      deleteCommand(editor, caret);\n    });\n    editor.addCommand('forwardDelete', function () {\n      forwardDeleteCommand(editor, caret);\n    });\n  };\n\n  var SIGNIFICANT_MOVE = 5;\n  var LONGPRESS_DELAY = 400;\n\n  var getTouch = function (event) {\n    if (event.touches === undefined || event.touches.length !== 1) {\n      return Optional.none();\n    }\n\n    return Optional.some(event.touches[0]);\n  };\n\n  var isFarEnough = function (touch, data) {\n    var distX = Math.abs(touch.clientX - data.x);\n    var distY = Math.abs(touch.clientY - data.y);\n    return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n  };\n\n  var setup$e = function (editor) {\n    var startData = value();\n    var longpressFired = Cell(false);\n    var debounceLongpress = last(function (e) {\n      editor.fire('longpress', __assign(__assign({}, e), {\n        type: 'longpress'\n      }));\n      longpressFired.set(true);\n    }, LONGPRESS_DELAY);\n    editor.on('touchstart', function (e) {\n      getTouch(e).each(function (touch) {\n        debounceLongpress.cancel();\n        var data = {\n          x: touch.clientX,\n          y: touch.clientY,\n          target: e.target\n        };\n        debounceLongpress.throttle(e);\n        longpressFired.set(false);\n        startData.set(data);\n      });\n    }, true);\n    editor.on('touchmove', function (e) {\n      debounceLongpress.cancel();\n      getTouch(e).each(function (touch) {\n        startData.on(function (data) {\n          if (isFarEnough(touch, data)) {\n            startData.clear();\n            longpressFired.set(false);\n            editor.fire('longpresscancel');\n          }\n        });\n      });\n    }, true);\n    editor.on('touchend touchcancel', function (e) {\n      debounceLongpress.cancel();\n\n      if (e.type === 'touchcancel') {\n        return;\n      }\n\n      startData.get().filter(function (data) {\n        return data.target.isEqualNode(e.target);\n      }).each(function () {\n        if (longpressFired.get()) {\n          e.preventDefault();\n        } else {\n          editor.fire('tap', __assign(__assign({}, e), {\n            type: 'tap'\n          }));\n        }\n      });\n    }, true);\n  };\n\n  var isBlockElement = function (blockElements, node) {\n    return has$2(blockElements, node.nodeName);\n  };\n\n  var isValidTarget = function (blockElements, node) {\n    if (isText$7(node)) {\n      return true;\n    } else if (isElement$5(node)) {\n      return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n    } else {\n      return false;\n    }\n  };\n\n  var hasBlockParent = function (blockElements, root, node) {\n    return exists(parents(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n      return isBlockElement(blockElements, elm.dom);\n    });\n  };\n\n  var shouldRemoveTextNode = function (blockElements, node) {\n    if (isText$7(node)) {\n      if (node.nodeValue.length === 0) {\n        return true;\n      } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n        return true;\n      }\n    }\n\n    return false;\n  };\n\n  var addRootBlocks = function (editor) {\n    var dom = editor.dom,\n        selection = editor.selection;\n    var schema = editor.schema,\n        blockElements = schema.getBlockElements();\n    var node = selection.getStart();\n    var rootNode = editor.getBody();\n    var rootBlockNode, tempNode, wrapped;\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (!node || !isElement$5(node) || !forcedRootBlock) {\n      return;\n    }\n\n    var rootNodeName = rootNode.nodeName.toLowerCase();\n\n    if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n      return;\n    }\n\n    var rng = selection.getRng();\n    var startContainer = rng.startContainer;\n    var startOffset = rng.startOffset;\n    var endContainer = rng.endContainer;\n    var endOffset = rng.endOffset;\n    var restoreSelection = hasFocus(editor);\n    node = rootNode.firstChild;\n\n    while (node) {\n      if (isValidTarget(blockElements, node)) {\n        if (shouldRemoveTextNode(blockElements, node)) {\n          tempNode = node;\n          node = node.nextSibling;\n          dom.remove(tempNode);\n          continue;\n        }\n\n        if (!rootBlockNode) {\n          rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n          node.parentNode.insertBefore(rootBlockNode, node);\n          wrapped = true;\n        }\n\n        tempNode = node;\n        node = node.nextSibling;\n        rootBlockNode.appendChild(tempNode);\n      } else {\n        rootBlockNode = null;\n        node = node.nextSibling;\n      }\n    }\n\n    if (wrapped && restoreSelection) {\n      rng.setStart(startContainer, startOffset);\n      rng.setEnd(endContainer, endOffset);\n      selection.setRng(rng);\n      editor.nodeChanged();\n    }\n  };\n\n  var setup$d = function (editor) {\n    if (getForcedRootBlock(editor)) {\n      editor.on('NodeChange', curry(addRootBlocks, editor));\n    }\n  };\n\n  var findBlockCaretContainer = function (editor) {\n    return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').map(function (elm) {\n      return elm.dom;\n    }).getOrNull();\n  };\n\n  var removeIeControlRect = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var showBlockCaretContainer = function (editor, blockCaretContainer) {\n    if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n      showCaretContainerBlock(blockCaretContainer);\n      removeIeControlRect(editor);\n      editor.selection.scrollIntoView(blockCaretContainer);\n    }\n  };\n\n  var handleBlockContainer = function (editor, e) {\n    var blockCaretContainer = findBlockCaretContainer(editor);\n\n    if (!blockCaretContainer) {\n      return;\n    }\n\n    if (e.type === 'compositionstart') {\n      e.preventDefault();\n      e.stopPropagation();\n      showBlockCaretContainer(editor, blockCaretContainer);\n      return;\n    }\n\n    if (hasContent(blockCaretContainer)) {\n      showBlockCaretContainer(editor, blockCaretContainer);\n      editor.undoManager.add();\n    }\n  };\n\n  var setup$c = function (editor) {\n    editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n  };\n\n  var isContentEditableFalse$2 = isContentEditableFalse$b;\n\n  var moveToCeFalseHorizontally = function (direction, editor, range) {\n    return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$2);\n  };\n\n  var moveToCeFalseVertically = function (direction, editor, range) {\n    var isBefore = function (caretPosition) {\n      return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n    };\n\n    var isAfter = function (caretPosition) {\n      return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n    };\n\n    return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$2);\n  };\n\n  var createTextBlock = function (editor) {\n    var textBlock = editor.dom.create(getForcedRootBlock(editor));\n\n    if (!Env.ie || Env.ie >= 11) {\n      textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n    }\n\n    return textBlock;\n  };\n\n  var exitPreBlock = function (editor, direction, range) {\n    var caretWalker = CaretWalker(editor.getBody());\n    var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n\n    if (range.collapsed && hasForcedRootBlock(editor)) {\n      var pre = editor.dom.getParent(range.startContainer, 'PRE');\n\n      if (!pre) {\n        return;\n      }\n\n      var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n\n      if (!caretPos) {\n        var newBlock = createTextBlock(editor);\n\n        if (direction === 1) {\n          editor.$(pre).after(newBlock);\n        } else {\n          editor.$(pre).before(newBlock);\n        }\n\n        editor.selection.select(newBlock, true);\n        editor.selection.collapse();\n      }\n    }\n  };\n\n  var getHorizontalRange = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var getVerticalRange = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n      exitPreBlock(editor, direction, range);\n      return Optional.none();\n    });\n  };\n\n  var moveH$2 = function (editor, forward) {\n    return getHorizontalRange(editor, forward).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV$3 = function (editor, down) {\n    return getVerticalRange(editor, down).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint$1 = function (editor, forward) {\n    var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n    return moveToLineEndPoint$3(editor, forward, isCefPosition);\n  };\n\n  var isTarget = function (node) {\n    return contains$3(['figcaption'], name(node));\n  };\n\n  var rangeBefore = function (target) {\n    var rng = document.createRange();\n    rng.setStartBefore(target.dom);\n    rng.setEndBefore(target.dom);\n    return rng;\n  };\n\n  var insertElement = function (root, elm, forward) {\n    if (forward) {\n      append$1(root, elm);\n    } else {\n      prepend(root, elm);\n    }\n  };\n\n  var insertBr = function (root, forward) {\n    var br = SugarElement.fromTag('br');\n    insertElement(root, br, forward);\n    return rangeBefore(br);\n  };\n\n  var insertBlock = function (root, forward, blockName, attrs) {\n    var block = SugarElement.fromTag(blockName);\n    var br = SugarElement.fromTag('br');\n    setAll$1(block, attrs);\n    append$1(block, br);\n    insertElement(root, block, forward);\n    return rangeBefore(br);\n  };\n\n  var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n    if (rootBlockName === '') {\n      return insertBr(root, forward);\n    } else {\n      return insertBlock(root, forward, rootBlockName, attrs);\n    }\n  };\n\n  var getClosestTargetBlock = function (pos, root) {\n    var isRoot = curry(eq, root);\n    return closest$3(SugarElement.fromDom(pos.container()), isBlock$2, isRoot).filter(isTarget);\n  };\n\n  var isAtFirstOrLastLine = function (root, forward, pos) {\n    return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n  };\n\n  var moveCaretToNewEmptyLine = function (editor, forward) {\n    var root = SugarElement.fromDom(editor.getBody());\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var rootBlock = getForcedRootBlock(editor);\n    var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n    return getClosestTargetBlock(pos, root).exists(function () {\n      if (isAtFirstOrLastLine(root, forward, pos)) {\n        var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n        editor.selection.setRng(rng);\n        return true;\n      } else {\n        return false;\n      }\n    });\n  };\n\n  var moveV$2 = function (editor, forward) {\n    if (editor.selection.isCollapsed()) {\n      return moveCaretToNewEmptyLine(editor, forward);\n    } else {\n      return false;\n    }\n  };\n\n  var defaultPatterns = function (patterns) {\n    return map$3(patterns, function (pattern) {\n      return __assign({\n        shiftKey: false,\n        altKey: false,\n        ctrlKey: false,\n        metaKey: false,\n        keyCode: 0,\n        action: noop\n      }, pattern);\n    });\n  };\n\n  var matchesEvent = function (pattern, evt) {\n    return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n  };\n\n  var match$1 = function (patterns, evt) {\n    return bind(defaultPatterns(patterns), function (pattern) {\n      return matchesEvent(pattern, evt) ? [pattern] : [];\n    });\n  };\n\n  var action = function (f) {\n    var x = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      x[_i - 1] = arguments[_i];\n    }\n\n    return function () {\n      return f.apply(null, x);\n    };\n  };\n\n  var execute = function (patterns, evt) {\n    return find$3(match$1(patterns, evt), function (pattern) {\n      return pattern.action();\n    });\n  };\n\n  var moveH$1 = function (editor, forward) {\n    var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n    var range = editor.selection.getRng();\n    return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia$2).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveV$1 = function (editor, down) {\n    var direction = down ? 1 : -1;\n    var range = editor.selection.getRng();\n    return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia$2).exists(function (newRange) {\n      moveToRange(editor, newRange);\n      return true;\n    });\n  };\n\n  var moveToLineEndPoint = function (editor, forward) {\n    var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n    return moveToLineEndPoint$3(editor, forward, isNearMedia);\n  };\n\n  var deflate = function (rect, delta) {\n    return {\n      left: rect.left - delta,\n      top: rect.top - delta,\n      right: rect.right + delta * 2,\n      bottom: rect.bottom + delta * 2,\n      width: rect.width + delta,\n      height: rect.height + delta\n    };\n  };\n\n  var getCorners = function (getYAxisValue, tds) {\n    return bind(tds, function (td) {\n      var rect = deflate(clone(td.getBoundingClientRect()), -1);\n      return [{\n        x: rect.left,\n        y: getYAxisValue(rect),\n        cell: td\n      }, {\n        x: rect.right,\n        y: getYAxisValue(rect),\n        cell: td\n      }];\n    });\n  };\n\n  var findClosestCorner = function (corners, x, y) {\n    return foldl(corners, function (acc, newCorner) {\n      return acc.fold(function () {\n        return Optional.some(newCorner);\n      }, function (oldCorner) {\n        var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n        var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n        return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n      });\n    }, Optional.none());\n  };\n\n  var getClosestCell = function (getYAxisValue, isTargetCorner, table, x, y) {\n    var cells = descendants(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n      return e.dom;\n    });\n    var corners = filter$4(getCorners(getYAxisValue, cells), function (corner) {\n      return isTargetCorner(corner, y);\n    });\n    return findClosestCorner(corners, x, y).map(function (corner) {\n      return corner.cell;\n    });\n  };\n\n  var getBottomValue = function (rect) {\n    return rect.bottom;\n  };\n\n  var getTopValue = function (rect) {\n    return rect.top;\n  };\n\n  var isAbove = function (corner, y) {\n    return corner.y < y;\n  };\n\n  var isBelow = function (corner, y) {\n    return corner.y > y;\n  };\n\n  var getClosestCellAbove = curry(getClosestCell, getBottomValue, isAbove);\n  var getClosestCellBelow = curry(getClosestCell, getTopValue, isBelow);\n\n  var findClosestPositionInAboveCell = function (table, pos) {\n    return head(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellAbove(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n    });\n  };\n\n  var findClosestPositionInBelowCell = function (table, pos) {\n    return last$2(pos.getClientRects()).bind(function (rect) {\n      return getClosestCellBelow(table, rect.left, rect.top);\n    }).bind(function (cell) {\n      return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n    });\n  };\n\n  var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n    return lineInfo.breakAt.exists(function (breakPos) {\n      return getPositionsUntil(scope, breakPos).breakAt.isSome();\n    });\n  };\n\n  var startsWithWrapBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n  };\n\n  var startsWithBrBreak = function (lineInfo) {\n    return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n  };\n\n  var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n    var lineInfo = getPositionsUntil(scope, pos);\n\n    if (startsWithWrapBreak(lineInfo) || !isBr$5(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n      return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n    } else {\n      return lineInfo.breakAt.isNone();\n    }\n  };\n\n  var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n  var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n\n  var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n    var caretPos = CaretPosition.fromRangeStart(rng);\n    return positionIn(!forward, table).exists(function (pos) {\n      return pos.isEqual(caretPos);\n    });\n  };\n\n  var navigateHorizontally = function (editor, forward, table, _td) {\n    var rng = editor.selection.getRng();\n    var direction = forward ? 1 : -1;\n\n    if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n      showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n        moveToRange(editor, newRng);\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  var getClosestAbovePosition = function (root, table, start) {\n    return findClosestPositionInAboveCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n      });\n    }).getOr(CaretPosition.before(table));\n  };\n\n  var getClosestBelowPosition = function (root, table, start) {\n    return findClosestPositionInBelowCell(table, start).orThunk(function () {\n      return head(start.getClientRects()).bind(function (rect) {\n        return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n      });\n    }).getOr(CaretPosition.after(table));\n  };\n\n  var getTable = function (previous, pos) {\n    var node = pos.getNode(previous);\n    return isElement$5(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n  };\n\n  var renderBlock = function (down, editor, table, pos) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n\n    if (forcedRootBlock) {\n      editor.undoManager.transact(function () {\n        var element = SugarElement.fromTag(forcedRootBlock);\n        setAll$1(element, getForcedRootBlockAttrs(editor));\n        append$1(element, SugarElement.fromTag('br'));\n\n        if (down) {\n          after$3(SugarElement.fromDom(table), element);\n        } else {\n          before$4(SugarElement.fromDom(table), element);\n        }\n\n        var rng = editor.dom.createRng();\n        rng.setStart(element.dom, 0);\n        rng.setEnd(element.dom, 0);\n        moveToRange(editor, rng);\n      });\n    } else {\n      moveToRange(editor, pos.toRange());\n    }\n  };\n\n  var moveCaret = function (editor, down, pos) {\n    var table = down ? getTable(true, pos) : getTable(false, pos);\n    var last = down === false;\n    table.fold(function () {\n      return moveToRange(editor, pos.toRange());\n    }, function (table) {\n      return positionIn(last, editor.getBody()).filter(function (lastPos) {\n        return lastPos.isEqual(pos);\n      }).fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (_) {\n        return renderBlock(down, editor, table, pos);\n      });\n    });\n  };\n\n  var navigateVertically = function (editor, down, table, td) {\n    var rng = editor.selection.getRng();\n    var pos = CaretPosition.fromRangeStart(rng);\n    var root = editor.getBody();\n\n    if (!down && isAtFirstTableCellLine(td, pos)) {\n      var newPos = getClosestAbovePosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else if (down && isAtLastTableCellLine(td, pos)) {\n      var newPos = getClosestBelowPosition(root, table, pos);\n      moveCaret(editor, down, newPos);\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  var move$1 = function (editor, forward, mover) {\n    return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n      return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n        return mover(editor, forward, table, td);\n      });\n    }).getOr(false);\n  };\n\n  var moveH = function (editor, forward) {\n    return move$1(editor, forward, navigateHorizontally);\n  };\n\n  var moveV = function (editor, forward) {\n    return move$1(editor, forward, navigateVertically);\n  };\n\n  var executeKeydownOverride$3 = function (editor, caret, evt) {\n    var os = detect().os;\n    execute([{\n      keyCode: VK.RIGHT,\n      action: action(moveH$2, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$2, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$3, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$3, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(moveH$1, editor, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(moveH$1, editor, false)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$1, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$1, editor, true)\n    }, {\n      keyCode: VK.RIGHT,\n      action: action(move$2, editor, caret, true)\n    }, {\n      keyCode: VK.LEFT,\n      action: action(move$2, editor, caret, false)\n    }, {\n      keyCode: VK.RIGHT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(moveNextWord, editor, caret)\n    }, {\n      keyCode: VK.LEFT,\n      ctrlKey: !os.isOSX(),\n      altKey: os.isOSX(),\n      action: action(movePrevWord, editor, caret)\n    }, {\n      keyCode: VK.UP,\n      action: action(moveV$2, editor, false)\n    }, {\n      keyCode: VK.DOWN,\n      action: action(moveV$2, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$b = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$3(editor, caret, evt);\n      }\n    });\n  };\n\n  var executeKeydownOverride$2 = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete, editor, false)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$5, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$5, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$6, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$6, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$3, editor, caret, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$3, editor, caret, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$9, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$9, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$4, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$4, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$1, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$1, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$7, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$7, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$8, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$8, editor, true)\n    }, {\n      keyCode: VK.BACKSPACE,\n      action: action(backspaceDelete$2, editor, false)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(backspaceDelete$2, editor, true)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var executeKeyupOverride = function (editor, evt) {\n    execute([{\n      keyCode: VK.BACKSPACE,\n      action: action(paddEmptyElement, editor)\n    }, {\n      keyCode: VK.DELETE,\n      action: action(paddEmptyElement, editor)\n    }], evt);\n  };\n\n  var setup$a = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$2(editor, caret, evt);\n      }\n    });\n    editor.on('keyup', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeyupOverride(editor, evt);\n      }\n    });\n  };\n\n  var firstNonWhiteSpaceNodeSibling = function (node) {\n    while (node) {\n      if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n        return node;\n      }\n\n      node = node.nextSibling;\n    }\n  };\n\n  var moveToCaretPosition = function (editor, root) {\n    var node,\n        lastNode = root;\n    var dom = editor.dom;\n    var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n\n    if (!root) {\n      return;\n    }\n\n    if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n      var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n\n      if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n        root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n      }\n    }\n\n    var rng = dom.createRng();\n    root.normalize();\n\n    if (root.hasChildNodes()) {\n      var walker = new DomTreeWalker(root, root);\n\n      while (node = walker.current()) {\n        if (isText$7(node)) {\n          rng.setStart(node, 0);\n          rng.setEnd(node, 0);\n          break;\n        }\n\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n          rng.setStartBefore(node);\n          rng.setEndBefore(node);\n          break;\n        }\n\n        lastNode = node;\n        node = walker.next();\n      }\n\n      if (!node) {\n        rng.setStart(lastNode, 0);\n        rng.setEnd(lastNode, 0);\n      }\n    } else {\n      if (isBr$5(root)) {\n        if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n          rng.setStartBefore(root);\n          rng.setEndBefore(root);\n        } else {\n          rng.setStartAfter(root);\n          rng.setEndAfter(root);\n        }\n      } else {\n        rng.setStart(root, 0);\n        rng.setEnd(root, 0);\n      }\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var getEditableRoot$1 = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var getParentBlock = function (editor) {\n    return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n  };\n\n  var getParentBlockName = function (editor) {\n    return getParentBlock(editor).fold(constant(''), function (parentBlock) {\n      return parentBlock.nodeName.toUpperCase();\n    });\n  };\n\n  var isListItemParentBlock = function (editor) {\n    return getParentBlock(editor).filter(function (elm) {\n      return isListItem(SugarElement.fromDom(elm));\n    }).isSome();\n  };\n\n  var hasFirstChild = function (elm, name) {\n    return elm.firstChild && elm.firstChild.nodeName === name;\n  };\n\n  var isFirstChild = function (elm) {\n    var _a;\n\n    return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n  };\n\n  var hasParent = function (elm, parentName) {\n    return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n  };\n\n  var isListBlock = function (elm) {\n    return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n  };\n\n  var isNestedList = function (elm) {\n    return isListBlock(elm) && isListBlock(elm.parentNode);\n  };\n\n  var getContainerBlock = function (containerBlock) {\n    var containerBlockParent = containerBlock.parentNode;\n\n    if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n      return containerBlockParent;\n    }\n\n    return containerBlock;\n  };\n\n  var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n    var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n\n    while (node) {\n      if (isElement$5(node)) {\n        break;\n      }\n\n      node = node[first ? 'nextSibling' : 'previousSibling'];\n    }\n\n    return node === parentBlock;\n  };\n\n  var insert$3 = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n    var dom = editor.dom;\n    var rng = editor.selection.getRng();\n\n    if (containerBlock === editor.getBody()) {\n      return;\n    }\n\n    if (isNestedList(containerBlock)) {\n      newBlockName = 'LI';\n    }\n\n    var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n\n    if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      if (hasParent(containerBlock, 'LI')) {\n        var containerBlockParent = getContainerBlock(containerBlock);\n        dom.insertAfter(newBlock, containerBlockParent);\n\n        if (isFirstChild(containerBlock)) {\n          dom.remove(containerBlockParent);\n        } else {\n          dom.remove(containerBlock);\n        }\n      } else {\n        dom.replace(newBlock, containerBlock);\n      }\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n      if (hasParent(containerBlock, 'LI')) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        newBlock.appendChild(dom.doc.createTextNode(' '));\n        newBlock.appendChild(containerBlock);\n      } else {\n        containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n      dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n      dom.remove(parentBlock);\n    } else {\n      containerBlock = getContainerBlock(containerBlock);\n      var tmpRng = rng.cloneRange();\n      tmpRng.setStartAfter(parentBlock);\n      tmpRng.setEndAfter(containerBlock);\n      var fragment = tmpRng.extractContents();\n\n      if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, containerBlock);\n      } else {\n        dom.insertAfter(fragment, containerBlock);\n        dom.insertAfter(newBlock, containerBlock);\n      }\n\n      dom.remove(parentBlock);\n    }\n\n    moveToCaretPosition(editor, newBlock);\n  };\n\n  var trimZwsp = function (fragment) {\n    each$k(descendants$1(SugarElement.fromDom(fragment), isText$8), function (text) {\n      var rawNode = text.dom;\n      rawNode.nodeValue = trim$2(rawNode.nodeValue);\n    });\n  };\n\n  var isEmptyAnchor = function (dom, elm) {\n    return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n  };\n\n  var isTableCell = function (node) {\n    return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n  };\n\n  var emptyBlock = function (elm) {\n    elm.innerHTML = '<br data-mce-bogus=\"1\">';\n  };\n\n  var containerAndSiblingName = function (container, nodeName) {\n    return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n  };\n\n  var canSplitBlock = function (dom, node) {\n    return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n  };\n\n  var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n    var node = block;\n    var firstChilds = [];\n    var i;\n\n    if (!node) {\n      return;\n    }\n\n    while (node = node.firstChild) {\n      if (dom.isBlock(node)) {\n        return;\n      }\n\n      if (isElement$5(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n        firstChilds.push(node);\n      }\n    }\n\n    i = firstChilds.length;\n\n    while (i--) {\n      node = firstChilds[i];\n\n      if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n        dom.remove(node);\n      } else {\n        if (isEmptyAnchor(dom, node)) {\n          dom.remove(node);\n        }\n      }\n    }\n  };\n\n  var normalizeZwspOffset = function (start, container, offset) {\n    if (isText$7(container) === false) {\n      return offset;\n    } else if (start) {\n      return offset === 1 && container.data.charAt(offset - 1) === ZWSP$1 ? 0 : offset;\n    } else {\n      return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP$1 ? container.data.length : offset;\n    }\n  };\n\n  var includeZwspInRange = function (rng) {\n    var newRng = rng.cloneRange();\n    newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n    newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n    return newRng;\n  };\n\n  var trimLeadingLineBreaks = function (node) {\n    do {\n      if (isText$7(node)) {\n        node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n      }\n\n      node = node.firstChild;\n    } while (node);\n  };\n\n  var getEditableRoot = function (dom, node) {\n    var root = dom.getRoot();\n    var parent, editableRoot;\n    parent = node;\n\n    while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n      if (dom.getContentEditable(parent) === 'true') {\n        editableRoot = parent;\n      }\n\n      parent = parent.parentNode;\n    }\n\n    return parent !== root ? editableRoot : root;\n  };\n\n  var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n    var dom = editor.dom;\n    Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n      var currentStyles = getAllRaw(SugarElement.fromDom(node));\n\n      var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n\n      dom.setStyles(node, newStyles);\n    });\n    var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n      return attrClasses.split(/\\s+/);\n    });\n    var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n      return filter$4(currentClasses.split(/\\s+/), function (clazz) {\n        return clazz !== '';\n      });\n    });\n    lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n      var filteredClasses = filter$4(currentClasses, function (clazz) {\n        return !contains$3(attrClasses, clazz);\n      });\n\n      var newClasses = __spreadArray(__spreadArray([], attrClasses, true), filteredClasses, true);\n\n      dom.setAttrib(node, 'class', newClasses.join(' '));\n    });\n    var appliedAttrs = ['style', 'class'];\n    var remainingAttrs = filter$3(forcedRootBlockAttrs, function (_, attrs) {\n      return !contains$3(appliedAttrs, attrs);\n    });\n    dom.setAttribs(node, remainingAttrs);\n  };\n\n  var setForcedBlockAttrs = function (editor, node) {\n    var forcedRootBlockName = getForcedRootBlock(editor);\n\n    if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n      var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n      applyAttributes(editor, node, forcedRootBlockAttrs);\n    }\n  };\n\n  var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n    var newBlock, parentBlock, startNode, node, next, rootBlockName;\n    var blockName = newBlockName || 'P';\n    var dom = editor.dom,\n        editableRoot = getEditableRoot(dom, container);\n    parentBlock = dom.getParent(container, dom.isBlock);\n\n    if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n      parentBlock = parentBlock || editableRoot;\n\n      if (parentBlock === editor.getBody() || isTableCell(parentBlock)) {\n        rootBlockName = parentBlock.nodeName.toLowerCase();\n      } else {\n        rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n      }\n\n      if (!parentBlock.hasChildNodes()) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        parentBlock.appendChild(newBlock);\n        rng.setStart(newBlock, 0);\n        rng.setEnd(newBlock, 0);\n        return newBlock;\n      }\n\n      node = container;\n\n      while (node.parentNode !== parentBlock) {\n        node = node.parentNode;\n      }\n\n      while (node && !dom.isBlock(node)) {\n        startNode = node;\n        node = node.previousSibling;\n      }\n\n      if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n        newBlock = dom.create(blockName);\n        setForcedBlockAttrs(editor, newBlock);\n        startNode.parentNode.insertBefore(newBlock, startNode);\n        node = startNode;\n\n        while (node && !dom.isBlock(node)) {\n          next = node.nextSibling;\n          newBlock.appendChild(node);\n          node = next;\n        }\n\n        rng.setStart(container, offset);\n        rng.setEnd(container, offset);\n      }\n    }\n\n    return container;\n  };\n\n  var addBrToBlockIfNeeded = function (dom, block) {\n    block.normalize();\n    var lastChild = block.lastChild;\n\n    if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n      dom.add(block, 'br');\n    }\n  };\n\n  var insert$2 = function (editor, evt) {\n    var tmpRng, container, offset, parentBlock;\n    var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n    var dom = editor.dom;\n    var schema = editor.schema,\n        nonEmptyElementsMap = schema.getNonEmptyElements();\n    var rng = editor.selection.getRng();\n\n    var createNewBlock = function (name) {\n      var node = container,\n          block,\n          clonedNode,\n          caretNode;\n      var textInlineElements = schema.getTextInlineElements();\n\n      if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n        block = dom.create(name || newBlockName);\n      } else {\n        block = parentBlock.cloneNode(false);\n      }\n\n      caretNode = block;\n\n      if (shouldKeepStyles(editor) === false) {\n        dom.setAttrib(block, 'style', null);\n        dom.setAttrib(block, 'class', null);\n      } else {\n        do {\n          if (textInlineElements[node.nodeName]) {\n            if (isCaretNode(node) || isBookmarkNode$1(node)) {\n              continue;\n            }\n\n            clonedNode = node.cloneNode(false);\n            dom.setAttrib(clonedNode, 'id', '');\n\n            if (block.hasChildNodes()) {\n              clonedNode.appendChild(block.firstChild);\n              block.appendChild(clonedNode);\n            } else {\n              caretNode = clonedNode;\n              block.appendChild(clonedNode);\n            }\n          }\n        } while ((node = node.parentNode) && node !== editableRoot);\n      }\n\n      setForcedBlockAttrs(editor, block);\n      emptyBlock(caretNode);\n      return block;\n    };\n\n    var isCaretAtStartOrEndOfBlock = function (start) {\n      var node, name;\n      var normalizedOffset = normalizeZwspOffset(start, container, offset);\n\n      if (isText$7(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n        return false;\n      }\n\n      if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n        return true;\n      }\n\n      if (start && isElement$5(container) && container === parentBlock.firstChild) {\n        return true;\n      }\n\n      if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n        return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n      }\n\n      var walker = new DomTreeWalker(container, parentBlock);\n\n      if (isText$7(container)) {\n        if (start && normalizedOffset === 0) {\n          walker.prev();\n        } else if (!start && normalizedOffset === container.nodeValue.length) {\n          walker.next();\n        }\n      }\n\n      while (node = walker.current()) {\n        if (isElement$5(node)) {\n          if (!node.getAttribute('data-mce-bogus')) {\n            name = node.nodeName.toLowerCase();\n\n            if (nonEmptyElementsMap[name] && name !== 'br') {\n              return false;\n            }\n          }\n        } else if (isText$7(node) && !isWhitespaceText(node.nodeValue)) {\n          return false;\n        }\n\n        if (start) {\n          walker.prev();\n        } else {\n          walker.next();\n        }\n      }\n\n      return true;\n    };\n\n    var insertNewBlockAfter = function () {\n      if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n        newBlock = createNewBlock(newBlockName);\n      } else {\n        newBlock = createNewBlock();\n      }\n\n      if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n        newBlock = dom.split(containerBlock, parentBlock);\n      } else {\n        dom.insertAfter(newBlock, parentBlock);\n      }\n\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    normalize$2(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    container = rng.startContainer;\n    offset = rng.startOffset;\n    newBlockName = getForcedRootBlock(editor);\n    var shiftKey = !!(evt && evt.shiftKey);\n    var ctrlKey = !!(evt && evt.ctrlKey);\n\n    if (isElement$5(container) && container.hasChildNodes()) {\n      isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && isText$7(container)) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var editableRoot = getEditableRoot(dom, container);\n\n    if (!editableRoot) {\n      return;\n    }\n\n    if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n      container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n    }\n\n    parentBlock = dom.getParent(container, dom.isBlock);\n    containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n\n    if (containerBlockName === 'LI' && !ctrlKey) {\n      parentBlock = containerBlock;\n      containerBlock = containerBlock.parentNode;\n      parentBlockName = containerBlockName;\n    }\n\n    if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n      if (dom.isEmpty(parentBlock)) {\n        insert$3(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n        return;\n      }\n    }\n\n    if (newBlockName && parentBlock === editor.getBody()) {\n      return;\n    }\n\n    newBlockName = newBlockName || 'P';\n\n    if (isCaretContainerBlock$1(parentBlock)) {\n      newBlock = showCaretContainerBlock(parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      setForcedBlockAttrs(editor, newBlock);\n      moveToCaretPosition(editor, newBlock);\n    } else if (isCaretAtStartOrEndOfBlock()) {\n      insertNewBlockAfter();\n    } else if (isCaretAtStartOrEndOfBlock(true)) {\n      newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n      moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n    } else {\n      tmpRng = includeZwspInRange(rng).cloneRange();\n      tmpRng.setEndAfter(parentBlock);\n      fragment = tmpRng.extractContents();\n      trimZwsp(fragment);\n      trimLeadingLineBreaks(fragment);\n      newBlock = fragment.firstChild;\n      dom.insertAfter(fragment, parentBlock);\n      trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n      addBrToBlockIfNeeded(dom, parentBlock);\n\n      if (dom.isEmpty(parentBlock)) {\n        emptyBlock(parentBlock);\n      }\n\n      newBlock.normalize();\n\n      if (dom.isEmpty(newBlock)) {\n        dom.remove(newBlock);\n        insertNewBlockAfter();\n      } else {\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      }\n    }\n\n    dom.setAttrib(newBlock, 'id', '');\n    editor.fire('NewBlock', {\n      newBlock: newBlock\n    });\n  };\n\n  var hasRightSideContent = function (schema, container, parentBlock) {\n    var walker = new DomTreeWalker(container, parentBlock);\n    var node;\n    var nonEmptyElementsMap = schema.getNonEmptyElements();\n\n    while (node = walker.next()) {\n      if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n        return true;\n      }\n    }\n  };\n\n  var moveSelectionToBr = function (editor, brElm, extraBr) {\n    var rng = editor.dom.createRng();\n\n    if (!extraBr) {\n      rng.setStartAfter(brElm);\n      rng.setEndAfter(brElm);\n    } else {\n      rng.setStartBefore(brElm);\n      rng.setEndBefore(brElm);\n    }\n\n    editor.selection.setRng(rng);\n    scrollRangeIntoView(editor, rng);\n  };\n\n  var insertBrAtCaret = function (editor, evt) {\n    var selection = editor.selection;\n    var dom = editor.dom;\n    var rng = selection.getRng();\n    var brElm;\n    var extraBr;\n    normalize$2(dom, rng).each(function (normRng) {\n      rng.setStart(normRng.startContainer, normRng.startOffset);\n      rng.setEnd(normRng.endContainer, normRng.endOffset);\n    });\n    var offset = rng.startOffset;\n    var container = rng.startContainer;\n\n    if (container.nodeType === 1 && container.hasChildNodes()) {\n      var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n      container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n\n      if (isAfterLastNodeInContainer && container.nodeType === 3) {\n        offset = container.nodeValue.length;\n      } else {\n        offset = 0;\n      }\n    }\n\n    var parentBlock = dom.getParent(container, dom.isBlock);\n    var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n    var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n    var isControlKey = !!(evt && evt.ctrlKey);\n\n    if (containerBlockName === 'LI' && !isControlKey) {\n      parentBlock = containerBlock;\n    }\n\n    if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n      if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n        brElm = dom.create('br');\n        rng.insertNode(brElm);\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n        extraBr = true;\n      }\n    }\n\n    brElm = dom.create('br');\n    rangeInsertNode(dom, rng, brElm);\n    moveSelectionToBr(editor, brElm, extraBr);\n    editor.undoManager.add();\n  };\n\n  var insertBrBefore = function (editor, inline) {\n    var br = SugarElement.fromTag('br');\n    before$4(SugarElement.fromDom(inline), br);\n    editor.undoManager.add();\n  };\n\n  var insertBrAfter = function (editor, inline) {\n    if (!hasBrAfter(editor.getBody(), inline)) {\n      after$3(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n    }\n\n    var br = SugarElement.fromTag('br');\n    after$3(SugarElement.fromDom(inline), br);\n    moveSelectionToBr(editor, br.dom, false);\n    editor.undoManager.add();\n  };\n\n  var isBeforeBr = function (pos) {\n    return isBr$5(pos.getNode());\n  };\n\n  var hasBrAfter = function (rootNode, startNode) {\n    if (isBeforeBr(CaretPosition.after(startNode))) {\n      return true;\n    } else {\n      return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n        return isBr$5(pos.getNode());\n      }).getOr(false);\n    }\n  };\n\n  var isAnchorLink = function (elm) {\n    return elm && elm.nodeName === 'A' && 'href' in elm;\n  };\n\n  var isInsideAnchor = function (location) {\n    return location.fold(never, isAnchorLink, isAnchorLink, never);\n  };\n\n  var readInlineAnchorLocation = function (editor) {\n    var isInlineTarget$1 = curry(isInlineTarget, editor);\n    var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n    return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n  };\n\n  var insertBrOutsideAnchor = function (editor, location) {\n    location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n  };\n\n  var insert$1 = function (editor, evt) {\n    var anchorLocation = readInlineAnchorLocation(editor);\n\n    if (anchorLocation.isSome()) {\n      anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n    } else {\n      insertBrAtCaret(editor, evt);\n    }\n  };\n\n  var matchesSelector = function (editor, selector) {\n    return getParentBlock(editor).filter(function (parentBlock) {\n      return selector.length > 0 && is$2(SugarElement.fromDom(parentBlock), selector);\n    }).isSome();\n  };\n\n  var shouldInsertBr = function (editor) {\n    return matchesSelector(editor, getBrNewLineSelector(editor));\n  };\n\n  var shouldBlockNewLine$1 = function (editor) {\n    return matchesSelector(editor, getNoNewLineSelector(editor));\n  };\n\n  var newLineAction = Adt.generate([{\n    br: []\n  }, {\n    block: []\n  }, {\n    none: []\n  }]);\n\n  var shouldBlockNewLine = function (editor, _shiftKey) {\n    return shouldBlockNewLine$1(editor);\n  };\n\n  var isBrMode = function (requiredState) {\n    return function (editor, _shiftKey) {\n      var brMode = getForcedRootBlock(editor) === '';\n      return brMode === requiredState;\n    };\n  };\n\n  var inListBlock = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return isListItemParentBlock(editor) === requiredState;\n    };\n  };\n\n  var inBlock = function (blockName, requiredState) {\n    return function (editor, _shiftKey) {\n      var state = getParentBlockName(editor) === blockName.toUpperCase();\n      return state === requiredState;\n    };\n  };\n\n  var inPreBlock = function (requiredState) {\n    return inBlock('pre', requiredState);\n  };\n\n  var inSummaryBlock = function () {\n    return inBlock('summary', true);\n  };\n\n  var shouldPutBrInPre = function (requiredState) {\n    return function (editor, _shiftKey) {\n      return shouldPutBrInPre$1(editor) === requiredState;\n    };\n  };\n\n  var inBrContext = function (editor, _shiftKey) {\n    return shouldInsertBr(editor);\n  };\n\n  var hasShiftKey = function (_editor, shiftKey) {\n    return shiftKey;\n  };\n\n  var canInsertIntoEditableRoot = function (editor) {\n    var forcedRootBlock = getForcedRootBlock(editor);\n    var rootEditable = getEditableRoot$1(editor.dom, editor.selection.getStart());\n    return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n  };\n\n  var match = function (predicates, action) {\n    return function (editor, shiftKey) {\n      var isMatch = foldl(predicates, function (res, p) {\n        return res && p(editor, shiftKey);\n      }, true);\n      return isMatch ? Optional.some(action) : Optional.none();\n    };\n  };\n\n  var getAction = function (editor, evt) {\n    return evaluateUntil([match([shouldBlockNewLine], newLineAction.none()), match([inSummaryBlock()], newLineAction.br()), match([inPreBlock(true), shouldPutBrInPre(false), hasShiftKey], newLineAction.br()), match([inPreBlock(true), shouldPutBrInPre(false)], newLineAction.block()), match([inPreBlock(true), shouldPutBrInPre(true), hasShiftKey], newLineAction.block()), match([inPreBlock(true), shouldPutBrInPre(true)], newLineAction.br()), match([inListBlock(true), hasShiftKey], newLineAction.br()), match([inListBlock(true)], newLineAction.block()), match([isBrMode(true), hasShiftKey, canInsertIntoEditableRoot], newLineAction.block()), match([isBrMode(true)], newLineAction.br()), match([inBrContext], newLineAction.br()), match([isBrMode(false), hasShiftKey], newLineAction.br()), match([canInsertIntoEditableRoot], newLineAction.block())], [editor, !!(evt && evt.shiftKey)]).getOr(newLineAction.none());\n  };\n\n  var insert = function (editor, evt) {\n    getAction(editor, evt).fold(function () {\n      insert$1(editor, evt);\n    }, function () {\n      insert$2(editor, evt);\n    }, noop);\n  };\n\n  var handleEnterKeyEvent = function (editor, event) {\n    if (event.isDefaultPrevented()) {\n      return;\n    }\n\n    event.preventDefault();\n    endTypingLevelIgnoreLocks(editor.undoManager);\n    editor.undoManager.transact(function () {\n      if (editor.selection.isCollapsed() === false) {\n        editor.execCommand('Delete');\n      }\n\n      insert(editor, event);\n    });\n  };\n\n  var setup$9 = function (editor) {\n    editor.on('keydown', function (event) {\n      if (event.keyCode === VK.ENTER) {\n        handleEnterKeyEvent(editor, event);\n      }\n    });\n  };\n\n  var executeKeydownOverride$1 = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$1, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$1, editor, false)\n    }, {\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint, editor, true)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint, editor, false)\n    }, {\n      keyCode: VK.END,\n      action: action(moveToLineEndPoint$2, editor, true, caret)\n    }, {\n      keyCode: VK.HOME,\n      action: action(moveToLineEndPoint$2, editor, false, caret)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$8 = function (editor, caret) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride$1(editor, caret, evt);\n      }\n    });\n  };\n\n  var browser = detect().browser;\n\n  var setupIeInput = function (editor) {\n    var keypressThrotter = first(function () {\n      if (!editor.composing) {\n        normalizeNbspsInEditor(editor);\n      }\n    }, 0);\n\n    if (browser.isIE()) {\n      editor.on('keypress', function (_e) {\n        keypressThrotter.throttle();\n      });\n      editor.on('remove', function (_e) {\n        keypressThrotter.cancel();\n      });\n    }\n  };\n\n  var setup$7 = function (editor) {\n    setupIeInput(editor);\n    editor.on('input', function (e) {\n      if (e.isComposing === false) {\n        normalizeNbspsInEditor(editor);\n      }\n    });\n  };\n\n  var platform = detect();\n\n  var executeKeyupAction = function (editor, caret, evt) {\n    execute([{\n      keyCode: VK.PAGE_UP,\n      action: action(moveToLineEndPoint$2, editor, false, caret)\n    }, {\n      keyCode: VK.PAGE_DOWN,\n      action: action(moveToLineEndPoint$2, editor, true, caret)\n    }], evt);\n  };\n\n  var stopImmediatePropagation = function (e) {\n    return e.stopImmediatePropagation();\n  };\n\n  var isPageUpDown = function (evt) {\n    return evt.keyCode === VK.PAGE_UP || evt.keyCode === VK.PAGE_DOWN;\n  };\n\n  var setNodeChangeBlocker = function (blocked, editor, block) {\n    if (block && !blocked.get()) {\n      editor.on('NodeChange', stopImmediatePropagation, true);\n    } else if (!block && blocked.get()) {\n      editor.off('NodeChange', stopImmediatePropagation);\n    }\n\n    blocked.set(block);\n  };\n\n  var setup$6 = function (editor, caret) {\n    if (platform.os.isOSX()) {\n      return;\n    }\n\n    var blocked = Cell(false);\n    editor.on('keydown', function (evt) {\n      if (isPageUpDown(evt)) {\n        setNodeChangeBlocker(blocked, editor, true);\n      }\n    });\n    editor.on('keyup', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeyupAction(editor, caret, evt);\n      }\n\n      if (isPageUpDown(evt) && blocked.get()) {\n        setNodeChangeBlocker(blocked, editor, false);\n        editor.nodeChanged();\n      }\n    });\n  };\n\n  var insertTextAtPosition = function (text, pos) {\n    var container = pos.container();\n    var offset = pos.offset();\n\n    if (isText$7(container)) {\n      container.insertData(offset, text);\n      return Optional.some(CaretPosition(container, offset + text.length));\n    } else {\n      return getElementFromPosition(pos).map(function (elm) {\n        var textNode = SugarElement.fromText(text);\n\n        if (pos.isAtEnd()) {\n          after$3(elm, textNode);\n        } else {\n          before$4(elm, textNode);\n        }\n\n        return CaretPosition(textNode.dom, text.length);\n      });\n    }\n  };\n\n  var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n  var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n  var locationToCaretPosition = function (root) {\n    return function (location) {\n      return location.fold(function (element) {\n        return prevPosition(root.dom, CaretPosition.before(element));\n      }, function (element) {\n        return firstPositionIn(element);\n      }, function (element) {\n        return lastPositionIn(element);\n      }, function (element) {\n        return nextPosition(root.dom, CaretPosition.after(element));\n      });\n    };\n  };\n\n  var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n    return function (checkPos) {\n      return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n    };\n  };\n\n  var setSelection = function (editor) {\n    return function (pos) {\n      editor.selection.setRng(pos.toRange());\n      editor.nodeChanged();\n      return true;\n    };\n  };\n\n  var insertSpaceOrNbspAtSelection = function (editor) {\n    var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n    var root = SugarElement.fromDom(editor.getBody());\n\n    if (editor.selection.isCollapsed()) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection(editor));\n    } else {\n      return false;\n    }\n  };\n\n  var executeKeydownOverride = function (editor, evt) {\n    execute([{\n      keyCode: VK.SPACEBAR,\n      action: action(insertSpaceOrNbspAtSelection, editor)\n    }], evt).each(function (_) {\n      evt.preventDefault();\n    });\n  };\n\n  var setup$5 = function (editor) {\n    editor.on('keydown', function (evt) {\n      if (evt.isDefaultPrevented() === false) {\n        executeKeydownOverride(editor, evt);\n      }\n    });\n  };\n\n  var registerKeyboardOverrides = function (editor) {\n    var caret = setupSelectedState(editor);\n    setup$c(editor);\n    setup$b(editor, caret);\n    setup$a(editor, caret);\n    setup$9(editor);\n    setup$5(editor);\n    setup$7(editor);\n    setup$8(editor, caret);\n    setup$6(editor, caret);\n    return caret;\n  };\n\n  var setup$4 = function (editor) {\n    if (!isRtc(editor)) {\n      return registerKeyboardOverrides(editor);\n    } else {\n      return Cell(null);\n    }\n  };\n\n  var NodeChange = function () {\n    function NodeChange(editor) {\n      this.lastPath = [];\n      this.editor = editor;\n      var lastRng;\n      var self = this;\n\n      if (!('onselectionchange' in editor.getDoc())) {\n        editor.on('NodeChange click mouseup keyup focus', function (e) {\n          var nativeRng = editor.selection.getRng();\n          var fakeRng = {\n            startContainer: nativeRng.startContainer,\n            startOffset: nativeRng.startOffset,\n            endContainer: nativeRng.endContainer,\n            endOffset: nativeRng.endOffset\n          };\n\n          if (e.type === 'nodechange' || !isEq$4(fakeRng, lastRng)) {\n            editor.fire('SelectionChange');\n          }\n\n          lastRng = fakeRng;\n        });\n      }\n\n      editor.on('contextmenu', function () {\n        editor.fire('SelectionChange');\n      });\n      editor.on('SelectionChange', function () {\n        var startElm = editor.selection.getStart(true);\n\n        if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n          return;\n        }\n\n        if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n          editor.nodeChanged({\n            selectionChange: true\n          });\n        }\n      });\n      editor.on('mouseup', function (e) {\n        if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n          if (editor.selection.getNode().nodeName === 'IMG') {\n            Delay.setEditorTimeout(editor, function () {\n              editor.nodeChanged();\n            });\n          } else {\n            editor.nodeChanged();\n          }\n        }\n      });\n    }\n\n    NodeChange.prototype.nodeChanged = function (args) {\n      var selection = this.editor.selection;\n      var node, parents, root;\n\n      if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n        root = this.editor.getBody();\n        node = selection.getStart(true) || root;\n\n        if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n          node = root;\n        }\n\n        parents = [];\n        this.editor.dom.getParent(node, function (node) {\n          if (node === root) {\n            return true;\n          }\n\n          parents.push(node);\n        });\n        args = args || {};\n        args.element = node;\n        args.parents = parents;\n        this.editor.fire('NodeChange', args);\n      }\n    };\n\n    NodeChange.prototype.isSameElementPath = function (startElm) {\n      var i;\n      var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n\n      if (currentPath.length === this.lastPath.length) {\n        for (i = currentPath.length; i >= 0; i--) {\n          if (currentPath[i] !== this.lastPath[i]) {\n            break;\n          }\n        }\n\n        if (i === -1) {\n          this.lastPath = currentPath;\n          return true;\n        }\n      }\n\n      this.lastPath = currentPath;\n      return false;\n    };\n\n    return NodeChange;\n  }();\n\n  var preventSummaryToggle = function (editor) {\n    editor.on('click', function (e) {\n      if (editor.dom.getParent(e.target, 'details')) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var filterDetails = function (editor) {\n    editor.parser.addNodeFilter('details', function (elms) {\n      each$k(elms, function (details) {\n        details.attr('data-mce-open', details.attr('open'));\n        details.attr('open', 'open');\n      });\n    });\n    editor.serializer.addNodeFilter('details', function (elms) {\n      each$k(elms, function (details) {\n        var open = details.attr('data-mce-open');\n        details.attr('open', isString$1(open) ? open : null);\n        details.attr('data-mce-open', null);\n      });\n    });\n  };\n\n  var setup$3 = function (editor) {\n    preventSummaryToggle(editor);\n    filterDetails(editor);\n  };\n\n  var isTextBlockNode = function (node) {\n    return isElement$5(node) && isTextBlock$2(SugarElement.fromDom(node));\n  };\n\n  var normalizeSelection = function (editor) {\n    var rng = editor.selection.getRng();\n    var startPos = CaretPosition.fromRangeStart(rng);\n    var endPos = CaretPosition.fromRangeEnd(rng);\n\n    if (CaretPosition.isElementPosition(startPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        firstPositionIn(container).each(function (pos) {\n          return rng.setStart(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    if (CaretPosition.isElementPosition(endPos)) {\n      var container = startPos.container();\n\n      if (isTextBlockNode(container)) {\n        lastPositionIn(container).each(function (pos) {\n          return rng.setEnd(pos.container(), pos.offset());\n        });\n      }\n    }\n\n    editor.selection.setRng(normalize(rng));\n  };\n\n  var setup$2 = function (editor) {\n    editor.on('click', function (e) {\n      if (e.detail >= 3) {\n        normalizeSelection(editor);\n      }\n    });\n  };\n\n  var getAbsolutePosition = function (elm) {\n    var clientRect = elm.getBoundingClientRect();\n    var doc = elm.ownerDocument;\n    var docElem = doc.documentElement;\n    var win = doc.defaultView;\n    return {\n      top: clientRect.top + win.pageYOffset - docElem.clientTop,\n      left: clientRect.left + win.pageXOffset - docElem.clientLeft\n    };\n  };\n\n  var getBodyPosition = function (editor) {\n    return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getScrollPosition = function (editor) {\n    var body = editor.getBody();\n    return editor.inline ? {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    } : {\n      left: 0,\n      top: 0\n    };\n  };\n\n  var getBodyScroll = function (editor) {\n    var body = editor.getBody(),\n        docElm = editor.getDoc().documentElement;\n    var inlineScroll = {\n      left: body.scrollLeft,\n      top: body.scrollTop\n    };\n    var iframeScroll = {\n      left: body.scrollLeft || docElm.scrollLeft,\n      top: body.scrollTop || docElm.scrollTop\n    };\n    return editor.inline ? inlineScroll : iframeScroll;\n  };\n\n  var getMousePosition = function (editor, event) {\n    if (event.target.ownerDocument !== editor.getDoc()) {\n      var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n      var scrollPosition = getBodyScroll(editor);\n      return {\n        left: event.pageX - iframePosition.left + scrollPosition.left,\n        top: event.pageY - iframePosition.top + scrollPosition.top\n      };\n    }\n\n    return {\n      left: event.pageX,\n      top: event.pageY\n    };\n  };\n\n  var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n    return {\n      pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n      pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n    };\n  };\n\n  var calc = function (editor, event) {\n    return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n  };\n\n  var isContentEditableFalse$1 = isContentEditableFalse$b,\n      isContentEditableTrue$1 = isContentEditableTrue$4;\n\n  var isDraggable = function (rootElm, elm) {\n    return isContentEditableFalse$1(elm) && elm !== rootElm;\n  };\n\n  var isValidDropTarget = function (editor, targetElement, dragElement) {\n    if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n      return false;\n    }\n\n    return !isContentEditableFalse$1(targetElement);\n  };\n\n  var cloneElement = function (elm) {\n    var cloneElm = elm.cloneNode(true);\n    cloneElm.removeAttribute('data-mce-selected');\n    return cloneElm;\n  };\n\n  var createGhost = function (editor, elm, width, height) {\n    var dom = editor.dom;\n    var clonedElm = elm.cloneNode(true);\n    dom.setStyles(clonedElm, {\n      width: width,\n      height: height\n    });\n    dom.setAttrib(clonedElm, 'data-mce-selected', null);\n    var ghostElm = dom.create('div', {\n      'class': 'mce-drag-container',\n      'data-mce-bogus': 'all',\n      'unselectable': 'on',\n      'contenteditable': 'false'\n    });\n    dom.setStyles(ghostElm, {\n      position: 'absolute',\n      opacity: 0.5,\n      overflow: 'hidden',\n      border: 0,\n      padding: 0,\n      margin: 0,\n      width: width,\n      height: height\n    });\n    dom.setStyles(clonedElm, {\n      margin: 0,\n      boxSizing: 'border-box'\n    });\n    ghostElm.appendChild(clonedElm);\n    return ghostElm;\n  };\n\n  var appendGhostToBody = function (ghostElm, bodyElm) {\n    if (ghostElm.parentNode !== bodyElm) {\n      bodyElm.appendChild(ghostElm);\n    }\n  };\n\n  var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n    var overflowX = 0,\n        overflowY = 0;\n    ghostElm.style.left = position.pageX + 'px';\n    ghostElm.style.top = position.pageY + 'px';\n\n    if (position.pageX + width > maxX) {\n      overflowX = position.pageX + width - maxX;\n    }\n\n    if (position.pageY + height > maxY) {\n      overflowY = position.pageY + height - maxY;\n    }\n\n    ghostElm.style.width = width - overflowX + 'px';\n    ghostElm.style.height = height - overflowY + 'px';\n  };\n\n  var removeElement = function (elm) {\n    if (elm && elm.parentNode) {\n      elm.parentNode.removeChild(elm);\n    }\n  };\n\n  var isLeftMouseButtonPressed = function (e) {\n    return e.button === 0;\n  };\n\n  var applyRelPos = function (state, position) {\n    return {\n      pageX: position.pageX - state.relX,\n      pageY: position.pageY + 5\n    };\n  };\n\n  var start = function (state, editor) {\n    return function (e) {\n      if (isLeftMouseButtonPressed(e)) {\n        var ceElm = find$3(editor.dom.getParents(e.target), or(isContentEditableFalse$1, isContentEditableTrue$1)).getOr(null);\n\n        if (isDraggable(editor.getBody(), ceElm)) {\n          var elmPos = editor.dom.getPos(ceElm);\n          var bodyElm = editor.getBody();\n          var docElm = editor.getDoc().documentElement;\n          state.set({\n            element: ceElm,\n            dragging: false,\n            screenX: e.screenX,\n            screenY: e.screenY,\n            maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n            maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n            relX: e.pageX - elmPos.x,\n            relY: e.pageY - elmPos.y,\n            width: ceElm.offsetWidth,\n            height: ceElm.offsetHeight,\n            ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n          });\n        }\n      }\n    };\n  };\n\n  var move = function (state, editor) {\n    var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n      editor._selectionOverrides.hideFakeCaret();\n\n      editor.selection.placeCaretAt(clientX, clientY);\n    }, 0);\n    editor.on('remove', throttledPlaceCaretAt.stop);\n    return function (e) {\n      return state.on(function (state) {\n        var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n\n        if (!state.dragging && movement > 10) {\n          var args = editor.fire('dragstart', {\n            target: state.element\n          });\n\n          if (args.isDefaultPrevented()) {\n            return;\n          }\n\n          state.dragging = true;\n          editor.focus();\n        }\n\n        if (state.dragging) {\n          var targetPos = applyRelPos(state, calc(editor, e));\n          appendGhostToBody(state.ghost, editor.getBody());\n          moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n          throttledPlaceCaretAt(e.clientX, e.clientY);\n        }\n      });\n    };\n  };\n\n  var getRawTarget = function (selection) {\n    var rng = selection.getSel().getRangeAt(0);\n    var startContainer = rng.startContainer;\n    return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n  };\n\n  var drop = function (state, editor) {\n    return function (e) {\n      state.on(function (state) {\n        if (state.dragging) {\n          if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n            var targetClone_1 = cloneElement(state.element);\n            var args = editor.fire('drop', {\n              clientX: e.clientX,\n              clientY: e.clientY\n            });\n\n            if (!args.isDefaultPrevented()) {\n              editor.undoManager.transact(function () {\n                removeElement(state.element);\n                editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n\n                editor._selectionOverrides.hideFakeCaret();\n              });\n            }\n          }\n\n          editor.fire('dragend');\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var stop = function (state, editor) {\n    return function () {\n      state.on(function (state) {\n        if (state.dragging) {\n          editor.fire('dragend');\n        }\n      });\n      removeDragState(state);\n    };\n  };\n\n  var removeDragState = function (state) {\n    state.on(function (state) {\n      removeElement(state.ghost);\n    });\n    state.clear();\n  };\n\n  var bindFakeDragEvents = function (editor) {\n    var state = value();\n    var pageDom = DOMUtils.DOM;\n    var rootDocument = document;\n    var dragStartHandler = start(state, editor);\n    var dragHandler = move(state, editor);\n    var dropHandler = drop(state, editor);\n    var dragEndHandler = stop(state, editor);\n    editor.on('mousedown', dragStartHandler);\n    editor.on('mousemove', dragHandler);\n    editor.on('mouseup', dropHandler);\n    pageDom.bind(rootDocument, 'mousemove', dragHandler);\n    pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n    editor.on('remove', function () {\n      pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n      pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n    });\n    editor.on('keydown', function (e) {\n      if (e.keyCode === VK.ESC) {\n        dragEndHandler();\n      }\n    });\n  };\n\n  var blockIeDrop = function (editor) {\n    editor.on('drop', function (e) {\n      var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n\n      if (isContentEditableFalse$1(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var blockUnsupportedFileDrop = function (editor) {\n    var preventFileDrop = function (e) {\n      if (!e.isDefaultPrevented()) {\n        var dataTransfer = e.dataTransfer;\n\n        if (dataTransfer && (contains$3(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n          e.preventDefault();\n\n          if (e.type === 'drop') {\n            displayError(editor, 'Dropped file type is not supported');\n          }\n        }\n      }\n    };\n\n    var preventFileDropIfUIElement = function (e) {\n      if (isUIElement(editor, e.target)) {\n        preventFileDrop(e);\n      }\n    };\n\n    var setup = function () {\n      var pageDom = DOMUtils.DOM;\n      var dom = editor.dom;\n      var doc = document;\n      var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n      var eventNames = ['drop', 'dragover'];\n      each$k(eventNames, function (name) {\n        pageDom.bind(doc, name, preventFileDropIfUIElement);\n        dom.bind(editorRoot, name, preventFileDrop);\n      });\n      editor.on('remove', function () {\n        each$k(eventNames, function (name) {\n          pageDom.unbind(doc, name, preventFileDropIfUIElement);\n          dom.unbind(editorRoot, name, preventFileDrop);\n        });\n      });\n    };\n\n    editor.on('init', function () {\n      Delay.setEditorTimeout(editor, setup, 0);\n    });\n  };\n\n  var init$2 = function (editor) {\n    bindFakeDragEvents(editor);\n    blockIeDrop(editor);\n\n    if (shouldBlockUnsupportedDrop(editor)) {\n      blockUnsupportedFileDrop(editor);\n    }\n  };\n\n  var setup$1 = function (editor) {\n    var renderFocusCaret = first(function () {\n      if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n        var rng = editor.selection.getRng();\n\n        if (rng.collapsed) {\n          var caretRange = renderRangeCaret(editor, rng, false);\n          editor.selection.setRng(caretRange);\n        }\n      }\n    }, 0);\n    editor.on('focus', function () {\n      renderFocusCaret.throttle();\n    });\n    editor.on('blur', function () {\n      renderFocusCaret.cancel();\n    });\n  };\n\n  var setup = function (editor) {\n    editor.on('init', function () {\n      editor.on('focusin', function (e) {\n        var target = e.target;\n\n        if (isMedia$2(target)) {\n          var ceRoot = getContentEditableRoot$1(editor.getBody(), target);\n          var node = isContentEditableFalse$b(ceRoot) ? ceRoot : target;\n\n          if (editor.selection.getNode() !== node) {\n            selectNode(editor, node).each(function (rng) {\n              return editor.selection.setRng(rng);\n            });\n          }\n        }\n      });\n    });\n  };\n\n  var isContentEditableTrue = isContentEditableTrue$4;\n  var isContentEditableFalse = isContentEditableFalse$b;\n\n  var getContentEditableRoot = function (editor, node) {\n    return getContentEditableRoot$1(editor.getBody(), node);\n  };\n\n  var SelectionOverrides = function (editor) {\n    var selection = editor.selection,\n        dom = editor.dom;\n    var isBlock = dom.isBlock;\n    var rootNode = editor.getBody();\n    var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n      return hasFocus(editor);\n    });\n    var realSelectionId = 'sel-' + dom.uniqueId();\n    var elementSelectionAttr = 'data-mce-selected';\n    var selectedElement;\n\n    var isFakeSelectionElement = function (node) {\n      return dom.hasClass(node, 'mce-offscreen-selection');\n    };\n\n    var isFakeSelectionTargetElement = function (node) {\n      return node !== rootNode && (isContentEditableFalse(node) || isMedia$2(node)) && dom.isChildOf(node, rootNode);\n    };\n\n    var isNearFakeSelectionElement = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n    };\n\n    var getRealSelectionElement = function () {\n      var container = dom.get(realSelectionId);\n      return container ? container.getElementsByTagName('*')[0] : container;\n    };\n\n    var setRange = function (range) {\n      if (range) {\n        selection.setRng(range);\n      }\n    };\n\n    var getRange = selection.getRng;\n\n    var showCaret = function (direction, node, before, scrollIntoView) {\n      if (scrollIntoView === void 0) {\n        scrollIntoView = true;\n      }\n\n      var e = editor.fire('ShowCaret', {\n        target: node,\n        direction: direction,\n        before: before\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      if (scrollIntoView) {\n        selection.scrollIntoView(node, direction === -1);\n      }\n\n      return fakeCaret.show(before, node);\n    };\n\n    var showBlockCaretContainer = function (blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        setRange(getRange());\n        selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n\n    var registerEvents = function () {\n      editor.on('mouseup', function (e) {\n        var range = getRange();\n\n        if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n          renderCaretAtRange(editor, range, false).each(setRange);\n        }\n      });\n      editor.on('click', function (e) {\n        var contentEditableRoot = getContentEditableRoot(editor, e.target);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse(contentEditableRoot)) {\n            e.preventDefault();\n            editor.focus();\n          }\n\n          if (isContentEditableTrue(contentEditableRoot)) {\n            if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n              removeElementSelection();\n            }\n          }\n        }\n      });\n      editor.on('blur NewBlock', removeElementSelection);\n      editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n\n      var hasNormalCaretPosition = function (elm) {\n        var start = elm.firstChild;\n\n        if (isNullable(start)) {\n          return false;\n        }\n\n        var startPos = CaretPosition.before(start);\n\n        if (isBr$5(startPos.getNode()) && elm.childNodes.length === 1) {\n          return !isNearFakeSelectionElement(startPos);\n        } else {\n          var caretWalker = CaretWalker(elm);\n          var newPos = caretWalker.next(startPos);\n          return newPos && !isNearFakeSelectionElement(newPos);\n        }\n      };\n\n      var isInSameBlock = function (node1, node2) {\n        var block1 = dom.getParent(node1, isBlock);\n        var block2 = dom.getParent(node2, isBlock);\n        return block1 === block2;\n      };\n\n      var hasBetterMouseTarget = function (targetNode, caretNode) {\n        var targetBlock = dom.getParent(targetNode, isBlock);\n        var caretBlock = dom.getParent(caretNode, isBlock);\n\n        if (isNullable(targetBlock)) {\n          return false;\n        }\n\n        if (targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse(getContentEditableRoot(editor, targetBlock)) === false) {\n          return true;\n        }\n\n        return !dom.isChildOf(caretBlock, targetBlock) && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n      };\n\n      editor.on('tap', function (e) {\n        var targetElm = e.target;\n        var contentEditableRoot = getContentEditableRoot(editor, targetElm);\n\n        if (isContentEditableFalse(contentEditableRoot)) {\n          e.preventDefault();\n          selectNode(editor, contentEditableRoot).each(setElementSelection);\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        }\n      }, true);\n      editor.on('mousedown', function (e) {\n        var targetElm = e.target;\n\n        if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n          return;\n        }\n\n        if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n          return;\n        }\n\n        var contentEditableRoot = getContentEditableRoot(editor, targetElm);\n\n        if (contentEditableRoot) {\n          if (isContentEditableFalse(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else {\n            removeElementSelection();\n\n            if (!(isContentEditableTrue(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n              hideFakeCaret();\n              selection.placeCaretAt(e.clientX, e.clientY);\n            }\n          }\n        } else if (isFakeSelectionTargetElement(targetElm)) {\n          selectNode(editor, targetElm).each(setElementSelection);\n        } else if (isFakeCaretTarget(targetElm) === false) {\n          removeElementSelection();\n          hideFakeCaret();\n          var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n\n          if (fakeCaretInfo) {\n            if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n              e.preventDefault();\n              var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n              setRange(range);\n              editor.getBody().focus();\n            }\n          }\n        }\n      });\n      editor.on('keypress', function (e) {\n        if (VK.modifierPressed(e)) {\n          return;\n        }\n\n        if (isContentEditableFalse(selection.getNode())) {\n          e.preventDefault();\n        }\n      });\n      editor.on('GetSelectionRange', function (e) {\n        var rng = e.range;\n\n        if (selectedElement) {\n          if (!selectedElement.parentNode) {\n            selectedElement = null;\n            return;\n          }\n\n          rng = rng.cloneRange();\n          rng.selectNode(selectedElement);\n          e.range = rng;\n        }\n      });\n      editor.on('SetSelectionRange', function (e) {\n        e.range = normalizeShortEndedElementSelection(e.range);\n        var rng = setElementSelection(e.range, e.forward);\n\n        if (rng) {\n          e.range = rng;\n        }\n      });\n\n      var isPasteBin = function (node) {\n        return node.id === 'mcepastebin';\n      };\n\n      editor.on('AfterSetSelectionRange', function (e) {\n        var rng = e.range;\n        var parentNode = rng.startContainer.parentNode;\n\n        if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n          hideFakeCaret();\n        }\n\n        if (!isFakeSelectionElement(parentNode)) {\n          removeElementSelection();\n        }\n      });\n      editor.on('copy', function (e) {\n        var clipboardData = e.clipboardData;\n\n        if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n          var realSelectionElement = getRealSelectionElement();\n\n          if (realSelectionElement) {\n            e.preventDefault();\n            clipboardData.clearData();\n            clipboardData.setData('text/html', realSelectionElement.outerHTML);\n            clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n          }\n        }\n      });\n      init$2(editor);\n      setup$1(editor);\n      setup(editor);\n    };\n\n    var isWithinCaretContainer = function (node) {\n      return isCaretContainer$2(node) || startsWithCaretContainer$1(node) || endsWithCaretContainer$1(node);\n    };\n\n    var isRangeInCaretContainer = function (rng) {\n      return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n    };\n\n    var normalizeShortEndedElementSelection = function (rng) {\n      var shortEndedElements = editor.schema.getShortEndedElements();\n      var newRng = dom.createRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n\n      if (has$2(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n        if (startOffset === 0) {\n          newRng.setStartBefore(startContainer);\n        } else {\n          newRng.setStartAfter(startContainer);\n        }\n      } else {\n        newRng.setStart(startContainer, startOffset);\n      }\n\n      if (has$2(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n        if (endOffset === 0) {\n          newRng.setEndBefore(endContainer);\n        } else {\n          newRng.setEndAfter(endContainer);\n        }\n      } else {\n        newRng.setEnd(endContainer, endOffset);\n      }\n\n      return newRng;\n    };\n\n    var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n      var $ = editor.$;\n      var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n        return $([]);\n      }, function (elm) {\n        return $([elm.dom]);\n      });\n\n      if ($realSelectionContainer.length === 0) {\n        $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n        $realSelectionContainer.appendTo(editor.getBody());\n      }\n\n      var newRange = dom.createRng();\n\n      if (targetClone === origTargetClone && Env.ie) {\n        $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n        newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n        newRange.setEndAfter(targetClone);\n      } else {\n        $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n        newRange.setStart($realSelectionContainer[0].firstChild, 1);\n        newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n      }\n\n      $realSelectionContainer.css({\n        top: dom.getPos(node, editor.getBody()).y\n      });\n      $realSelectionContainer[0].focus();\n      var sel = selection.getSel();\n      sel.removeAllRanges();\n      sel.addRange(newRange);\n      return newRange;\n    };\n\n    var selectElement = function (elm) {\n      var targetClone = elm.cloneNode(true);\n      var e = editor.fire('ObjectSelected', {\n        target: elm,\n        targetClone: targetClone\n      });\n\n      if (e.isDefaultPrevented()) {\n        return null;\n      }\n\n      var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n      var nodeElm = SugarElement.fromDom(elm);\n      each$k(descendants(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n        if (!eq(nodeElm, elm)) {\n          remove$6(elm, elementSelectionAttr);\n        }\n      });\n\n      if (!dom.getAttrib(elm, elementSelectionAttr)) {\n        elm.setAttribute(elementSelectionAttr, '1');\n      }\n\n      selectedElement = elm;\n      hideFakeCaret();\n      return range;\n    };\n\n    var setElementSelection = function (range, forward) {\n      if (!range) {\n        return null;\n      }\n\n      if (range.collapsed) {\n        if (!isRangeInCaretContainer(range)) {\n          var dir = forward ? 1 : -1;\n          var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n          var beforeNode = caretPosition.getNode(!forward);\n\n          if (isFakeCaretTarget(beforeNode)) {\n            return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n          }\n\n          var afterNode = caretPosition.getNode(forward);\n\n          if (isFakeCaretTarget(afterNode)) {\n            return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n          }\n        }\n\n        return null;\n      }\n\n      var startContainer = range.startContainer;\n      var startOffset = range.startOffset;\n      var endOffset = range.endOffset;\n\n      if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse(startContainer.parentNode)) {\n        startContainer = startContainer.parentNode;\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n\n      if (startContainer.nodeType !== 1) {\n        return null;\n      }\n\n      if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n        var node = startContainer.childNodes[startOffset];\n\n        if (isFakeSelectionTargetElement(node)) {\n          return selectElement(node);\n        }\n      }\n\n      return null;\n    };\n\n    var removeElementSelection = function () {\n      if (selectedElement) {\n        selectedElement.removeAttribute(elementSelectionAttr);\n      }\n\n      descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove$7);\n      selectedElement = null;\n    };\n\n    var destroy = function () {\n      fakeCaret.destroy();\n      selectedElement = null;\n    };\n\n    var hideFakeCaret = function () {\n      fakeCaret.hide();\n    };\n\n    if (Env.ceFalse && !isRtc(editor)) {\n      registerEvents();\n    }\n\n    return {\n      showCaret: showCaret,\n      showBlockCaretContainer: showBlockCaretContainer,\n      hideFakeCaret: hideFakeCaret,\n      destroy: destroy\n    };\n  };\n\n  var Quirks = function (editor) {\n    var each = Tools.each;\n    var BACKSPACE = VK.BACKSPACE,\n        DELETE = VK.DELETE,\n        dom = editor.dom,\n        selection = editor.selection,\n        parser = editor.parser;\n    var isGecko = Env.gecko,\n        isIE = Env.ie,\n        isWebKit = Env.webkit;\n    var mceInternalUrlPrefix = 'data:text/mce-internal,';\n    var mceInternalDataType = isIE ? 'Text' : 'URL';\n\n    var setEditorCommandState = function (cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, state);\n      } catch (ex) {}\n    };\n\n    var isDefaultPrevented = function (e) {\n      return e.isDefaultPrevented();\n    };\n\n    var setMceInternalContent = function (e) {\n      var selectionHtml, internalContent;\n\n      if (e.dataTransfer) {\n        if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n          selection.select(e.target);\n        }\n\n        selectionHtml = editor.selection.getContent();\n\n        if (selectionHtml.length > 0) {\n          internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n          e.dataTransfer.setData(mceInternalDataType, internalContent);\n        }\n      }\n    };\n\n    var getMceInternalContent = function (e) {\n      var internalContent;\n\n      if (e.dataTransfer) {\n        internalContent = e.dataTransfer.getData(mceInternalDataType);\n\n        if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n          internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n          return {\n            id: unescape(internalContent[0]),\n            html: unescape(internalContent[1])\n          };\n        }\n      }\n\n      return null;\n    };\n\n    var insertClipboardContents = function (content, internal) {\n      if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n        editor.execCommand('mceInsertClipboardContent', false, {\n          content: content,\n          internal: internal\n        });\n      } else {\n        editor.execCommand('mceInsertContent', false, content);\n      }\n    };\n\n    var emptyEditorWhenDeleting = function () {\n      var serializeRng = function (rng) {\n        var body = dom.create('body');\n        var contents = rng.cloneContents();\n        body.appendChild(contents);\n        return selection.serializer.serialize(body, {\n          format: 'html'\n        });\n      };\n\n      var allContentsSelected = function (rng) {\n        var selection = serializeRng(rng);\n        var allRng = dom.createRng();\n        allRng.selectNode(editor.getBody());\n        var allSelection = serializeRng(allRng);\n        return selection === allSelection;\n      };\n\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        var isCollapsed, body;\n\n        if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n          isCollapsed = editor.selection.isCollapsed();\n          body = editor.getBody();\n\n          if (isCollapsed && !dom.isEmpty(body)) {\n            return;\n          }\n\n          if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n            return;\n          }\n\n          e.preventDefault();\n          editor.setContent('');\n\n          if (body.firstChild && dom.isBlock(body.firstChild)) {\n            editor.selection.setCursorLocation(body.firstChild, 0);\n          } else {\n            editor.selection.setCursorLocation(body, 0);\n          }\n\n          editor.nodeChanged();\n        }\n      });\n    };\n\n    var selectAll = function () {\n      editor.shortcuts.add('meta+a', null, 'SelectAll');\n    };\n\n    var documentElementEditingFocus = function () {\n      if (!editor.inline) {\n        dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n          var rng;\n\n          if (e.target === editor.getDoc().documentElement) {\n            rng = selection.getRng();\n            editor.getBody().focus();\n\n            if (e.type === 'mousedown') {\n              if (isCaretContainer$2(rng.startContainer)) {\n                return;\n              }\n\n              selection.placeCaretAt(e.clientX, e.clientY);\n            } else {\n              selection.setRng(rng);\n            }\n          }\n        });\n      }\n    };\n\n    var removeHrOnBackspace = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (!editor.getBody().getElementsByTagName('hr').length) {\n            return;\n          }\n\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var node = selection.getNode();\n            var previousSibling = node.previousSibling;\n\n            if (node.nodeName === 'HR') {\n              dom.remove(node);\n              e.preventDefault();\n              return;\n            }\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n              dom.remove(previousSibling);\n              e.preventDefault();\n            }\n          }\n        }\n      });\n    };\n\n    var focusBody = function () {\n      if (!Range.prototype.getClientRects) {\n        editor.on('mousedown', function (e) {\n          if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n            var body_1 = editor.getBody();\n            body_1.blur();\n            Delay.setEditorTimeout(editor, function () {\n              body_1.focus();\n            });\n          }\n        });\n      }\n    };\n\n    var selectControlElements = function () {\n      editor.on('click', function (e) {\n        var target = e.target;\n\n        if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n          e.preventDefault();\n          editor.selection.select(target);\n          editor.nodeChanged();\n        }\n\n        if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n          e.preventDefault();\n          selection.select(target);\n        }\n      });\n    };\n\n    var removeStylesWhenDeletingAcrossBlockElements = function () {\n      var getAttributeApplyFunction = function () {\n        var template = dom.getAttribs(selection.getStart().cloneNode(false));\n        return function () {\n          var target = selection.getStart();\n\n          if (target !== editor.getBody()) {\n            dom.setAttrib(target, 'style', null);\n            each(template, function (attr) {\n              target.setAttributeNode(attr.cloneNode(true));\n            });\n          }\n        };\n      };\n\n      var isSelectionAcrossElements = function () {\n        return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n      };\n\n      editor.on('keypress', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          editor.getDoc().execCommand('delete', false, null);\n          applyAttributes();\n          e.preventDefault();\n          return false;\n        }\n      });\n      dom.bind(editor.getDoc(), 'cut', function (e) {\n        var applyAttributes;\n\n        if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n          applyAttributes = getAttributeApplyFunction();\n          Delay.setEditorTimeout(editor, function () {\n            applyAttributes();\n          });\n        }\n      });\n    };\n\n    var disableBackspaceIntoATable = function () {\n      editor.on('keydown', function (e) {\n        if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n          if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n            var previousSibling = selection.getNode().previousSibling;\n\n            if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n              e.preventDefault();\n              return false;\n            }\n          }\n        }\n      });\n    };\n\n    var removeBlockQuoteOnBackSpace = function () {\n      editor.on('keydown', function (e) {\n        var rng, parent;\n\n        if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n          return;\n        }\n\n        rng = selection.getRng();\n        var container = rng.startContainer;\n        var offset = rng.startOffset;\n        var root = dom.getRoot();\n        parent = container;\n\n        if (!rng.collapsed || offset !== 0) {\n          return;\n        }\n\n        while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n          parent = parent.parentNode;\n        }\n\n        if (parent.tagName === 'BLOCKQUOTE') {\n          editor.formatter.toggle('blockquote', null, parent);\n          rng = dom.createRng();\n          rng.setStart(container, 0);\n          rng.setEnd(container, 0);\n          selection.setRng(rng);\n        }\n      });\n    };\n\n    var setGeckoEditingOptions = function () {\n      var setOpts = function () {\n        setEditorCommandState('StyleWithCSS', false);\n        setEditorCommandState('enableInlineTableEditing', false);\n\n        if (!getObjectResizing(editor)) {\n          setEditorCommandState('enableObjectResizing', false);\n        }\n      };\n\n      if (!isReadOnly$1(editor)) {\n        editor.on('BeforeExecCommand mousedown', setOpts);\n      }\n    };\n\n    var addBrAfterLastLinks = function () {\n      var fixLinks = function () {\n        each(dom.select('a'), function (node) {\n          var parentNode = node.parentNode;\n          var root = dom.getRoot();\n\n          if (parentNode.lastChild === node) {\n            while (parentNode && !dom.isBlock(parentNode)) {\n              if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                return;\n              }\n\n              parentNode = parentNode.parentNode;\n            }\n\n            dom.add(parentNode, 'br', {\n              'data-mce-bogus': 1\n            });\n          }\n        });\n      };\n\n      editor.on('SetContent ExecCommand', function (e) {\n        if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n          fixLinks();\n        }\n      });\n    };\n\n    var setDefaultBlockType = function () {\n      if (getForcedRootBlock(editor)) {\n        editor.on('init', function () {\n          setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n        });\n      }\n    };\n\n    var normalizeSelection = function () {\n      editor.on('keyup focusin mouseup', function (e) {\n        if (!VK.modifierPressed(e)) {\n          selection.normalize();\n        }\n      }, true);\n    };\n\n    var showBrokenImageIcon = function () {\n      editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n    };\n\n    var restoreFocusOnKeyDown = function () {\n      if (!editor.inline) {\n        editor.on('keydown', function () {\n          if (document.activeElement === document.body) {\n            editor.getWin().focus();\n          }\n        });\n      }\n    };\n\n    var bodyHeight = function () {\n      if (!editor.inline) {\n        editor.contentStyles.push('body {min-height: 150px}');\n        editor.on('click', function (e) {\n          var rng;\n\n          if (e.target.nodeName === 'HTML') {\n            if (Env.ie > 11) {\n              editor.getBody().focus();\n              return;\n            }\n\n            rng = editor.selection.getRng();\n            editor.getBody().focus();\n            editor.selection.setRng(rng);\n            editor.selection.normalize();\n            editor.nodeChanged();\n          }\n        });\n      }\n    };\n\n    var blockCmdArrowNavigation = function () {\n      if (Env.mac) {\n        editor.on('keydown', function (e) {\n          if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n            e.preventDefault();\n            var selection_1 = editor.selection.getSel();\n            selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n          }\n        });\n      }\n    };\n\n    var disableAutoUrlDetect = function () {\n      setEditorCommandState('AutoUrlDetect', false);\n    };\n\n    var tapLinksAndImages = function () {\n      editor.on('click', function (e) {\n        var elm = e.target;\n\n        do {\n          if (elm.tagName === 'A') {\n            e.preventDefault();\n            return;\n          }\n        } while (elm = elm.parentNode);\n      });\n      editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n    };\n\n    var blockFormSubmitInsideEditor = function () {\n      editor.on('init', function () {\n        editor.dom.bind(editor.getBody(), 'submit', function (e) {\n          e.preventDefault();\n        });\n      });\n    };\n\n    var removeAppleInterchangeBrs = function () {\n      parser.addNodeFilter('br', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n            nodes[i].remove();\n          }\n        }\n      });\n    };\n\n    var ieInternalDragAndDrop = function () {\n      editor.on('dragstart', function (e) {\n        setMceInternalContent(e);\n      });\n      editor.on('drop', function (e) {\n        if (!isDefaultPrevented(e)) {\n          var internalContent = getMceInternalContent(e);\n\n          if (internalContent && internalContent.id !== editor.id) {\n            e.preventDefault();\n            var rng = fromPoint(e.x, e.y, editor.getDoc());\n            selection.setRng(rng);\n            insertClipboardContents(internalContent.html, true);\n          }\n        }\n      });\n    };\n\n    var refreshContentEditable = noop;\n\n    var isHidden = function () {\n      if (!isGecko || editor.removed) {\n        return false;\n      }\n\n      var sel = editor.selection.getSel();\n      return !sel || !sel.rangeCount || sel.rangeCount === 0;\n    };\n\n    var setupRtc = function () {\n      if (isWebKit) {\n        documentElementEditingFocus();\n        selectControlElements();\n        blockFormSubmitInsideEditor();\n        selectAll();\n\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        }\n      }\n\n      if (isGecko) {\n        focusBody();\n        setGeckoEditingOptions();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n      }\n    };\n\n    var setup = function () {\n      removeBlockQuoteOnBackSpace();\n      emptyEditorWhenDeleting();\n\n      if (!Env.windowsPhone) {\n        normalizeSelection();\n      }\n\n      if (isWebKit) {\n        documentElementEditingFocus();\n        selectControlElements();\n        setDefaultBlockType();\n        blockFormSubmitInsideEditor();\n        disableBackspaceIntoATable();\n        removeAppleInterchangeBrs();\n\n        if (Env.iOS) {\n          restoreFocusOnKeyDown();\n          bodyHeight();\n          tapLinksAndImages();\n        } else {\n          selectAll();\n        }\n      }\n\n      if (Env.ie >= 11) {\n        bodyHeight();\n        disableBackspaceIntoATable();\n      }\n\n      if (Env.ie) {\n        selectAll();\n        disableAutoUrlDetect();\n        ieInternalDragAndDrop();\n      }\n\n      if (isGecko) {\n        removeHrOnBackspace();\n        focusBody();\n        removeStylesWhenDeletingAcrossBlockElements();\n        setGeckoEditingOptions();\n        addBrAfterLastLinks();\n        showBrokenImageIcon();\n        blockCmdArrowNavigation();\n        disableBackspaceIntoATable();\n      }\n    };\n\n    if (isRtc(editor)) {\n      setupRtc();\n    } else {\n      setup();\n    }\n\n    return {\n      refreshContentEditable: refreshContentEditable,\n      isHidden: isHidden\n    };\n  };\n\n  var DOM$6 = DOMUtils.DOM;\n\n  var appendStyle = function (editor, text) {\n    var body = SugarElement.fromDom(editor.getBody());\n    var container = getStyleContainer(getRootNode(body));\n    var style = SugarElement.fromTag('style');\n    set$1(style, 'type', 'text/css');\n    append$1(style, SugarElement.fromText(text));\n    append$1(container, style);\n    editor.on('remove', function () {\n      remove$7(style);\n    });\n  };\n\n  var getRootName = function (editor) {\n    return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n  };\n\n  var removeUndefined = function (obj) {\n    return filter$3(obj, function (v) {\n      return isUndefined(v) === false;\n    });\n  };\n\n  var mkParserSettings = function (editor) {\n    var settings = editor.settings;\n    var blobCache = editor.editorUpload.blobCache;\n    return removeUndefined({\n      allow_conditional_comments: settings.allow_conditional_comments,\n      allow_html_data_urls: settings.allow_html_data_urls,\n      allow_svg_data_urls: settings.allow_svg_data_urls,\n      allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n      allow_script_urls: settings.allow_script_urls,\n      allow_unsafe_link_target: settings.allow_unsafe_link_target,\n      convert_fonts_to_spans: settings.convert_fonts_to_spans,\n      fix_list_elements: settings.fix_list_elements,\n      font_size_legacy_values: settings.font_size_legacy_values,\n      forced_root_block: settings.forced_root_block,\n      forced_root_block_attrs: settings.forced_root_block_attrs,\n      padd_empty_with_br: settings.padd_empty_with_br,\n      preserve_cdata: settings.preserve_cdata,\n      remove_trailing_brs: settings.remove_trailing_brs,\n      inline_styles: settings.inline_styles,\n      root_name: getRootName(editor),\n      validate: true,\n      blob_cache: blobCache,\n      document: editor.getDoc(),\n      images_dataimg_filter: settings.images_dataimg_filter\n    });\n  };\n\n  var mkSerializerSettings = function (editor) {\n    var settings = editor.settings;\n    return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n      url_converter: settings.url_converter,\n      url_converter_scope: settings.url_converter_scope,\n      element_format: settings.element_format,\n      entities: settings.entities,\n      entity_encoding: settings.entity_encoding,\n      indent: settings.indent,\n      indent_after: settings.indent_after,\n      indent_before: settings.indent_before,\n      block_elements: settings.block_elements,\n      boolean_attributes: settings.boolean_attributes,\n      custom_elements: settings.custom_elements,\n      extended_valid_elements: settings.extended_valid_elements,\n      invalid_elements: settings.invalid_elements,\n      invalid_styles: settings.invalid_styles,\n      move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n      non_empty_elements: settings.non_empty_elements,\n      schema: settings.schema,\n      self_closing_elements: settings.self_closing_elements,\n      short_ended_elements: settings.short_ended_elements,\n      special: settings.special,\n      text_block_elements: settings.text_block_elements,\n      text_inline_elements: settings.text_inline_elements,\n      valid_children: settings.valid_children,\n      valid_classes: settings.valid_classes,\n      valid_elements: settings.valid_elements,\n      valid_styles: settings.valid_styles,\n      verify_html: settings.verify_html,\n      whitespace_elements: settings.whitespace_elements\n    }));\n  };\n\n  var createParser = function (editor) {\n    var parser = DomParser(mkParserSettings(editor), editor.schema);\n    parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n      var i = nodes.length,\n          node,\n          value;\n      var dom = editor.dom;\n      var internalName = 'data-mce-' + name;\n\n      while (i--) {\n        node = nodes[i];\n        value = node.attr(name);\n\n        if (value && !node.attr(internalName)) {\n          if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n            continue;\n          }\n\n          if (name === 'style') {\n            value = dom.serializeStyle(dom.parseStyle(value), node.name);\n\n            if (!value.length) {\n              value = null;\n            }\n\n            node.attr(internalName, value);\n            node.attr(name, value);\n          } else if (name === 'tabindex') {\n            node.attr(internalName, value);\n            node.attr(name, null);\n          } else {\n            node.attr(internalName, editor.convertURL(value, name, node.name));\n          }\n        }\n      }\n    });\n    parser.addNodeFilter('script', function (nodes) {\n      var i = nodes.length;\n\n      while (i--) {\n        var node = nodes[i];\n        var type = node.attr('type') || 'no/type';\n\n        if (type.indexOf('mce-') !== 0) {\n          node.attr('type', 'mce-' + type);\n        }\n      }\n    });\n\n    if (editor.settings.preserve_cdata) {\n      parser.addNodeFilter('#cdata', function (nodes) {\n        var i = nodes.length;\n\n        while (i--) {\n          var node = nodes[i];\n          node.type = 8;\n          node.name = '#comment';\n          node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n        }\n      });\n    }\n\n    parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n      var i = nodes.length;\n      var nonEmptyElements = editor.schema.getNonEmptyElements();\n\n      while (i--) {\n        var node = nodes[i];\n\n        if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n          node.append(new AstNode('br', 1)).shortEnded = true;\n        }\n      }\n    });\n    return parser;\n  };\n\n  var autoFocus = function (editor) {\n    if (editor.settings.auto_focus) {\n      Delay.setEditorTimeout(editor, function () {\n        var focusEditor;\n\n        if (editor.settings.auto_focus === true) {\n          focusEditor = editor;\n        } else {\n          focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n        }\n\n        if (!focusEditor.destroyed) {\n          focusEditor.focus();\n        }\n      }, 100);\n    }\n  };\n\n  var moveSelectionToFirstCaretPosition = function (editor) {\n    var root = editor.dom.getRoot();\n\n    if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n      firstPositionIn(root).each(function (pos) {\n        var node = pos.getNode();\n        var caretPos = isTable$3(node) ? firstPositionIn(node).getOr(pos) : pos;\n\n        if (Env.browser.isIE()) {\n          storeNative(editor, caretPos.toRange());\n        } else {\n          editor.selection.setRng(caretPos.toRange());\n        }\n      });\n    }\n  };\n\n  var initEditor = function (editor) {\n    editor.bindPendingEventDelegates();\n    editor.initialized = true;\n    fireInit(editor);\n    editor.focus(true);\n    moveSelectionToFirstCaretPosition(editor);\n    editor.nodeChanged({\n      initial: true\n    });\n    editor.execCallback('init_instance_callback', editor);\n    autoFocus(editor);\n  };\n\n  var getStyleSheetLoader$1 = function (editor) {\n    return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n  };\n\n  var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n    var promises = [new promiseObj(function (resolve, reject) {\n      return getStyleSheetLoader$1(editor).loadAll(css, resolve, reject);\n    })];\n\n    if (editor.inline) {\n      return promises;\n    } else {\n      return promises.concat([new promiseObj(function (resolve, reject) {\n        return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n      })]);\n    }\n  };\n\n  var loadContentCss = function (editor) {\n    var styleSheetLoader = getStyleSheetLoader$1(editor);\n    var fontCss = getFontCss(editor);\n    var css = editor.contentCSS;\n\n    var removeCss = function () {\n      styleSheetLoader.unloadAll(css);\n\n      if (!editor.inline) {\n        editor.ui.styleSheetLoader.unloadAll(fontCss);\n      }\n    };\n\n    var loaded = function () {\n      if (editor.removed) {\n        removeCss();\n      } else {\n        editor.on('remove', removeCss);\n      }\n    };\n\n    if (editor.contentStyles.length > 0) {\n      var contentCssText_1 = '';\n      Tools.each(editor.contentStyles, function (style) {\n        contentCssText_1 += style + '\\r\\n';\n      });\n      editor.dom.addStyle(contentCssText_1);\n    }\n\n    var allStylesheets = promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n\n    if (editor.settings.content_style) {\n      appendStyle(editor, editor.settings.content_style);\n    }\n\n    return allStylesheets;\n  };\n\n  var preInit = function (editor) {\n    var settings = editor.settings,\n        doc = editor.getDoc(),\n        body = editor.getBody();\n    firePreInit(editor);\n\n    if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n      doc.body.spellcheck = false;\n      DOM$6.setAttrib(body, 'spellcheck', 'false');\n    }\n\n    editor.quirks = Quirks(editor);\n    firePostRender(editor);\n    var directionality = getDirectionality(editor);\n\n    if (directionality !== undefined) {\n      body.dir = directionality;\n    }\n\n    if (settings.protect) {\n      editor.on('BeforeSetContent', function (e) {\n        Tools.each(settings.protect, function (pattern) {\n          e.content = e.content.replace(pattern, function (str) {\n            return '<!--mce:protected ' + escape(str) + '-->';\n          });\n        });\n      });\n    }\n\n    editor.on('SetContent', function () {\n      editor.addVisual(editor.getBody());\n    });\n    editor.on('compositionstart compositionend', function (e) {\n      editor.composing = e.type === 'compositionstart';\n    });\n  };\n\n  var loadInitialContent = function (editor) {\n    if (!isRtc(editor)) {\n      editor.load({\n        initial: true,\n        format: 'html'\n      });\n    }\n\n    editor.startContent = editor.getContent({\n      format: 'raw'\n    });\n  };\n\n  var initEditorWithInitialContent = function (editor) {\n    if (editor.removed !== true) {\n      loadInitialContent(editor);\n      initEditor(editor);\n    }\n  };\n\n  var initContentBody = function (editor, skipWrite) {\n    var settings = editor.settings;\n    var targetElm = editor.getElement();\n    var doc = editor.getDoc();\n\n    if (!settings.inline) {\n      editor.getElement().style.visibility = editor.orgVisibility;\n    }\n\n    if (!skipWrite && !editor.inline) {\n      doc.open();\n      doc.write(editor.iframeHTML);\n      doc.close();\n    }\n\n    if (editor.inline) {\n      DOM$6.addClass(targetElm, 'mce-content-body');\n      editor.contentDocument = doc = document;\n      editor.contentWindow = window;\n      editor.bodyElement = targetElm;\n      editor.contentAreaContainer = targetElm;\n    }\n\n    var body = editor.getBody();\n    body.disabled = true;\n    editor.readonly = !!settings.readonly;\n\n    if (!editor.readonly) {\n      if (editor.inline && DOM$6.getStyle(body, 'position', true) === 'static') {\n        body.style.position = 'relative';\n      }\n\n      body.contentEditable = editor.getParam('content_editable_state', true);\n    }\n\n    body.disabled = false;\n    editor.editorUpload = EditorUpload(editor);\n    editor.schema = Schema(settings);\n    editor.dom = DOMUtils(doc, {\n      keep_values: true,\n      url_converter: editor.convertURL,\n      url_converter_scope: editor,\n      hex_colors: settings.force_hex_style_colors,\n      update_styles: true,\n      root_element: editor.inline ? editor.getBody() : null,\n      collect: function () {\n        return editor.inline;\n      },\n      schema: editor.schema,\n      contentCssCors: shouldUseContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor),\n      onSetAttrib: function (e) {\n        editor.fire('SetAttrib', e);\n      }\n    });\n    editor.parser = createParser(editor);\n    editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n    editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n    editor.annotator = Annotator(editor);\n    editor.formatter = Formatter(editor);\n    editor.undoManager = UndoManager(editor);\n    editor._nodeChangeDispatcher = new NodeChange(editor);\n    editor._selectionOverrides = SelectionOverrides(editor);\n    setup$e(editor);\n    setup$3(editor);\n\n    if (!isRtc(editor)) {\n      setup$2(editor);\n    }\n\n    var caret = setup$4(editor);\n    setup$f(editor, caret);\n    setup$d(editor);\n    setup$g(editor);\n    var setupRtcThunk = setup$i(editor);\n    preInit(editor);\n    setupRtcThunk.fold(function () {\n      loadContentCss(editor).then(function () {\n        return initEditorWithInitialContent(editor);\n      });\n    }, function (setupRtc) {\n      editor.setProgressState(true);\n      loadContentCss(editor).then(function () {\n        setupRtc().then(function (_rtcMode) {\n          editor.setProgressState(false);\n          initEditorWithInitialContent(editor);\n        }, function (err) {\n          editor.notificationManager.open({\n            type: 'error',\n            text: String(err)\n          });\n          initEditorWithInitialContent(editor);\n        });\n      });\n    });\n  };\n\n  var DOM$5 = DOMUtils.DOM;\n\n  var relaxDomain = function (editor, ifr) {\n    if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n      var bodyUuid = uuid('mce');\n\n      editor[bodyUuid] = function () {\n        initContentBody(editor);\n      };\n\n      var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n      DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n      return true;\n    }\n\n    return false;\n  };\n\n  var createIframeElement = function (id, title, height, customAttrs) {\n    var iframe = SugarElement.fromTag('iframe');\n    setAll$1(iframe, customAttrs);\n    setAll$1(iframe, {\n      id: id + '_ifr',\n      frameBorder: '0',\n      allowTransparency: 'true',\n      title: title\n    });\n    add$1(iframe, 'tox-edit-area__iframe');\n    return iframe;\n  };\n\n  var getIframeHtml = function (editor) {\n    var iframeHTML = getDocType(editor) + '<html><head>';\n\n    if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n      iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n    }\n\n    iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n    var bodyId = getBodyId(editor);\n    var bodyClass = getBodyClass(editor);\n    var translatedAriaText = editor.translate(getIframeAriaText(editor));\n\n    if (getContentSecurityPolicy(editor)) {\n      iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n    }\n\n    iframeHTML += '</head>' + ('<body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\" aria-label=\"' + translatedAriaText + '\">') + '<br>' + '</body></html>';\n    return iframeHTML;\n  };\n\n  var createIframe = function (editor, o) {\n    var iframeTitle = editor.translate('Rich Text Area');\n    var ifr = createIframeElement(editor.id, iframeTitle, o.height, getIframeAttrs(editor)).dom;\n\n    ifr.onload = function () {\n      ifr.onload = null;\n      editor.fire('load');\n    };\n\n    var isDomainRelaxed = relaxDomain(editor, ifr);\n    editor.contentAreaContainer = o.iframeContainer;\n    editor.iframeElement = ifr;\n    editor.iframeHTML = getIframeHtml(editor);\n    DOM$5.add(o.iframeContainer, ifr);\n    return isDomainRelaxed;\n  };\n\n  var init$1 = function (editor, boxInfo) {\n    var isDomainRelaxed = createIframe(editor, boxInfo);\n\n    if (boxInfo.editorContainer) {\n      DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n      editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n    }\n\n    editor.getElement().style.display = 'none';\n    DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n\n    if (!isDomainRelaxed) {\n      initContentBody(editor);\n    }\n  };\n\n  var DOM$4 = DOMUtils.DOM;\n\n  var initPlugin = function (editor, initializedPlugins, plugin) {\n    var Plugin = PluginManager.get(plugin);\n    var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n    plugin = Tools.trim(plugin);\n\n    if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n      Tools.each(PluginManager.dependencies(plugin), function (dep) {\n        initPlugin(editor, initializedPlugins, dep);\n      });\n\n      if (editor.plugins[plugin]) {\n        return;\n      }\n\n      try {\n        var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n        editor.plugins[plugin] = pluginInstance;\n\n        if (pluginInstance.init) {\n          pluginInstance.init(editor, pluginUrl);\n          initializedPlugins.push(plugin);\n        }\n      } catch (e) {\n        pluginInitError(editor, plugin, e);\n      }\n    }\n  };\n\n  var trimLegacyPrefix = function (name) {\n    return name.replace(/^\\-/, '');\n  };\n\n  var initPlugins = function (editor) {\n    var initializedPlugins = [];\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n      initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n    });\n  };\n\n  var initIcons = function (editor) {\n    var iconPackName = Tools.trim(getIconPackName(editor));\n    var currentIcons = editor.ui.registry.getAll().icons;\n\n    var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n\n    each$j(loadIcons, function (svgData, icon) {\n      if (!has$2(currentIcons, icon)) {\n        editor.ui.registry.addIcon(icon, svgData);\n      }\n    });\n  };\n\n  var initTheme = function (editor) {\n    var theme = getTheme(editor);\n\n    if (isString$1(theme)) {\n      editor.settings.theme = trimLegacyPrefix(theme);\n      var Theme = ThemeManager.get(theme);\n      editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n\n      if (editor.theme.init) {\n        editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n      }\n    } else {\n      editor.theme = {};\n    }\n  };\n\n  var renderFromLoadedTheme = function (editor) {\n    return editor.theme.renderUI();\n  };\n\n  var renderFromThemeFunc = function (editor) {\n    var elm = editor.getElement();\n    var theme = getTheme(editor);\n    var info = theme(editor, elm);\n\n    if (info.editorContainer.nodeType) {\n      info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n    }\n\n    if (info.iframeContainer && info.iframeContainer.nodeType) {\n      info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n    }\n\n    info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n    return info;\n  };\n\n  var createThemeFalseResult = function (element) {\n    return {\n      editorContainer: element,\n      iframeContainer: element,\n      api: {}\n    };\n  };\n\n  var renderThemeFalseIframe = function (targetElement) {\n    var iframeContainer = DOM$4.create('div');\n    DOM$4.insertAfter(iframeContainer, targetElement);\n    return createThemeFalseResult(iframeContainer);\n  };\n\n  var renderThemeFalse = function (editor) {\n    var targetElement = editor.getElement();\n    return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n  };\n\n  var renderThemeUi = function (editor) {\n    var elm = editor.getElement();\n    editor.orgDisplay = elm.style.display;\n\n    if (isString$1(getTheme(editor))) {\n      return renderFromLoadedTheme(editor);\n    } else if (isFunction(getTheme(editor))) {\n      return renderFromThemeFunc(editor);\n    } else {\n      return renderThemeFalse(editor);\n    }\n  };\n\n  var augmentEditorUiApi = function (editor, api) {\n    var uiApiFacade = {\n      show: Optional.from(api.show).getOr(noop),\n      hide: Optional.from(api.hide).getOr(noop),\n      disable: Optional.from(api.disable).getOr(noop),\n      isDisabled: Optional.from(api.isDisabled).getOr(never),\n      enable: function () {\n        if (!editor.mode.isReadOnly()) {\n          Optional.from(api.enable).map(call);\n        }\n      }\n    };\n    editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n  };\n\n  var init = function (editor) {\n    editor.fire('ScriptsLoaded');\n    initIcons(editor);\n    initTheme(editor);\n    initPlugins(editor);\n    var renderInfo = renderThemeUi(editor);\n    augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n    var boxInfo = {\n      editorContainer: renderInfo.editorContainer,\n      iframeContainer: renderInfo.iframeContainer\n    };\n    editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n    appendContentCssFromSettings(editor);\n\n    if (editor.inline) {\n      return initContentBody(editor);\n    } else {\n      return init$1(editor, boxInfo);\n    }\n  };\n\n  var DOM$3 = DOMUtils.DOM;\n\n  var hasSkipLoadPrefix = function (name) {\n    return name.charAt(0) === '-';\n  };\n\n  var loadLanguage = function (scriptLoader, editor) {\n    var languageCode = getLanguageCode(editor);\n    var languageUrl = getLanguageUrl(editor);\n\n    if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n      var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n      scriptLoader.add(url_1, noop, undefined, function () {\n        languageLoadError(editor, url_1, languageCode);\n      });\n    }\n  };\n\n  var loadTheme = function (scriptLoader, editor, suffix, callback) {\n    var theme = getTheme(editor);\n\n    if (isString$1(theme)) {\n      if (!hasSkipLoadPrefix(theme) && !has$2(ThemeManager.urls, theme)) {\n        var themeUrl = getThemeUrl(editor);\n\n        if (themeUrl) {\n          ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n        } else {\n          ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n        }\n      }\n\n      scriptLoader.loadQueue(function () {\n        ThemeManager.waitFor(theme, callback);\n      });\n    } else {\n      callback();\n    }\n  };\n\n  var getIconsUrlMetaFromUrl = function (editor) {\n    return Optional.from(getIconsUrl(editor)).filter(function (url) {\n      return url.length > 0;\n    }).map(function (url) {\n      return {\n        url: url,\n        name: Optional.none()\n      };\n    });\n  };\n\n  var getIconsUrlMetaFromName = function (editor, name, suffix) {\n    return Optional.from(name).filter(function (name) {\n      return name.length > 0 && !IconManager.has(name);\n    }).map(function (name) {\n      return {\n        url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n        name: Optional.some(name)\n      };\n    });\n  };\n\n  var loadIcons = function (scriptLoader, editor, suffix) {\n    var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n    var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n      return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n    });\n    each$k(cat([defaultIconsUrl, customIconsUrl]), function (urlMeta) {\n      scriptLoader.add(urlMeta.url, noop, undefined, function () {\n        iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n      });\n    });\n  };\n\n  var loadPlugins = function (editor, suffix) {\n    Tools.each(getExternalPlugins$1(editor), function (url, name) {\n      PluginManager.load(name, url, noop, undefined, function () {\n        pluginLoadError(editor, url, name);\n      });\n      editor.settings.plugins += ' ' + name;\n    });\n    Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n      plugin = Tools.trim(plugin);\n\n      if (plugin && !PluginManager.urls[plugin]) {\n        if (hasSkipLoadPrefix(plugin)) {\n          plugin = plugin.substr(1, plugin.length);\n          var dependencies = PluginManager.dependencies(plugin);\n          Tools.each(dependencies, function (depPlugin) {\n            var defaultSettings = {\n              prefix: 'plugins/',\n              resource: depPlugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n            PluginManager.load(dep.resource, dep, noop, undefined, function () {\n              pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n            });\n          });\n        } else {\n          var url_2 = {\n            prefix: 'plugins/',\n            resource: plugin,\n            suffix: '/plugin' + suffix + '.js'\n          };\n          PluginManager.load(plugin, url_2, noop, undefined, function () {\n            pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n          });\n        }\n      }\n    });\n  };\n\n  var loadScripts = function (editor, suffix) {\n    var scriptLoader = ScriptLoader.ScriptLoader;\n    loadTheme(scriptLoader, editor, suffix, function () {\n      loadLanguage(scriptLoader, editor);\n      loadIcons(scriptLoader, editor, suffix);\n      loadPlugins(editor, suffix);\n      scriptLoader.loadQueue(function () {\n        if (!editor.removed) {\n          init(editor);\n        }\n      }, editor, function () {\n        if (!editor.removed) {\n          init(editor);\n        }\n      });\n    });\n  };\n\n  var getStyleSheetLoader = function (element, editor) {\n    return instance.forElement(element, {\n      contentCssCors: hasContentCssCors(editor),\n      referrerPolicy: getReferrerPolicy(editor)\n    });\n  };\n\n  var render = function (editor) {\n    var id = editor.id;\n    I18n.setCode(getLanguageCode(editor));\n\n    var readyHandler = function () {\n      DOM$3.unbind(window, 'ready', readyHandler);\n      editor.render();\n    };\n\n    if (!EventUtils.Event.domLoaded) {\n      DOM$3.bind(window, 'ready', readyHandler);\n      return;\n    }\n\n    if (!editor.getElement()) {\n      return;\n    }\n\n    if (!Env.contentEditable) {\n      return;\n    }\n\n    var element = SugarElement.fromDom(editor.getElement());\n    var snapshot = clone$3(element);\n    editor.on('remove', function () {\n      eachr(element.dom.attributes, function (attr) {\n        return remove$6(element, attr.name);\n      });\n      setAll$1(element, snapshot);\n    });\n    editor.ui.styleSheetLoader = getStyleSheetLoader(element, editor);\n\n    if (!isInline(editor)) {\n      editor.orgVisibility = editor.getElement().style.visibility;\n      editor.getElement().style.visibility = 'hidden';\n    } else {\n      editor.inline = true;\n    }\n\n    var form = editor.getElement().form || DOM$3.getParent(id, 'form');\n\n    if (form) {\n      editor.formElement = form;\n\n      if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n        DOM$3.insertAfter(DOM$3.create('input', {\n          type: 'hidden',\n          name: id\n        }), id);\n        editor.hasHiddenInput = true;\n      }\n\n      editor.formEventDelegate = function (e) {\n        editor.fire(e.type, e);\n      };\n\n      DOM$3.bind(form, 'submit reset', editor.formEventDelegate);\n      editor.on('reset', function () {\n        editor.resetContent();\n      });\n\n      if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n        form._mceOldSubmit = form.submit;\n\n        form.submit = function () {\n          editor.editorManager.triggerSave();\n          editor.setDirty(false);\n          return form._mceOldSubmit(form);\n        };\n      }\n    }\n\n    editor.windowManager = WindowManager(editor);\n    editor.notificationManager = NotificationManager(editor);\n\n    if (isEncodingXml(editor)) {\n      editor.on('GetContent', function (e) {\n        if (e.save) {\n          e.content = DOM$3.encode(e.content);\n        }\n      });\n    }\n\n    if (shouldAddFormSubmitTrigger(editor)) {\n      editor.on('submit', function () {\n        if (editor.initialized) {\n          editor.save();\n        }\n      });\n    }\n\n    if (shouldAddUnloadTrigger(editor)) {\n      editor._beforeUnload = function () {\n        if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n          editor.save({\n            format: 'raw',\n            no_events: true,\n            set_dirty: false\n          });\n        }\n      };\n\n      editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n    }\n\n    editor.editorManager.add(editor);\n    loadScripts(editor, editor.suffix);\n  };\n\n  var addVisual = function (editor, elm) {\n    return addVisual$1(editor, elm);\n  };\n\n  var legacyPropNames = {\n    'font-size': 'size',\n    'font-family': 'face'\n  };\n\n  var getSpecifiedFontProp = function (propName, rootElm, elm) {\n    var getProperty = function (elm) {\n      return getRaw(elm, propName).orThunk(function () {\n        if (name(elm) === 'font') {\n          return get$9(legacyPropNames, propName).bind(function (legacyPropName) {\n            return getOpt(elm, legacyPropName);\n          });\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n\n    var isRoot = function (elm) {\n      return eq(SugarElement.fromDom(rootElm), elm);\n    };\n\n    return closest$1(SugarElement.fromDom(elm), function (elm) {\n      return getProperty(elm);\n    }, isRoot);\n  };\n\n  var normalizeFontFamily = function (fontFamily) {\n    return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n  };\n\n  var getComputedFontProp = function (propName, elm) {\n    return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n  };\n\n  var getFontProp = function (propName) {\n    return function (rootElm, elm) {\n      return Optional.from(elm).map(SugarElement.fromDom).filter(isElement$6).bind(function (element) {\n        return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n      }).getOr('');\n    };\n  };\n\n  var getFontSize = getFontProp('font-size');\n  var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n  var findFirstCaretElement = function (editor) {\n    return firstPositionIn(editor.getBody()).map(function (caret) {\n      var container = caret.container();\n      return isText$7(container) ? container.parentNode : container;\n    });\n  };\n\n  var getCaretElement = function (editor) {\n    return Optional.from(editor.selection.getRng()).bind(function (rng) {\n      var root = editor.getBody();\n      var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n      return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n    });\n  };\n\n  var bindRange = function (editor, binder) {\n    return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement$6).bind(binder);\n  };\n\n  var mapRange = function (editor, mapper) {\n    return bindRange(editor, compose1(Optional.some, mapper));\n  };\n\n  var fromFontSizeNumber = function (editor, value) {\n    if (/^[0-9.]+$/.test(value)) {\n      var fontSizeNumber = parseInt(value, 10);\n\n      if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n        var fontSizes = getFontStyleValues(editor);\n        var fontClasses = getFontSizeClasses(editor);\n\n        if (fontClasses) {\n          return fontClasses[fontSizeNumber - 1] || value;\n        } else {\n          return fontSizes[fontSizeNumber - 1] || value;\n        }\n      } else {\n        return value;\n      }\n    } else {\n      return value;\n    }\n  };\n\n  var normalizeFontNames = function (font) {\n    var fonts = font.split(/\\s*,\\s*/);\n    return map$3(fonts, function (font) {\n      if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n        return '\\'' + font + '\\'';\n      } else {\n        return font;\n      }\n    }).join(',');\n  };\n\n  var fontNameAction = function (editor, value) {\n    var font = fromFontSizeNumber(editor, value);\n    editor.formatter.toggle('fontname', {\n      value: normalizeFontNames(font)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontNameQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontFamily(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var fontSizeAction = function (editor, value) {\n    editor.formatter.toggle('fontsize', {\n      value: fromFontSizeNumber(editor, value)\n    });\n    editor.nodeChanged();\n  };\n\n  var fontSizeQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      return getFontSize(editor.getBody(), elm.dom);\n    }).getOr('');\n  };\n\n  var lineHeightQuery = function (editor) {\n    return mapRange(editor, function (elm) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var specifiedStyle = closest$1(elm, function (elm) {\n        return getRaw(elm, 'line-height');\n      }, curry(eq, root));\n\n      var computedStyle = function () {\n        var lineHeight = parseFloat(get$5(elm, 'line-height'));\n        var fontSize = parseFloat(get$5(elm, 'font-size'));\n        return String(lineHeight / fontSize);\n      };\n\n      return specifiedStyle.getOrThunk(computedStyle);\n    }).getOr('');\n  };\n\n  var lineHeightAction = function (editor, lineHeight) {\n    editor.formatter.toggle('lineheight', {\n      value: String(lineHeight)\n    });\n    editor.nodeChanged();\n  };\n\n  var processValue = function (value) {\n    if (typeof value !== 'string') {\n      var details = Tools.extend({\n        paste: value.paste,\n        data: {\n          paste: value.paste\n        }\n      }, value);\n      return {\n        content: value.content,\n        details: details\n      };\n    }\n\n    return {\n      content: value,\n      details: {}\n    };\n  };\n\n  var insertAtCaret = function (editor, value) {\n    var result = processValue(value);\n    insertContent(editor, result.content, result.details);\n  };\n\n  var each$4 = Tools.each;\n  var map = Tools.map,\n      inArray = Tools.inArray;\n\n  var EditorCommands = function () {\n    function EditorCommands(editor) {\n      this.commands = {\n        state: {},\n        exec: {},\n        value: {}\n      };\n      this.editor = editor;\n      this.setupCommands(editor);\n    }\n\n    EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n      var func,\n          state = false;\n      var self = this;\n\n      if (self.editor.removed) {\n        return;\n      }\n\n      if (command.toLowerCase() !== 'mcefocus') {\n        if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n          self.editor.focus();\n        } else {\n          restore(self.editor);\n        }\n      }\n\n      args = self.editor.fire('BeforeExecCommand', {\n        command: command,\n        ui: ui,\n        value: value\n      });\n\n      if (args.isDefaultPrevented()) {\n        return false;\n      }\n\n      var customCommand = command.toLowerCase();\n\n      if (func = self.commands.exec[customCommand]) {\n        func(customCommand, ui, value);\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      each$4(this.editor.plugins, function (p) {\n        if (p.execCommand && p.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          state = true;\n          return false;\n        }\n      });\n\n      if (state) {\n        return state;\n      }\n\n      if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      try {\n        state = self.editor.getDoc().execCommand(command, ui, value);\n      } catch (ex) {}\n\n      if (state) {\n        self.editor.fire('ExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        return true;\n      }\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandState = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.state[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandState(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.queryCommandValue = function (command) {\n      var func;\n\n      if (this.editor.quirks.isHidden() || this.editor.removed) {\n        return;\n      }\n\n      command = command.toLowerCase();\n\n      if (func = this.commands.value[command]) {\n        return func(command);\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandValue(command);\n      } catch (ex) {}\n    };\n\n    EditorCommands.prototype.addCommands = function (commandList, type) {\n      if (type === void 0) {\n        type = 'exec';\n      }\n\n      var self = this;\n      each$4(commandList, function (callback, command) {\n        each$4(command.toLowerCase().split(','), function (command) {\n          self.commands[type][command] = callback;\n        });\n      });\n    };\n\n    EditorCommands.prototype.addCommand = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.exec[command] = function (command, ui, value, args) {\n        return callback.call(scope || _this.editor, ui, value, args);\n      };\n    };\n\n    EditorCommands.prototype.queryCommandSupported = function (command) {\n      command = command.toLowerCase();\n\n      if (this.commands.exec[command]) {\n        return true;\n      }\n\n      try {\n        return this.editor.getDoc().queryCommandSupported(command);\n      } catch (ex) {}\n\n      return false;\n    };\n\n    EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.state[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n      var _this = this;\n\n      command = command.toLowerCase();\n\n      this.commands.value[command] = function () {\n        return callback.call(scope || _this.editor);\n      };\n    };\n\n    EditorCommands.prototype.hasCustomCommand = function (command) {\n      command = command.toLowerCase();\n      return !!this.commands.exec[command];\n    };\n\n    EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n      if (ui === undefined) {\n        ui = false;\n      }\n\n      if (value === undefined) {\n        value = null;\n      }\n\n      return this.editor.getDoc().execCommand(command, ui, value);\n    };\n\n    EditorCommands.prototype.isFormatMatch = function (name) {\n      return this.editor.formatter.match(name);\n    };\n\n    EditorCommands.prototype.toggleFormat = function (name, value) {\n      this.editor.formatter.toggle(name, value);\n      this.editor.nodeChanged();\n    };\n\n    EditorCommands.prototype.storeSelection = function (type) {\n      this.selectionBookmark = this.editor.selection.getBookmark(type);\n    };\n\n    EditorCommands.prototype.restoreSelection = function () {\n      this.editor.selection.moveToBookmark(this.selectionBookmark);\n    };\n\n    EditorCommands.prototype.setupCommands = function (editor) {\n      var self = this;\n      this.addCommands({\n        'mceResetDesignMode,mceBeginUndoLevel': noop,\n        'mceEndUndoLevel,mceAddUndoLevel': function () {\n          editor.undoManager.add();\n        },\n        'mceFocus': function (_command, _ui, value) {\n          focus(editor, value);\n        },\n        'Cut,Copy,Paste': function (command) {\n          var doc = editor.getDoc();\n          var failed;\n\n          try {\n            self.execNativeCommand(command);\n          } catch (ex) {\n            failed = true;\n          }\n\n          if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n            failed = true;\n          }\n\n          if (failed || !doc.queryCommandSupported(command)) {\n            var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n\n            if (Env.mac) {\n              msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n            }\n\n            editor.notificationManager.open({\n              text: msg,\n              type: 'error'\n            });\n          }\n        },\n        'unlink': function () {\n          if (editor.selection.isCollapsed()) {\n            var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n\n            if (elm) {\n              editor.dom.remove(elm, true);\n            }\n\n            return;\n          }\n\n          editor.formatter.remove('link');\n        },\n        'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n          var align = command.substring(7);\n\n          if (align === 'full') {\n            align = 'justify';\n          }\n\n          each$4('left,center,right,justify'.split(','), function (name) {\n            if (align !== name) {\n              editor.formatter.remove('align' + name);\n            }\n          });\n\n          if (align !== 'none') {\n            self.toggleFormat('align' + align);\n          }\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var listParent;\n          self.execNativeCommand(command);\n          var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n\n          if (listElm) {\n            listParent = listElm.parentNode;\n\n            if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n              self.storeSelection();\n              editor.dom.split(listParent, listElm);\n              self.restoreSelection();\n            }\n          }\n        },\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          self.toggleFormat(command);\n        },\n        'ForeColor,HiliteColor': function (command, ui, value) {\n          self.toggleFormat(command, {\n            value: value\n          });\n        },\n        'FontName': function (command, ui, value) {\n          fontNameAction(editor, value);\n        },\n        'FontSize': function (command, ui, value) {\n          fontSizeAction(editor, value);\n        },\n        'LineHeight': function (command, ui, value) {\n          lineHeightAction(editor, value);\n        },\n        'Lang': function (command, ui, lang) {\n          self.toggleFormat(command, {\n            value: lang.code,\n            customValue: lang.customCode\n          });\n        },\n        'RemoveFormat': function (command) {\n          editor.formatter.remove(command);\n        },\n        'mceBlockQuote': function () {\n          self.toggleFormat('blockquote');\n        },\n        'FormatBlock': function (command, ui, value) {\n          return self.toggleFormat(value || 'p');\n        },\n        'mceCleanup': function () {\n          var bookmark = editor.selection.getBookmark();\n          editor.setContent(editor.getContent());\n          editor.selection.moveToBookmark(bookmark);\n        },\n        'mceRemoveNode': function (command, ui, value) {\n          var node = value || editor.selection.getNode();\n\n          if (node !== editor.getBody()) {\n            self.storeSelection();\n            editor.dom.remove(node, true);\n            self.restoreSelection();\n          }\n        },\n        'mceSelectNodeDepth': function (command, ui, value) {\n          var counter = 0;\n          editor.dom.getParent(editor.selection.getNode(), function (node) {\n            if (node.nodeType === 1 && counter++ === value) {\n              editor.selection.select(node);\n              return false;\n            }\n          }, editor.getBody());\n        },\n        'mceSelectNode': function (command, ui, value) {\n          editor.selection.select(value);\n        },\n        'mceInsertContent': function (command, ui, value) {\n          insertAtCaret(editor, value);\n        },\n        'mceInsertRawHTML': function (command, ui, value) {\n          editor.selection.setContent('tiny_mce_marker');\n          var content = editor.getContent();\n          editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n            return value;\n          }));\n        },\n        'mceInsertNewLine': function (command, ui, value) {\n          insert(editor, value);\n        },\n        'mceToggleFormat': function (command, ui, value) {\n          self.toggleFormat(value);\n        },\n        'mceSetContent': function (command, ui, value) {\n          editor.setContent(value);\n        },\n        'Indent,Outdent': function (command) {\n          handle(editor, command);\n        },\n        'mceRepaint': noop,\n        'InsertHorizontalRule': function () {\n          editor.execCommand('mceInsertContent', false, '<hr />');\n        },\n        'mceToggleVisualAid': function () {\n          editor.hasVisual = !editor.hasVisual;\n          editor.addVisual();\n        },\n        'mceReplaceContent': function (command, ui, value) {\n          editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({\n            format: 'text'\n          })));\n        },\n        'mceInsertLink': function (command, ui, value) {\n          if (typeof value === 'string') {\n            value = {\n              href: value\n            };\n          }\n\n          var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n          value.href = value.href.replace(/ /g, '%20');\n\n          if (!anchor || !value.href) {\n            editor.formatter.remove('link');\n          }\n\n          if (value.href) {\n            editor.formatter.apply('link', value, anchor);\n          }\n        },\n        'selectAll': function () {\n          var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue$4);\n\n          if (editingHost) {\n            var rng = editor.dom.createRng();\n            rng.selectNodeContents(editingHost);\n            editor.selection.setRng(rng);\n          }\n        },\n        'mceNewDocument': function () {\n          editor.setContent('');\n        },\n        'InsertLineBreak': function (command, ui, value) {\n          insert$1(editor, value);\n          return true;\n        }\n      });\n\n      var alignStates = function (name) {\n        return function () {\n          var selection = editor.selection;\n          var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n          var matches = map(nodes, function (node) {\n            return !!editor.formatter.matchNode(node, name);\n          });\n          return inArray(matches, true) !== -1;\n        };\n      };\n\n      self.addCommands({\n        'JustifyLeft': alignStates('alignleft'),\n        'JustifyCenter': alignStates('aligncenter'),\n        'JustifyRight': alignStates('alignright'),\n        'JustifyFull': alignStates('alignjustify'),\n        'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n          return self.isFormatMatch(command);\n        },\n        'mceBlockQuote': function () {\n          return self.isFormatMatch('blockquote');\n        },\n        'Outdent': function () {\n          return canOutdent(editor);\n        },\n        'InsertUnorderedList,InsertOrderedList': function (command) {\n          var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n          return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n        }\n      }, 'state');\n      self.addCommands({\n        Undo: function () {\n          editor.undoManager.undo();\n        },\n        Redo: function () {\n          editor.undoManager.redo();\n        }\n      });\n      self.addQueryValueHandler('FontName', function () {\n        return fontNameQuery(editor);\n      }, this);\n      self.addQueryValueHandler('FontSize', function () {\n        return fontSizeQuery(editor);\n      }, this);\n      self.addQueryValueHandler('LineHeight', function () {\n        return lineHeightQuery(editor);\n      }, this);\n    };\n\n    return EditorCommands;\n  }();\n\n  var internalContentEditableAttr = 'data-mce-contenteditable';\n\n  var toggleClass = function (elm, cls, state) {\n    if (has(elm, cls) && state === false) {\n      remove$3(elm, cls);\n    } else if (state) {\n      add$1(elm, cls);\n    }\n  };\n\n  var setEditorCommandState = function (editor, cmd, state) {\n    try {\n      editor.getDoc().execCommand(cmd, false, String(state));\n    } catch (ex) {}\n  };\n\n  var setContentEditable = function (elm, state) {\n    elm.dom.contentEditable = state ? 'true' : 'false';\n  };\n\n  var switchOffContentEditableTrue = function (elm) {\n    each$k(descendants(elm, '*[contenteditable=\"true\"]'), function (elm) {\n      set$1(elm, internalContentEditableAttr, 'true');\n      setContentEditable(elm, false);\n    });\n  };\n\n  var switchOnContentEditableTrue = function (elm) {\n    each$k(descendants(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n      remove$6(elm, internalContentEditableAttr);\n      setContentEditable(elm, true);\n    });\n  };\n\n  var removeFakeSelection = function (editor) {\n    Optional.from(editor.selection.getNode()).each(function (elm) {\n      elm.removeAttribute('data-mce-selected');\n    });\n  };\n\n  var restoreFakeSelection = function (editor) {\n    editor.selection.setRng(editor.selection.getRng());\n  };\n\n  var toggleReadOnly = function (editor, state) {\n    var body = SugarElement.fromDom(editor.getBody());\n    toggleClass(body, 'mce-content-readonly', state);\n\n    if (state) {\n      editor.selection.controlSelection.hideResizeRect();\n\n      editor._selectionOverrides.hideFakeCaret();\n\n      removeFakeSelection(editor);\n      editor.readonly = true;\n      setContentEditable(body, false);\n      switchOffContentEditableTrue(body);\n    } else {\n      editor.readonly = false;\n      setContentEditable(body, true);\n      switchOnContentEditableTrue(body);\n      setEditorCommandState(editor, 'StyleWithCSS', false);\n      setEditorCommandState(editor, 'enableInlineTableEditing', false);\n      setEditorCommandState(editor, 'enableObjectResizing', false);\n\n      if (hasEditorOrUiFocus(editor)) {\n        editor.focus();\n      }\n\n      restoreFakeSelection(editor);\n      editor.nodeChanged();\n    }\n  };\n\n  var isReadOnly = function (editor) {\n    return editor.readonly;\n  };\n\n  var registerFilters = function (editor) {\n    editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n      if (isReadOnly(editor)) {\n        each$k(nodes, function (node) {\n          node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n          node.attr('contenteditable', 'false');\n        });\n      }\n    });\n    editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n      if (isReadOnly(editor)) {\n        each$k(nodes, function (node) {\n          node.attr('contenteditable', node.attr(internalContentEditableAttr));\n        });\n      }\n    });\n    editor.serializer.addTempAttr(internalContentEditableAttr);\n  };\n\n  var registerReadOnlyContentFilters = function (editor) {\n    if (editor.serializer) {\n      registerFilters(editor);\n    } else {\n      editor.on('PreInit', function () {\n        registerFilters(editor);\n      });\n    }\n  };\n\n  var isClickEvent = function (e) {\n    return e.type === 'click';\n  };\n\n  var getAnchorHrefOpt = function (editor, elm) {\n    var isRoot = function (elm) {\n      return eq(elm, SugarElement.fromDom(editor.getBody()));\n    };\n\n    return closest$2(elm, 'a', isRoot).bind(function (a) {\n      return getOpt(a, 'href');\n    });\n  };\n\n  var processReadonlyEvents = function (editor, e) {\n    if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n      var elm = SugarElement.fromDom(e.target);\n      getAnchorHrefOpt(editor, elm).each(function (href) {\n        e.preventDefault();\n\n        if (/^#/.test(href)) {\n          var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n\n          if (targetEl.length) {\n            editor.selection.scrollIntoView(targetEl[0], true);\n          }\n        } else {\n          window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n        }\n      });\n    }\n  };\n\n  var registerReadOnlySelectionBlockers = function (editor) {\n    editor.on('ShowCaret', function (e) {\n      if (isReadOnly(editor)) {\n        e.preventDefault();\n      }\n    });\n    editor.on('ObjectSelected', function (e) {\n      if (isReadOnly(editor)) {\n        e.preventDefault();\n      }\n    });\n  };\n\n  var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n\n  var EventDispatcher = function () {\n    function EventDispatcher(settings) {\n      this.bindings = {};\n      this.settings = settings || {};\n      this.scope = this.settings.scope || this;\n      this.toggleEvent = this.settings.toggleEvent || never;\n    }\n\n    EventDispatcher.isNative = function (name) {\n      return !!nativeEvents[name.toLowerCase()];\n    };\n\n    EventDispatcher.prototype.fire = function (name, args) {\n      var lcName = name.toLowerCase();\n      var event = normalize$3(lcName, args || {}, this.scope);\n\n      if (this.settings.beforeFire) {\n        this.settings.beforeFire(event);\n      }\n\n      var handlers = this.bindings[lcName];\n\n      if (handlers) {\n        for (var i = 0, l = handlers.length; i < l; i++) {\n          var callback = handlers[i];\n\n          if (callback.removed) {\n            continue;\n          }\n\n          if (callback.once) {\n            this.off(lcName, callback.func);\n          }\n\n          if (event.isImmediatePropagationStopped()) {\n            return event;\n          }\n\n          if (callback.func.call(this.scope, event) === false) {\n            event.preventDefault();\n            return event;\n          }\n        }\n      }\n\n      return event;\n    };\n\n    EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n      if (callback === false) {\n        callback = never;\n      }\n\n      if (callback) {\n        var wrappedCallback = {\n          func: callback,\n          removed: false\n        };\n\n        if (extra) {\n          Tools.extend(wrappedCallback, extra);\n        }\n\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!handlers) {\n            handlers = [];\n            this.toggleEvent(currentName, true);\n          }\n\n          if (prepend) {\n            handlers = __spreadArray([wrappedCallback], handlers, true);\n          } else {\n            handlers = __spreadArray(__spreadArray([], handlers, true), [wrappedCallback], false);\n          }\n\n          this.bindings[currentName] = handlers;\n        }\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.off = function (name, callback) {\n      var _this = this;\n\n      if (name) {\n        var names = name.toLowerCase().split(' ');\n        var i = names.length;\n\n        while (i--) {\n          var currentName = names[i];\n          var handlers = this.bindings[currentName];\n\n          if (!currentName) {\n            each$j(this.bindings, function (_value, bindingName) {\n              _this.toggleEvent(bindingName, false);\n\n              delete _this.bindings[bindingName];\n            });\n            return this;\n          }\n\n          if (handlers) {\n            if (!callback) {\n              handlers.length = 0;\n            } else {\n              var filteredHandlers = partition(handlers, function (handler) {\n                return handler.func === callback;\n              });\n              handlers = filteredHandlers.fail;\n              this.bindings[currentName] = handlers;\n              each$k(filteredHandlers.pass, function (handler) {\n                handler.removed = true;\n              });\n            }\n\n            if (!handlers.length) {\n              this.toggleEvent(name, false);\n              delete this.bindings[currentName];\n            }\n          }\n        }\n      } else {\n        each$j(this.bindings, function (_value, name) {\n          _this.toggleEvent(name, false);\n        });\n        this.bindings = {};\n      }\n\n      return this;\n    };\n\n    EventDispatcher.prototype.once = function (name, callback, prepend) {\n      return this.on(name, callback, prepend, {\n        once: true\n      });\n    };\n\n    EventDispatcher.prototype.has = function (name) {\n      name = name.toLowerCase();\n      return !(!this.bindings[name] || this.bindings[name].length === 0);\n    };\n\n    return EventDispatcher;\n  }();\n\n  var getEventDispatcher = function (obj) {\n    if (!obj._eventDispatcher) {\n      obj._eventDispatcher = new EventDispatcher({\n        scope: obj,\n        toggleEvent: function (name, state) {\n          if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n            obj.toggleNativeEvent(name, state);\n          }\n        }\n      });\n    }\n\n    return obj._eventDispatcher;\n  };\n\n  var Observable = {\n    fire: function (name, args, bubble) {\n      var self = this;\n\n      if (self.removed && name !== 'remove' && name !== 'detach') {\n        return args;\n      }\n\n      var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n\n      if (bubble !== false && self.parent) {\n        var parent_1 = self.parent();\n\n        while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n          parent_1.fire(name, dispatcherArgs, false);\n          parent_1 = parent_1.parent();\n        }\n      }\n\n      return dispatcherArgs;\n    },\n    on: function (name, callback, prepend) {\n      return getEventDispatcher(this).on(name, callback, prepend);\n    },\n    off: function (name, callback) {\n      return getEventDispatcher(this).off(name, callback);\n    },\n    once: function (name, callback) {\n      return getEventDispatcher(this).once(name, callback);\n    },\n    hasEventListeners: function (name) {\n      return getEventDispatcher(this).has(name);\n    }\n  };\n  var DOM$2 = DOMUtils.DOM;\n  var customEventRootDelegates;\n\n  var getEventTarget = function (editor, eventName) {\n    if (eventName === 'selectionchange') {\n      return editor.getDoc();\n    }\n\n    if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n      return editor.getDoc().documentElement;\n    }\n\n    var eventRoot = getEventRoot(editor);\n\n    if (eventRoot) {\n      if (!editor.eventRoot) {\n        editor.eventRoot = DOM$2.select(eventRoot)[0];\n      }\n\n      return editor.eventRoot;\n    }\n\n    return editor.getBody();\n  };\n\n  var isListening = function (editor) {\n    return !editor.hidden && !isReadOnly(editor);\n  };\n\n  var fireEvent = function (editor, eventName, e) {\n    if (isListening(editor)) {\n      editor.fire(eventName, e);\n    } else if (isReadOnly(editor)) {\n      processReadonlyEvents(editor, e);\n    }\n  };\n\n  var bindEventDelegate = function (editor, eventName) {\n    var delegate;\n\n    if (!editor.delegates) {\n      editor.delegates = {};\n    }\n\n    if (editor.delegates[eventName] || editor.removed) {\n      return;\n    }\n\n    var eventRootElm = getEventTarget(editor, eventName);\n\n    if (getEventRoot(editor)) {\n      if (!customEventRootDelegates) {\n        customEventRootDelegates = {};\n        editor.editorManager.on('removeEditor', function () {\n          if (!editor.editorManager.activeEditor) {\n            if (customEventRootDelegates) {\n              each$j(customEventRootDelegates, function (_value, name) {\n                editor.dom.unbind(getEventTarget(editor, name));\n              });\n              customEventRootDelegates = null;\n            }\n          }\n        });\n      }\n\n      if (customEventRootDelegates[eventName]) {\n        return;\n      }\n\n      delegate = function (e) {\n        var target = e.target;\n        var editors = editor.editorManager.get();\n        var i = editors.length;\n\n        while (i--) {\n          var body = editors[i].getBody();\n\n          if (body === target || DOM$2.isChildOf(target, body)) {\n            fireEvent(editors[i], eventName, e);\n          }\n        }\n      };\n\n      customEventRootDelegates[eventName] = delegate;\n      DOM$2.bind(eventRootElm, eventName, delegate);\n    } else {\n      delegate = function (e) {\n        fireEvent(editor, eventName, e);\n      };\n\n      DOM$2.bind(eventRootElm, eventName, delegate);\n      editor.delegates[eventName] = delegate;\n    }\n  };\n\n  var EditorObservable = __assign(__assign({}, Observable), {\n    bindPendingEventDelegates: function () {\n      var self = this;\n      Tools.each(self._pendingNativeEvents, function (name) {\n        bindEventDelegate(self, name);\n      });\n    },\n    toggleNativeEvent: function (name, state) {\n      var self = this;\n\n      if (name === 'focus' || name === 'blur') {\n        return;\n      }\n\n      if (self.removed) {\n        return;\n      }\n\n      if (state) {\n        if (self.initialized) {\n          bindEventDelegate(self, name);\n        } else {\n          if (!self._pendingNativeEvents) {\n            self._pendingNativeEvents = [name];\n          } else {\n            self._pendingNativeEvents.push(name);\n          }\n        }\n      } else if (self.initialized) {\n        self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n        delete self.delegates[name];\n      }\n    },\n    unbindAllNativeEvents: function () {\n      var self = this;\n      var body = self.getBody();\n      var dom = self.dom;\n\n      if (self.delegates) {\n        each$j(self.delegates, function (value, name) {\n          self.dom.unbind(getEventTarget(self, name), name, value);\n        });\n        delete self.delegates;\n      }\n\n      if (!self.inline && body && dom) {\n        body.onload = null;\n        dom.unbind(self.getWin());\n        dom.unbind(self.getDoc());\n      }\n\n      if (dom) {\n        dom.unbind(body);\n        dom.unbind(self.getContainer());\n      }\n    }\n  });\n\n  var defaultModes = ['design', 'readonly'];\n\n  var switchToMode = function (editor, activeMode, availableModes, mode) {\n    var oldMode = availableModes[activeMode.get()];\n    var newMode = availableModes[mode];\n\n    try {\n      newMode.activate();\n    } catch (e) {\n      console.error('problem while activating editor mode ' + mode + ':', e);\n      return;\n    }\n\n    oldMode.deactivate();\n\n    if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n      toggleReadOnly(editor, newMode.editorReadOnly);\n    }\n\n    activeMode.set(mode);\n    fireSwitchMode(editor, mode);\n  };\n\n  var setMode = function (editor, availableModes, activeMode, mode) {\n    if (mode === activeMode.get()) {\n      return;\n    } else if (!has$2(availableModes, mode)) {\n      throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n    }\n\n    if (editor.initialized) {\n      switchToMode(editor, activeMode, availableModes, mode);\n    } else {\n      editor.on('init', function () {\n        return switchToMode(editor, activeMode, availableModes, mode);\n      });\n    }\n  };\n\n  var registerMode = function (availableModes, mode, api) {\n    var _a;\n\n    if (contains$3(defaultModes, mode)) {\n      throw new Error('Cannot override default mode ' + mode);\n    }\n\n    return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n      deactivate: function () {\n        try {\n          api.deactivate();\n        } catch (e) {\n          console.error('problem while deactivating editor mode ' + mode + ':', e);\n        }\n      }\n    }), _a));\n  };\n\n  var create$4 = function (editor) {\n    var activeMode = Cell('design');\n    var availableModes = Cell({\n      design: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: false\n      },\n      readonly: {\n        activate: noop,\n        deactivate: noop,\n        editorReadOnly: true\n      }\n    });\n    registerReadOnlyContentFilters(editor);\n    registerReadOnlySelectionBlockers(editor);\n    return {\n      isReadOnly: function () {\n        return isReadOnly(editor);\n      },\n      set: function (mode) {\n        return setMode(editor, availableModes.get(), activeMode, mode);\n      },\n      get: function () {\n        return activeMode.get();\n      },\n      register: function (mode, api) {\n        availableModes.set(registerMode(availableModes.get(), mode, api));\n      }\n    };\n  };\n\n  var each$3 = Tools.each,\n      explode$1 = Tools.explode;\n  var keyCodeLookup = {\n    f1: 112,\n    f2: 113,\n    f3: 114,\n    f4: 115,\n    f5: 116,\n    f6: 117,\n    f7: 118,\n    f8: 119,\n    f9: 120,\n    f10: 121,\n    f11: 122,\n    f12: 123\n  };\n  var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n\n  var parseShortcut = function (pattern) {\n    var key;\n    var shortcut = {};\n    each$3(explode$1(pattern.toLowerCase(), '+'), function (value) {\n      if (value in modifierNames) {\n        shortcut[value] = true;\n      } else {\n        if (/^[0-9]{2,}$/.test(value)) {\n          shortcut.keyCode = parseInt(value, 10);\n        } else {\n          shortcut.charCode = value.charCodeAt(0);\n          shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n        }\n      }\n    });\n    var id = [shortcut.keyCode];\n\n    for (key in modifierNames) {\n      if (shortcut[key]) {\n        id.push(key);\n      } else {\n        shortcut[key] = false;\n      }\n    }\n\n    shortcut.id = id.join(',');\n\n    if (shortcut.access) {\n      shortcut.alt = true;\n\n      if (Env.mac) {\n        shortcut.ctrl = true;\n      } else {\n        shortcut.shift = true;\n      }\n    }\n\n    if (shortcut.meta) {\n      if (Env.mac) {\n        shortcut.meta = true;\n      } else {\n        shortcut.ctrl = true;\n        shortcut.meta = false;\n      }\n    }\n\n    return shortcut;\n  };\n\n  var Shortcuts = function () {\n    function Shortcuts(editor) {\n      this.shortcuts = {};\n      this.pendingPatterns = [];\n      this.editor = editor;\n      var self = this;\n      editor.on('keyup keypress keydown', function (e) {\n        if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n          each$3(self.shortcuts, function (shortcut) {\n            if (self.matchShortcut(e, shortcut)) {\n              self.pendingPatterns = shortcut.subpatterns.slice(0);\n\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(shortcut);\n              }\n\n              return true;\n            }\n          });\n\n          if (self.matchShortcut(e, self.pendingPatterns[0])) {\n            if (self.pendingPatterns.length === 1) {\n              if (e.type === 'keydown') {\n                self.executeShortcutAction(self.pendingPatterns[0]);\n              }\n            }\n\n            self.pendingPatterns.shift();\n          }\n        }\n      });\n    }\n\n    Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n      var self = this;\n      var func = self.normalizeCommandFunc(cmdFunc);\n      each$3(explode$1(Tools.trim(pattern)), function (pattern) {\n        var shortcut = self.createShortcut(pattern, desc, func, scope);\n        self.shortcuts[shortcut.id] = shortcut;\n      });\n      return true;\n    };\n\n    Shortcuts.prototype.remove = function (pattern) {\n      var shortcut = this.createShortcut(pattern);\n\n      if (this.shortcuts[shortcut.id]) {\n        delete this.shortcuts[shortcut.id];\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n      var self = this;\n      var cmd = cmdFunc;\n\n      if (typeof cmd === 'string') {\n        return function () {\n          self.editor.execCommand(cmd, false, null);\n        };\n      } else if (Tools.isArray(cmd)) {\n        return function () {\n          self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n        };\n      } else {\n        return cmd;\n      }\n    };\n\n    Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n      var shortcuts = Tools.map(explode$1(pattern, '>'), parseShortcut);\n      shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n        func: cmdFunc,\n        scope: scope || this.editor\n      });\n      return Tools.extend(shortcuts[0], {\n        desc: this.editor.translate(desc),\n        subpatterns: shortcuts.slice(1)\n      });\n    };\n\n    Shortcuts.prototype.hasModifier = function (e) {\n      return e.altKey || e.ctrlKey || e.metaKey;\n    };\n\n    Shortcuts.prototype.isFunctionKey = function (e) {\n      return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n    };\n\n    Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n      if (!shortcut) {\n        return false;\n      }\n\n      if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n        return false;\n      }\n\n      if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n        return false;\n      }\n\n      if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n        e.preventDefault();\n        return true;\n      }\n\n      return false;\n    };\n\n    Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n      return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n    };\n\n    return Shortcuts;\n  }();\n\n  var create$3 = function () {\n    var buttons = {};\n    var menuItems = {};\n    var popups = {};\n    var icons = {};\n    var contextMenus = {};\n    var contextToolbars = {};\n    var sidebars = {};\n\n    var add = function (collection, type) {\n      return function (name, spec) {\n        return collection[name.toLowerCase()] = __assign(__assign({}, spec), {\n          type: type\n        });\n      };\n    };\n\n    var addIcon = function (name, svgData) {\n      return icons[name.toLowerCase()] = svgData;\n    };\n\n    return {\n      addButton: add(buttons, 'button'),\n      addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n      addToggleButton: add(buttons, 'togglebutton'),\n      addMenuButton: add(buttons, 'menubutton'),\n      addSplitButton: add(buttons, 'splitbutton'),\n      addMenuItem: add(menuItems, 'menuitem'),\n      addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n      addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n      addAutocompleter: add(popups, 'autocompleter'),\n      addContextMenu: add(contextMenus, 'contextmenu'),\n      addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n      addContextForm: add(contextToolbars, 'contextform'),\n      addSidebar: add(sidebars, 'sidebar'),\n      addIcon: addIcon,\n      getAll: function () {\n        return {\n          buttons: buttons,\n          menuItems: menuItems,\n          icons: icons,\n          popups: popups,\n          contextMenus: contextMenus,\n          contextToolbars: contextToolbars,\n          sidebars: sidebars\n        };\n      }\n    };\n  };\n\n  var registry = function () {\n    var bridge = create$3();\n    return {\n      addAutocompleter: bridge.addAutocompleter,\n      addButton: bridge.addButton,\n      addContextForm: bridge.addContextForm,\n      addContextMenu: bridge.addContextMenu,\n      addContextToolbar: bridge.addContextToolbar,\n      addIcon: bridge.addIcon,\n      addMenuButton: bridge.addMenuButton,\n      addMenuItem: bridge.addMenuItem,\n      addNestedMenuItem: bridge.addNestedMenuItem,\n      addSidebar: bridge.addSidebar,\n      addSplitButton: bridge.addSplitButton,\n      addToggleButton: bridge.addToggleButton,\n      addGroupToolbarButton: bridge.addGroupToolbarButton,\n      addToggleMenuItem: bridge.addToggleMenuItem,\n      getAll: bridge.getAll\n    };\n  };\n\n  var DOM$1 = DOMUtils.DOM;\n  var extend$3 = Tools.extend,\n      each$2 = Tools.each;\n  var resolve = Tools.resolve;\n  var ie = Env.ie;\n\n  var Editor = function () {\n    function Editor(id, settings, editorManager) {\n      var _this = this;\n\n      this.plugins = {};\n      this.contentCSS = [];\n      this.contentStyles = [];\n      this.loadedCSS = {};\n      this.isNotDirty = false;\n      this.editorManager = editorManager;\n      this.documentBaseUrl = editorManager.documentBaseURL;\n      extend$3(this, EditorObservable);\n      this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n\n      if (this.settings.suffix) {\n        editorManager.suffix = this.settings.suffix;\n      }\n\n      this.suffix = editorManager.suffix;\n\n      if (this.settings.base_url) {\n        editorManager._setBaseUrl(this.settings.base_url);\n      }\n\n      this.baseUri = editorManager.baseURI;\n\n      if (this.settings.referrer_policy) {\n        ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n\n        DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n      }\n\n      AddOnManager.languageLoad = this.settings.language_load;\n      AddOnManager.baseURL = editorManager.baseURL;\n      this.id = id;\n      this.setDirty(false);\n      this.documentBaseURI = new URI(this.settings.document_base_url, {\n        base_uri: this.baseUri\n      });\n      this.baseURI = this.baseUri;\n      this.inline = !!this.settings.inline;\n      this.shortcuts = new Shortcuts(this);\n      this.editorCommands = new EditorCommands(this);\n\n      if (this.settings.cache_suffix) {\n        Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n      }\n\n      this.ui = {\n        registry: registry(),\n        styleSheetLoader: undefined,\n        show: noop,\n        hide: noop,\n        enable: noop,\n        disable: noop,\n        isDisabled: never\n      };\n      var self = this;\n      var modeInstance = create$4(self);\n      this.mode = modeInstance;\n      this.setMode = modeInstance.set;\n      editorManager.fire('SetupEditor', {\n        editor: this\n      });\n      this.execCallback('setup', this);\n      this.$ = DomQuery.overrideDefaults(function () {\n        return {\n          context: _this.inline ? _this.getBody() : _this.getDoc(),\n          element: _this.getBody()\n        };\n      });\n    }\n\n    Editor.prototype.render = function () {\n      render(this);\n    };\n\n    Editor.prototype.focus = function (skipFocus) {\n      this.execCommand('mceFocus', false, skipFocus);\n    };\n\n    Editor.prototype.hasFocus = function () {\n      return hasFocus(this);\n    };\n\n    Editor.prototype.execCallback = function (name) {\n      var x = [];\n\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n\n      var self = this;\n      var callback = self.settings[name],\n          scope;\n\n      if (!callback) {\n        return;\n      }\n\n      if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n        callback = scope.func;\n        scope = scope.scope;\n      }\n\n      if (typeof callback === 'string') {\n        scope = callback.replace(/\\.\\w+$/, '');\n        scope = scope ? resolve(scope) : 0;\n        callback = resolve(callback);\n        self.callbackLookup = self.callbackLookup || {};\n        self.callbackLookup[name] = {\n          func: callback,\n          scope: scope\n        };\n      }\n\n      return callback.apply(scope || self, x);\n    };\n\n    Editor.prototype.translate = function (text) {\n      return I18n.translate(text);\n    };\n\n    Editor.prototype.getParam = function (name, defaultVal, type) {\n      return getParam(this, name, defaultVal, type);\n    };\n\n    Editor.prototype.hasPlugin = function (name, loaded) {\n      var hasPlugin = contains$3(getPlugins(this).split(/[ ,]/), name);\n\n      if (hasPlugin) {\n        return loaded ? PluginManager.get(name) !== undefined : true;\n      } else {\n        return false;\n      }\n    };\n\n    Editor.prototype.nodeChanged = function (args) {\n      this._nodeChangeDispatcher.nodeChanged(args);\n    };\n\n    Editor.prototype.addCommand = function (name, callback, scope) {\n      this.editorCommands.addCommand(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryStateHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n      this.editorCommands.addQueryValueHandler(name, callback, scope);\n    };\n\n    Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n      this.shortcuts.add(pattern, desc, cmdFunc, scope);\n    };\n\n    Editor.prototype.execCommand = function (cmd, ui, value, args) {\n      return this.editorCommands.execCommand(cmd, ui, value, args);\n    };\n\n    Editor.prototype.queryCommandState = function (cmd) {\n      return this.editorCommands.queryCommandState(cmd);\n    };\n\n    Editor.prototype.queryCommandValue = function (cmd) {\n      return this.editorCommands.queryCommandValue(cmd);\n    };\n\n    Editor.prototype.queryCommandSupported = function (cmd) {\n      return this.editorCommands.queryCommandSupported(cmd);\n    };\n\n    Editor.prototype.show = function () {\n      var self = this;\n\n      if (self.hidden) {\n        self.hidden = false;\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'true';\n        } else {\n          DOM$1.show(self.getContainer());\n          DOM$1.hide(self.id);\n        }\n\n        self.load();\n        self.fire('show');\n      }\n    };\n\n    Editor.prototype.hide = function () {\n      var self = this,\n          doc = self.getDoc();\n\n      if (!self.hidden) {\n        if (ie && doc && !self.inline) {\n          doc.execCommand('SelectAll');\n        }\n\n        self.save();\n\n        if (self.inline) {\n          self.getBody().contentEditable = 'false';\n\n          if (self === self.editorManager.focusedEditor) {\n            self.editorManager.focusedEditor = null;\n          }\n        } else {\n          DOM$1.hide(self.getContainer());\n          DOM$1.setStyle(self.id, 'display', self.orgDisplay);\n        }\n\n        self.hidden = true;\n        self.fire('hide');\n      }\n    };\n\n    Editor.prototype.isHidden = function () {\n      return !!this.hidden;\n    };\n\n    Editor.prototype.setProgressState = function (state, time) {\n      this.fire('ProgressState', {\n        state: state,\n        time: time\n      });\n    };\n\n    Editor.prototype.load = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html;\n\n      if (self.removed) {\n        return '';\n      }\n\n      if (elm) {\n        args = args || {};\n        args.load = true;\n        var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n        html = self.setContent(value, args);\n        args.element = elm;\n\n        if (!args.no_events) {\n          self.fire('LoadContent', args);\n        }\n\n        args.element = elm = null;\n        return html;\n      }\n    };\n\n    Editor.prototype.save = function (args) {\n      var self = this;\n      var elm = self.getElement(),\n          html,\n          form;\n\n      if (!elm || !self.initialized || self.removed) {\n        return;\n      }\n\n      args = args || {};\n      args.save = true;\n      args.element = elm;\n      html = args.content = self.getContent(args);\n\n      if (!args.no_events) {\n        self.fire('SaveContent', args);\n      }\n\n      if (args.format === 'raw') {\n        self.fire('RawSaveContent', args);\n      }\n\n      html = args.content;\n\n      if (!isTextareaOrInput(elm)) {\n        if (args.is_removing || !self.inline) {\n          elm.innerHTML = html;\n        }\n\n        if (form = DOM$1.getParent(self.id, 'form')) {\n          each$2(form.elements, function (elm) {\n            if (elm.name === self.id) {\n              elm.value = html;\n              return false;\n            }\n          });\n        }\n      } else {\n        elm.value = html;\n      }\n\n      args.element = elm = null;\n\n      if (args.set_dirty !== false) {\n        self.setDirty(false);\n      }\n\n      return html;\n    };\n\n    Editor.prototype.setContent = function (content, args) {\n      return setContent(this, content, args);\n    };\n\n    Editor.prototype.getContent = function (args) {\n      return getContent(this, args);\n    };\n\n    Editor.prototype.insertContent = function (content, args) {\n      if (args) {\n        content = extend$3({\n          content: content\n        }, args);\n      }\n\n      this.execCommand('mceInsertContent', false, content);\n    };\n\n    Editor.prototype.resetContent = function (initialContent) {\n      if (initialContent === undefined) {\n        setContent(this, this.startContent, {\n          format: 'raw'\n        });\n      } else {\n        setContent(this, initialContent);\n      }\n\n      this.undoManager.reset();\n      this.setDirty(false);\n      this.nodeChanged();\n    };\n\n    Editor.prototype.isDirty = function () {\n      return !this.isNotDirty;\n    };\n\n    Editor.prototype.setDirty = function (state) {\n      var oldState = !this.isNotDirty;\n      this.isNotDirty = !state;\n\n      if (state && state !== oldState) {\n        this.fire('dirty');\n      }\n    };\n\n    Editor.prototype.getContainer = function () {\n      var self = this;\n\n      if (!self.container) {\n        self.container = DOM$1.get(self.editorContainer || self.id + '_parent');\n      }\n\n      return self.container;\n    };\n\n    Editor.prototype.getContentAreaContainer = function () {\n      return this.contentAreaContainer;\n    };\n\n    Editor.prototype.getElement = function () {\n      if (!this.targetElm) {\n        this.targetElm = DOM$1.get(this.id);\n      }\n\n      return this.targetElm;\n    };\n\n    Editor.prototype.getWin = function () {\n      var self = this;\n      var elm;\n\n      if (!self.contentWindow) {\n        elm = self.iframeElement;\n\n        if (elm) {\n          self.contentWindow = elm.contentWindow;\n        }\n      }\n\n      return self.contentWindow;\n    };\n\n    Editor.prototype.getDoc = function () {\n      var self = this;\n      var win;\n\n      if (!self.contentDocument) {\n        win = self.getWin();\n\n        if (win) {\n          self.contentDocument = win.document;\n        }\n      }\n\n      return self.contentDocument;\n    };\n\n    Editor.prototype.getBody = function () {\n      var doc = this.getDoc();\n      return this.bodyElement || (doc ? doc.body : null);\n    };\n\n    Editor.prototype.convertURL = function (url, name, elm) {\n      var self = this,\n          settings = self.settings;\n\n      if (settings.urlconverter_callback) {\n        return self.execCallback('urlconverter_callback', url, elm, true, name);\n      }\n\n      if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n        return url;\n      }\n\n      if (settings.relative_urls) {\n        return self.documentBaseURI.toRelative(url);\n      }\n\n      url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n      return url;\n    };\n\n    Editor.prototype.addVisual = function (elm) {\n      addVisual(this, elm);\n    };\n\n    Editor.prototype.remove = function () {\n      remove(this);\n    };\n\n    Editor.prototype.destroy = function (automatic) {\n      destroy(this, automatic);\n    };\n\n    Editor.prototype.uploadImages = function (callback) {\n      return this.editorUpload.uploadImages(callback);\n    };\n\n    Editor.prototype._scanForImages = function () {\n      return this.editorUpload.scanForImages();\n    };\n\n    Editor.prototype.addButton = function () {\n      throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n    };\n\n    Editor.prototype.addSidebar = function () {\n      throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n    };\n\n    Editor.prototype.addMenuItem = function () {\n      throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n    };\n\n    Editor.prototype.addContextToolbar = function () {\n      throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n    };\n\n    return Editor;\n  }();\n\n  var DOM = DOMUtils.DOM;\n  var explode = Tools.explode,\n      each$1 = Tools.each,\n      extend$2 = Tools.extend;\n  var instanceCounter = 0,\n      boundGlobalEvents = false;\n  var beforeUnloadDelegate;\n  var legacyEditors = [];\n  var editors = [];\n\n  var isValidLegacyKey = function (id) {\n    return id !== 'length';\n  };\n\n  var globalEventDelegate = function (e) {\n    var type = e.type;\n    each$1(EditorManager.get(), function (editor) {\n      switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n      }\n    });\n  };\n\n  var toggleGlobalEvents = function (state) {\n    if (state !== boundGlobalEvents) {\n      if (state) {\n        DomQuery(window).on('resize scroll', globalEventDelegate);\n      } else {\n        DomQuery(window).off('resize scroll', globalEventDelegate);\n      }\n\n      boundGlobalEvents = state;\n    }\n  };\n\n  var removeEditorFromList = function (targetEditor) {\n    var oldEditors = editors;\n    delete legacyEditors[targetEditor.id];\n\n    for (var i = 0; i < legacyEditors.length; i++) {\n      if (legacyEditors[i] === targetEditor) {\n        legacyEditors.splice(i, 1);\n        break;\n      }\n    }\n\n    editors = filter$4(editors, function (editor) {\n      return targetEditor !== editor;\n    });\n\n    if (EditorManager.activeEditor === targetEditor) {\n      EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n    }\n\n    if (EditorManager.focusedEditor === targetEditor) {\n      EditorManager.focusedEditor = null;\n    }\n\n    return oldEditors.length !== editors.length;\n  };\n\n  var purgeDestroyedEditor = function (editor) {\n    if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n      removeEditorFromList(editor);\n      editor.unbindAllNativeEvents();\n      editor.destroy(true);\n      editor.removed = true;\n      editor = null;\n    }\n\n    return editor;\n  };\n\n  var isQuirksMode = document.compatMode !== 'CSS1Compat';\n\n  var EditorManager = __assign(__assign({}, Observable), {\n    baseURI: null,\n    baseURL: null,\n    defaultSettings: {},\n    documentBaseURL: null,\n    suffix: null,\n    $: DomQuery,\n    majorVersion: '5',\n    minorVersion: '10.3',\n    releaseDate: '2022-02-09',\n    editors: legacyEditors,\n    i18n: I18n,\n    activeEditor: null,\n    focusedEditor: null,\n    settings: {},\n    setup: function () {\n      var self = this;\n      var baseURL,\n          documentBaseURL,\n          suffix = '';\n      documentBaseURL = URI.getDocumentBaseUrl(document.location);\n\n      if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n        documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n\n        if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n          documentBaseURL += '/';\n        }\n      }\n\n      var preInit = window.tinymce || window.tinyMCEPreInit;\n\n      if (preInit) {\n        baseURL = preInit.base || preInit.baseURL;\n        suffix = preInit.suffix;\n      } else {\n        var scripts = document.getElementsByTagName('script');\n\n        for (var i = 0; i < scripts.length; i++) {\n          var src = scripts[i].src || '';\n\n          if (src === '') {\n            continue;\n          }\n\n          var srcScript = src.substring(src.lastIndexOf('/'));\n\n          if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n            if (srcScript.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n            break;\n          }\n        }\n\n        if (!baseURL && document.currentScript) {\n          var src = document.currentScript.src;\n\n          if (src.indexOf('.min') !== -1) {\n            suffix = '.min';\n          }\n\n          baseURL = src.substring(0, src.lastIndexOf('/'));\n        }\n      }\n\n      self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n      self.documentBaseURL = documentBaseURL;\n      self.baseURI = new URI(self.baseURL);\n      self.suffix = suffix;\n      setup$l(self);\n    },\n    overrideDefaults: function (defaultSettings) {\n      var baseUrl = defaultSettings.base_url;\n\n      if (baseUrl) {\n        this._setBaseUrl(baseUrl);\n      }\n\n      var suffix = defaultSettings.suffix;\n\n      if (defaultSettings.suffix) {\n        this.suffix = suffix;\n      }\n\n      this.defaultSettings = defaultSettings;\n      var pluginBaseUrls = defaultSettings.plugin_base_urls;\n\n      if (pluginBaseUrls !== undefined) {\n        each$j(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n          AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n        });\n      }\n    },\n    init: function (settings) {\n      var self = this;\n      var result;\n      var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n\n      var isInvalidInlineTarget = function (settings, elm) {\n        return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n      };\n\n      var createId = function (elm) {\n        var id = elm.id;\n\n        if (!id) {\n          id = get$9(elm, 'name').filter(function (name) {\n            return !DOM.get(name);\n          }).getOrThunk(DOM.uniqueId);\n          elm.setAttribute('id', id);\n        }\n\n        return id;\n      };\n\n      var execCallback = function (name) {\n        var callback = settings[name];\n\n        if (!callback) {\n          return;\n        }\n\n        return callback.apply(self, []);\n      };\n\n      var hasClass = function (elm, className) {\n        return className.constructor === RegExp ? className.test(elm.className) : DOM.hasClass(elm, className);\n      };\n\n      var findTargets = function (settings) {\n        var targets = [];\n\n        if (Env.browser.isIE() && Env.browser.version.major < 11) {\n          initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n          return [];\n        } else if (isQuirksMode) {\n          initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n          return [];\n        }\n\n        if (settings.types) {\n          each$1(settings.types, function (type) {\n            targets = targets.concat(DOM.select(type.selector));\n          });\n          return targets;\n        } else if (settings.selector) {\n          return DOM.select(settings.selector);\n        } else if (settings.target) {\n          return [settings.target];\n        }\n\n        switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n\n            if (l.length > 0) {\n              each$1(explode(l), function (id) {\n                var elm = DOM.get(id);\n\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$1(document.forms, function (f) {\n                    each$1(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n\n            break;\n\n          case 'textareas':\n          case 'specific_textareas':\n            each$1(DOM.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n        }\n\n        return targets;\n      };\n\n      var provideResults = function (editors) {\n        result = editors;\n      };\n\n      var initEditors = function () {\n        var initCount = 0;\n        var editors = [];\n        var targets;\n\n        var createEditor = function (id, settings, targetElm) {\n          var editor = new Editor(id, settings, self);\n          editors.push(editor);\n          editor.on('init', function () {\n            if (++initCount === targets.length) {\n              provideResults(editors);\n            }\n          });\n          editor.targetElm = editor.targetElm || targetElm;\n          editor.render();\n        };\n\n        DOM.unbind(window, 'ready', initEditors);\n        execCallback('onpageload');\n        targets = DomQuery.unique(findTargets(settings));\n\n        if (settings.types) {\n          each$1(settings.types, function (type) {\n            Tools.each(targets, function (elm) {\n              if (DOM.is(elm, type.selector)) {\n                createEditor(createId(elm), extend$2({}, settings, type), elm);\n                return false;\n              }\n\n              return true;\n            });\n          });\n          return;\n        }\n\n        Tools.each(targets, function (elm) {\n          purgeDestroyedEditor(self.get(elm.id));\n        });\n        targets = Tools.grep(targets, function (elm) {\n          return !self.get(elm.id);\n        });\n\n        if (targets.length === 0) {\n          provideResults([]);\n        } else {\n          each$1(targets, function (elm) {\n            if (isInvalidInlineTarget(settings, elm)) {\n              initError('Could not initialize inline editor on invalid inline target element', elm);\n            } else {\n              createEditor(createId(elm), settings, elm);\n            }\n          });\n        }\n      };\n\n      self.settings = settings;\n      DOM.bind(window, 'ready', initEditors);\n      return new promiseObj(function (resolve) {\n        if (result) {\n          resolve(result);\n        } else {\n          provideResults = function (editors) {\n            resolve(editors);\n          };\n        }\n      });\n    },\n    get: function (id) {\n      if (arguments.length === 0) {\n        return editors.slice(0);\n      } else if (isString$1(id)) {\n        return find$3(editors, function (editor) {\n          return editor.id === id;\n        }).getOr(null);\n      } else if (isNumber(id)) {\n        return editors[id] ? editors[id] : null;\n      } else {\n        return null;\n      }\n    },\n    add: function (editor) {\n      var self = this;\n      var existingEditor = legacyEditors[editor.id];\n\n      if (existingEditor === editor) {\n        return editor;\n      }\n\n      if (self.get(editor.id) === null) {\n        if (isValidLegacyKey(editor.id)) {\n          legacyEditors[editor.id] = editor;\n        }\n\n        legacyEditors.push(editor);\n        editors.push(editor);\n      }\n\n      toggleGlobalEvents(true);\n      self.activeEditor = editor;\n      self.fire('AddEditor', {\n        editor: editor\n      });\n\n      if (!beforeUnloadDelegate) {\n        beforeUnloadDelegate = function (e) {\n          var event = self.fire('BeforeUnload');\n\n          if (event.returnValue) {\n            e.preventDefault();\n            e.returnValue = event.returnValue;\n            return event.returnValue;\n          }\n        };\n\n        window.addEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      return editor;\n    },\n    createEditor: function (id, settings) {\n      return this.add(new Editor(id, settings, this));\n    },\n    remove: function (selector) {\n      var self = this;\n      var i, editor;\n\n      if (!selector) {\n        for (i = editors.length - 1; i >= 0; i--) {\n          self.remove(editors[i]);\n        }\n\n        return;\n      }\n\n      if (isString$1(selector)) {\n        each$1(DOM.select(selector), function (elm) {\n          editor = self.get(elm.id);\n\n          if (editor) {\n            self.remove(editor);\n          }\n        });\n        return;\n      }\n\n      editor = selector;\n\n      if (isNull(self.get(editor.id))) {\n        return null;\n      }\n\n      if (removeEditorFromList(editor)) {\n        self.fire('RemoveEditor', {\n          editor: editor\n        });\n      }\n\n      if (editors.length === 0) {\n        window.removeEventListener('beforeunload', beforeUnloadDelegate);\n      }\n\n      editor.remove();\n      toggleGlobalEvents(editors.length > 0);\n      return editor;\n    },\n    execCommand: function (cmd, ui, value) {\n      var self = this,\n          editor = self.get(value);\n\n      switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n\n          return true;\n\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n\n          return true;\n\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n\n          return true;\n      }\n\n      if (self.activeEditor) {\n        return self.activeEditor.execCommand(cmd, ui, value);\n      }\n\n      return false;\n    },\n    triggerSave: function () {\n      each$1(editors, function (editor) {\n        editor.save();\n      });\n    },\n    addI18n: function (code, items) {\n      I18n.add(code, items);\n    },\n    translate: function (text) {\n      return I18n.translate(text);\n    },\n    setActive: function (editor) {\n      var activeEditor = this.activeEditor;\n\n      if (this.activeEditor !== editor) {\n        if (activeEditor) {\n          activeEditor.fire('deactivate', {\n            relatedTarget: editor\n          });\n        }\n\n        editor.fire('activate', {\n          relatedTarget: activeEditor\n        });\n      }\n\n      this.activeEditor = editor;\n    },\n    _setBaseUrl: function (baseUrl) {\n      this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n      this.baseURI = new URI(this.baseURL);\n    }\n  });\n\n  EditorManager.setup();\n  var min$1 = Math.min,\n      max$1 = Math.max,\n      round$1 = Math.round;\n\n  var relativePosition = function (rect, targetRect, rel) {\n    var x = targetRect.x;\n    var y = targetRect.y;\n    var w = rect.w;\n    var h = rect.h;\n    var targetW = targetRect.w;\n    var targetH = targetRect.h;\n    var relChars = (rel || '').split('');\n\n    if (relChars[0] === 'b') {\n      y += targetH;\n    }\n\n    if (relChars[1] === 'r') {\n      x += targetW;\n    }\n\n    if (relChars[0] === 'c') {\n      y += round$1(targetH / 2);\n    }\n\n    if (relChars[1] === 'c') {\n      x += round$1(targetW / 2);\n    }\n\n    if (relChars[3] === 'b') {\n      y -= h;\n    }\n\n    if (relChars[4] === 'r') {\n      x -= w;\n    }\n\n    if (relChars[3] === 'c') {\n      y -= round$1(h / 2);\n    }\n\n    if (relChars[4] === 'c') {\n      x -= round$1(w / 2);\n    }\n\n    return create$2(x, y, w, h);\n  };\n\n  var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n    var pos, i;\n\n    for (i = 0; i < rels.length; i++) {\n      pos = relativePosition(rect, targetRect, rels[i]);\n\n      if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n        return rels[i];\n      }\n    }\n\n    return null;\n  };\n\n  var inflate = function (rect, w, h) {\n    return create$2(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n  };\n\n  var intersect = function (rect, cropRect) {\n    var x1 = max$1(rect.x, cropRect.x);\n    var y1 = max$1(rect.y, cropRect.y);\n    var x2 = min$1(rect.x + rect.w, cropRect.x + cropRect.w);\n    var y2 = min$1(rect.y + rect.h, cropRect.y + cropRect.h);\n\n    if (x2 - x1 < 0 || y2 - y1 < 0) {\n      return null;\n    }\n\n    return create$2(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var clamp = function (rect, clampRect, fixedSize) {\n    var x1 = rect.x;\n    var y1 = rect.y;\n    var x2 = rect.x + rect.w;\n    var y2 = rect.y + rect.h;\n    var cx2 = clampRect.x + clampRect.w;\n    var cy2 = clampRect.y + clampRect.h;\n    var underflowX1 = max$1(0, clampRect.x - x1);\n    var underflowY1 = max$1(0, clampRect.y - y1);\n    var overflowX2 = max$1(0, x2 - cx2);\n    var overflowY2 = max$1(0, y2 - cy2);\n    x1 += underflowX1;\n    y1 += underflowY1;\n\n    if (fixedSize) {\n      x2 += underflowX1;\n      y2 += underflowY1;\n      x1 -= overflowX2;\n      y1 -= overflowY2;\n    }\n\n    x2 -= overflowX2;\n    y2 -= overflowY2;\n    return create$2(x1, y1, x2 - x1, y2 - y1);\n  };\n\n  var create$2 = function (x, y, w, h) {\n    return {\n      x: x,\n      y: y,\n      w: w,\n      h: h\n    };\n  };\n\n  var fromClientRect = function (clientRect) {\n    return create$2(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n  };\n\n  var Rect = {\n    inflate: inflate,\n    relativePosition: relativePosition,\n    findBestRelativePosition: findBestRelativePosition,\n    intersect: intersect,\n    clamp: clamp,\n    create: create$2,\n    fromClientRect: fromClientRect\n  };\n\n  var awaiter = function (resolveCb, rejectCb, timeout) {\n    if (timeout === void 0) {\n      timeout = 1000;\n    }\n\n    var done = false;\n    var timer = null;\n\n    var complete = function (completer) {\n      return function () {\n        var args = [];\n\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n\n        if (!done) {\n          done = true;\n\n          if (timer !== null) {\n            clearTimeout(timer);\n            timer = null;\n          }\n\n          completer.apply(null, args);\n        }\n      };\n    };\n\n    var resolve = complete(resolveCb);\n    var reject = complete(rejectCb);\n\n    var start = function () {\n      var args = [];\n\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n\n      if (!done && timer === null) {\n        timer = setTimeout(function () {\n          return reject.apply(null, args);\n        }, timeout);\n      }\n    };\n\n    return {\n      start: start,\n      resolve: resolve,\n      reject: reject\n    };\n  };\n\n  var create$1 = function () {\n    var tasks = {};\n    var resultFns = {};\n\n    var load = function (id, url) {\n      var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n      var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n\n      if (tasks[id] !== undefined) {\n        return tasks[id];\n      } else {\n        var task = new promiseObj(function (resolve, reject) {\n          var waiter = awaiter(resolve, reject);\n          resultFns[id] = waiter.resolve;\n          ScriptLoader.ScriptLoader.loadScript(url, function () {\n            return waiter.start(runErrMsg);\n          }, function () {\n            return waiter.reject(loadErrMsg);\n          });\n        });\n        tasks[id] = task;\n        return task;\n      }\n    };\n\n    var add = function (id, data) {\n      if (resultFns[id] !== undefined) {\n        resultFns[id](data);\n        delete resultFns[id];\n      }\n\n      tasks[id] = promiseObj.resolve(data);\n    };\n\n    return {\n      load: load,\n      add: add\n    };\n  };\n\n  var Resource = create$1();\n  var each = Tools.each,\n      extend$1 = Tools.extend;\n  var extendClass, initializing;\n\n  var Class = function () {};\n\n  Class.extend = extendClass = function (props) {\n    var self = this;\n    var _super = self.prototype;\n\n    var Class = function () {\n      var i, mixins, mixin;\n      var self = this;\n\n      if (!initializing) {\n        if (self.init) {\n          self.init.apply(self, arguments);\n        }\n\n        mixins = self.Mixins;\n\n        if (mixins) {\n          i = mixins.length;\n\n          while (i--) {\n            mixin = mixins[i];\n\n            if (mixin.init) {\n              mixin.init.apply(self, arguments);\n            }\n          }\n        }\n      }\n    };\n\n    var dummy = function () {\n      return this;\n    };\n\n    var createMethod = function (name, fn) {\n      return function () {\n        var self = this;\n        var tmp = self._super;\n        self._super = _super[name];\n        var ret = fn.apply(self, arguments);\n        self._super = tmp;\n        return ret;\n      };\n    };\n\n    initializing = true;\n    var prototype = new self();\n    initializing = false;\n\n    if (props.Mixins) {\n      each(props.Mixins, function (mixin) {\n        for (var name_1 in mixin) {\n          if (name_1 !== 'init') {\n            props[name_1] = mixin[name_1];\n          }\n        }\n      });\n\n      if (_super.Mixins) {\n        props.Mixins = _super.Mixins.concat(props.Mixins);\n      }\n    }\n\n    if (props.Methods) {\n      each(props.Methods.split(','), function (name) {\n        props[name] = dummy;\n      });\n    }\n\n    if (props.Properties) {\n      each(props.Properties.split(','), function (name) {\n        var fieldName = '_' + name;\n\n        props[name] = function (value) {\n          var self = this;\n\n          if (value !== undefined) {\n            self[fieldName] = value;\n            return self;\n          }\n\n          return self[fieldName];\n        };\n      });\n    }\n\n    if (props.Statics) {\n      each(props.Statics, function (func, name) {\n        Class[name] = func;\n      });\n    }\n\n    if (props.Defaults && _super.Defaults) {\n      props.Defaults = extend$1({}, _super.Defaults, props.Defaults);\n    }\n\n    each$j(props, function (member, name) {\n      if (typeof member === 'function' && _super[name]) {\n        prototype[name] = createMethod(name, member);\n      } else {\n        prototype[name] = member;\n      }\n    });\n    Class.prototype = prototype;\n    Class.constructor = Class;\n    Class.extend = extendClass;\n    return Class;\n  };\n\n  var min = Math.min,\n      max = Math.max,\n      round = Math.round;\n\n  var Color = function (value) {\n    var self = {};\n    var r = 0,\n        g = 0,\n        b = 0;\n\n    var rgb2hsv = function (r, g, b) {\n      var h, s, v;\n      h = 0;\n      s = 0;\n      v = 0;\n      r = r / 255;\n      g = g / 255;\n      b = b / 255;\n      var minRGB = min(r, min(g, b));\n      var maxRGB = max(r, max(g, b));\n\n      if (minRGB === maxRGB) {\n        v = minRGB;\n        return {\n          h: 0,\n          s: 0,\n          v: v * 100\n        };\n      }\n\n      var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n      h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n      h = 60 * (h - d / (maxRGB - minRGB));\n      s = (maxRGB - minRGB) / maxRGB;\n      v = maxRGB;\n      return {\n        h: round(h),\n        s: round(s * 100),\n        v: round(v * 100)\n      };\n    };\n\n    var hsvToRgb = function (hue, saturation, brightness) {\n      hue = (parseInt(hue, 10) || 0) % 360;\n      saturation = parseInt(saturation, 10) / 100;\n      brightness = parseInt(brightness, 10) / 100;\n      saturation = max(0, min(saturation, 1));\n      brightness = max(0, min(brightness, 1));\n\n      if (saturation === 0) {\n        r = g = b = round(255 * brightness);\n        return;\n      }\n\n      var side = hue / 60;\n      var chroma = brightness * saturation;\n      var x = chroma * (1 - Math.abs(side % 2 - 1));\n      var match = brightness - chroma;\n\n      switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n\n        default:\n          r = g = b = 0;\n      }\n\n      r = round(255 * (r + match));\n      g = round(255 * (g + match));\n      b = round(255 * (b + match));\n    };\n\n    var toHex = function () {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n\n    var toRgb = function () {\n      return {\n        r: r,\n        g: g,\n        b: b\n      };\n    };\n\n    var toHsv = function () {\n      return rgb2hsv(r, g, b);\n    };\n\n    var parse = function (value) {\n      var matches;\n\n      if (typeof value === 'object') {\n        if ('r' in value) {\n          r = value.r;\n          g = value.g;\n          b = value.b;\n        } else if ('v' in value) {\n          hsvToRgb(value.h, value.s, value.v);\n        }\n      } else {\n        if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n          r = parseInt(matches[1], 10);\n          g = parseInt(matches[2], 10);\n          b = parseInt(matches[3], 10);\n        } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n          r = parseInt(matches[1], 16);\n          g = parseInt(matches[2], 16);\n          b = parseInt(matches[3], 16);\n        } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n          r = parseInt(matches[1] + matches[1], 16);\n          g = parseInt(matches[2] + matches[2], 16);\n          b = parseInt(matches[3] + matches[3], 16);\n        }\n      }\n\n      r = r < 0 ? 0 : r > 255 ? 255 : r;\n      g = g < 0 ? 0 : g > 255 ? 255 : g;\n      b = b < 0 ? 0 : b > 255 ? 255 : b;\n      return self;\n    };\n\n    if (value) {\n      parse(value);\n    }\n\n    self.toRgb = toRgb;\n    self.toHsv = toHsv;\n    self.toHex = toHex;\n    self.parse = parse;\n    return self;\n  };\n\n  var serialize = function (obj) {\n    var data = JSON.stringify(obj);\n\n    if (!isString$1(data)) {\n      return data;\n    }\n\n    return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n      var hexCode = match.charCodeAt(0).toString(16);\n      return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n    });\n  };\n\n  var JSONUtils = {\n    serialize: serialize,\n    parse: function (text) {\n      try {\n        return JSON.parse(text);\n      } catch (ex) {}\n    }\n  };\n  var JSONP = {\n    callbacks: {},\n    count: 0,\n    send: function (settings) {\n      var self = this,\n          dom = DOMUtils.DOM,\n          count = settings.count !== undefined ? settings.count : self.count;\n      var id = 'tinymce_jsonp_' + count;\n\n      self.callbacks[count] = function (json) {\n        dom.remove(id);\n        delete self.callbacks[count];\n        settings.callback(json);\n      };\n\n      dom.add(dom.doc.body, 'script', {\n        id: id,\n        src: settings.url,\n        type: 'text/javascript'\n      });\n      self.count++;\n    }\n  };\n\n  var XHR = __assign(__assign({}, Observable), {\n    send: function (settings) {\n      var xhr,\n          count = 0;\n\n      var ready = function () {\n        if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n          if (settings.success && count < 10000 && xhr.status === 200) {\n            settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n          } else if (settings.error) {\n            settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n          }\n\n          xhr = null;\n        } else {\n          Delay.setTimeout(ready, 10);\n        }\n      };\n\n      settings.scope = settings.scope || this;\n      settings.success_scope = settings.success_scope || settings.scope;\n      settings.error_scope = settings.error_scope || settings.scope;\n      settings.async = settings.async !== false;\n      settings.data = settings.data || '';\n      XHR.fire('beforeInitialize', {\n        settings: settings\n      });\n      xhr = new XMLHttpRequest();\n\n      if (xhr.overrideMimeType) {\n        xhr.overrideMimeType(settings.content_type);\n      }\n\n      xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n\n      if (settings.crossDomain) {\n        xhr.withCredentials = true;\n      }\n\n      if (settings.content_type) {\n        xhr.setRequestHeader('Content-Type', settings.content_type);\n      }\n\n      if (settings.requestheaders) {\n        Tools.each(settings.requestheaders, function (header) {\n          xhr.setRequestHeader(header.key, header.value);\n        });\n      }\n\n      xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n      xhr = XHR.fire('beforeSend', {\n        xhr: xhr,\n        settings: settings\n      }).xhr;\n      xhr.send(settings.data);\n\n      if (!settings.async) {\n        return ready();\n      }\n\n      Delay.setTimeout(ready, 10);\n    }\n  });\n\n  var extend = Tools.extend;\n\n  var JSONRequest = function () {\n    function JSONRequest(settings) {\n      this.settings = extend({}, settings);\n      this.count = 0;\n    }\n\n    JSONRequest.sendRPC = function (o) {\n      return new JSONRequest().send(o);\n    };\n\n    JSONRequest.prototype.send = function (args) {\n      var ecb = args.error,\n          scb = args.success;\n      var xhrArgs = extend(this.settings, args);\n\n      xhrArgs.success = function (c, x) {\n        c = JSONUtils.parse(c);\n\n        if (typeof c === 'undefined') {\n          c = {\n            error: 'JSON Parse error.'\n          };\n        }\n\n        if (c.error) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n        } else {\n          scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n        }\n      };\n\n      xhrArgs.error = function (ty, x) {\n        if (ecb) {\n          ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n        }\n      };\n\n      xhrArgs.data = JSONUtils.serialize({\n        id: args.id || 'c' + this.count++,\n        method: args.method,\n        params: args.params\n      });\n      xhrArgs.content_type = 'application/json';\n      XHR.send(xhrArgs);\n    };\n\n    return JSONRequest;\n  }();\n\n  var create = function () {\n    return function () {\n      var data = {};\n      var keys = [];\n      var storage = {\n        getItem: function (key) {\n          var item = data[key];\n          return item ? item : null;\n        },\n        setItem: function (key, value) {\n          keys.push(key);\n          data[key] = String(value);\n        },\n        key: function (index) {\n          return keys[index];\n        },\n        removeItem: function (key) {\n          keys = keys.filter(function (k) {\n            return k === key;\n          });\n          delete data[key];\n        },\n        clear: function () {\n          keys = [];\n          data = {};\n        },\n        length: 0\n      };\n      Object.defineProperty(storage, 'length', {\n        get: function () {\n          return keys.length;\n        },\n        configurable: false,\n        enumerable: false\n      });\n      return storage;\n    }();\n  };\n\n  var localStorage;\n\n  try {\n    var test = '__storage_test__';\n    localStorage = window.localStorage;\n    localStorage.setItem(test, test);\n    localStorage.removeItem(test);\n  } catch (e) {\n    localStorage = create();\n  }\n\n  var LocalStorage = localStorage;\n  var publicApi = {\n    geom: {\n      Rect: Rect\n    },\n    util: {\n      Promise: promiseObj,\n      Delay: Delay,\n      Tools: Tools,\n      VK: VK,\n      URI: URI,\n      Class: Class,\n      EventDispatcher: EventDispatcher,\n      Observable: Observable,\n      I18n: I18n,\n      XHR: XHR,\n      JSON: JSONUtils,\n      JSONRequest: JSONRequest,\n      JSONP: JSONP,\n      LocalStorage: LocalStorage,\n      Color: Color,\n      ImageUploader: ImageUploader\n    },\n    dom: {\n      EventUtils: EventUtils,\n      Sizzle: Sizzle,\n      DomQuery: DomQuery,\n      TreeWalker: DomTreeWalker,\n      TextSeeker: TextSeeker,\n      DOMUtils: DOMUtils,\n      ScriptLoader: ScriptLoader,\n      RangeUtils: RangeUtils,\n      Serializer: DomSerializer,\n      StyleSheetLoader: StyleSheetLoader,\n      ControlSelection: ControlSelection,\n      BookmarkManager: BookmarkManager,\n      Selection: EditorSelection,\n      Event: EventUtils.Event\n    },\n    html: {\n      Styles: Styles,\n      Entities: Entities,\n      Node: AstNode,\n      Schema: Schema,\n      SaxParser: SaxParser,\n      DomParser: DomParser,\n      Writer: Writer,\n      Serializer: HtmlSerializer\n    },\n    Env: Env,\n    AddOnManager: AddOnManager,\n    Annotator: Annotator,\n    Formatter: Formatter,\n    UndoManager: UndoManager,\n    EditorCommands: EditorCommands,\n    WindowManager: WindowManager,\n    NotificationManager: NotificationManager,\n    EditorObservable: EditorObservable,\n    Shortcuts: Shortcuts,\n    Editor: Editor,\n    FocusManager: FocusManager,\n    EditorManager: EditorManager,\n    DOM: DOMUtils.DOM,\n    ScriptLoader: ScriptLoader.ScriptLoader,\n    PluginManager: PluginManager,\n    ThemeManager: ThemeManager,\n    IconManager: IconManager,\n    Resource: Resource,\n    trim: Tools.trim,\n    isArray: Tools.isArray,\n    is: Tools.is,\n    toArray: Tools.toArray,\n    makeMap: Tools.makeMap,\n    each: Tools.each,\n    map: Tools.map,\n    grep: Tools.grep,\n    inArray: Tools.inArray,\n    extend: Tools.extend,\n    create: Tools.create,\n    walk: Tools.walk,\n    createNS: Tools.createNS,\n    resolve: Tools.resolve,\n    explode: Tools.explode,\n    _addCacheSuffix: Tools._addCacheSuffix,\n    isOpera: Env.opera,\n    isWebKit: Env.webkit,\n    isIE: Env.ie,\n    isGecko: Env.gecko,\n    isMac: Env.mac\n  };\n  var tinymce = Tools.extend(EditorManager, publicApi);\n\n  var exportToModuleLoaders = function (tinymce) {\n    if (typeof module === 'object') {\n      try {\n        module.exports = tinymce;\n      } catch (_) {}\n    }\n  };\n\n  var exportToWindowGlobal = function (tinymce) {\n    window.tinymce = tinymce;\n    window.tinyMCE = tinymce;\n  };\n\n  exportToWindowGlobal(tinymce);\n  exportToModuleLoaders(tinymce);\n})();","map":{"version":3,"sources":["D:/D-Downlods/MINI_ Prpject 2022/lab-manage-sys/client/node_modules/tinymce/tinymce.js"],"names":["typeOf$1","x","undefined","t","Array","prototype","isPrototypeOf","constructor","name","String","isEquatableType","indexOf","sort$1","xs","compareFn","clone","slice","call","sort","contramap","eqa","f","eq$2","y","eq","tripleEq","eqString","eqArray","length","len","i","eqSortedArray","eqRecord","kx","Object","keys","ky","q","eqAny","tx","ty","typeOf","isType$1","type","value","isSimpleType","eq$1","a","isString$1","isObject","isArray$1","isNull","isBoolean","isUndefined","isNullable","isNonNullable","isFunction","isNumber","noop","compose","fa","fb","args","_i","arguments","apply","compose1","fbc","fab","constant","identity","tripleEquals","b","curry","fn","initialArgs","restArgs","all","concat","not","die","msg","Error","never","always","none","NONE","thunk","id","me","fold","n","_s","isSome","isNone","getOr","getOrThunk","getOrDie","getOrNull","getOrUndefined","or","orThunk","map","each","bind","exists","forall","filter","toArray","toString","some","constant_a","self","s","from$1","Optional","from","nativeSlice","nativeIndexOf","nativePush","push","rawIndexOf","ts","indexOf$2","r","contains$3","pred","map$3","each$k","eachr","partition","pass","fail","arr","filter$4","foldr","acc","foldl","findUntil$1","until","find$3","findIndex$2","flatten","reverse","difference","a1","a2","mapToObject","comparator","copy","get$a","head","last$2","findMap","hasOwnProperty$1","hasOwnProperty","each$j","obj","props","k","map$2","tupleMap","v","tuple","objAcc","internalFilter","onTrue","onFalse","bifilter","filter$3","mapToArray","values","get$9","key","has$2","hasNonNullableKey","equal$1","isArray","toArray$1","array","l","each$i","o","cb","map$1","callback","out","item","index","filter$2","indexOf$1","reduce","collection","iteratee","accumulator","thisArg","findIndex$1","predicate","last$1","__assign","assign","p","__rest","e","getOwnPropertySymbols","propertyIsEnumerable","__spreadArray","to","pack","ar","cached","called","DeviceType","os","browser","userAgent","mediaMatch","isiPad","isiOS","test","isiPhone","isMobile","isAndroid","isTouch","isTablet","isPhone","iOSwebview","isSafari","isDesktop","isWebView","firstMatch","regexes","find$2","agent","major","minor","group","Number","replace","nu$4","detect$3","versionRegexes","cleanedAgent","toLowerCase","unknown$2","Version","nu","detect","unknown","detectBrowser$1","browsers","userAgentData","brands","uaBrand","lcBrand","brand","_a","info","current","version","parseInt","detect$2","candidates","candidate","search","detectBrowser","detectOs","oses","removeFromStart","str","numChars","substring","checkRange","substr","start","removeLeading","prefix","startsWith","contains$2","blank","trim$4","lTrim","rTrim","isNotEmpty","isEmpty$3","normalVersionRegex","checkContains","target","uastring","PlatformInfo","edge","chrome","ie$1","opera","firefox","safari","unknown$1","nu$3","isBrowser","isEdge","isChrome","isIE","isOpera","isFirefox","Browser","ie","windows","ios","android","linux","osx","solaris","freebsd","chromeos","nu$2","isOS","isWindows","isOSX","isLinux","isSolaris","isFreeBSD","isChromeOS","OperatingSystem","detect$1","userAgentDataOpt","deviceType","PlatformDetection","query","window","matchMedia","matches","platform$2","navigator","platform$1","browser$4","webkit","fileApi","URL","createObjectURL","windowsPhone","Env","gecko","mac","iOS","contentEditable","transparentSrc","caretAfter","range","getSelection","documentMode","document","ceFalse","cacheSuffix","container","experimentalShadowDom","canHaveCSP","desktop","whiteSpaceRegExp$2","trim$3","is$3","makeMap$4","items","delim","split","create$9","root","sp","scn","c","de","exec","cn","match","ns","createNS","onCreate","extend","resolve","parent","static","extend$6","exts","ext","name_1","walk$3","resolve$3","explode$4","d","_addCacheSuffix","url","Tools","trim","is","makeMap","grep","inArray","hasOwn","create","walk","explode","fromHtml$1","html","scope","doc","div","createElement","innerHTML","hasChildNodes","childNodes","console","error","fromDom$2","fromTag","tag","node","fromText","text","createTextNode","dom","fromPoint$1","docElm","elementFromPoint","SugarElement","fromHtml","fromDom","fromPoint","recurse","cur","compareDocumentPosition","documentPositionContainedBy","Node","DOCUMENT_POSITION_CONTAINED_BY","COMMENT","DOCUMENT","DOCUMENT_FRAGMENT","ELEMENT","TEXT","is$2","element","selector","nodeType","elem","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","bypassSelector","childElementCount","base","querySelectorAll","one","querySelector","e1","e2","regularContains","d1","d2","contains","ieContains","contains$1","Function","nodeName","isType","isComment$1","isElement$6","isText$8","isDocument$2","isDocumentFragment$1","isTag","owner$1","ownerDocument","documentOrOwner","dos","documentElement","defaultView","parentNode","parents$1","isRoot","stop","ret","rawParent","siblings","filterSelf","elements","children","prevSibling","previousSibling","nextSibling","prevSiblings","nextSiblings","child$1","cs","firstChild","lastChild","childNodesCount","getHead","isShadowRoot","host","supported","Element","attachShadow","getRootNode","isSupported$1","getStyleContainer","getShadowRoot","getShadowHost","getOriginalEventTarget","event","el","isOpenShadowHost","composed","composedPath","shadowRoot","before$4","marker","parent$1","insertBefore","after$3","sibling","append$1","prepend","firstChild$1","appendChild","wrap$3","wrapper","before$3","append","empty","textContent","rogue","remove$7","removeChild","unwrap","children$1","inBody","body","left","top","translate","SugarPosition","boxPosition","box","getBoundingClientRect","firstDefinedOrZero","absolute","win","offsetLeft","offsetTop","scrollTop","pageYOffset","scrollLeft","pageXOffset","clientTop","clientLeft","viewport","get$8","_DOC","scrollTo","intoView","alignToTop","scrollIntoViewIfNeeded","scrollIntoView","get$7","_win","bounds","width","height","right","bottom","getBounds","scroll","clientWidth","clientHeight","visualViewport","Math","max","pageLeft","pageTop","isNodeType","isRestrictedNode","getPrototypeOf","isElement$5","matchNodeNames","names","lowercasedNames","matchStyleValues","computed","getComputedStyle","cssValue","getPropertyValue","hasAttribute","attrName","hasAttributeValue","attrValue","getAttribute","isBogus$2","isBogusAll$1","isTable$3","tagName","hasContentEditableState","isTextareaOrInput","isText$7","isComment","isDocument$1","isDocumentFragment","isBr$5","isImg","isContentEditableTrue$4","isContentEditableFalse$b","isTableCell$5","isMedia$2","is$1","lhs","rhs","cat","lift2","oa","ob","lift3","oc","someIf","isSupported","style","rawSet","setAttribute","set$1","setAll$1","attrs","get$6","getOpt","has$1","remove$6","removeAttribute","clone$3","attributes","attr","internalSet","property","setProperty","setAll","css","get$5","styles","getUnsafeProperty","getRaw","raw","getAllRaw","ruleName","reflow","offsetWidth","browser$3","firstElement","nodes","getTableCaptionDeltaY","elm","caption","bodyTop","captionTop","captionHeight","offsetHeight","hasChild","child","getPos","rootElm","pos","offsetParent","castOffsetParent","exports$1","module$1","exports","define","module","require","global","factory","amd","globalThis","EphoxContactWrapper","commonjsGlobal","promise","setTimeoutFunc","setTimeout","Promise","TypeError","_state","_handled","_value","_deferreds","doResolve","handle","deferred","_immediateFn","onFulfilled","onRejected","reject","newValue","then","finale","_unhandledRejectionFn","Handler","done","reason","ex","prom","remaining","res","val","race","setImmediate","err","warn","_setImmediateFn","_setUnhandledRejectionFn","promisePolyfill","Global","promisePolyfill_1","boltExport","Promise$1","nu$1","baseFn","data","callbacks","nCallback","get","isReady","set","run","cbs","pure$1","LazyValue","pure","errorReporter","make","aFutureB","toPromise","anonBind","futureB","toLazy","toCached","cache","Future","par$1","asyncValues","count","asyncValue","par","futures","value$1","_opt","_f","mapError","_","onValue","toOptional","isValue","isError","message","onError","fromOption","opt","Result","generate$1","cases","constructors","adt","acase","keys$1","argLength","branches","branchKeys","join","allReqd","reqKey","foldArgs","log","label","params","Adt","generate","bothErrors","firstError","secondError","bothValues","unite","result","ClosestOrAncestor","ancestor","ancestor$3","closest$3","sibling$2","ancestor$2","descendant","closest$2","promiseObj","requestAnimationFramePromise","requestAnimationFrame","requestAnimationFrameFunc","vendors","featurefill","wrappedSetTimeout","time","wrappedSetInterval","setInterval","wrappedClearTimeout","clearTimeout","wrappedClearInterval","clearInterval","debounce","timer","func","Delay","setEditorTimeout","editor","removed","setEditorInterval","throttle","StyleSheetLoader","documentOrShadowRoot","settings","idCount","loadedStates","edos","maxLoadTime","_setReferrerPolicy","referrerPolicy","addStyle","removeStyle","styleContainer","getOrCreateState","passed","failed","load","success","failure","link","urlWithSuffix","state","status","onload","onerror","wait","testCallback","waitCallback","Date","now","startTime","waitForWebKitLinkLoaded","styleSheets","styleSheet","owner","ownerNode","linkElem","rel","contentCssCors","loadF","loadAll","urls","parts","unload","unloadAll","create$8","WeakMap","forElement","referenceElement","rootDom","sl","instance","DomTreeWalker","startNode","rootNode","next","prev","prev2","shallow","findSibling","findPreviousNode","startName","siblingName","blocks","tableCells","tableSections","textBlocks","headings","listItems$1","lists","wsElements","lazyLookup","lookup","isHeading","isBlock$2","isTable$2","isInline$1","isBr$4","isTextBlock$2","isList","isListItem","isTableSection","isTableCell$4","isWsPreserveElement","ancestor$1","zeroWidth","nbsp","isZwsp$1","char","removeZwsp","ZWSP$1","isZwsp","trim$2","isElement$4","isText$6","isCaretContainerBlock$1","isCaretContainerInline","isCaretContainer$2","hasContent","insertInline$1","before","textNode","startsWithCaretContainer$1","splitText","endsWithCaretContainer$1","isBeforeInline","charAt","offset","isAtStart","isAfterInline","isAtEnd","createBogusBr","br","insertBlock$1","blockName","blockNode","trimBogusBr","brs","getElementsByTagName","lastBr","showCaretContainerBlock","caretContainer","isRangeInCaretContainerBlock","startContainer","isContentEditableTrue$3","isContentEditableFalse$a","isBr$3","isText$5","isInvalidTextElement","isAtomicInline","isTable$1","isCaretContainer$1","isCaretCandidate$3","isNonUiContentEditableFalse","isUnselectable","isInEditable","isAtomicContentEditableFalse","isAtomic$1","isEditableCaretCandidate$1","whiteSpaceRegExp$1","isWhitespaceText","hasWhitespacePreserveParent","rootElement","isWhitespace","isNamedAnchor","isContent$1","isBookmark","isBogus$1","isBogusAll","isEmptyNode","targetNode","skipBogus","brCount","walker","isEmpty$2","isSpan","isInlineContent","surroundedByInlineContent","prevIsInline","nextIsInline","isBookmarkNode$2","isKeepTextNode","isKeepElement","isDocument","trimNode","currentChildren","remove","makeMap$3","attrsCharsRegExp","textCharsRegExp","rawCharsRegExp","entityRegExp","asciiMap","baseEntities","reverseEntities","nativeDecode","innerText","buildEntitiesLookup","radix","chr","entity","fromCharCode","namedEntities","encodeRaw","encodeAllRaw","encodeNumeric","charCodeAt","encodeNamed","entities","getEncodeFunc","entitiesMap","encodeNamedAndNumeric","encodeCustomNamed","nameMap","named","numeric","decode","Entities","mapCache","dummyObj","makeMap$2","each$h","extend$5","explode$3","inArray$2","split$1","compileSchema","schema","globalAttributes","blockContent","phrasingContent","flowContent","html4BlockContent","html4PhrasingContent","add","ni","attributesOrder","arrayToMap","addAttrs","schemaItem","table","script","compileElementMap","mode","toUpperCase","Schema","patternElements","customElementsMap","specialElements","createLookupTable","option","defaultValue","extendWith","schemaItems","verify_html","valid_elements","validStyles","valid_styles","invalidStyles","invalid_styles","validClasses","valid_classes","whiteSpaceElementsMap","selfClosingElementsMap","shortEndedElementsMap","boolAttrMap","nonEmptyOrMoveCaretBeforeOnEnter","nonEmptyElementsMap","moveCaretBeforeOnEnterElementsMap","textBlockElementsMap","blockElementsMap","textInlineElementsMap","special","RegExp","patternToRegExp","addValidElements","validElements","ei","ai","al","attrData","elementName","attrType","outputName","globalAttributesOrder","elementRuleRegExp","attrRuleRegExp","hasPatternsRegExp","validElementsArr","paddEmpty","removeEmpty","removeEmptyAttrs","attributesRequired","required","splice","attributesDefault","attributesForced","forcedValue","validValues","attributePatterns","pattern","setValidElements","addCustomElements","customElements","customElementRegExp","text_block_elements","block_elements","rule","inline","cloneName","customRule","elmName","addValidChildren","validChildren","childRuleRegExp","getElementRule","custom_elements","valid_children","extended_valid_elements","dd","dt","li","td","th","tr","tbody","thead","tfoot","legend","area","param","parents","parentsRequired","invalid_elements","getValidStyles","getInvalidStyles","getValidClasses","getBoolAttrs","getBlockElements","getTextBlockElements","getTextInlineElements","getShortEndedElements","getSelfClosingElements","getNonEmptyElements","getMoveCaretBeforeOnEnterElements","getWhiteSpaceElements","getSpecialElements","isValidChild","isValid","attrPatterns","getCustomElements","toHex","g","hex","Styles","_this","rgbRegExp","urlOrStrRegExp","styleRegExp","trimRightRegExp","encodingLookup","invisibleChar","encodingItems","color","parse","isEncoded","urlConverter","url_converter","urlConverterScope","url_converter_scope","compress","suffix","noJoin","canCompress","compress2","encode","keepSlashes","decodeSingleHexSequence","escSeq","decodeHexSequences","processUrl","url2","url3","str2","allow_script_urls","scriptUrl","allow_svg_data_urls","lastIndex","border","serialize","serializeStyles","styleList","i_1","styleMap","deprecated","keyLocation","layerX","layerY","returnValue","webkitMovementX","webkitMovementY","keyIdentifier","mozPressure","isNativeEvent","Event","initEvent","hasIsDefaultPrevented","isDefaultPrevented","needsNormalizing","preventDefault","clone$2","originalEvent","normalize$3","fallbackTarget","srcElement","defaultPrevented","stopPropagation","cancelBubble","isPropagationStopped","stopImmediatePropagation","isImmediatePropagationStopped","eventExpandoPrefix","mouseEventRe","addEvent","capture","addEventListener","attachEvent","removeEvent","removeEventListener","detachEvent","isMouseEvent","fix","pageX","clientX","eventDoc","mouseEvent","pageY","clientY","metaKey","bindOnReady","eventUtils","domLoaded","isDocReady","readyState","readyHandler","EventUtils","events","expando","hasMouseEnterLeave","hasFocusIn","callbackList","fakeName","nativeHandler","defaultNativeHandler","evt","executeHandlers","namesList","mouseEnterLeave","currentTarget","related","relatedTarget","unbind","ci","eventMap","fire","parentWindow","clean","destroy","cancel","support","Expr","getText","isXML","tokenize","compile","select$1","outermostContext","sortInput","hasDuplicate","setDocument","document$1","docElem","documentIsHTML","rbuggyQSA","rbuggyMatches","preferredDoc","dirruns","classCache","createCache","tokenCache","compilerCache","sortOrder","strundefined","MAX_NEGATIVE","pop","push_native","push$1","slice$1","booleans","whitespace","identifier","pseudos","rtrim","rcomma","rcombinators","rattributeQuotes","rpseudo","ridentifier","matchExpr","ID","CLASS","TAG","ATTR","PSEUDO","CHILD","bool","needsContext","rinputs","rheader","rnative","rquickExpr$1","rsibling","rescape","runescape","funescape","escaped","escapedWhitespace","high","els","j","Sizzle","context","results","seed","m","groups","old","nid","newContext","newSelector","getElementById","getElementsByClassName","qsa","toSelector","testContext","qsaError","cacheLength","shift","markFunction","siblingCheck","diff","sourceIndex","createInputPseudo","createButtonPseudo","createPositionalPseudo","argument","matchIndexes","hasCompare","getTop","getById","find","attrId","tmp","className","disconnectedMatch","adown","bup","compare","sortDetached","aup","ap","bp","unshift","expr","matchesSelector","attrHandle","getAttributeNode","specified","uniqueSort","duplicates","detectDuplicates","sortStable","nodeValue","selectors","createPseudo","relative","dir","first","preFilter","excess","unquoted","nodeNameSelector","operator","check","what","last","simple","forward","ofType","xml","outerCache","nodeIndex","useCache","pseudo","setFilters","idx","matched","input","matcher","unmatched","has","lang","elemLang","hash","location","focus","activeElement","hasFocus","href","tabIndex","enabled","disabled","checked","selected","selectedIndex","header","button","even","odd","lt","gt","nth","filters","parseOnly","tokens","soFar","preFilters","addCombinator","combinator","checkNonElements","doneName","oldCache","newCache","elementMatcher","matchers","multipleContexts","contexts","condense","newUnmatched","mapped","setMatcher","postFilter","postFinder","postSelector","temp","preMap","postMap","preexisting","elems","matcherIn","matcherOut","matcherFromTokens","checkContext","leadingRelative","implicitRelative","matchContext","matchAnyContext","matcherFromGroupMatchers","elementMatchers","setMatchers","bySet","byElement","superMatcher","outermost","matchedCount","setMatched","contextBackup","dirrunsUnique","random","select","token","compiled","rquickExpr","Event$1","skipUniques","isDefined","isString","isWindow","createFragment$1","fragDoc","frag","createDocumentFragment","domManipulate","targetNodes","sourceItem","getElementDocument","DomQuery","makeArray","hasClass","wrap$2","lastParent","newWrapper","cloneNode","numericCssMap","booleanMap","propFix","for","class","readonly","cssFix","float","attrHooks","cssHooks","DomQueryConstructor","init","inArray$1","whiteSpaceRegExp","trim$1","each$g","grep$2","unique","hook","prop","removeAttr","camel","dashed","removeProperty","currentStyle","after","appendTo","prependTo","replaceWith","content","wrap","wrapAll","wrapInner","contents","addClass","toggleClass","removeClass","classState","existingClassName","on","off","trigger","show","hide","closest","object","sibling$1","firstSibling","contentDocument","contentWindow","wrappedResult","parentsUntil","nextUntil","prevUntil","overrideDefaults","defaults","sub","each$f","grep$1","simpleSelectorRe","setupAttrHooks","getContext","keepValues","keep_values","keepUrlHook","$elm","src","updateInternalStyleAttr","rawValue","findNodeIndex","normalized","lastNodeType","DOMUtils","addedStyles","files","counter","stdMode","boxModel","styleSheetLoader","boundEvents","ownEvents","$","getRoot","isBlock","$$","getAttrib","defaultVal","getAttribs","setAttrib","originalValue","onSetAttrib","attrElm","deep","clone_1","root_element","getViewPort","argWin","vp","w","h","getPos$1","setStyle","update_styles","setStyles","stylesArg","getStyle","getSize","getRect","size","elms","getParents","collect","selectorVal","getParent","_findSib","getNext","getPrev","setAttribs","setHTML","canHaveHTML","parentElm","newElm","createHTML","outHtml","createFragment","keepChildren","$node","removeAllAttribs","removeAttributeNode","parseStyle","cssText","serializeStyle","styleElm","DOM","loadCSS","cls","isHidden","uniqueId","getOuterHTML","outerHTML","setOuterHTML","insertAfter","reference","referenceNode","oldElm","replaceChild","rename","attrNode","findCommonAncestor","ps","pe","rgbVal","isNonEmptyElement","isEmpty","bogusVal","createRng","createRange","splitElm","replacementElm","beforeFragment","afterFragment","setStart","setEnd","extractContents","rv","output","getContentEditable","getContentEditableParent","isChildOf","dumpRng","startOffset","endContainer","endOffset","DOM$a","each$e","QUEUED","LOADING","LOADED","FAILED","ScriptLoader","states","queue","scriptLoadedCallbacks","queueLoadedCallbacks","loading","loadScript","cleanup","isDone","markDone","loadQueue","loadScripts","scripts","failures","execCallbacks","loadingScripts","notifyCallbacks","Cell","initial","isRaw","isTokenised","currentCode","getLanguageData","getData","setCode","newCode","getCode","add$4","code","langData","translation","getLangData","textstr","removeContext","values_1","substitued","$1","$2","isRtl$1","hasCode","I18n","isRtl","AddOnManager","_listeners","runListeners","matchedListeners","listener","dependencies","requireLangPack","languages","languageLoad","waitFor","language","wrappedLanguages","addOn","addOnConstructor","createUrl","baseUrl","dep","resource","addComponents","pluginName","pluginUrl","loadDependencies","addOnUrl","deps","newUrl","urlString","baseURL","lastIndexOf","PluginManager","ThemeManager","singleton","doRevoke","subject","revoke","clear","isSet","rate","read$4","add$3","remove$5","supports","classList","get$4","add$2","clazz","remove$4","add$1","cleanClass","remove$3","descendants$1","descendants","annotation","dataAnnotation","dataAnnotationId","identify","annotationName","rng","selection","getRng","getBody","an","newStart","getAttr","uid","findMarkers","isAnnotation","findAll","markers","directory","nodesAlready","setup$n","_registry","changeCallbacks","initData","listeners","previous","withCallbacks","updateCallbacks","callbackMap","outputData","fireCallbacks","fireNoAnnotation","onNodeChange","annotations","addListener","setup$m","registry","identifyParserNode","span","serializer","addNodeFilter","spans","persistent","create$7","register","date","getTime","floor","classes","fromDom$1","get$3","docDom","fragment","contentElements","clone$1","original","isDeep","deep$1","TextWalker","isBoundary","direction","TextSeeker","isBlockBoundary","process","newOffset","backwards","forwards","round$2","round","rect","collapse","toStart","isEqual","rect1","rect2","isValidOverflow","overflowY","min","isAbove$1","halfHeight","isBelow$1","containsXY","clamp$2","getSelectedNode","getNode$1","safeOffset","getNodeUnsafe","extendingChars","isExtendingChar","ch","and","isElement$3","isCaretCandidate$2","isBlock$1","isFloated","isValidElementCaretCandidate","isNotPre","isText$4","isBr$2","nodeIndex$1","resolveIndex$1","createRange$1","isWhiteSpace$1","isRange","isHiddenWhiteSpaceRange","getBrClientRect","brNode","nbsp$1","clientRect","getBoundingClientRectWebKitText","sc","ec","so","eo","newRng","cloneRange","setEndAfter","getBoundingClientRect$1","isZeroRect","clientRects","getClientRects","collapseAndInflateWidth","newClientRect","getCaretPositionClientRects","caretPosition","addUniqueAndValidRect","addCharacterOffset","beforeNode","CaretPosition","toRange","isVisible","getNode","fromRangeStart","fromRangeEnd","isAbove","pos1","pos2","isBelow","isTextPosition","isElementPosition","trimEmptyTextNode$1","insertNode","insertFragment","rangeInsertNode","isText$3","isBogus","normalizedParent","getChildNodes","normalizedTextOffset","equal","normalizedNodeIndex","numTextFragments","createPathItem","parentsUntil$1","create$6","path","outputOffset","resolvePathItem","findTextPosition","targetOffset","dataLen","resolve$2","paths","isContentEditableFalse$9","getNormalizedTextOffset","trimmedOffset","getPoint","point","getLocation","bookmark","isCollapsed","end","isFakeCaret","findIndex","moveEndPoint$1","normalizeTableCellSelection","findAdjacentContentEditableFalseElm","getOffsetBookmark","getCaretBookmark","getRangeBookmark","createBookmarkSpan","filled","getPersistentBookmark","collapsed","rng2","endBookmarkNode","startBookmarkNode","moveToBookmark","keep","getBookmark$2","getUndoBookmark","DOM$9","defaultPreviewStyles","getBodySetting","getParam","bodyObj","getIframeAttrs","getDocType","getDocumentBaseUrl","getBodyId","getBodyClass","getContentSecurityPolicy","shouldPutBrInPre$1","getForcedRootBlock","block","getForcedRootBlockAttrs","getBrNewLineSelector","getNoNewLineSelector","shouldKeepStyles","shouldEndContainerOnEmptyBlock","getFontStyleValues","getFontSizeClasses","getImagesDataImgFilter","isAutomaticUploadsEnabled","shouldReuseFileName","shouldReplaceBlobUris","getIconPackName","getIconsUrl","getImageUploadUrl","getImageUploadBasePath","getImagesUploadCredentials","getImagesUploadHandler","shouldUseContentCssCors","getReferrerPolicy","getLanguageCode","getLanguageUrl","shouldIndentUseMargin","getIndentation","getContentCss","contentCss","getFontCss","fontCss","getDirectionality","getInlineBoundarySelector","getObjectResizing","getResizeImgProportional","getPlaceholder","getElement","getEventRoot","getServiceMessage","getTheme","shouldValidate","isInlineBoundariesEnabled","getFormats","getPreviewStyles","canFormatEmptyLines","getCustomUiSelector","getThemeUrl","isInline","hasHiddenInput","shouldPatchSubmit","isEncodingXml","shouldAddFormSubmitTrigger","shouldAddUnloadTrigger","hasForcedRootBlock","getCustomUndoRedoLevels","shouldDisableNodeChange","isReadOnly$1","hasContentCssCors","getPlugins","getExternalPlugins$1","shouldBlockUnsupportedDrop","isVisualAidsEnabled","getVisualAidsTableClass","getVisualAidsAnchorClass","getIframeAriaText","isElement$2","isText$2","removeNode$1","trimCount","trimmedText","deleteZwspChars","deleteData","removeUnchanged","remove$2","removeTextAndReposition","removeElementAndReposition","newPosition","removeTextCaretContainer","removeElementCaretContainer","removeAndReposition","caretContainerNode","browser$2","isContentEditableFalse$8","isMedia$1","isTableCell$3","inlineFakeCaretSelector","getAbsoluteClientRect","scrollX","scrollY","rootRect","margin","trimInlineCaretContainers","fakeCaretTargetNodes","FakeCaret","lastVisualCaret","cursorInterval","rootBlock","caretBlock","caret","startBlink","isInlineFakeCaretTarget","caretState","reposition","getCss","isFakeCaretTableBrowser","isFakeCaretTarget","isContentEditableFalse$7","isMedia","isBlockLike","isCaretContainer","isCaretContainerBlock","isElement$1","isCaretCandidate$1","isForwards","isBackwards","skipCaretContainers","findNode$1","predicateFn","isCefOrCaretContainer","getParentBlock$2","isInSameBlock","caretPosition1","caretPosition2","getChildNodeAtRelativeOffset","relativeOffset","beforeAfter","setStartBefore","setEndBefore","setStartAfter","isNodesInSameBlock","node1","node2","lean","before$2","after$2","normalizeRange","leanLeft","leanRight","location_1","getRelativeCefElm","getNormalizedRangeEndPoint","normalizedRange","getElementFromPosition","getElementFromPrevPosition","getVisualCaretPosition","walkFn","isMoveInsideSameBlock","inSameBlock","HDirection","isContentEditableFalse$6","isText$1","isElement","isBr$1","isCaretCandidate","isAtomic","isEditableCaretCandidate","getParents$3","nodeAtIndex","getCaretCandidatePosition","moveForwardFromBr","nextNode","findCaretPosition$1","Forwards","startPos","innerNode","rootContentEditableFalseElm","CaretWalker","Backwards","walkToPositionIn","position","fromPosition","afterElement","isBeforeOrStart","isAfterOrEnd","isBeforeAfterSameElement","isAtBr","shouldSkipPosition","navigate","navigateIgnore","ignoreFilter","positionIn","nextPosition","prevPosition","firstPositionIn","lastPositionIn","CARET_ID$1","isCaretNode","getParentCaretContainer","isStringPathBookmark","isRangeBookmark","isIdBookmark","isIndexBookmark","isPathBookmark","addBogus","resolveCaretPositionBookmark","insertZwsp","isEmpty$1","tryFindRangePosition","padEmptyCaretContainer","setEndPoint","isValidTextNode","restoreEndPoint","appendData","resolvePaths","resolveId","endPos","spos","epos","resolveIndex","selectNode","resolve$1","getBookmark$1","setRng","isBookmarkNode$1","expected","actual","isNbsp","isWhiteSpace","isContent","isNode","isInlineBlock","moveStart","isWhiteSpaceNode$1","getNonWhiteSpaceSibling","inc","nextName","isTextBlock$1","ed","allowSpaces","isEmptyTextNode$1","replaceVars","vars","isEq$5","str1","normalizeStyleValue","getTextDecoration","decoration","getParents$2","isVariableFormatName","formatName","hasVariableValues","format","isVariableValue","field","fieldValues","formatter","areSimilarFormats","otherFormatName","validKeys","filterObj","validKey","fmt1","filteredFmt1","fmt2","filteredFmt2","isBlockFormat","isSelectorFormat","isInlineFormat","isMixedFormat","shouldExpandToSelector","expand","isBookmarkNode","getParents$1","isWhiteSpaceNode","isTextBlock","isBogusBr","findParentContentEditable","walkText","findSpace","findContent","findWordEndPoint","includeTrailingSpaces","lastTextNode","textSeeker","textOffset","spaceResult","findSelectorEndPoint","formatList","curFormat","findBlockEndPoint","scopeRoot","isAtBlockBoundary$1","findParentContainer","block_expand","isSelfOrParentBookmark","expandRng","includeTrailingSpace","startPoint","endPoint","walk$2","exclude","firstNode","lastNode","collectSiblings","endNode","findEndPoint","walkBoundary","parent_1","siblings_1","getRanges","ranges","rangeCount","getRangeAt","getSelectedNodes","hasMultipleRanges","getCellsFromRanges","getCellsFromElement","getCellsFromElementOrRanges","selectedCells","getCellsFromEditor","getSel","getClosestTable","cell","getStartNode","getEndNode","getFirstChildren","getLastChildren$1","hasAllContentsSelected","moveEndPoint","hasAnyRanges","sel","runOnRanges","executor","fakeSelectionNodes","fakeNodeRng","preserve","fillBookmark","NodeValue","getOption","api$1","get$2","isZeroWidth","wrapName","applyWordGrab","makeAnnotation","eDoc","decorate","_b","master","_c","_d","_e","annotate","newWrappers","getDoc","finishWrapper","getOrOpenWrapper","processElements","processElement","ctx","processNodes","annotateWithBookmark","undoManager","transact","initialRng","hasFakeSelection","selectionRng","Annotator","changes","annotationChanged","getAll","BookmarkManager","getBookmark","getContentEditableRoot$1","isXYWithinRange","firePreProcess","firePostProcess","fireRemove","fireDetach","fireSwitchMode","fireObjectResizeStart","origin","fireObjectResized","firePreInit","firePostRender","fireInit","firePlaceholderToggle","fireError","errorType","fireFormatApply","fireFormatRemove","VK","BACKSPACE","DELETE","DOWN","ENTER","ESC","LEFT","RIGHT","SPACEBAR","TAB","UP","PAGE_UP","PAGE_DOWN","END","HOME","modifierPressed","shiftKey","ctrlKey","altKey","metaKeyPressed","isContentEditableFalse$5","ControlSelection","elementSelectionAttr","selectedElm","selectedElmGhost","resizeHelper","selectedHandle","resizeBackdrop","startX","startY","selectedElmX","selectedElmY","startW","startH","ratio","resizeStarted","editableDoc","rootDocument","abs","startScrollWidth","startScrollHeight","resizeHandles","nw","ne","se","sw","isImage","isEventOnImageOutsideRange","touch","touches","contextMenuSelectImage","getResizeTargets","firstElementChild","isResizable","createGhostElement","setSizeProp","targets","setGhostElmSize","ghostElm","resizeGhostElement","deltaX","deltaY","proportional","resizeHelperX","resizeHelperY","screenX","screenY","display","scrollWidth","scrollHeight","endGhostResize","wasResizeStarted","showResizeRect","nodeChanged","targetElm","unbindResizeHandleEvents","targetWidth","targetHeight","hideResizeRect","selectedValue","handleElm","startDrag","updateResizeRect","startElm","controlElm","isChildOrEqual","img","disableGeckoResize","getStart","getEnd","isWithinContentEditableFalse","execCommand","handleMSControlSelect_1","delayedSelect","throttledUpdateResizeRect","composing","hasCeProperty","findParent$1","findClosestIeRange","rects","createTextRange","moveToElementText","moveToPoint","moveOutOfContentEditableFalse","parentElement","pointDoc","caretPositionFromPoint","offsetNode","caretRangeFromPoint","isEq$4","rng1","findParent","hasParent$1","hasParentWithName","isTable","isTableCell$2","isCeFalseCaretContainer","hasBrBeforeAfter","isPrevNode","hasContentEditableFalseParent","findTextNodeRelative","isAfterNode","lastInlineElement","parentBlockContainer","normalizeEndPoint","directionLeft","normalize$2","normRng","RangeUtils","normalize","normalizedRng","compareRanges","getCaretRangeFromPoint","Dimension","getOffset","parseFloat","getOuter","aggregate","properties","isNaN","cumulativeInclusions","absoluteMax","api","get$1","walkUp","navigation","frame","view","rest","pathTo","frameElement","Navigation","freeze","__proto__","find$1","frames","loc","excludeFromDescend","fireScrollIntoViewEvent","scrollEvent","fireAfterScrollIntoViewEvent","descend","markerInfo","cleanupFun","createMarker","elementMarker","withMarker","preserveWith","applyWithMarker","withScrollEvents","withElement","startElement","endElement","scrollToMarker","viewHeight","intoWindowIfNeeded","viewportBottom","markerTop","markerBottom","largerThanViewport","align","intoWindow","innerHeight","intoFrame","frameViewHeight","op","viewportBounds","rangeIntoWindow","elementIntoWindow","rangeIntoFrame","elementIntoFrame","scrollElementIntoView","scroller","scrollRangeIntoView","getDocument","focus$1","hasFocus$1","active","create$5","soffset","finish","foffset","SimRange","adt$1","cata","onBefore","onOn","onAfter","getStart$2","situ","before$1","after$1","Situ","domRange","exact","exactFromRange","simRange","getStart$1","startSitu","_finishSitu","_soffset","_finish","_foffset","getWin","SimSelection","browser$1","clamp$1","normalizeRng","isOrContains","isRngInRoot","shouldStore","nativeRangeToSelectionRange","readRange","validate","bookmarkToNativeRng","store","newBookmark","storeNative","restore","isEditorUIElement$1","FocusManager","isEditorUIElement","isManualNodeChange","selectionChange","registerPageMouseUp","throttledStore","mouseUpPage","registerFocusOut","registerMouseUp","registerEditorEvents","register$3","documentFocusInHandler","DOM$8","isEditorContentAreaElement","isUIElement","customSelector","getActiveElement","registerEvents$1","editorManager","focusedEditor","setActive","blurredEditor","activeEditor","unregisterDocumentEvents","setup$l","getContentEditableHost","getCollapsedNode","getFocusInElement","normalizeSelection$1","caretPos","focusBody","hasElementFocus","hasIframeFocus","iframeElement","hasInlineFocus","rawBody","hasUiFocus","hasEditorOrUiFocus","focusEditor","quirks","refreshContentEditable","bookmarkRng","contentEditableHost","activateEditor","skipFocus","getEndpointElement","real","skipEmptyTextNodes","orig","commonAncestorContainer","getSelectedBlocks","endElm","selectedBlocks","processRanges","typeLookup","walk$1","isEmptyTextNode","AstNode","insert","selfAttrs","cloneAttrs","selfAttr","shortEnded","refNode","extractBase64DataUris","dataImageUri","chunks","uris","uri","imageId","re","restoreDataUris","parseDataUri$1","decodeURIComponent","each$d","queryParts","DEFAULT_PORTS","ftp","http","https","mailto","safeSvgDataUrlElements","blockSvgDataUris","allowSvgDataUrls","isInvalidUri","allow_html_data_urls","URI","baseUri","base_uri","source","isProtocolRelative","protocol","toAbsPath","urlMatch","part","userInfo","port","parseDataUri","uriComponents","isDomSafe","options","decodedUri","unescape","pathname","setPath","pathMatch","file","getURI","toRelative","relativeUri","tu","uu","toRelPath","anchor","toAbsolute","noHost","absoluteUri","isSameOrigin","defaultPort","breakPoint","normalizedBase","nb","outPath","normalizedPath","noProtoHost","filteredClobberElements","isValidPrefixAttrName","findMatchingEndTagIndex","startIndex","startTagRegExp","endTagRegExp","shortEndedElements","startMatch","findCommentEndIndex","endMatch","isConditionalComment","lcHtml","endIfIndex","endIndex","endCommentRegexp","checkBogusAttribute","regExp","attrString","SaxParser","form","fix_self_closing","comment","cdata","pi","doctype","parseInternal","base64Extract","endRegExp","stack","attrList","textData","isInternalElement","isShortEnded","elementRule","isValidElement","attribsValue","validAttributesMap","validAttributePatterns","anyAttributesRequired","filteredUrlAttrs","parsingMode","processEndTag","valid","processText","processComment","allow_conditional_comments","processAttr","processMalformedComment","startTag","parseAttribute","val2","val3","fillAttrsMap","attrRule","isNameOrId","tokenRegExp","attrRegExp","selfClosing","self_closing_elements","removeInternalElements","remove_internals","fixSelfClosing","processHtml","matchText","bogusValue","isValidCdataSection","preserve_cdata","findEndTag","trimHtml","tempAttrs","trimContentRegExp","trimInternal","bogusAllRegExp","getTempAttrs","matchLength","endTagIndex","trimExternal","trimEmptyContents","emptyRegExp","setupArgs$3","getInner","getContentFromBody","defaultedArgs","updatedArgs","no_events","getContentInternal","each$c","ElementUtils","attribs","compareObjects","obj1","obj2","makeMap$1","Writer","indent","indentBefore","indent_before","indentAfter","indent_after","entity_encoding","htmlOutput","element_format","reset","getContent","HtmlSerializer","writer","handlers","handler","sortedAttrs","inner","nonInheritableStyles","Set","nonInheritableStylesArr","shorthandStyleProps","getStyleProps","isNonInheritableStyle","hasInheritableStyles","getLonghandStyleProps","hasStyleConflict","nodeStyleProps","parentNodeStyleProps","valueMismatch","parentValue","nodeStyleProp","propExists","longhandProps","isChar","delta","isBeforeSpace","isAfterSpace","isEmptyText","matchesElementPosition","isImageBlock","isCefNode","isBeforeImageBlock","isAfterImageBlock","isBeforeMedia","isAfterMedia","isBeforeTable","isAfterTable","isBeforeContentEditableFalse","isAfterContentEditableFalse","getLastChildren","rawNode","removeTrailingBr","allBrs","fillWithPaddingBr","trimBlockTrailingBr","lastChildPrevSibling","dropLast","parentsAndSelf","navigateIgnoreEmptyTextNodes","getClosestBlock$1","isAtBeforeAfterBlockBoundary","newPos","fromBlock","isAtBlockBoundary","isAtStartOfBlock","isAtEndOfBlock","isBeforeBlock","isAfterBlock","isBr","findBr","parentBlocks","isBeforeBr$1","isAfterBr","findPreviousBr","findNextBr","isInMiddleOfText","getClosestBlock","hasSpaceBefore","hasSpaceAfter","isPreValue","isInPre","isAtBeginningOfBody","isAtEndOfBody","isAtLineBoundary","needsToHaveNbsp","needsToBeNbspLeft","needsToBeNbspRight","needsToBeNbsp","isNbspAt","hasNbsp","normalizeNbspMiddle","chars","normalizeNbspAtStart","firstPos","normalizeNbspInMiddleOfTextNode","newText","normalizeNbspAtEnd","lastPos","normalizeNbsps","normalizeNbspsInEditor","normalizeContent","isStartOfContent","isEndOfContent","previousCharIsSpace","normalize$1","replaceData","normalizeWhitespaceAfter","whitespaceCount","normalizeWhitespaceBefore","mergeTextNodes","prevNode","normalizeWhitespace","mergeToPrev","whitespaceOffset","newNode","removeNode","insertData","needsReposition","beforeOrStartOf","afterOrEndOf","getPreviousSiblingCaretPosition","getNextSiblingCaretPosition","findCaretPositionBackwardsFromElm","startPosition","findCaretPositionForwardsFromElm","findCaretPositionBackwards","findCaretPositionForward","findCaretPosition","findCaretPosOutsideElmAfterDelete","setSelection$1","eqRawNode","paddEmptyBlock","deleteNormalized","afterDeletePosOpt","prevTextOpt","nextTextOpt","isInlineElement","deleteElement$2","moveCaret","afterDeletePos","parentBlock","normalizedAfterDeletePos","setContent","setCursorLocation","paddPos","isRootFromElement","getTableCells","getTableDetailsFromRange","getTable","startTable","endTable","isStartInTable","isEndInTable","isSameTable","isMultiTable","tableCellRng","tableSelection","cells","deleteAction","singleCellTable","fullTable","partialTable","multiTable","getClosestCell$1","isExpandedCellRng","cellRng","getTableFromCellRng","startParentTable","endParentTable","isSingleCellTable","rows","getCellRng","startCell","endCell","getCellRangeFromStartTable","getCellRangeFromEndTable","getTableSelectionFromCellRng","getTableSelections","selectionDetails","sameTableSelection","startTableSelection","endTableSelection","getCellIndex","getSelectedCells","isSingleCellTableContentSelected","optCellRng","unselectCells","otherContentRng","handleSingleTable","handleMultiTable","startTableSelectedCells","endTableSelectedCells","getActionFromRange","freefallRtl","cleanCells","getOutsideBlock","handleEmptyBlock","startInTable","emptyBlock","deleteContentInsideCell","isFirstCellInSelection","insideTableRng","deleteCellContents","collapseAndRestoreCellSelection","selectedNode","emptySingleTableCells","outsideDetails","editorRng","cellsToClean","outsideBlock","deleteContents","endPointCell","emptyMultiTableCells","startTableCells","endTableCells","betweenRng","startTableCellsToClean","endTableCellsToClean","moveSelection","lastBlock","additionalCleanupNodes","deleteTableElement","deleteCellRange","action","deleteCaptionRange","emptyElement","deleteTableRange","getParentCaption","deleteRange$2","getParentCell","deleteBetweenCells","fromCell","toCell","isDeleteOfLastCharPos","fromCaption","emptyCaretCaption","validateCaretCaption","toCaption","deleteCaretInsideCaption","deleteCaretCells","deleteCaretCaption","isNearTable","isBeforeOrAfterTable","fromPos","deleteCaret$3","backspaceDelete$9","normalizeBlockSelectionRange","newEndPos","hasOnlyOneChild$1","isPaddingNode","isPaddedEmptyBlock","blockElements","isEmptyFragmentElement","nonEmptyElements","isListFragment","cleanupDomFragment","domFragment","toDomFragment","listItems","isPadding","isListItemPadded","isEmptyOrPadded","trimListItems","getParentLi","isParentBlockLi","getSplit","beforeRng","afterRng","cloneContents","findFirstIn","caretWalker","newCaretPos","findLastOf","insertMiddle","insertBefore$1","insertAfter$1","insertAtCaret$1","liTarget","liElms","BEGINNING","isAt","trimOrPadLeftRight","isTableCell$1","isTableCellContentSelected","validInsertion","trimBrsFromTableCell","reduceInlineTextElements","merge","textInlineElements","root_1","elementUtils_1","styleConflict","markFragmentElements","unmarkFragmentElements","isPartOfFragment","canHaveChildren","moveSelectionToMarker","nextRng","parentEditableElm","findNextCaretRng","deleteSelectedContent","insertHtmlAtCaret","details","parser","bookmarkHtml","paste","caretElement","parserArgs","_selectionOverrides","showBlockCaretContainer","invalid","addVisual","traverse","findMatchingNodes","nodeFilters","attributeFilters","nodeMatches","attrMatches","name_2","filter$1","defaultFormat$1","isTreeNode","setEditorHtml","noSelection","setContentString","padd","forcedRootBlockName","no_selection","isRootContent","setContentTree","getNodeFilters","getAttributeFilters","setupArgs$2","setContentInternal","ensureIsRoot","transform","transformed","closest$1","isEq$3","matchesUnInheritedFormatSelector","inherit","matchParents","similar","matchNode","matchName$1","matchItems","itemName","onmatch","expectedValue","isEmptyValue","match$2","matchAll","matchedFormatNames","checkedMap","rawElm","canApply","defaultBlock","matchAllOnNode","formatNames","matchSimilar","ZWSP","CARET_ID","importNode","getEmptyCaretContainers","isCaretContainerEmpty","findFirstTextNode","createCaretContainer","fill","trimZwspFromCaretContainer","removeCaretContainerNode","removeCaretContainer","insertCaretContainerNode","formatNode","appendNode","insertFormatNodesIntoCaretContainer","formatNodes","innerMostFormatNode","cleanFormatNode","validFormats","matchedFormats","uniqueFormats","fmtName","clonedFormatNode","applyCaretFormat","wordcharRegex","removeCaretFormat","hasContentAfter","expandedRng","newCaretContainer","cleanedFormatNode","caretTextNode","disableCaretContainer","keyCode","setup$k","replaceWithCaretFormat","innerMost","isFormatElement","inlineElements","isEmptyCaretFormatElement","postProcessHooks","each$b","addPostProcessHook","hooks","postProcess$1","hasPreSibling","pre","isPre","joinPre","pre1","pre2","each$a","isElementNode$1","findElementSibling","mergeSiblingsNodes","elementUtils","tmpSibling","mergeSiblings","merge_siblings","clearChildStyles","clear_child_styles","links","processChildElements","unwrapEmptySpan","hasStyle","applyStyle","removeResult","MCE_ATTR_RE","each$9","isEq$2","isTableCellOrRow","isChildOfInlineParent","getContainer","lastIdx","normalizeTableSelection","childNode","wrap$1","wrapWithSiblings","matchName","isColorFormatAndAnchor","rootBlockElm","forcedRootBlock","list_block","forced_root_block_attrs","removeFormatInternal","compareNode","stylesModified","preserve_attributes","attrsToPreserve","remove_similar","valueOut","removeFormat$1","newName","findFormatRoot","formatRoot","removeFormatFromClone","wrapAndSplit","lastClone","firstClone","formatRootParent","mixed","remove$1","splitToFormatRoot","isRemoveBookmarkNode","removeNodeFormat","fmt","lastContentEditable","currentNodeMatches","textDecorations","textDecoration","removeRngStyle","ceFalseOverride","each$8","mergeTextDecorationsAndColor","processTextDecorationsAndColor","mergeBackgroundColorAndFontSize","backgroundColor","mergeSubSup","mergeWithChildren","mergeWithParents","merge_with_parents","each$7","isElementNode","canFormatBR","parentName","validBRParentElements","figcaption","summary","hasCaretNodeSibling","applyFormat$1","setElementFormat","onformat","styleVal","applyNodeStyle","found","createWrapElement","wrapElm","applyRngStyle","nodeSpecific","currentWrapElm","getChildCount","mergeStyles","childElement","childCount","formatItem","curSelNode","firstFormat","forced_root_block","fake","hasVars","setup$j","registeredFormatListeners","updateAndFireChangeCallbacks","nodeOrRange","fallbackElement","matchingNode","isMatchingNode","matchingFormat","isUnableToMatch","registeredCallbacks","runIfChanged","spec","node_1","withSimilar","withoutSimilar","withVars","addListeners","formats","formatChangeItems","getCurrent","toAppendTo","removeListeners","formatChangedInternal","toggle","fromElements","tableModel","tableRow","cellPosition","getSpan","fillout","rowspan","colspan","y2","x2","cellExists","skipCellsX","getWidth","row","findElementPos","extractRows","sx","sy","ey","newRows","subTable","createDomTable","tableElement","tableBody","modelRowsToDomRows","tableElm","toDom","subsection","findParentListContainer","getFullySelectedListWrappers","_li","listCont","listElm","listStyles","_style","innerElm","wrapped","directListWrappers","commonAnchorContainer","getWrapElements","wrapElements","listWrappers","allWrappers","emptyFragment","getFragmentFromRange","getParentTable","getTableFragment","selectedTableCells","firstCell","lastCell","fullTableModel","sectionedTableModel","getSelectionFragment","read$3","trimLeadingCollapsibleText","isCollapsibleWhitespace","getInnerText","bin","shouldTrim","getContextNodeName","parentBlockOpt","getTextContent","contextNodeName","shouldTrimSpaces","nonRenderedText","parentBlockText","textIndex","hasProceedingSpace","hasTrailingSpace","getSerializedContent","tmpElm","contextual","setupArgs$1","getSelectedContentInternal","KEEP","INSERT","vDown","vUp","snake","diag","buildScript","start1","end1","start2","end2","middle","getMiddleSnake","i2","buildSnake","sum","getOuterHtml","insertAt","removeAt","applyDiff","read$2","write","fragments","currentFragments","lazyTempDocument","implementation","createHTMLDocument","hasIframes","createFragmentedLevel","beforeBookmark","createCompleteLevel","createFromEditor","trimmedFragments","trimmed","applyToEditor","level","getLevelContent","getCleanLevelContent","hasEqualContent","level1","level2","hasEqualCleanedContent","isEq$1","isUnlocked","locks","setTyping","typing","endTyping","endTypingLevelIgnoreLocks","beforeChange$1","addUndoLevel$1","currentLevel","lastLevel","bm","customUndoRedoLevels","setDirty","clear$1","extra$1","callback1","callback2","redo$1","undo$1","reset$1","hasUndo$1","hasRedo$1","transact$1","beforeChange","ignore","ignore$1","addVisualInternal","hasVisual","matchedElm","value_1","cls_1","makePlainAdaptor","undo","redo","hasUndo","hasRedo","extra","formatChanged","insertContent","getModel","makeRtcAdaptor","rtcEditor","defaultVars","_undoManager","_locks","_index","_node","_similar","_rfl","_format","_details","getRawModel","makeNoopAdaptor","nul","isRtc","plugins","getRtcSetup","rtcPlugin","setup","setup$i","editorCast","rtcInstance","rtc","isRemote","getRtcInstanceWithFallback","getRtcInstanceWithError","addUndoLevel","matchFormat","matchAllFormats","matchNodeFormat","canApplyFormat","closestFormat","applyFormat","removeFormat","toggleFormat","getContent$2","setContent$2","getSelectedContent","addVisual$1","getContent$1","walkPastBookmark","outer","outerElm","oldLength","normalizeTextIfRequired","mergeAndNormalizeText","outerNode","normalizer","innerTextNode","rngSetContent","prevText","nextText","setupArgs","cleanContent","contextBlock","contextArgs","setContent$1","eventArgs","createContextualFragment","deleteFromCallbackMap","newCallbacks","SelectorChanged","selectorChangedData","currentSelectors","findMatchingNode","selectorChangedWithUnbind","matchedSelectors","isNativeIeSelection","isAttachedToDom","isValidRange","EditorSelection","selectedRange","explicitRange","getRng$1","getEnd$1","bookmarkManager","compareEndPoints","tryCompareBoundaryPoints","how","sourceRange","destinationRange","compareBoundaryPoints","anchorNode","START_TO_START","END_TO_END","ieRange","removeAllRanges","addRange","setBaseAndExtent","focusNode","setNode","getSelectedBlocks$1","isForward","anchorRange","anchorOffset","focusRange","focusOffset","selectorChanged","getScrollContainer","scrollContainer","placeCaretAt","controlSelection","removeAttrs","addFontToSpansFilter","domParser","fontSizes","face","addStrikeToSpanFilter","addFilters","convert_fonts_to_spans","font_size_legacy_values","register$2","inline_styles","blobUriToBlob","rejectWithError","xhr_1","XMLHttpRequest","open","responseType","response","send","uriParts","buildBlob","atob","Uint8Array","Blob","dataUriToBlob","uriToBlob","blobToDataUri","blob","reader","FileReader","onloadend","readAsDataURL","count$1","imageToBlobInfo","blobCache","base64","blobInfo","getByUri","image","dataUri","getByData","getAllImages","ImageScanner","uploadStatus","cachedPromises","images","isUploaded","promises","imageInfo","newPromise","catch","paddEmptyNode","brPreferred","padd_empty_with_br","isPaddedWithNbsp","hasOnlyChild","isPadded","whitespaceElements","isLineBreakNode","isBogusImage","isInternalImageSource","isValidDataImg","images_dataimg_filter","imgElem_1","Image","registerBase64ImageFilter","blob_cache","processImage","inputSrc","blobUri","addAttributeFilter","register$1","remove_trailing_brs","prevName","whiteSpaceElements","appendRel","addNoOpener","newRel","allow_unsafe_link_target","allow_html_in_named_anchor","fix_list_elements","classValue","validClassesMap","each$6","explode$2","extend$4","DomParser","matchedNodes","matchedAttributes","root_name","fixInvalidChildren","nonSplitableElements","textBlockElements","removeOrUnwrapInvalidNode","originalNodeParent","children_1","newParent","tempNode","fixed","filterNode","currentNode","list","fi","fl","invalidChildren","getRootBlockName","rootBlockName","startWhiteSpaceRegExp","endWhiteSpaceRegExp","allWhiteSpaceRegExp","isAllWhiteSpaceRegExp","isInWhiteSpacePreservedElement","addRootBlocks","rootBlockNode","createNode","removeWhitespaceBefore","textVal","textNodeNext","cloneAndExcludeBlocks","parent_2","attrFiltersLen","htmlParser","internalName","hasChildren","trimTrailingBr","brNode1","brNode2","preProcess","oldDoc","clonedNode","impl","doc_1","shouldFireEvent","hasEventListeners","addTempAttr","postProcess","outArgs","getHtmlFromNode","parseHtml","serializeNode","htmlSerializer","toHtml","DomSerializerImpl","addRules","setRules","DomSerializer","domSerializer","defaultFormat","DOM$7","restoreOriginalStyles","orgDisplay","safeDestroy","clearDomReferences","contentAreaContainer","formElement","editorContainer","bodyElement","restoreForm","_mceOldSubmit","submit","formEventDelegate","editorUpload","save","is_removing","unbindAllNativeEvents","automatic","destroyed","_beforeUnload","theme","bothObjects","deepMerge","baseMerge","merger","objects","curObject","deprecatedSettings","deprecatedPlugins","movedToPremiumPlugins","getDeprecatedSettings","settingNames","setting","getDeprecatedPlugins","hasPlugin","plugin","pluginNames","logDeprecationsWarning","rawSettings","finalSettings","hasDeprecatedPlugins","hasDeprecatedSettings","isLegacyMobileTheme","listJoiner","themesMessage","pluginsMessage","settingsMessage","sectionResult","sections","deviceDetection","legacyMobilePlugins","defaultTouchSettings","table_grid","object_resizing","resize","normalizePlugins","trimmedPlugins","filterLegacyMobilePlugins","extractSections","getSection","sectionSettings","hasSection","isSectionTheme","section","getSectionConfig","getToolbarMode","getDefaultSettings","documentBaseUrl","baseDefaults","toolbar_mode","document_base_url","add_form_submit_trigger","submit_patch","add_unload_trigger","convert_urls","relative_urls","remove_script_host","visual","hidden_input","convertURL","getDefaultMobileSettings","mobileSettings","defaultMobileSettings","toolbar_sticky","defaultPhoneSettings","menubar","getExternalPlugins","overrideSettings","userDefinedExternalPlugins","external_plugins","combinePlugins","forcedPlugins","getPlatformPlugins","isMobileDevice","desktopPlugins","mobilePlugins","processPlugins","defaultOverrideSettings","forced_plugins","mobileConfig","platformPlugins","combinedPlugins","isOnMobile","combineSettings","defaultSettings","defaultDeviceSettings","mobile","extendedSettings","getEditorSettings","deprecation_warnings","getFiltered","getParamObject","isArrayOf","CreateIconManager","iconPack","icons","IconManager","getProp","propName","getComputedSizeProp","getClientWidth","getClientHeight","getMarginTop","getMarginLeft","isInsideElementContentArea","bodyElm","transpose","isXYInContentArea","transposedPoint","fromDomSafe","isEditorAttachedToDom","rawContainer","getContentAreaContainer","NotificationManagerImpl","unimplemented","close","getArgs","NotificationManager","notifications","getImplementation","getNotificationManagerImpl","getTopNotification","progressBar","timeout","addNotification","notification","closeNotification","otherNotification","fireEvent","getEl","getNotifications","registerEvents","serviceMessage","WindowManagerImpl","openUrl","alert","confirm","getParams","setParams","WindowManager","dialogs","getWindowManagerImpl","funcBind","fireOpenEvent","dialog","fireCloseEvent","addDialog","closeDialog","otherDialog","getTopDialog","storeSelectionAndOpenDialog","openDialog","windowManagerImpl","displayNotification","notificationManager","displayError","_skinLoaded","uploadError","logError","createLoadError","pluginLoadError","iconsLoadError","languageLoadError","pluginInitError","initError","isContentCssSkinName","getContentCssUrls","transformToUrls","getFontCssUrls","cssLinks","skinUrl","contentCssFile","documentBaseURI","appendContentCssFromSettings","contentCSS","UploadStatus","PENDING","UPLOADED","blobUriStatuses","createStatus","resultUri","hasBlobUri","getResultUri","isPending","markPending","markUploaded","removeFailed","rnd","uuid","BlobCache","mimeToExt","mime","mimes","filename","toBlobInfo","findFirst","cachedBlobInfo","removeByUri","revokeObjectURL","Uploader","pendingPromises","pathJoin","path1","path2","defaultHandler","progress","xhr","withCredentials","credentials","upload","onprogress","loaded","total","json","JSON","responseText","basePath","formData","FormData","noUpload","handlerSuccess","handlerFailure","resolvePending","uploadBlobInfo","openNotification","closeNotification_1","failureOptions","percent","isDefaultHandler","pendingUploadBlobInfo","uploadBlobs","blobInfos","createUploader","ImageUploader","uploader","showNotification","UploadChangeHandler","lastChangedLevel","fireIfChanged","EditorUpload","imageScanner","urlFilters","changeHandler","aliveGuard","cacheInvalidator","replaceString","replaceImageUrl","targetUrl","replacementUrl","replacementString","replaceUrlInUndoStack","replaceImageUriInView","uploadImages","scanForImages","imageInfos","imagesToRemove","filteredResult","uploadInfo","uploadUri","uploadImagesAuto","isValidDataUriImage","imgElm","dataImgFilter","addFilter","resultItem","replaceBlobUris","source_view","valigntop","verticalAlign","valignmiddle","valignbottom","alignleft","preview","textAlign","aligncenter","marginLeft","marginRight","alignright","alignjustify","bold","fontWeight","italic","fontStyle","underline","strikethrough","forecolor","hilitecolor","fontname","fontFamily","fontsize","fontSize","lineheight","lineHeight","fontsize_class","blockquote","subscript","superscript","_fmt","_itemName","customValue","removeformat","FormatRegistry","unregister","each$5","parsedSelectorToHtml","ancestry","sItem","getRequiredParent","elmRule","wrapInHtml","parentCandidate","ancestorName","parentRequired","siblingElm","parseSelectorItem","$0","$3","$4","parseSelector","getCssText","previewFrag","previewCss","parentFontSize","previewStyles","removeVars","previewOpt","previewElm","numValue","setup$h","addShortcut","Formatter","formatChangeState","shouldIgnoreCommand","cmd","isFirstTypedCharacter","addNonTypingUndoLevel","command","isDirty","modKey","isInsertReplacementText","inputType","isInsertTextDataNull","isInsertFromPasteOrDrop","addKeyboardShortcuts","UndoManager","nonTypingKeycodes","placeholderAttr","isKeyboardEvent","isDeleteEvent","isNonTypingKeyboardEvent","isTypingKeyboardEvent","isVisuallyEmpty","isForcedRootBlockFalse","setup$g","placeholder","updatePlaceholder","showPlaceholder","isPlaceholderShown","strongRtl","hasStrongRtl","isInlineTarget","findInlineParents","findRootInline","hasSameParentBlock","block1","block2","isAtZwsp","normalizePosition","normalizeForwards","normalizeBackwards","isBeforeRoot","isTextBlockOrListItem","getParentBlock$1","placeCaretInEmptyBody","paddEmptyBody","willDeleteLastPositionInElement","normalizedFirstPos","normalizedLastPos","normalizedFromPos","nextPos","prevPos","blockPosition","blockBoundary","getBlockPosition","containerElm","isDifferentBlocks","hasSameParent","parent1","parent2","isEditable$1","skipLastBr","lastPositionInBlock","readFromRange","fromBlockPos","toBlockPos","blockPos","read$1","getChildrenUntilBlockBoundary","extractChildren","removeEmptyRoot","isEmptyBefore","nestedBlockMerge","toBlock","insertionPoint","sidelongBlockMerge","findInsertionPoint","parentsAndSelf$1","getInsertionPoint","trimBr","mergeBlockInto","mergeBlocks","backspaceDelete$8","deleteRangeMergeBlocks","isRawNodeInTable","isSelectionInTable","isEverythingSelected","noPrevious","noNext","emptyEditor","deleteRange$1","backspaceDelete$7","_forward","isContentEditableTrue$2","isContentEditableFalse$4","showCaret","getNodeRange","renderCaretAtRange","caretPositionNode","caretPositionBeforeNode","ceRoot","renderRangeCaret","isBeforeBoundary","isAfterBoundary","trimEmptyTextNode","deleteContentAndShowCaret","peekCaretPosition","caretRange","deleteRange","deleteBoundaryText","getNextPosFn","isBeforeFn","nextCaretPosition","backspaceDelete$6","isCompoundElement","DeleteAction","moveToElement","moveToPosition","isAtContentEditableBlockCaret","caretLocation","isDeleteFromCefDifferentBlocks","deleteEmptyBlockOrMoveToCef","toCefElm","blockElm","findCefPosition","getContentEditableBlockAction","skipMoveToActionFromInlineCefToContent","getContentEditableAction","read","deleteElement$1","hideFakeCaret","getAncestorCe","backspaceDeleteCaret","deleteOffscreenSelection","backspaceDeleteRange","hasCefAncestor","paddEmptyElement","backspaceDelete$5","deleteCaret$2","backspaceDelete$4","isText","startsWithCaretContainer","endsWithCaretContainer","createZwsp","insertInline","insertInlineBefore","insertInlineAfter","insertInlinePos","isPosCaretContainer","caretNode","renderCaret","evaluateUntil","fns","Location","rescope$1","nPos","isNotInsideFormatCaretContainer","findInsideRootInline","start$1","isValidLocation","readLocation","getName","outside","inside","isEq","location1","location2","betweenInlines","fromInline","toInline","skipNoMovement","fromLocation","toLocation","findLocationTraverse","findLocationSimple","findLocation$1","hasSelectionModifyApi","modify","moveRel","moveByWord","BreakType","flip","positions","getBreakType","currentPos","Br","Block","Wrap","getPositionsUntil","breakType","breakAt","Eol","getAdjacentLinePositions","getPositionsUntilBreak","findClosestHorizontalPositionFromPoint","lastRect","newRect","lastDist","newDist","findClosestHorizontalPosition","targetRect","getPositionsUntilPreviousLine","getPositionsUntilNextLine","getPositionsAbove","getPositionsBelow","isAtFirstLine","isAtLastLine","getFirstLinePositions","getLastLinePositions","getNodeClientRects","toArrayWithNode","VDirection","findUntil","walkUntil$1","isAboveFn","isBeflowFn","line","targetClientRect","aboveLineNumber","lineNumber","isLineNumber","upUntil","Up","downUntil","Down","positionsUntil","isBelowFn","getClientRect","isAboveLine","isLine","isContentEditableFalse$3","findNode","distanceToRectLeft","distanceToRectRight","isInsideX","isInsideY","isNodeClientRect","findClosestClientRect","allowInside","oldClientRect","oldDistance","newDistance","walkUntil","includeChildren","findLineNodeRects","targetNodeRect","checkPosFn","lineRects","getFakeCaretTargets","caretInfo","closestFakeCaret","fakeTargetNodeRects","targetNodeRects","checkInside","closestNodeRect","moveToRange","renderRangeCaretOpt","moveHorizontally","isBefore","isAfter","rangeIsInContainerBlock","moveVertically","caretClientRect","walkerFn","linePositions","nextLinePositions","nextLineRect","dist1","dist2","caretPositions","closestNextLineRect","getLineEndPoint","moveToLineEndPoint$3","setCaretPosition","setSelected","renderCaretLocation","findLocation","isInlineTarget$1","toggleInlines","inlineBoundaries","selectedInlines","targetInlines","safeRemoveCaretContainer","renderInsideInlineCaret","inlines","_inline","move$2","moveWord","_caret","setupSelectedState","moveNextWord","movePrevWord","moveToLineEndPoint$2","linePoint","outsideLoc","rangeFromPositions","hasOnlyTwoOrLessPositionsLeft","setCaretLocation","deleteFromTo","rescope","backspaceDeleteCollapsed","toPosition","backspaceDelete$3","getParentInlines","hasOnlyOneChild","deleteLastPosition","parentInlines","isFormatElement$1","deleteCaret$1","backspaceDelete$2","deleteElement","deleteCaret","isNearMedia","backspaceDelete$1","isEditable","parseIndentValue","number","getIndentStyleName","useMargin","indentStyleName","indentElement","unit","styleValue","validateBlocks","intentValue","canOutdent","getBlocksToIndent","isReadOnly","isListComponent","parentIsListComponent","indentation","indentUnit","indentValue","queryCommandState","backspaceDelete","nativeCommand","deleteCommand","forwardDeleteCommand","setup$f","addCommand","SIGNIFICANT_MOVE","LONGPRESS_DELAY","getTouch","isFarEnough","distX","distY","setup$e","startData","longpressFired","debounceLongpress","isEqualNode","isBlockElement","isValidTarget","hasBlockParent","shouldRemoveTextNode","rootNodeName","restoreSelection","setup$d","findBlockCaretContainer","removeIeControlRect","blockCaretContainer","handleBlockContainer","setup$c","isContentEditableFalse$2","moveToCeFalseHorizontally","moveToCeFalseVertically","createTextBlock","textBlock","exitPreBlock","getVisualCaretPosition$1","newBlock","getHorizontalRange","getVerticalRange","down","moveH$2","newRange","moveV$3","moveToLineEndPoint$1","isCefPosition","isTarget","rangeBefore","insertElement","insertBr","insertBlock","insertEmptyLine","getClosestTargetBlock","isAtFirstOrLastLine","moveCaretToNewEmptyLine","rootBlockAttrs","moveV$2","defaultPatterns","patterns","matchesEvent","match$1","execute","moveH$1","moveV$1","moveToLineEndPoint","deflate","getCorners","getYAxisValue","tds","findClosestCorner","corners","newCorner","oldCorner","oldDist","sqrt","getClosestCell","isTargetCorner","corner","getBottomValue","getTopValue","getClosestCellAbove","getClosestCellBelow","findClosestPositionInAboveCell","findClosestPositionInBelowCell","hasNextBreak","lineInfo","breakPos","startsWithWrapBreak","startsWithBrBreak","isAtTableCellLine","isAtFirstTableCellLine","isAtLastTableCellLine","isCaretAtStartOrEndOfTable","navigateHorizontally","_td","getClosestAbovePosition","getClosestBelowPosition","renderBlock","navigateVertically","move$1","mover","moveH","moveV","executeKeydownOverride$3","setup$b","executeKeydownOverride$2","executeKeyupOverride","setup$a","firstNonWhiteSpaceNodeSibling","moveToCaretPosition","getEditableRoot$1","editableRoot","getParentBlock","getParentBlockName","isListItemParentBlock","hasFirstChild","isFirstChild","hasParent","isListBlock","isNestedList","getContainerBlock","containerBlock","containerBlockParent","isFirstOrLastLi","insert$3","createNewBlock","newBlockName","tmpRng","trimZwsp","isEmptyAnchor","isTableCell","containerAndSiblingName","canSplitBlock","trimInlineElementsOnLeftSideOfBlock","firstChilds","normalizeZwspOffset","includeZwspInRange","trimLeadingLineBreaks","getEditableRoot","applyAttributes","forcedRootBlockAttrs","attrStyles","currentStyles","newStyles","attrClassesOpt","attrClasses","currentClassesOpt","currentClasses","filteredClasses","newClasses","appliedAttrs","remainingAttrs","setForcedBlockAttrs","wrapSelfAndSiblingsInDefaultBlock","addBrToBlockIfNeeded","insert$2","parentBlockName","isAfterLastNodeInContainer","isCaretAtStartOrEndOfBlock","normalizedOffset","insertNewBlockAfter","containerBlockName","hasRightSideContent","moveSelectionToBr","brElm","extraBr","insertBrAtCaret","isControlKey","insertBrBefore","insertBrAfter","hasBrAfter","isBeforeBr","isAnchorLink","isInsideAnchor","readInlineAnchorLocation","insertBrOutsideAnchor","insert$1","anchorLocation","shouldInsertBr","shouldBlockNewLine$1","newLineAction","shouldBlockNewLine","_shiftKey","isBrMode","requiredState","brMode","inListBlock","inBlock","inPreBlock","inSummaryBlock","shouldPutBrInPre","inBrContext","hasShiftKey","_editor","canInsertIntoEditableRoot","rootEditable","predicates","isMatch","getAction","handleEnterKeyEvent","setup$9","executeKeydownOverride$1","setup$8","setupIeInput","keypressThrotter","setup$7","isComposing","platform","executeKeyupAction","isPageUpDown","setNodeChangeBlocker","blocked","setup$6","insertTextAtPosition","insertNbspAtPosition","insertSpaceAtPosition","locationToCaretPosition","insertInlineBoundarySpaceOrNbsp","checkPos","setSelection","insertSpaceOrNbspAtSelection","executeKeydownOverride","setup$5","registerKeyboardOverrides","setup$4","NodeChange","lastPath","lastRng","nativeRng","fakeRng","isSameElementPath","initialized","currentPath","preventSummaryToggle","filterDetails","setup$3","isTextBlockNode","normalizeSelection","setup$2","detail","getAbsolutePosition","getBodyPosition","getScrollPosition","getBodyScroll","inlineScroll","iframeScroll","getMousePosition","iframePosition","scrollPosition","calculatePosition","bodyPosition","mousePosition","calc","isContentEditableFalse$1","isContentEditableTrue$1","isDraggable","isValidDropTarget","targetElement","dragElement","cloneElement","cloneElm","createGhost","clonedElm","opacity","overflow","padding","boxSizing","appendGhostToBody","moveGhost","maxX","maxY","overflowX","removeElement","isLeftMouseButtonPressed","applyRelPos","relX","ceElm","elmPos","dragging","relY","ghost","move","throttledPlaceCaretAt","movement","targetPos","getRawTarget","drop","targetClone_1","removeDragState","bindFakeDragEvents","pageDom","dragStartHandler","dragHandler","dropHandler","dragEndHandler","blockIeDrop","realTarget","blockUnsupportedFileDrop","preventFileDrop","dataTransfer","types","preventFileDropIfUIElement","editorRoot","eventNames","init$2","setup$1","renderFocusCaret","isContentEditableTrue","isContentEditableFalse","getContentEditableRoot","SelectionOverrides","fakeCaret","realSelectionId","selectedElement","isFakeSelectionElement","isFakeSelectionTargetElement","isNearFakeSelectionElement","getRealSelectionElement","setRange","getRange","contentEditableRoot","removeElementSelection","hasNormalCaretPosition","hasBetterMouseTarget","targetBlock","setElementSelection","fakeCaretInfo","normalizeShortEndedElementSelection","isPasteBin","isRangeInCaretContainer","clipboardData","realSelectionElement","clearData","setData","outerText","isWithinCaretContainer","setupOffscreenSelection","targetClone","origTargetClone","$realSelectionContainer","selectElement","nodeElm","afterNode","Quirks","isGecko","isWebKit","mceInternalUrlPrefix","mceInternalDataType","setEditorCommandState","setMceInternalContent","selectionHtml","internalContent","escape","getMceInternalContent","insertClipboardContents","internal","queryCommandSupported","emptyEditorWhenDeleting","serializeRng","allContentsSelected","allRng","allSelection","selectAll","shortcuts","documentElementEditingFocus","removeHrOnBackspace","Range","body_1","blur","selectControlElements","removeStylesWhenDeletingAcrossBlockElements","getAttributeApplyFunction","template","setAttributeNode","isSelectionAcrossElements","disableBackspaceIntoATable","removeBlockQuoteOnBackSpace","setGeckoEditingOptions","setOpts","addBrAfterLastLinks","fixLinks","setDefaultBlockType","showBrokenImageIcon","contentStyles","restoreFocusOnKeyDown","bodyHeight","blockCmdArrowNavigation","selection_1","disableAutoUrlDetect","tapLinksAndImages","blockFormSubmitInsideEditor","removeAppleInterchangeBrs","ieInternalDragAndDrop","setupRtc","DOM$6","appendStyle","getRootName","removeUndefined","mkParserSettings","mkSerializerSettings","boolean_attributes","move_caret_before_on_enter_elements","non_empty_elements","short_ended_elements","text_inline_elements","whitespace_elements","createParser","autoFocus","auto_focus","moveSelectionToFirstCaretPosition","initEditor","bindPendingEventDelegates","execCallback","getStyleSheetLoader$1","ui","makeStylesheetLoadingPromises","framedFonts","loadContentCss","removeCss","contentCssText_1","allStylesheets","content_style","preInit","browser_spellcheck","gecko_spellcheck","spellcheck","directionality","protect","loadInitialContent","startContent","initEditorWithInitialContent","initContentBody","skipWrite","visibility","orgVisibility","iframeHTML","hex_colors","force_hex_style_colors","annotator","_nodeChangeDispatcher","setupRtcThunk","setProgressState","_rtcMode","DOM$5","relaxDomain","ifr","domain","hostname","bodyUuid","domainRelaxUrl","createIframeElement","title","customAttrs","iframe","frameBorder","allowTransparency","getIframeHtml","bodyId","bodyClass","translatedAriaText","createIframe","iframeTitle","isDomainRelaxed","iframeContainer","init$1","boxInfo","hidden","DOM$4","initPlugin","initializedPlugins","Plugin","pluginInstance","trimLegacyPrefix","initPlugins","initIcons","iconPackName","currentIcons","loadIcons","svgData","icon","addIcon","initTheme","Theme","renderFromLoadedTheme","renderUI","renderFromThemeFunc","iframeHeight","createThemeFalseResult","renderThemeFalseIframe","renderThemeFalse","renderThemeUi","augmentEditorUiApi","uiApiFacade","disable","isDisabled","enable","renderInfo","DOM$3","hasSkipLoadPrefix","loadLanguage","scriptLoader","languageCode","languageUrl","url_1","loadTheme","themeUrl","getIconsUrlMetaFromUrl","getIconsUrlMetaFromName","defaultIconsUrl","customIconsUrl","urlMeta","loadPlugins","depPlugin","url_2","getStyleSheetLoader","render","snapshot","resetContent","triggerSave","windowManager","set_dirty","legacyPropNames","getSpecifiedFontProp","getProperty","legacyPropName","normalizeFontFamily","getComputedFontProp","getFontProp","getFontSize","getFontFamily","findFirstCaretElement","getCaretElement","atStartOfNode","bindRange","binder","mapRange","mapper","fromFontSizeNumber","fontSizeNumber","fontClasses","normalizeFontNames","font","fonts","fontNameAction","fontNameQuery","fontSizeAction","fontSizeQuery","lineHeightQuery","specifiedStyle","computedStyle","lineHeightAction","processValue","insertAtCaret","each$4","EditorCommands","commands","setupCommands","skip_focus","customCommand","queryCommandValue","addCommands","commandList","addQueryStateHandler","addQueryValueHandler","hasCustomCommand","execNativeCommand","isFormatMatch","storeSelection","selectionBookmark","_command","_ui","queryCommandEnabled","listParent","customCode","editingHost","selectNodeContents","alignStates","Undo","Redo","internalContentEditableAttr","setContentEditable","switchOffContentEditableTrue","switchOnContentEditableTrue","removeFakeSelection","restoreFakeSelection","toggleReadOnly","registerFilters","registerReadOnlyContentFilters","isClickEvent","getAnchorHrefOpt","processReadonlyEvents","targetEl","registerReadOnlySelectionBlockers","nativeEvents","EventDispatcher","bindings","toggleEvent","isNative","lcName","beforeFire","once","wrappedCallback","currentName","bindingName","filteredHandlers","getEventDispatcher","_eventDispatcher","toggleNativeEvent","Observable","bubble","dispatcherArgs","DOM$2","customEventRootDelegates","getEventTarget","eventName","eventRoot","isListening","bindEventDelegate","delegate","delegates","eventRootElm","editors","EditorObservable","_pendingNativeEvents","defaultModes","switchToMode","activeMode","availableModes","oldMode","newMode","activate","deactivate","editorReadOnly","setMode","registerMode","create$4","design","each$3","explode$1","keyCodeLookup","f1","f2","f3","f4","f5","f6","f7","f8","f9","f10","f11","f12","modifierNames","parseShortcut","shortcut","charCode","access","alt","ctrl","meta","Shortcuts","pendingPatterns","hasModifier","isFunctionKey","matchShortcut","subpatterns","executeShortcutAction","desc","cmdFunc","normalizeCommandFunc","createShortcut","create$3","buttons","menuItems","popups","contextMenus","contextToolbars","sidebars","addButton","addGroupToolbarButton","addToggleButton","addMenuButton","addSplitButton","addMenuItem","addNestedMenuItem","addToggleMenuItem","addAutocompleter","addContextMenu","addContextToolbar","addContextForm","addSidebar","bridge","DOM$1","extend$3","each$2","Editor","loadedCSS","isNotDirty","documentBaseURL","base_url","_setBaseUrl","baseURI","referrer_policy","language_load","editorCommands","cache_suffix","modeInstance","callbackLookup","initialContent","oldState","urlconverter_callback","_scanForImages","each$1","extend$2","instanceCounter","boundGlobalEvents","beforeUnloadDelegate","legacyEditors","isValidLegacyKey","globalEventDelegate","EditorManager","toggleGlobalEvents","removeEditorFromList","targetEditor","oldEditors","purgeDestroyedEditor","isQuirksMode","compatMode","majorVersion","minorVersion","releaseDate","i18n","tinymce","tinyMCEPreInit","srcScript","currentScript","pluginBaseUrls","plugin_base_urls","pluginBaseUrl","invalidInlineTargets","isInvalidInlineTarget","createId","findTargets","forms","editor_deselector","editor_selector","provideResults","initEditors","initCount","createEditor","existingEditor","addI18n","min$1","max$1","round$1","relativePosition","targetW","targetH","relChars","create$2","findBestRelativePosition","constrainRect","rels","inflate","intersect","cropRect","x1","y1","clamp","clampRect","fixedSize","cx2","cy2","underflowX1","underflowY1","overflowX2","overflowY2","fromClientRect","Rect","awaiter","resolveCb","rejectCb","complete","completer","create$1","tasks","resultFns","loadErrMsg","runErrMsg","task","waiter","Resource","extend$1","extendClass","initializing","Class","_super","mixins","mixin","Mixins","dummy","createMethod","Methods","Properties","fieldName","Statics","Defaults","member","Color","rgb2hsv","minRGB","maxRGB","hsvToRgb","hue","saturation","brightness","side","chroma","toRgb","toHsv","stringify","hexCode","JSONUtils","JSONP","XHR","ready","async","success_scope","error_scope","overrideMimeType","content_type","crossDomain","setRequestHeader","requestheaders","JSONRequest","sendRPC","ecb","scb","xhrArgs","method","storage","getItem","setItem","removeItem","defineProperty","configurable","enumerable","localStorage","LocalStorage","publicApi","geom","util","TreeWalker","Serializer","Selection","isMac","exportToModuleLoaders","exportToWindowGlobal","tinyMCE"],"mappings":"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","sourcesContent":["/**\n * Copyright (c) Tiny Technologies, Inc. All rights reserved.\n * Licensed under the LGPL or a commercial license.\n * For LGPL see License.txt in the project root for license information.\n * For commercial licenses see https://www.tiny.cloud/\n *\n * Version: 5.10.3 (2022-02-09)\n */\n(function () {\n    'use strict';\n\n    var typeOf$1 = function (x) {\n      if (x === null) {\n        return 'null';\n      }\n      if (x === undefined) {\n        return 'undefined';\n      }\n      var t = typeof x;\n      if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      }\n      if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      }\n      return t;\n    };\n    var isEquatableType = function (x) {\n      return [\n        'undefined',\n        'boolean',\n        'number',\n        'string',\n        'function',\n        'xml',\n        'null'\n      ].indexOf(x) !== -1;\n    };\n\n    var sort$1 = function (xs, compareFn) {\n      var clone = Array.prototype.slice.call(xs);\n      return clone.sort(compareFn);\n    };\n\n    var contramap = function (eqa, f) {\n      return eq$2(function (x, y) {\n        return eqa.eq(f(x), f(y));\n      });\n    };\n    var eq$2 = function (f) {\n      return { eq: f };\n    };\n    var tripleEq = eq$2(function (x, y) {\n      return x === y;\n    });\n    var eqString = tripleEq;\n    var eqArray = function (eqa) {\n      return eq$2(function (x, y) {\n        if (x.length !== y.length) {\n          return false;\n        }\n        var len = x.length;\n        for (var i = 0; i < len; i++) {\n          if (!eqa.eq(x[i], y[i])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqSortedArray = function (eqa, compareFn) {\n      return contramap(eqArray(eqa), function (xs) {\n        return sort$1(xs, compareFn);\n      });\n    };\n    var eqRecord = function (eqa) {\n      return eq$2(function (x, y) {\n        var kx = Object.keys(x);\n        var ky = Object.keys(y);\n        if (!eqSortedArray(eqString).eq(kx, ky)) {\n          return false;\n        }\n        var len = kx.length;\n        for (var i = 0; i < len; i++) {\n          var q = kx[i];\n          if (!eqa.eq(x[q], y[q])) {\n            return false;\n          }\n        }\n        return true;\n      });\n    };\n    var eqAny = eq$2(function (x, y) {\n      if (x === y) {\n        return true;\n      }\n      var tx = typeOf$1(x);\n      var ty = typeOf$1(y);\n      if (tx !== ty) {\n        return false;\n      }\n      if (isEquatableType(tx)) {\n        return x === y;\n      } else if (tx === 'array') {\n        return eqArray(eqAny).eq(x, y);\n      } else if (tx === 'object') {\n        return eqRecord(eqAny).eq(x, y);\n      }\n      return false;\n    });\n\n    var typeOf = function (x) {\n      var t = typeof x;\n      if (x === null) {\n        return 'null';\n      } else if (t === 'object' && (Array.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'Array')) {\n        return 'array';\n      } else if (t === 'object' && (String.prototype.isPrototypeOf(x) || x.constructor && x.constructor.name === 'String')) {\n        return 'string';\n      } else {\n        return t;\n      }\n    };\n    var isType$1 = function (type) {\n      return function (value) {\n        return typeOf(value) === type;\n      };\n    };\n    var isSimpleType = function (type) {\n      return function (value) {\n        return typeof value === type;\n      };\n    };\n    var eq$1 = function (t) {\n      return function (a) {\n        return t === a;\n      };\n    };\n    var isString$1 = isType$1('string');\n    var isObject = isType$1('object');\n    var isArray$1 = isType$1('array');\n    var isNull = eq$1(null);\n    var isBoolean = isSimpleType('boolean');\n    var isUndefined = eq$1(undefined);\n    var isNullable = function (a) {\n      return a === null || a === undefined;\n    };\n    var isNonNullable = function (a) {\n      return !isNullable(a);\n    };\n    var isFunction = isSimpleType('function');\n    var isNumber = isSimpleType('number');\n\n    var noop = function () {\n    };\n    var compose = function (fa, fb) {\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        return fa(fb.apply(null, args));\n      };\n    };\n    var compose1 = function (fbc, fab) {\n      return function (a) {\n        return fbc(fab(a));\n      };\n    };\n    var constant = function (value) {\n      return function () {\n        return value;\n      };\n    };\n    var identity = function (x) {\n      return x;\n    };\n    var tripleEquals = function (a, b) {\n      return a === b;\n    };\n    function curry(fn) {\n      var initialArgs = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        initialArgs[_i - 1] = arguments[_i];\n      }\n      return function () {\n        var restArgs = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          restArgs[_i] = arguments[_i];\n        }\n        var all = initialArgs.concat(restArgs);\n        return fn.apply(null, all);\n      };\n    }\n    var not = function (f) {\n      return function (t) {\n        return !f(t);\n      };\n    };\n    var die = function (msg) {\n      return function () {\n        throw new Error(msg);\n      };\n    };\n    var apply = function (f) {\n      return f();\n    };\n    var call = function (f) {\n      f();\n    };\n    var never = constant(false);\n    var always = constant(true);\n\n    var none = function () {\n      return NONE;\n    };\n    var NONE = function () {\n      var call = function (thunk) {\n        return thunk();\n      };\n      var id = identity;\n      var me = {\n        fold: function (n, _s) {\n          return n();\n        },\n        isSome: never,\n        isNone: always,\n        getOr: id,\n        getOrThunk: call,\n        getOrDie: function (msg) {\n          throw new Error(msg || 'error: getOrDie called on none.');\n        },\n        getOrNull: constant(null),\n        getOrUndefined: constant(undefined),\n        or: id,\n        orThunk: call,\n        map: none,\n        each: noop,\n        bind: none,\n        exists: never,\n        forall: always,\n        filter: function () {\n          return none();\n        },\n        toArray: function () {\n          return [];\n        },\n        toString: constant('none()')\n      };\n      return me;\n    }();\n    var some = function (a) {\n      var constant_a = constant(a);\n      var self = function () {\n        return me;\n      };\n      var bind = function (f) {\n        return f(a);\n      };\n      var me = {\n        fold: function (n, s) {\n          return s(a);\n        },\n        isSome: always,\n        isNone: never,\n        getOr: constant_a,\n        getOrThunk: constant_a,\n        getOrDie: constant_a,\n        getOrNull: constant_a,\n        getOrUndefined: constant_a,\n        or: self,\n        orThunk: self,\n        map: function (f) {\n          return some(f(a));\n        },\n        each: function (f) {\n          f(a);\n        },\n        bind: bind,\n        exists: bind,\n        forall: bind,\n        filter: function (f) {\n          return f(a) ? me : NONE;\n        },\n        toArray: function () {\n          return [a];\n        },\n        toString: function () {\n          return 'some(' + a + ')';\n        }\n      };\n      return me;\n    };\n    var from$1 = function (value) {\n      return value === null || value === undefined ? NONE : some(value);\n    };\n    var Optional = {\n      some: some,\n      none: none,\n      from: from$1\n    };\n\n    var nativeSlice = Array.prototype.slice;\n    var nativeIndexOf = Array.prototype.indexOf;\n    var nativePush = Array.prototype.push;\n    var rawIndexOf = function (ts, t) {\n      return nativeIndexOf.call(ts, t);\n    };\n    var indexOf$2 = function (xs, x) {\n      var r = rawIndexOf(xs, x);\n      return r === -1 ? Optional.none() : Optional.some(r);\n    };\n    var contains$3 = function (xs, x) {\n      return rawIndexOf(xs, x) > -1;\n    };\n    var exists = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var map$3 = function (xs, f) {\n      var len = xs.length;\n      var r = new Array(len);\n      for (var i = 0; i < len; i++) {\n        var x = xs[i];\n        r[i] = f(x, i);\n      }\n      return r;\n    };\n    var each$k = function (xs, f) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var eachr = function (xs, f) {\n      for (var i = xs.length - 1; i >= 0; i--) {\n        var x = xs[i];\n        f(x, i);\n      }\n    };\n    var partition = function (xs, pred) {\n      var pass = [];\n      var fail = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        var arr = pred(x, i) ? pass : fail;\n        arr.push(x);\n      }\n      return {\n        pass: pass,\n        fail: fail\n      };\n    };\n    var filter$4 = function (xs, pred) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          r.push(x);\n        }\n      }\n      return r;\n    };\n    var foldr = function (xs, f, acc) {\n      eachr(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var foldl = function (xs, f, acc) {\n      each$k(xs, function (x, i) {\n        acc = f(acc, x, i);\n      });\n      return acc;\n    };\n    var findUntil$1 = function (xs, pred, until) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(x);\n        } else if (until(x, i)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var find$3 = function (xs, pred) {\n      return findUntil$1(xs, pred, never);\n    };\n    var findIndex$2 = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        if (pred(x, i)) {\n          return Optional.some(i);\n        }\n      }\n      return Optional.none();\n    };\n    var flatten = function (xs) {\n      var r = [];\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        if (!isArray$1(xs[i])) {\n          throw new Error('Arr.flatten item ' + i + ' was not an array, input: ' + xs);\n        }\n        nativePush.apply(r, xs[i]);\n      }\n      return r;\n    };\n    var bind = function (xs, f) {\n      return flatten(map$3(xs, f));\n    };\n    var forall = function (xs, pred) {\n      for (var i = 0, len = xs.length; i < len; ++i) {\n        var x = xs[i];\n        if (pred(x, i) !== true) {\n          return false;\n        }\n      }\n      return true;\n    };\n    var reverse = function (xs) {\n      var r = nativeSlice.call(xs, 0);\n      r.reverse();\n      return r;\n    };\n    var difference = function (a1, a2) {\n      return filter$4(a1, function (x) {\n        return !contains$3(a2, x);\n      });\n    };\n    var mapToObject = function (xs, f) {\n      var r = {};\n      for (var i = 0, len = xs.length; i < len; i++) {\n        var x = xs[i];\n        r[String(x)] = f(x, i);\n      }\n      return r;\n    };\n    var sort = function (xs, comparator) {\n      var copy = nativeSlice.call(xs, 0);\n      copy.sort(comparator);\n      return copy;\n    };\n    var get$a = function (xs, i) {\n      return i >= 0 && i < xs.length ? Optional.some(xs[i]) : Optional.none();\n    };\n    var head = function (xs) {\n      return get$a(xs, 0);\n    };\n    var last$2 = function (xs) {\n      return get$a(xs, xs.length - 1);\n    };\n    var from = isFunction(Array.from) ? Array.from : function (x) {\n      return nativeSlice.call(x);\n    };\n    var findMap = function (arr, f) {\n      for (var i = 0; i < arr.length; i++) {\n        var r = f(arr[i], i);\n        if (r.isSome()) {\n          return r;\n        }\n      }\n      return Optional.none();\n    };\n\n    var keys = Object.keys;\n    var hasOwnProperty$1 = Object.hasOwnProperty;\n    var each$j = function (obj, f) {\n      var props = keys(obj);\n      for (var k = 0, len = props.length; k < len; k++) {\n        var i = props[k];\n        var x = obj[i];\n        f(x, i);\n      }\n    };\n    var map$2 = function (obj, f) {\n      return tupleMap(obj, function (x, i) {\n        return {\n          k: i,\n          v: f(x, i)\n        };\n      });\n    };\n    var tupleMap = function (obj, f) {\n      var r = {};\n      each$j(obj, function (x, i) {\n        var tuple = f(x, i);\n        r[tuple.k] = tuple.v;\n      });\n      return r;\n    };\n    var objAcc = function (r) {\n      return function (x, i) {\n        r[i] = x;\n      };\n    };\n    var internalFilter = function (obj, pred, onTrue, onFalse) {\n      var r = {};\n      each$j(obj, function (x, i) {\n        (pred(x, i) ? onTrue : onFalse)(x, i);\n      });\n      return r;\n    };\n    var bifilter = function (obj, pred) {\n      var t = {};\n      var f = {};\n      internalFilter(obj, pred, objAcc(t), objAcc(f));\n      return {\n        t: t,\n        f: f\n      };\n    };\n    var filter$3 = function (obj, pred) {\n      var t = {};\n      internalFilter(obj, pred, objAcc(t), noop);\n      return t;\n    };\n    var mapToArray = function (obj, f) {\n      var r = [];\n      each$j(obj, function (value, name) {\n        r.push(f(value, name));\n      });\n      return r;\n    };\n    var values = function (obj) {\n      return mapToArray(obj, identity);\n    };\n    var get$9 = function (obj, key) {\n      return has$2(obj, key) ? Optional.from(obj[key]) : Optional.none();\n    };\n    var has$2 = function (obj, key) {\n      return hasOwnProperty$1.call(obj, key);\n    };\n    var hasNonNullableKey = function (obj, key) {\n      return has$2(obj, key) && obj[key] !== undefined && obj[key] !== null;\n    };\n    var equal$1 = function (a1, a2, eq) {\n      if (eq === void 0) {\n        eq = eqAny;\n      }\n      return eqRecord(eq).eq(a1, a2);\n    };\n\n    var isArray = Array.isArray;\n    var toArray$1 = function (obj) {\n      if (!isArray(obj)) {\n        var array = [];\n        for (var i = 0, l = obj.length; i < l; i++) {\n          array[i] = obj[i];\n        }\n        return array;\n      } else {\n        return obj;\n      }\n    };\n    var each$i = function (o, cb, s) {\n      var n, l;\n      if (!o) {\n        return false;\n      }\n      s = s || o;\n      if (o.length !== undefined) {\n        for (n = 0, l = o.length; n < l; n++) {\n          if (cb.call(s, o[n], n, o) === false) {\n            return false;\n          }\n        }\n      } else {\n        for (n in o) {\n          if (has$2(o, n)) {\n            if (cb.call(s, o[n], n, o) === false) {\n              return false;\n            }\n          }\n        }\n      }\n      return true;\n    };\n    var map$1 = function (array, callback) {\n      var out = [];\n      each$i(array, function (item, index) {\n        out.push(callback(item, index, array));\n      });\n      return out;\n    };\n    var filter$2 = function (a, f) {\n      var o = [];\n      each$i(a, function (v, index) {\n        if (!f || f(v, index, a)) {\n          o.push(v);\n        }\n      });\n      return o;\n    };\n    var indexOf$1 = function (a, v) {\n      if (a) {\n        for (var i = 0, l = a.length; i < l; i++) {\n          if (a[i] === v) {\n            return i;\n          }\n        }\n      }\n      return -1;\n    };\n    var reduce = function (collection, iteratee, accumulator, thisArg) {\n      var acc = isUndefined(accumulator) ? collection[0] : accumulator;\n      for (var i = 0; i < collection.length; i++) {\n        acc = iteratee.call(thisArg, acc, collection[i], i);\n      }\n      return acc;\n    };\n    var findIndex$1 = function (array, predicate, thisArg) {\n      var i, l;\n      for (i = 0, l = array.length; i < l; i++) {\n        if (predicate.call(thisArg, array[i], i, array)) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var last$1 = function (collection) {\n      return collection[collection.length - 1];\n    };\n\n    var __assign = function () {\n      __assign = Object.assign || function __assign(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s)\n            if (Object.prototype.hasOwnProperty.call(s, p))\n              t[p] = s[p];\n        }\n        return t;\n      };\n      return __assign.apply(this, arguments);\n    };\n    function __rest(s, e) {\n      var t = {};\n      for (var p in s)\n        if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n          t[p] = s[p];\n      if (s != null && typeof Object.getOwnPropertySymbols === 'function')\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n            t[p[i]] = s[p[i]];\n        }\n      return t;\n    }\n    function __spreadArray(to, from, pack) {\n      if (pack || arguments.length === 2)\n        for (var i = 0, l = from.length, ar; i < l; i++) {\n          if (ar || !(i in from)) {\n            if (!ar)\n              ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n          }\n        }\n      return to.concat(ar || Array.prototype.slice.call(from));\n    }\n\n    var cached = function (f) {\n      var called = false;\n      var r;\n      return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!called) {\n          called = true;\n          r = f.apply(null, args);\n        }\n        return r;\n      };\n    };\n\n    var DeviceType = function (os, browser, userAgent, mediaMatch) {\n      var isiPad = os.isiOS() && /ipad/i.test(userAgent) === true;\n      var isiPhone = os.isiOS() && !isiPad;\n      var isMobile = os.isiOS() || os.isAndroid();\n      var isTouch = isMobile || mediaMatch('(pointer:coarse)');\n      var isTablet = isiPad || !isiPhone && isMobile && mediaMatch('(min-device-width:768px)');\n      var isPhone = isiPhone || isMobile && !isTablet;\n      var iOSwebview = browser.isSafari() && os.isiOS() && /safari/i.test(userAgent) === false;\n      var isDesktop = !isPhone && !isTablet && !iOSwebview;\n      return {\n        isiPad: constant(isiPad),\n        isiPhone: constant(isiPhone),\n        isTablet: constant(isTablet),\n        isPhone: constant(isPhone),\n        isTouch: constant(isTouch),\n        isAndroid: os.isAndroid,\n        isiOS: os.isiOS,\n        isWebView: constant(iOSwebview),\n        isDesktop: constant(isDesktop)\n      };\n    };\n\n    var firstMatch = function (regexes, s) {\n      for (var i = 0; i < regexes.length; i++) {\n        var x = regexes[i];\n        if (x.test(s)) {\n          return x;\n        }\n      }\n      return undefined;\n    };\n    var find$2 = function (regexes, agent) {\n      var r = firstMatch(regexes, agent);\n      if (!r) {\n        return {\n          major: 0,\n          minor: 0\n        };\n      }\n      var group = function (i) {\n        return Number(agent.replace(r, '$' + i));\n      };\n      return nu$4(group(1), group(2));\n    };\n    var detect$3 = function (versionRegexes, agent) {\n      var cleanedAgent = String(agent).toLowerCase();\n      if (versionRegexes.length === 0) {\n        return unknown$2();\n      }\n      return find$2(versionRegexes, cleanedAgent);\n    };\n    var unknown$2 = function () {\n      return nu$4(0, 0);\n    };\n    var nu$4 = function (major, minor) {\n      return {\n        major: major,\n        minor: minor\n      };\n    };\n    var Version = {\n      nu: nu$4,\n      detect: detect$3,\n      unknown: unknown$2\n    };\n\n    var detectBrowser$1 = function (browsers, userAgentData) {\n      return findMap(userAgentData.brands, function (uaBrand) {\n        var lcBrand = uaBrand.brand.toLowerCase();\n        return find$3(browsers, function (browser) {\n          var _a;\n          return lcBrand === ((_a = browser.brand) === null || _a === void 0 ? void 0 : _a.toLowerCase());\n        }).map(function (info) {\n          return {\n            current: info.name,\n            version: Version.nu(parseInt(uaBrand.version, 10), 0)\n          };\n        });\n      });\n    };\n\n    var detect$2 = function (candidates, userAgent) {\n      var agent = String(userAgent).toLowerCase();\n      return find$3(candidates, function (candidate) {\n        return candidate.search(agent);\n      });\n    };\n    var detectBrowser = function (browsers, userAgent) {\n      return detect$2(browsers, userAgent).map(function (browser) {\n        var version = Version.detect(browser.versionRegexes, userAgent);\n        return {\n          current: browser.name,\n          version: version\n        };\n      });\n    };\n    var detectOs = function (oses, userAgent) {\n      return detect$2(oses, userAgent).map(function (os) {\n        var version = Version.detect(os.versionRegexes, userAgent);\n        return {\n          current: os.name,\n          version: version\n        };\n      });\n    };\n\n    var removeFromStart = function (str, numChars) {\n      return str.substring(numChars);\n    };\n\n    var checkRange = function (str, substr, start) {\n      return substr === '' || str.length >= substr.length && str.substr(start, start + substr.length) === substr;\n    };\n    var removeLeading = function (str, prefix) {\n      return startsWith(str, prefix) ? removeFromStart(str, prefix.length) : str;\n    };\n    var contains$2 = function (str, substr) {\n      return str.indexOf(substr) !== -1;\n    };\n    var startsWith = function (str, prefix) {\n      return checkRange(str, prefix, 0);\n    };\n    var blank = function (r) {\n      return function (s) {\n        return s.replace(r, '');\n      };\n    };\n    var trim$4 = blank(/^\\s+|\\s+$/g);\n    var lTrim = blank(/^\\s+/g);\n    var rTrim = blank(/\\s+$/g);\n    var isNotEmpty = function (s) {\n      return s.length > 0;\n    };\n    var isEmpty$3 = function (s) {\n      return !isNotEmpty(s);\n    };\n\n    var normalVersionRegex = /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/;\n    var checkContains = function (target) {\n      return function (uastring) {\n        return contains$2(uastring, target);\n      };\n    };\n    var browsers = [\n      {\n        name: 'Edge',\n        versionRegexes: [/.*?edge\\/ ?([0-9]+)\\.([0-9]+)$/],\n        search: function (uastring) {\n          return contains$2(uastring, 'edge/') && contains$2(uastring, 'chrome') && contains$2(uastring, 'safari') && contains$2(uastring, 'applewebkit');\n        }\n      },\n      {\n        name: 'Chrome',\n        brand: 'Chromium',\n        versionRegexes: [\n          /.*?chrome\\/([0-9]+)\\.([0-9]+).*/,\n          normalVersionRegex\n        ],\n        search: function (uastring) {\n          return contains$2(uastring, 'chrome') && !contains$2(uastring, 'chromeframe');\n        }\n      },\n      {\n        name: 'IE',\n        versionRegexes: [\n          /.*?msie\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*?rv:([0-9]+)\\.([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return contains$2(uastring, 'msie') || contains$2(uastring, 'trident');\n        }\n      },\n      {\n        name: 'Opera',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?opera\\/([0-9]+)\\.([0-9]+).*/\n        ],\n        search: checkContains('opera')\n      },\n      {\n        name: 'Firefox',\n        versionRegexes: [/.*?firefox\\/\\ ?([0-9]+)\\.([0-9]+).*/],\n        search: checkContains('firefox')\n      },\n      {\n        name: 'Safari',\n        versionRegexes: [\n          normalVersionRegex,\n          /.*?cpu os ([0-9]+)_([0-9]+).*/\n        ],\n        search: function (uastring) {\n          return (contains$2(uastring, 'safari') || contains$2(uastring, 'mobile/')) && contains$2(uastring, 'applewebkit');\n        }\n      }\n    ];\n    var oses = [\n      {\n        name: 'Windows',\n        search: checkContains('win'),\n        versionRegexes: [/.*?windows\\ nt\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'iOS',\n        search: function (uastring) {\n          return contains$2(uastring, 'iphone') || contains$2(uastring, 'ipad');\n        },\n        versionRegexes: [\n          /.*?version\\/\\ ?([0-9]+)\\.([0-9]+).*/,\n          /.*cpu os ([0-9]+)_([0-9]+).*/,\n          /.*cpu iphone os ([0-9]+)_([0-9]+).*/\n        ]\n      },\n      {\n        name: 'Android',\n        search: checkContains('android'),\n        versionRegexes: [/.*?android\\ ?([0-9]+)\\.([0-9]+).*/]\n      },\n      {\n        name: 'OSX',\n        search: checkContains('mac os x'),\n        versionRegexes: [/.*?mac\\ os\\ x\\ ?([0-9]+)_([0-9]+).*/]\n      },\n      {\n        name: 'Linux',\n        search: checkContains('linux'),\n        versionRegexes: []\n      },\n      {\n        name: 'Solaris',\n        search: checkContains('sunos'),\n        versionRegexes: []\n      },\n      {\n        name: 'FreeBSD',\n        search: checkContains('freebsd'),\n        versionRegexes: []\n      },\n      {\n        name: 'ChromeOS',\n        search: checkContains('cros'),\n        versionRegexes: [/.*?chrome\\/([0-9]+)\\.([0-9]+).*/]\n      }\n    ];\n    var PlatformInfo = {\n      browsers: constant(browsers),\n      oses: constant(oses)\n    };\n\n    var edge = 'Edge';\n    var chrome = 'Chrome';\n    var ie$1 = 'IE';\n    var opera = 'Opera';\n    var firefox = 'Firefox';\n    var safari = 'Safari';\n    var unknown$1 = function () {\n      return nu$3({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$3 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isBrowser = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isEdge: isBrowser(edge),\n        isChrome: isBrowser(chrome),\n        isIE: isBrowser(ie$1),\n        isOpera: isBrowser(opera),\n        isFirefox: isBrowser(firefox),\n        isSafari: isBrowser(safari)\n      };\n    };\n    var Browser = {\n      unknown: unknown$1,\n      nu: nu$3,\n      edge: constant(edge),\n      chrome: constant(chrome),\n      ie: constant(ie$1),\n      opera: constant(opera),\n      firefox: constant(firefox),\n      safari: constant(safari)\n    };\n\n    var windows = 'Windows';\n    var ios = 'iOS';\n    var android = 'Android';\n    var linux = 'Linux';\n    var osx = 'OSX';\n    var solaris = 'Solaris';\n    var freebsd = 'FreeBSD';\n    var chromeos = 'ChromeOS';\n    var unknown = function () {\n      return nu$2({\n        current: undefined,\n        version: Version.unknown()\n      });\n    };\n    var nu$2 = function (info) {\n      var current = info.current;\n      var version = info.version;\n      var isOS = function (name) {\n        return function () {\n          return current === name;\n        };\n      };\n      return {\n        current: current,\n        version: version,\n        isWindows: isOS(windows),\n        isiOS: isOS(ios),\n        isAndroid: isOS(android),\n        isOSX: isOS(osx),\n        isLinux: isOS(linux),\n        isSolaris: isOS(solaris),\n        isFreeBSD: isOS(freebsd),\n        isChromeOS: isOS(chromeos)\n      };\n    };\n    var OperatingSystem = {\n      unknown: unknown,\n      nu: nu$2,\n      windows: constant(windows),\n      ios: constant(ios),\n      android: constant(android),\n      linux: constant(linux),\n      osx: constant(osx),\n      solaris: constant(solaris),\n      freebsd: constant(freebsd),\n      chromeos: constant(chromeos)\n    };\n\n    var detect$1 = function (userAgent, userAgentDataOpt, mediaMatch) {\n      var browsers = PlatformInfo.browsers();\n      var oses = PlatformInfo.oses();\n      var browser = userAgentDataOpt.bind(function (userAgentData) {\n        return detectBrowser$1(browsers, userAgentData);\n      }).orThunk(function () {\n        return detectBrowser(browsers, userAgent);\n      }).fold(Browser.unknown, Browser.nu);\n      var os = detectOs(oses, userAgent).fold(OperatingSystem.unknown, OperatingSystem.nu);\n      var deviceType = DeviceType(os, browser, userAgent, mediaMatch);\n      return {\n        browser: browser,\n        os: os,\n        deviceType: deviceType\n      };\n    };\n    var PlatformDetection = { detect: detect$1 };\n\n    var mediaMatch = function (query) {\n      return window.matchMedia(query).matches;\n    };\n    var platform$2 = cached(function () {\n      return PlatformDetection.detect(navigator.userAgent, Optional.from(navigator.userAgentData), mediaMatch);\n    });\n    var detect = function () {\n      return platform$2();\n    };\n\n    var userAgent = navigator.userAgent;\n    var platform$1 = detect();\n    var browser$4 = platform$1.browser;\n    var os = platform$1.os;\n    var deviceType = platform$1.deviceType;\n    var webkit = /WebKit/.test(userAgent) && !browser$4.isEdge();\n    var fileApi = 'FormData' in window && 'FileReader' in window && 'URL' in window && !!URL.createObjectURL;\n    var windowsPhone = userAgent.indexOf('Windows Phone') !== -1;\n    var Env = {\n      opera: browser$4.isOpera(),\n      webkit: webkit,\n      ie: browser$4.isIE() || browser$4.isEdge() ? browser$4.version.major : false,\n      gecko: browser$4.isFirefox(),\n      mac: os.isOSX() || os.isiOS(),\n      iOS: deviceType.isiPad() || deviceType.isiPhone(),\n      android: os.isAndroid(),\n      contentEditable: true,\n      transparentSrc: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n      caretAfter: true,\n      range: window.getSelection && 'Range' in window,\n      documentMode: browser$4.isIE() ? document.documentMode || 7 : 10,\n      fileApi: fileApi,\n      ceFalse: true,\n      cacheSuffix: null,\n      container: null,\n      experimentalShadowDom: false,\n      canHaveCSP: !browser$4.isIE(),\n      desktop: deviceType.isDesktop(),\n      windowsPhone: windowsPhone,\n      browser: {\n        current: browser$4.current,\n        version: browser$4.version,\n        isChrome: browser$4.isChrome,\n        isEdge: browser$4.isEdge,\n        isFirefox: browser$4.isFirefox,\n        isIE: browser$4.isIE,\n        isOpera: browser$4.isOpera,\n        isSafari: browser$4.isSafari\n      },\n      os: {\n        current: os.current,\n        version: os.version,\n        isAndroid: os.isAndroid,\n        isChromeOS: os.isChromeOS,\n        isFreeBSD: os.isFreeBSD,\n        isiOS: os.isiOS,\n        isLinux: os.isLinux,\n        isOSX: os.isOSX,\n        isSolaris: os.isSolaris,\n        isWindows: os.isWindows\n      },\n      deviceType: {\n        isDesktop: deviceType.isDesktop,\n        isiPad: deviceType.isiPad,\n        isiPhone: deviceType.isiPhone,\n        isPhone: deviceType.isPhone,\n        isTablet: deviceType.isTablet,\n        isTouch: deviceType.isTouch,\n        isWebView: deviceType.isWebView\n      }\n    };\n\n    var whiteSpaceRegExp$2 = /^\\s*|\\s*$/g;\n    var trim$3 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp$2, '');\n    };\n    var is$3 = function (obj, type) {\n      if (!type) {\n        return obj !== undefined;\n      }\n      if (type === 'array' && isArray(obj)) {\n        return true;\n      }\n      return typeof obj === type;\n    };\n    var makeMap$4 = function (items, delim, map) {\n      var i;\n      items = items || [];\n      delim = delim || ',';\n      if (typeof items === 'string') {\n        items = items.split(delim);\n      }\n      map = map || {};\n      i = items.length;\n      while (i--) {\n        map[items[i]] = {};\n      }\n      return map;\n    };\n    var hasOwnProperty = has$2;\n    var create$9 = function (s, p, root) {\n      var self = this;\n      var sp, scn, c, de = 0;\n      s = /^((static) )?([\\w.]+)(:([\\w.]+))?/.exec(s);\n      var cn = s[3].match(/(^|\\.)(\\w+)$/i)[2];\n      var ns = self.createNS(s[3].replace(/\\.\\w+$/, ''), root);\n      if (ns[cn]) {\n        return;\n      }\n      if (s[2] === 'static') {\n        ns[cn] = p;\n        if (this.onCreate) {\n          this.onCreate(s[2], s[3], ns[cn]);\n        }\n        return;\n      }\n      if (!p[cn]) {\n        p[cn] = function () {\n        };\n        de = 1;\n      }\n      ns[cn] = p[cn];\n      self.extend(ns[cn].prototype, p);\n      if (s[5]) {\n        sp = self.resolve(s[5]).prototype;\n        scn = s[5].match(/\\.(\\w+)$/i)[1];\n        c = ns[cn];\n        if (de) {\n          ns[cn] = function () {\n            return sp[scn].apply(this, arguments);\n          };\n        } else {\n          ns[cn] = function () {\n            this.parent = sp[scn];\n            return c.apply(this, arguments);\n          };\n        }\n        ns[cn].prototype[cn] = ns[cn];\n        self.each(sp, function (f, n) {\n          ns[cn].prototype[n] = sp[n];\n        });\n        self.each(p, function (f, n) {\n          if (sp[n]) {\n            ns[cn].prototype[n] = function () {\n              this.parent = sp[n];\n              return f.apply(this, arguments);\n            };\n          } else {\n            if (n !== cn) {\n              ns[cn].prototype[n] = f;\n            }\n          }\n        });\n      }\n      self.each(p.static, function (f, n) {\n        ns[cn][n] = f;\n      });\n    };\n    var extend$6 = function (obj) {\n      var exts = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        exts[_i - 1] = arguments[_i];\n      }\n      for (var i = 0; i < exts.length; i++) {\n        var ext = exts[i];\n        for (var name_1 in ext) {\n          if (has$2(ext, name_1)) {\n            var value = ext[name_1];\n            if (value !== undefined) {\n              obj[name_1] = value;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var walk$3 = function (o, f, n, s) {\n      s = s || this;\n      if (o) {\n        if (n) {\n          o = o[n];\n        }\n        each$i(o, function (o, i) {\n          if (f.call(s, o, i, n) === false) {\n            return false;\n          }\n          walk$3(o, f, n, s);\n        });\n      }\n    };\n    var createNS = function (n, o) {\n      var i, v;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0; i < n.length; i++) {\n        v = n[i];\n        if (!o[v]) {\n          o[v] = {};\n        }\n        o = o[v];\n      }\n      return o;\n    };\n    var resolve$3 = function (n, o) {\n      var i, l;\n      o = o || window;\n      n = n.split('.');\n      for (i = 0, l = n.length; i < l; i++) {\n        o = o[n[i]];\n        if (!o) {\n          break;\n        }\n      }\n      return o;\n    };\n    var explode$4 = function (s, d) {\n      if (!s || is$3(s, 'array')) {\n        return s;\n      }\n      return map$1(s.split(d || ','), trim$3);\n    };\n    var _addCacheSuffix = function (url) {\n      var cacheSuffix = Env.cacheSuffix;\n      if (cacheSuffix) {\n        url += (url.indexOf('?') === -1 ? '?' : '&') + cacheSuffix;\n      }\n      return url;\n    };\n    var Tools = {\n      trim: trim$3,\n      isArray: isArray,\n      is: is$3,\n      toArray: toArray$1,\n      makeMap: makeMap$4,\n      each: each$i,\n      map: map$1,\n      grep: filter$2,\n      inArray: indexOf$1,\n      hasOwn: hasOwnProperty,\n      extend: extend$6,\n      create: create$9,\n      walk: walk$3,\n      createNS: createNS,\n      resolve: resolve$3,\n      explode: explode$4,\n      _addCacheSuffix: _addCacheSuffix\n    };\n\n    var fromHtml$1 = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      if (!div.hasChildNodes() || div.childNodes.length > 1) {\n        console.error('HTML does not have a single root node', html);\n        throw new Error('HTML must have a single root node');\n      }\n      return fromDom$2(div.childNodes[0]);\n    };\n    var fromTag = function (tag, scope) {\n      var doc = scope || document;\n      var node = doc.createElement(tag);\n      return fromDom$2(node);\n    };\n    var fromText = function (text, scope) {\n      var doc = scope || document;\n      var node = doc.createTextNode(text);\n      return fromDom$2(node);\n    };\n    var fromDom$2 = function (node) {\n      if (node === null || node === undefined) {\n        throw new Error('Node cannot be null or undefined');\n      }\n      return { dom: node };\n    };\n    var fromPoint$1 = function (docElm, x, y) {\n      return Optional.from(docElm.dom.elementFromPoint(x, y)).map(fromDom$2);\n    };\n    var SugarElement = {\n      fromHtml: fromHtml$1,\n      fromTag: fromTag,\n      fromText: fromText,\n      fromDom: fromDom$2,\n      fromPoint: fromPoint$1\n    };\n\n    var toArray = function (target, f) {\n      var r = [];\n      var recurse = function (e) {\n        r.push(e);\n        return f(e);\n      };\n      var cur = f(target);\n      do {\n        cur = cur.bind(recurse);\n      } while (cur.isSome());\n      return r;\n    };\n\n    var compareDocumentPosition = function (a, b, match) {\n      return (a.compareDocumentPosition(b) & match) !== 0;\n    };\n    var documentPositionContainedBy = function (a, b) {\n      return compareDocumentPosition(a, b, Node.DOCUMENT_POSITION_CONTAINED_BY);\n    };\n\n    var COMMENT = 8;\n    var DOCUMENT = 9;\n    var DOCUMENT_FRAGMENT = 11;\n    var ELEMENT = 1;\n    var TEXT = 3;\n\n    var is$2 = function (element, selector) {\n      var dom = element.dom;\n      if (dom.nodeType !== ELEMENT) {\n        return false;\n      } else {\n        var elem = dom;\n        if (elem.matches !== undefined) {\n          return elem.matches(selector);\n        } else if (elem.msMatchesSelector !== undefined) {\n          return elem.msMatchesSelector(selector);\n        } else if (elem.webkitMatchesSelector !== undefined) {\n          return elem.webkitMatchesSelector(selector);\n        } else if (elem.mozMatchesSelector !== undefined) {\n          return elem.mozMatchesSelector(selector);\n        } else {\n          throw new Error('Browser lacks native selectors');\n        }\n      }\n    };\n    var bypassSelector = function (dom) {\n      return dom.nodeType !== ELEMENT && dom.nodeType !== DOCUMENT && dom.nodeType !== DOCUMENT_FRAGMENT || dom.childElementCount === 0;\n    };\n    var all = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? [] : map$3(base.querySelectorAll(selector), SugarElement.fromDom);\n    };\n    var one = function (selector, scope) {\n      var base = scope === undefined ? document : scope.dom;\n      return bypassSelector(base) ? Optional.none() : Optional.from(base.querySelector(selector)).map(SugarElement.fromDom);\n    };\n\n    var eq = function (e1, e2) {\n      return e1.dom === e2.dom;\n    };\n    var regularContains = function (e1, e2) {\n      var d1 = e1.dom;\n      var d2 = e2.dom;\n      return d1 === d2 ? false : d1.contains(d2);\n    };\n    var ieContains = function (e1, e2) {\n      return documentPositionContainedBy(e1.dom, e2.dom);\n    };\n    var contains$1 = function (e1, e2) {\n      return detect().browser.isIE() ? ieContains(e1, e2) : regularContains(e1, e2);\n    };\n\n    typeof window !== 'undefined' ? window : Function('return this;')();\n\n    var name = function (element) {\n      var r = element.dom.nodeName;\n      return r.toLowerCase();\n    };\n    var type = function (element) {\n      return element.dom.nodeType;\n    };\n    var isType = function (t) {\n      return function (element) {\n        return type(element) === t;\n      };\n    };\n    var isComment$1 = function (element) {\n      return type(element) === COMMENT || name(element) === '#comment';\n    };\n    var isElement$6 = isType(ELEMENT);\n    var isText$8 = isType(TEXT);\n    var isDocument$2 = isType(DOCUMENT);\n    var isDocumentFragment$1 = isType(DOCUMENT_FRAGMENT);\n    var isTag = function (tag) {\n      return function (e) {\n        return isElement$6(e) && name(e) === tag;\n      };\n    };\n\n    var owner$1 = function (element) {\n      return SugarElement.fromDom(element.dom.ownerDocument);\n    };\n    var documentOrOwner = function (dos) {\n      return isDocument$2(dos) ? dos : owner$1(dos);\n    };\n    var documentElement = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.documentElement);\n    };\n    var defaultView = function (element) {\n      return SugarElement.fromDom(documentOrOwner(element).dom.defaultView);\n    };\n    var parent = function (element) {\n      return Optional.from(element.dom.parentNode).map(SugarElement.fromDom);\n    };\n    var parents$1 = function (element, isRoot) {\n      var stop = isFunction(isRoot) ? isRoot : never;\n      var dom = element.dom;\n      var ret = [];\n      while (dom.parentNode !== null && dom.parentNode !== undefined) {\n        var rawParent = dom.parentNode;\n        var p = SugarElement.fromDom(rawParent);\n        ret.push(p);\n        if (stop(p) === true) {\n          break;\n        } else {\n          dom = rawParent;\n        }\n      }\n      return ret;\n    };\n    var siblings = function (element) {\n      var filterSelf = function (elements) {\n        return filter$4(elements, function (x) {\n          return !eq(element, x);\n        });\n      };\n      return parent(element).map(children).map(filterSelf).getOr([]);\n    };\n    var prevSibling = function (element) {\n      return Optional.from(element.dom.previousSibling).map(SugarElement.fromDom);\n    };\n    var nextSibling = function (element) {\n      return Optional.from(element.dom.nextSibling).map(SugarElement.fromDom);\n    };\n    var prevSiblings = function (element) {\n      return reverse(toArray(element, prevSibling));\n    };\n    var nextSiblings = function (element) {\n      return toArray(element, nextSibling);\n    };\n    var children = function (element) {\n      return map$3(element.dom.childNodes, SugarElement.fromDom);\n    };\n    var child$1 = function (element, index) {\n      var cs = element.dom.childNodes;\n      return Optional.from(cs[index]).map(SugarElement.fromDom);\n    };\n    var firstChild = function (element) {\n      return child$1(element, 0);\n    };\n    var lastChild = function (element) {\n      return child$1(element, element.dom.childNodes.length - 1);\n    };\n    var childNodesCount = function (element) {\n      return element.dom.childNodes.length;\n    };\n\n    var getHead = function (doc) {\n      var b = doc.dom.head;\n      if (b === null || b === undefined) {\n        throw new Error('Head is not available yet');\n      }\n      return SugarElement.fromDom(b);\n    };\n\n    var isShadowRoot = function (dos) {\n      return isDocumentFragment$1(dos) && isNonNullable(dos.dom.host);\n    };\n    var supported = isFunction(Element.prototype.attachShadow) && isFunction(Node.prototype.getRootNode);\n    var isSupported$1 = constant(supported);\n    var getRootNode = supported ? function (e) {\n      return SugarElement.fromDom(e.dom.getRootNode());\n    } : documentOrOwner;\n    var getStyleContainer = function (dos) {\n      return isShadowRoot(dos) ? dos : getHead(documentOrOwner(dos));\n    };\n    var getShadowRoot = function (e) {\n      var r = getRootNode(e);\n      return isShadowRoot(r) ? Optional.some(r) : Optional.none();\n    };\n    var getShadowHost = function (e) {\n      return SugarElement.fromDom(e.dom.host);\n    };\n    var getOriginalEventTarget = function (event) {\n      if (isSupported$1() && isNonNullable(event.target)) {\n        var el = SugarElement.fromDom(event.target);\n        if (isElement$6(el) && isOpenShadowHost(el)) {\n          if (event.composed && event.composedPath) {\n            var composedPath = event.composedPath();\n            if (composedPath) {\n              return head(composedPath);\n            }\n          }\n        }\n      }\n      return Optional.from(event.target);\n    };\n    var isOpenShadowHost = function (element) {\n      return isNonNullable(element.dom.shadowRoot);\n    };\n\n    var before$4 = function (marker, element) {\n      var parent$1 = parent(marker);\n      parent$1.each(function (v) {\n        v.dom.insertBefore(element.dom, marker.dom);\n      });\n    };\n    var after$3 = function (marker, element) {\n      var sibling = nextSibling(marker);\n      sibling.fold(function () {\n        var parent$1 = parent(marker);\n        parent$1.each(function (v) {\n          append$1(v, element);\n        });\n      }, function (v) {\n        before$4(v, element);\n      });\n    };\n    var prepend = function (parent, element) {\n      var firstChild$1 = firstChild(parent);\n      firstChild$1.fold(function () {\n        append$1(parent, element);\n      }, function (v) {\n        parent.dom.insertBefore(element.dom, v.dom);\n      });\n    };\n    var append$1 = function (parent, element) {\n      parent.dom.appendChild(element.dom);\n    };\n    var wrap$3 = function (element, wrapper) {\n      before$4(element, wrapper);\n      append$1(wrapper, element);\n    };\n\n    var before$3 = function (marker, elements) {\n      each$k(elements, function (x) {\n        before$4(marker, x);\n      });\n    };\n    var append = function (parent, elements) {\n      each$k(elements, function (x) {\n        append$1(parent, x);\n      });\n    };\n\n    var empty = function (element) {\n      element.dom.textContent = '';\n      each$k(children(element), function (rogue) {\n        remove$7(rogue);\n      });\n    };\n    var remove$7 = function (element) {\n      var dom = element.dom;\n      if (dom.parentNode !== null) {\n        dom.parentNode.removeChild(dom);\n      }\n    };\n    var unwrap = function (wrapper) {\n      var children$1 = children(wrapper);\n      if (children$1.length > 0) {\n        before$3(wrapper, children$1);\n      }\n      remove$7(wrapper);\n    };\n\n    var inBody = function (element) {\n      var dom = isText$8(element) ? element.dom.parentNode : element.dom;\n      if (dom === undefined || dom === null || dom.ownerDocument === null) {\n        return false;\n      }\n      var doc = dom.ownerDocument;\n      return getShadowRoot(SugarElement.fromDom(dom)).fold(function () {\n        return doc.body.contains(dom);\n      }, compose1(inBody, getShadowHost));\n    };\n\n    var r = function (left, top) {\n      var translate = function (x, y) {\n        return r(left + x, top + y);\n      };\n      return {\n        left: left,\n        top: top,\n        translate: translate\n      };\n    };\n    var SugarPosition = r;\n\n    var boxPosition = function (dom) {\n      var box = dom.getBoundingClientRect();\n      return SugarPosition(box.left, box.top);\n    };\n    var firstDefinedOrZero = function (a, b) {\n      if (a !== undefined) {\n        return a;\n      } else {\n        return b !== undefined ? b : 0;\n      }\n    };\n    var absolute = function (element) {\n      var doc = element.dom.ownerDocument;\n      var body = doc.body;\n      var win = doc.defaultView;\n      var html = doc.documentElement;\n      if (body === element.dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      var scrollTop = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageYOffset, html.scrollTop);\n      var scrollLeft = firstDefinedOrZero(win === null || win === void 0 ? void 0 : win.pageXOffset, html.scrollLeft);\n      var clientTop = firstDefinedOrZero(html.clientTop, body.clientTop);\n      var clientLeft = firstDefinedOrZero(html.clientLeft, body.clientLeft);\n      return viewport(element).translate(scrollLeft - clientLeft, scrollTop - clientTop);\n    };\n    var viewport = function (element) {\n      var dom = element.dom;\n      var doc = dom.ownerDocument;\n      var body = doc.body;\n      if (body === dom) {\n        return SugarPosition(body.offsetLeft, body.offsetTop);\n      }\n      if (!inBody(element)) {\n        return SugarPosition(0, 0);\n      }\n      return boxPosition(dom);\n    };\n\n    var get$8 = function (_DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var x = doc.body.scrollLeft || doc.documentElement.scrollLeft;\n      var y = doc.body.scrollTop || doc.documentElement.scrollTop;\n      return SugarPosition(x, y);\n    };\n    var to = function (x, y, _DOC) {\n      var doc = _DOC !== undefined ? _DOC.dom : document;\n      var win = doc.defaultView;\n      if (win) {\n        win.scrollTo(x, y);\n      }\n    };\n    var intoView = function (element, alignToTop) {\n      var isSafari = detect().browser.isSafari();\n      if (isSafari && isFunction(element.dom.scrollIntoViewIfNeeded)) {\n        element.dom.scrollIntoViewIfNeeded(false);\n      } else {\n        element.dom.scrollIntoView(alignToTop);\n      }\n    };\n\n    var get$7 = function (_win) {\n      var win = _win === undefined ? window : _win;\n      if (detect().browser.isFirefox()) {\n        return Optional.none();\n      } else {\n        return Optional.from(win['visualViewport']);\n      }\n    };\n    var bounds = function (x, y, width, height) {\n      return {\n        x: x,\n        y: y,\n        width: width,\n        height: height,\n        right: x + width,\n        bottom: y + height\n      };\n    };\n    var getBounds = function (_win) {\n      var win = _win === undefined ? window : _win;\n      var doc = win.document;\n      var scroll = get$8(SugarElement.fromDom(doc));\n      return get$7(win).fold(function () {\n        var html = win.document.documentElement;\n        var width = html.clientWidth;\n        var height = html.clientHeight;\n        return bounds(scroll.left, scroll.top, width, height);\n      }, function (visualViewport) {\n        return bounds(Math.max(visualViewport.pageLeft, scroll.left), Math.max(visualViewport.pageTop, scroll.top), visualViewport.width, visualViewport.height);\n      });\n    };\n\n    var isNodeType = function (type) {\n      return function (node) {\n        return !!node && node.nodeType === type;\n      };\n    };\n    var isRestrictedNode = function (node) {\n      return !!node && !Object.getPrototypeOf(node);\n    };\n    var isElement$5 = isNodeType(1);\n    var matchNodeNames = function (names) {\n      var lowercasedNames = names.map(function (s) {\n        return s.toLowerCase();\n      });\n      return function (node) {\n        if (node && node.nodeName) {\n          var nodeName = node.nodeName.toLowerCase();\n          return contains$3(lowercasedNames, nodeName);\n        }\n        return false;\n      };\n    };\n    var matchStyleValues = function (name, values) {\n      var items = values.toLowerCase().split(' ');\n      return function (node) {\n        if (isElement$5(node)) {\n          for (var i = 0; i < items.length; i++) {\n            var computed = node.ownerDocument.defaultView.getComputedStyle(node, null);\n            var cssValue = computed ? computed.getPropertyValue(name) : null;\n            if (cssValue === items[i]) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n    };\n    var hasAttribute = function (attrName) {\n      return function (node) {\n        return isElement$5(node) && node.hasAttribute(attrName);\n      };\n    };\n    var hasAttributeValue = function (attrName, attrValue) {\n      return function (node) {\n        return isElement$5(node) && node.getAttribute(attrName) === attrValue;\n      };\n    };\n    var isBogus$2 = function (node) {\n      return isElement$5(node) && node.hasAttribute('data-mce-bogus');\n    };\n    var isBogusAll$1 = function (node) {\n      return isElement$5(node) && node.getAttribute('data-mce-bogus') === 'all';\n    };\n    var isTable$3 = function (node) {\n      return isElement$5(node) && node.tagName === 'TABLE';\n    };\n    var hasContentEditableState = function (value) {\n      return function (node) {\n        if (isElement$5(node)) {\n          if (node.contentEditable === value) {\n            return true;\n          }\n          if (node.getAttribute('data-mce-contenteditable') === value) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var isTextareaOrInput = matchNodeNames([\n      'textarea',\n      'input'\n    ]);\n    var isText$7 = isNodeType(3);\n    var isComment = isNodeType(8);\n    var isDocument$1 = isNodeType(9);\n    var isDocumentFragment = isNodeType(11);\n    var isBr$5 = matchNodeNames(['br']);\n    var isImg = matchNodeNames(['img']);\n    var isContentEditableTrue$4 = hasContentEditableState('true');\n    var isContentEditableFalse$b = hasContentEditableState('false');\n    var isTableCell$5 = matchNodeNames([\n      'td',\n      'th'\n    ]);\n    var isMedia$2 = matchNodeNames([\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n\n    var is$1 = function (lhs, rhs, comparator) {\n      if (comparator === void 0) {\n        comparator = tripleEquals;\n      }\n      return lhs.exists(function (left) {\n        return comparator(left, rhs);\n      });\n    };\n    var cat = function (arr) {\n      var r = [];\n      var push = function (x) {\n        r.push(x);\n      };\n      for (var i = 0; i < arr.length; i++) {\n        arr[i].each(push);\n      }\n      return r;\n    };\n    var lift2 = function (oa, ob, f) {\n      return oa.isSome() && ob.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie())) : Optional.none();\n    };\n    var lift3 = function (oa, ob, oc, f) {\n      return oa.isSome() && ob.isSome() && oc.isSome() ? Optional.some(f(oa.getOrDie(), ob.getOrDie(), oc.getOrDie())) : Optional.none();\n    };\n    var someIf = function (b, a) {\n      return b ? Optional.some(a) : Optional.none();\n    };\n\n    var isSupported = function (dom) {\n      return dom.style !== undefined && isFunction(dom.style.getPropertyValue);\n    };\n\n    var rawSet = function (dom, key, value) {\n      if (isString$1(value) || isBoolean(value) || isNumber(value)) {\n        dom.setAttribute(key, value + '');\n      } else {\n        console.error('Invalid call to Attribute.set. Key ', key, ':: Value ', value, ':: Element ', dom);\n        throw new Error('Attribute value was not simple');\n      }\n    };\n    var set$1 = function (element, key, value) {\n      rawSet(element.dom, key, value);\n    };\n    var setAll$1 = function (element, attrs) {\n      var dom = element.dom;\n      each$j(attrs, function (v, k) {\n        rawSet(dom, k, v);\n      });\n    };\n    var get$6 = function (element, key) {\n      var v = element.dom.getAttribute(key);\n      return v === null ? undefined : v;\n    };\n    var getOpt = function (element, key) {\n      return Optional.from(get$6(element, key));\n    };\n    var has$1 = function (element, key) {\n      var dom = element.dom;\n      return dom && dom.hasAttribute ? dom.hasAttribute(key) : false;\n    };\n    var remove$6 = function (element, key) {\n      element.dom.removeAttribute(key);\n    };\n    var clone$3 = function (element) {\n      return foldl(element.dom.attributes, function (acc, attr) {\n        acc[attr.name] = attr.value;\n        return acc;\n      }, {});\n    };\n\n    var internalSet = function (dom, property, value) {\n      if (!isString$1(value)) {\n        console.error('Invalid call to CSS.set. Property ', property, ':: Value ', value, ':: Element ', dom);\n        throw new Error('CSS value must be a string: ' + value);\n      }\n      if (isSupported(dom)) {\n        dom.style.setProperty(property, value);\n      }\n    };\n    var setAll = function (element, css) {\n      var dom = element.dom;\n      each$j(css, function (v, k) {\n        internalSet(dom, k, v);\n      });\n    };\n    var get$5 = function (element, property) {\n      var dom = element.dom;\n      var styles = window.getComputedStyle(dom);\n      var r = styles.getPropertyValue(property);\n      return r === '' && !inBody(element) ? getUnsafeProperty(dom, property) : r;\n    };\n    var getUnsafeProperty = function (dom, property) {\n      return isSupported(dom) ? dom.style.getPropertyValue(property) : '';\n    };\n    var getRaw = function (element, property) {\n      var dom = element.dom;\n      var raw = getUnsafeProperty(dom, property);\n      return Optional.from(raw).filter(function (r) {\n        return r.length > 0;\n      });\n    };\n    var getAllRaw = function (element) {\n      var css = {};\n      var dom = element.dom;\n      if (isSupported(dom)) {\n        for (var i = 0; i < dom.style.length; i++) {\n          var ruleName = dom.style.item(i);\n          css[ruleName] = dom.style[ruleName];\n        }\n      }\n      return css;\n    };\n    var reflow = function (e) {\n      return e.dom.offsetWidth;\n    };\n\n    var browser$3 = detect().browser;\n    var firstElement = function (nodes) {\n      return find$3(nodes, isElement$6);\n    };\n    var getTableCaptionDeltaY = function (elm) {\n      if (browser$3.isFirefox() && name(elm) === 'table') {\n        return firstElement(children(elm)).filter(function (elm) {\n          return name(elm) === 'caption';\n        }).bind(function (caption) {\n          return firstElement(nextSiblings(caption)).map(function (body) {\n            var bodyTop = body.dom.offsetTop;\n            var captionTop = caption.dom.offsetTop;\n            var captionHeight = caption.dom.offsetHeight;\n            return bodyTop <= captionTop ? -captionHeight : 0;\n          });\n        }).getOr(0);\n      } else {\n        return 0;\n      }\n    };\n    var hasChild = function (elm, child) {\n      return elm.children && contains$3(elm.children, child);\n    };\n    var getPos = function (body, elm, rootElm) {\n      var x = 0, y = 0;\n      var doc = body.ownerDocument;\n      rootElm = rootElm ? rootElm : body;\n      if (elm) {\n        if (rootElm === body && elm.getBoundingClientRect && get$5(SugarElement.fromDom(body), 'position') === 'static') {\n          var pos = elm.getBoundingClientRect();\n          x = pos.left + (doc.documentElement.scrollLeft || body.scrollLeft) - doc.documentElement.clientLeft;\n          y = pos.top + (doc.documentElement.scrollTop || body.scrollTop) - doc.documentElement.clientTop;\n          return {\n            x: x,\n            y: y\n          };\n        }\n        var offsetParent = elm;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          var castOffsetParent = offsetParent;\n          x += castOffsetParent.offsetLeft || 0;\n          y += castOffsetParent.offsetTop || 0;\n          offsetParent = castOffsetParent.offsetParent;\n        }\n        offsetParent = elm.parentNode;\n        while (offsetParent && offsetParent !== rootElm && offsetParent.nodeType && !hasChild(offsetParent, rootElm)) {\n          x -= offsetParent.scrollLeft || 0;\n          y -= offsetParent.scrollTop || 0;\n          offsetParent = offsetParent.parentNode;\n        }\n        y += getTableCaptionDeltaY(SugarElement.fromDom(elm));\n      }\n      return {\n        x: x,\n        y: y\n      };\n    };\n\n    var exports$1 = {}, module$1 = { exports: exports$1 };\n    (function (define, exports, module, require) {\n      (function (global, factory) {\n        typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = typeof globalThis !== 'undefined' ? globalThis : global || self, global.EphoxContactWrapper = factory());\n      }(this, function () {\n        var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n        var promise = { exports: {} };\n        (function (module) {\n          (function (root) {\n            var setTimeoutFunc = setTimeout;\n            function noop() {\n            }\n            function bind(fn, thisArg) {\n              return function () {\n                fn.apply(thisArg, arguments);\n              };\n            }\n            function Promise(fn) {\n              if (typeof this !== 'object')\n                throw new TypeError('Promises must be constructed via new');\n              if (typeof fn !== 'function')\n                throw new TypeError('not a function');\n              this._state = 0;\n              this._handled = false;\n              this._value = undefined;\n              this._deferreds = [];\n              doResolve(fn, this);\n            }\n            function handle(self, deferred) {\n              while (self._state === 3) {\n                self = self._value;\n              }\n              if (self._state === 0) {\n                self._deferreds.push(deferred);\n                return;\n              }\n              self._handled = true;\n              Promise._immediateFn(function () {\n                var cb = self._state === 1 ? deferred.onFulfilled : deferred.onRejected;\n                if (cb === null) {\n                  (self._state === 1 ? resolve : reject)(deferred.promise, self._value);\n                  return;\n                }\n                var ret;\n                try {\n                  ret = cb(self._value);\n                } catch (e) {\n                  reject(deferred.promise, e);\n                  return;\n                }\n                resolve(deferred.promise, ret);\n              });\n            }\n            function resolve(self, newValue) {\n              try {\n                if (newValue === self)\n                  throw new TypeError('A promise cannot be resolved with itself.');\n                if (newValue && (typeof newValue === 'object' || typeof newValue === 'function')) {\n                  var then = newValue.then;\n                  if (newValue instanceof Promise) {\n                    self._state = 3;\n                    self._value = newValue;\n                    finale(self);\n                    return;\n                  } else if (typeof then === 'function') {\n                    doResolve(bind(then, newValue), self);\n                    return;\n                  }\n                }\n                self._state = 1;\n                self._value = newValue;\n                finale(self);\n              } catch (e) {\n                reject(self, e);\n              }\n            }\n            function reject(self, newValue) {\n              self._state = 2;\n              self._value = newValue;\n              finale(self);\n            }\n            function finale(self) {\n              if (self._state === 2 && self._deferreds.length === 0) {\n                Promise._immediateFn(function () {\n                  if (!self._handled) {\n                    Promise._unhandledRejectionFn(self._value);\n                  }\n                });\n              }\n              for (var i = 0, len = self._deferreds.length; i < len; i++) {\n                handle(self, self._deferreds[i]);\n              }\n              self._deferreds = null;\n            }\n            function Handler(onFulfilled, onRejected, promise) {\n              this.onFulfilled = typeof onFulfilled === 'function' ? onFulfilled : null;\n              this.onRejected = typeof onRejected === 'function' ? onRejected : null;\n              this.promise = promise;\n            }\n            function doResolve(fn, self) {\n              var done = false;\n              try {\n                fn(function (value) {\n                  if (done)\n                    return;\n                  done = true;\n                  resolve(self, value);\n                }, function (reason) {\n                  if (done)\n                    return;\n                  done = true;\n                  reject(self, reason);\n                });\n              } catch (ex) {\n                if (done)\n                  return;\n                done = true;\n                reject(self, ex);\n              }\n            }\n            Promise.prototype['catch'] = function (onRejected) {\n              return this.then(null, onRejected);\n            };\n            Promise.prototype.then = function (onFulfilled, onRejected) {\n              var prom = new this.constructor(noop);\n              handle(this, new Handler(onFulfilled, onRejected, prom));\n              return prom;\n            };\n            Promise.all = function (arr) {\n              var args = Array.prototype.slice.call(arr);\n              return new Promise(function (resolve, reject) {\n                if (args.length === 0)\n                  return resolve([]);\n                var remaining = args.length;\n                function res(i, val) {\n                  try {\n                    if (val && (typeof val === 'object' || typeof val === 'function')) {\n                      var then = val.then;\n                      if (typeof then === 'function') {\n                        then.call(val, function (val) {\n                          res(i, val);\n                        }, reject);\n                        return;\n                      }\n                    }\n                    args[i] = val;\n                    if (--remaining === 0) {\n                      resolve(args);\n                    }\n                  } catch (ex) {\n                    reject(ex);\n                  }\n                }\n                for (var i = 0; i < args.length; i++) {\n                  res(i, args[i]);\n                }\n              });\n            };\n            Promise.resolve = function (value) {\n              if (value && typeof value === 'object' && value.constructor === Promise) {\n                return value;\n              }\n              return new Promise(function (resolve) {\n                resolve(value);\n              });\n            };\n            Promise.reject = function (value) {\n              return new Promise(function (resolve, reject) {\n                reject(value);\n              });\n            };\n            Promise.race = function (values) {\n              return new Promise(function (resolve, reject) {\n                for (var i = 0, len = values.length; i < len; i++) {\n                  values[i].then(resolve, reject);\n                }\n              });\n            };\n            Promise._immediateFn = typeof setImmediate === 'function' ? function (fn) {\n              setImmediate(fn);\n            } : function (fn) {\n              setTimeoutFunc(fn, 0);\n            };\n            Promise._unhandledRejectionFn = function _unhandledRejectionFn(err) {\n              if (typeof console !== 'undefined' && console) {\n                console.warn('Possible Unhandled Promise Rejection:', err);\n              }\n            };\n            Promise._setImmediateFn = function _setImmediateFn(fn) {\n              Promise._immediateFn = fn;\n            };\n            Promise._setUnhandledRejectionFn = function _setUnhandledRejectionFn(fn) {\n              Promise._unhandledRejectionFn = fn;\n            };\n            if (module.exports) {\n              module.exports = Promise;\n            } else if (!root.Promise) {\n              root.Promise = Promise;\n            }\n          }(commonjsGlobal));\n        }(promise));\n        var promisePolyfill = promise.exports;\n        var Global = function () {\n          if (typeof window !== 'undefined') {\n            return window;\n          } else {\n            return Function('return this;')();\n          }\n        }();\n        var promisePolyfill_1 = { boltExport: Global.Promise || promisePolyfill };\n        return promisePolyfill_1;\n      }));\n    }(undefined, exports$1, module$1));\n    var Promise$1 = module$1.exports.boltExport;\n\n    var nu$1 = function (baseFn) {\n      var data = Optional.none();\n      var callbacks = [];\n      var map = function (f) {\n        return nu$1(function (nCallback) {\n          get(function (data) {\n            nCallback(f(data));\n          });\n        });\n      };\n      var get = function (nCallback) {\n        if (isReady()) {\n          call(nCallback);\n        } else {\n          callbacks.push(nCallback);\n        }\n      };\n      var set = function (x) {\n        if (!isReady()) {\n          data = Optional.some(x);\n          run(callbacks);\n          callbacks = [];\n        }\n      };\n      var isReady = function () {\n        return data.isSome();\n      };\n      var run = function (cbs) {\n        each$k(cbs, call);\n      };\n      var call = function (cb) {\n        data.each(function (x) {\n          setTimeout(function () {\n            cb(x);\n          }, 0);\n        });\n      };\n      baseFn(set);\n      return {\n        get: get,\n        map: map,\n        isReady: isReady\n      };\n    };\n    var pure$1 = function (a) {\n      return nu$1(function (callback) {\n        callback(a);\n      });\n    };\n    var LazyValue = {\n      nu: nu$1,\n      pure: pure$1\n    };\n\n    var errorReporter = function (err) {\n      setTimeout(function () {\n        throw err;\n      }, 0);\n    };\n    var make = function (run) {\n      var get = function (callback) {\n        run().then(callback, errorReporter);\n      };\n      var map = function (fab) {\n        return make(function () {\n          return run().then(fab);\n        });\n      };\n      var bind = function (aFutureB) {\n        return make(function () {\n          return run().then(function (v) {\n            return aFutureB(v).toPromise();\n          });\n        });\n      };\n      var anonBind = function (futureB) {\n        return make(function () {\n          return run().then(function () {\n            return futureB.toPromise();\n          });\n        });\n      };\n      var toLazy = function () {\n        return LazyValue.nu(get);\n      };\n      var toCached = function () {\n        var cache = null;\n        return make(function () {\n          if (cache === null) {\n            cache = run();\n          }\n          return cache;\n        });\n      };\n      var toPromise = run;\n      return {\n        map: map,\n        bind: bind,\n        anonBind: anonBind,\n        toLazy: toLazy,\n        toCached: toCached,\n        toPromise: toPromise,\n        get: get\n      };\n    };\n    var nu = function (baseFn) {\n      return make(function () {\n        return new Promise$1(baseFn);\n      });\n    };\n    var pure = function (a) {\n      return make(function () {\n        return Promise$1.resolve(a);\n      });\n    };\n    var Future = {\n      nu: nu,\n      pure: pure\n    };\n\n    var par$1 = function (asyncValues, nu) {\n      return nu(function (callback) {\n        var r = [];\n        var count = 0;\n        var cb = function (i) {\n          return function (value) {\n            r[i] = value;\n            count++;\n            if (count >= asyncValues.length) {\n              callback(r);\n            }\n          };\n        };\n        if (asyncValues.length === 0) {\n          callback([]);\n        } else {\n          each$k(asyncValues, function (asyncValue, i) {\n            asyncValue.get(cb(i));\n          });\n        }\n      });\n    };\n\n    var par = function (futures) {\n      return par$1(futures, Future.nu);\n    };\n\n    var value$1 = function (o) {\n      var or = function (_opt) {\n        return value$1(o);\n      };\n      var orThunk = function (_f) {\n        return value$1(o);\n      };\n      var map = function (f) {\n        return value$1(f(o));\n      };\n      var mapError = function (_f) {\n        return value$1(o);\n      };\n      var each = function (f) {\n        f(o);\n      };\n      var bind = function (f) {\n        return f(o);\n      };\n      var fold = function (_, onValue) {\n        return onValue(o);\n      };\n      var exists = function (f) {\n        return f(o);\n      };\n      var forall = function (f) {\n        return f(o);\n      };\n      var toOptional = function () {\n        return Optional.some(o);\n      };\n      return {\n        isValue: always,\n        isError: never,\n        getOr: constant(o),\n        getOrThunk: constant(o),\n        getOrDie: constant(o),\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: each,\n        bind: bind,\n        exists: exists,\n        forall: forall,\n        toOptional: toOptional\n      };\n    };\n    var error = function (message) {\n      var getOrThunk = function (f) {\n        return f();\n      };\n      var getOrDie = function () {\n        return die(String(message))();\n      };\n      var or = identity;\n      var orThunk = function (f) {\n        return f();\n      };\n      var map = function (_f) {\n        return error(message);\n      };\n      var mapError = function (f) {\n        return error(f(message));\n      };\n      var bind = function (_f) {\n        return error(message);\n      };\n      var fold = function (onError, _) {\n        return onError(message);\n      };\n      return {\n        isValue: never,\n        isError: always,\n        getOr: identity,\n        getOrThunk: getOrThunk,\n        getOrDie: getOrDie,\n        or: or,\n        orThunk: orThunk,\n        fold: fold,\n        map: map,\n        mapError: mapError,\n        each: noop,\n        bind: bind,\n        exists: never,\n        forall: always,\n        toOptional: Optional.none\n      };\n    };\n    var fromOption = function (opt, err) {\n      return opt.fold(function () {\n        return error(err);\n      }, value$1);\n    };\n    var Result = {\n      value: value$1,\n      error: error,\n      fromOption: fromOption\n    };\n\n    var generate$1 = function (cases) {\n      if (!isArray$1(cases)) {\n        throw new Error('cases must be an array');\n      }\n      if (cases.length === 0) {\n        throw new Error('there must be at least one case');\n      }\n      var constructors = [];\n      var adt = {};\n      each$k(cases, function (acase, count) {\n        var keys$1 = keys(acase);\n        if (keys$1.length !== 1) {\n          throw new Error('one and only one name per case');\n        }\n        var key = keys$1[0];\n        var value = acase[key];\n        if (adt[key] !== undefined) {\n          throw new Error('duplicate key detected:' + key);\n        } else if (key === 'cata') {\n          throw new Error('cannot have a case named cata (sorry)');\n        } else if (!isArray$1(value)) {\n          throw new Error('case arguments must be an array');\n        }\n        constructors.push(key);\n        adt[key] = function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          var argLength = args.length;\n          if (argLength !== value.length) {\n            throw new Error('Wrong number of arguments to case ' + key + '. Expected ' + value.length + ' (' + value + '), got ' + argLength);\n          }\n          var match = function (branches) {\n            var branchKeys = keys(branches);\n            if (constructors.length !== branchKeys.length) {\n              throw new Error('Wrong number of arguments to match. Expected: ' + constructors.join(',') + '\\nActual: ' + branchKeys.join(','));\n            }\n            var allReqd = forall(constructors, function (reqKey) {\n              return contains$3(branchKeys, reqKey);\n            });\n            if (!allReqd) {\n              throw new Error('Not all branches were specified when using match. Specified: ' + branchKeys.join(', ') + '\\nRequired: ' + constructors.join(', '));\n            }\n            return branches[key].apply(null, args);\n          };\n          return {\n            fold: function () {\n              var foldArgs = [];\n              for (var _i = 0; _i < arguments.length; _i++) {\n                foldArgs[_i] = arguments[_i];\n              }\n              if (foldArgs.length !== cases.length) {\n                throw new Error('Wrong number of arguments to fold. Expected ' + cases.length + ', got ' + foldArgs.length);\n              }\n              var target = foldArgs[count];\n              return target.apply(null, args);\n            },\n            match: match,\n            log: function (label) {\n              console.log(label, {\n                constructors: constructors,\n                constructor: key,\n                params: args\n              });\n            }\n          };\n        };\n      });\n      return adt;\n    };\n    var Adt = { generate: generate$1 };\n\n    Adt.generate([\n      {\n        bothErrors: [\n          'error1',\n          'error2'\n        ]\n      },\n      {\n        firstError: [\n          'error1',\n          'value2'\n        ]\n      },\n      {\n        secondError: [\n          'value1',\n          'error2'\n        ]\n      },\n      {\n        bothValues: [\n          'value1',\n          'value2'\n        ]\n      }\n    ]);\n    var unite = function (result) {\n      return result.fold(identity, identity);\n    };\n\n    function ClosestOrAncestor (is, ancestor, scope, a, isRoot) {\n      if (is(scope, a)) {\n        return Optional.some(scope);\n      } else if (isFunction(isRoot) && isRoot(scope)) {\n        return Optional.none();\n      } else {\n        return ancestor(scope, a, isRoot);\n      }\n    }\n\n    var ancestor$3 = function (scope, predicate, isRoot) {\n      var element = scope.dom;\n      var stop = isFunction(isRoot) ? isRoot : never;\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        if (predicate(el)) {\n          return Optional.some(el);\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$3 = function (scope, predicate, isRoot) {\n      var is = function (s, test) {\n        return test(s);\n      };\n      return ClosestOrAncestor(is, ancestor$3, scope, predicate, isRoot);\n    };\n    var sibling$2 = function (scope, predicate) {\n      var element = scope.dom;\n      if (!element.parentNode) {\n        return Optional.none();\n      }\n      return child(SugarElement.fromDom(element.parentNode), function (x) {\n        return !eq(scope, x) && predicate(x);\n      });\n    };\n    var child = function (scope, predicate) {\n      var pred = function (node) {\n        return predicate(SugarElement.fromDom(node));\n      };\n      var result = find$3(scope.dom.childNodes, pred);\n      return result.map(SugarElement.fromDom);\n    };\n\n    var ancestor$2 = function (scope, selector, isRoot) {\n      return ancestor$3(scope, function (e) {\n        return is$2(e, selector);\n      }, isRoot);\n    };\n    var descendant = function (scope, selector) {\n      return one(selector, scope);\n    };\n    var closest$2 = function (scope, selector, isRoot) {\n      var is = function (element, selector) {\n        return is$2(element, selector);\n      };\n      return ClosestOrAncestor(is, ancestor$2, scope, selector, isRoot);\n    };\n\n    var promiseObj = window.Promise ? window.Promise : Promise$1;\n\n    var requestAnimationFramePromise;\n    var requestAnimationFrame = function (callback, element) {\n      var requestAnimationFrameFunc = window.requestAnimationFrame;\n      var vendors = [\n        'ms',\n        'moz',\n        'webkit'\n      ];\n      var featurefill = function (cb) {\n        window.setTimeout(cb, 0);\n      };\n      for (var i = 0; i < vendors.length && !requestAnimationFrameFunc; i++) {\n        requestAnimationFrameFunc = window[vendors[i] + 'RequestAnimationFrame'];\n      }\n      if (!requestAnimationFrameFunc) {\n        requestAnimationFrameFunc = featurefill;\n      }\n      requestAnimationFrameFunc(callback, element);\n    };\n    var wrappedSetTimeout = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 0;\n      }\n      return setTimeout(callback, time);\n    };\n    var wrappedSetInterval = function (callback, time) {\n      if (typeof time !== 'number') {\n        time = 1;\n      }\n      return setInterval(callback, time);\n    };\n    var wrappedClearTimeout = function (id) {\n      return clearTimeout(id);\n    };\n    var wrappedClearInterval = function (id) {\n      return clearInterval(id);\n    };\n    var debounce = function (callback, time) {\n      var timer;\n      var func = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        clearTimeout(timer);\n        timer = wrappedSetTimeout(function () {\n          callback.apply(this, args);\n        }, time);\n      };\n      func.stop = function () {\n        clearTimeout(timer);\n      };\n      return func;\n    };\n    var Delay = {\n      requestAnimationFrame: function (callback, element) {\n        if (requestAnimationFramePromise) {\n          requestAnimationFramePromise.then(callback);\n          return;\n        }\n        requestAnimationFramePromise = new promiseObj(function (resolve) {\n          if (!element) {\n            element = document.body;\n          }\n          requestAnimationFrame(resolve, element);\n        }).then(callback);\n      },\n      setTimeout: wrappedSetTimeout,\n      setInterval: wrappedSetInterval,\n      setEditorTimeout: function (editor, callback, time) {\n        return wrappedSetTimeout(function () {\n          if (!editor.removed) {\n            callback();\n          }\n        }, time);\n      },\n      setEditorInterval: function (editor, callback, time) {\n        var timer = wrappedSetInterval(function () {\n          if (!editor.removed) {\n            callback();\n          } else {\n            clearInterval(timer);\n          }\n        }, time);\n        return timer;\n      },\n      debounce: debounce,\n      throttle: debounce,\n      clearInterval: wrappedClearInterval,\n      clearTimeout: wrappedClearTimeout\n    };\n\n    var StyleSheetLoader = function (documentOrShadowRoot, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var idCount = 0;\n      var loadedStates = {};\n      var edos = SugarElement.fromDom(documentOrShadowRoot);\n      var doc = documentOrOwner(edos);\n      var maxLoadTime = settings.maxLoadTime || 5000;\n      var _setReferrerPolicy = function (referrerPolicy) {\n        settings.referrerPolicy = referrerPolicy;\n      };\n      var addStyle = function (element) {\n        append$1(getStyleContainer(edos), element);\n      };\n      var removeStyle = function (id) {\n        var styleContainer = getStyleContainer(edos);\n        descendant(styleContainer, '#' + id).each(remove$7);\n      };\n      var getOrCreateState = function (url) {\n        return get$9(loadedStates, url).getOrThunk(function () {\n          return {\n            id: 'mce-u' + idCount++,\n            passed: [],\n            failed: [],\n            count: 0\n          };\n        });\n      };\n      var load = function (url, success, failure) {\n        var link;\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        var state = getOrCreateState(urlWithSuffix);\n        loadedStates[urlWithSuffix] = state;\n        state.count++;\n        var resolve = function (callbacks, status) {\n          var i = callbacks.length;\n          while (i--) {\n            callbacks[i]();\n          }\n          state.status = status;\n          state.passed = [];\n          state.failed = [];\n          if (link) {\n            link.onload = null;\n            link.onerror = null;\n            link = null;\n          }\n        };\n        var passed = function () {\n          return resolve(state.passed, 2);\n        };\n        var failed = function () {\n          return resolve(state.failed, 3);\n        };\n        var wait = function (testCallback, waitCallback) {\n          if (!testCallback()) {\n            if (Date.now() - startTime < maxLoadTime) {\n              Delay.setTimeout(waitCallback);\n            } else {\n              failed();\n            }\n          }\n        };\n        var waitForWebKitLinkLoaded = function () {\n          wait(function () {\n            var styleSheets = documentOrShadowRoot.styleSheets;\n            var i = styleSheets.length;\n            while (i--) {\n              var styleSheet = styleSheets[i];\n              var owner = styleSheet.ownerNode;\n              if (owner && owner.id === link.id) {\n                passed();\n                return true;\n              }\n            }\n            return false;\n          }, waitForWebKitLinkLoaded);\n        };\n        if (success) {\n          state.passed.push(success);\n        }\n        if (failure) {\n          state.failed.push(failure);\n        }\n        if (state.status === 1) {\n          return;\n        }\n        if (state.status === 2) {\n          passed();\n          return;\n        }\n        if (state.status === 3) {\n          failed();\n          return;\n        }\n        state.status = 1;\n        var linkElem = SugarElement.fromTag('link', doc.dom);\n        setAll$1(linkElem, {\n          rel: 'stylesheet',\n          type: 'text/css',\n          id: state.id\n        });\n        var startTime = Date.now();\n        if (settings.contentCssCors) {\n          set$1(linkElem, 'crossOrigin', 'anonymous');\n        }\n        if (settings.referrerPolicy) {\n          set$1(linkElem, 'referrerpolicy', settings.referrerPolicy);\n        }\n        link = linkElem.dom;\n        link.onload = waitForWebKitLinkLoaded;\n        link.onerror = failed;\n        addStyle(linkElem);\n        set$1(linkElem, 'href', urlWithSuffix);\n      };\n      var loadF = function (url) {\n        return Future.nu(function (resolve) {\n          load(url, compose(resolve, constant(Result.value(url))), compose(resolve, constant(Result.error(url))));\n        });\n      };\n      var loadAll = function (urls, success, failure) {\n        par(map$3(urls, loadF)).get(function (result) {\n          var parts = partition(result, function (r) {\n            return r.isValue();\n          });\n          if (parts.fail.length > 0) {\n            failure(parts.fail.map(unite));\n          } else {\n            success(parts.pass.map(unite));\n          }\n        });\n      };\n      var unload = function (url) {\n        var urlWithSuffix = Tools._addCacheSuffix(url);\n        get$9(loadedStates, urlWithSuffix).each(function (state) {\n          var count = --state.count;\n          if (count === 0) {\n            delete loadedStates[urlWithSuffix];\n            removeStyle(state.id);\n          }\n        });\n      };\n      var unloadAll = function (urls) {\n        each$k(urls, function (url) {\n          unload(url);\n        });\n      };\n      return {\n        load: load,\n        loadAll: loadAll,\n        unload: unload,\n        unloadAll: unloadAll,\n        _setReferrerPolicy: _setReferrerPolicy\n      };\n    };\n\n    var create$8 = function () {\n      var map = new WeakMap();\n      var forElement = function (referenceElement, settings) {\n        var root = getRootNode(referenceElement);\n        var rootDom = root.dom;\n        return Optional.from(map.get(rootDom)).getOrThunk(function () {\n          var sl = StyleSheetLoader(rootDom, settings);\n          map.set(rootDom, sl);\n          return sl;\n        });\n      };\n      return { forElement: forElement };\n    };\n    var instance = create$8();\n\n    var DomTreeWalker = function () {\n      function DomTreeWalker(startNode, rootNode) {\n        this.node = startNode;\n        this.rootNode = rootNode;\n        this.current = this.current.bind(this);\n        this.next = this.next.bind(this);\n        this.prev = this.prev.bind(this);\n        this.prev2 = this.prev2.bind(this);\n      }\n      DomTreeWalker.prototype.current = function () {\n        return this.node;\n      };\n      DomTreeWalker.prototype.next = function (shallow) {\n        this.node = this.findSibling(this.node, 'firstChild', 'nextSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev = function (shallow) {\n        this.node = this.findSibling(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.prev2 = function (shallow) {\n        this.node = this.findPreviousNode(this.node, 'lastChild', 'previousSibling', shallow);\n        return this.node;\n      };\n      DomTreeWalker.prototype.findSibling = function (node, startName, siblingName, shallow) {\n        var sibling, parent;\n        if (node) {\n          if (!shallow && node[startName]) {\n            return node[startName];\n          }\n          if (node !== this.rootNode) {\n            sibling = node[siblingName];\n            if (sibling) {\n              return sibling;\n            }\n            for (parent = node.parentNode; parent && parent !== this.rootNode; parent = parent.parentNode) {\n              sibling = parent[siblingName];\n              if (sibling) {\n                return sibling;\n              }\n            }\n          }\n        }\n      };\n      DomTreeWalker.prototype.findPreviousNode = function (node, startName, siblingName, shallow) {\n        var sibling, parent, child;\n        if (node) {\n          sibling = node[siblingName];\n          if (this.rootNode && sibling === this.rootNode) {\n            return;\n          }\n          if (sibling) {\n            if (!shallow) {\n              for (child = sibling[startName]; child; child = child[startName]) {\n                if (!child[startName]) {\n                  return child;\n                }\n              }\n            }\n            return sibling;\n          }\n          parent = node.parentNode;\n          if (parent && parent !== this.rootNode) {\n            return parent;\n          }\n        }\n      };\n      return DomTreeWalker;\n    }();\n\n    var blocks = [\n      'article',\n      'aside',\n      'details',\n      'div',\n      'dt',\n      'figcaption',\n      'footer',\n      'form',\n      'fieldset',\n      'header',\n      'hgroup',\n      'html',\n      'main',\n      'nav',\n      'section',\n      'summary',\n      'body',\n      'p',\n      'dl',\n      'multicol',\n      'dd',\n      'figure',\n      'address',\n      'center',\n      'blockquote',\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'listing',\n      'xmp',\n      'pre',\n      'plaintext',\n      'menu',\n      'dir',\n      'ul',\n      'ol',\n      'li',\n      'hr',\n      'table',\n      'tbody',\n      'thead',\n      'tfoot',\n      'th',\n      'tr',\n      'td',\n      'caption'\n    ];\n    var tableCells = [\n      'td',\n      'th'\n    ];\n    var tableSections = [\n      'thead',\n      'tbody',\n      'tfoot'\n    ];\n    var textBlocks = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6',\n      'p',\n      'div',\n      'address',\n      'pre',\n      'form',\n      'blockquote',\n      'center',\n      'dir',\n      'fieldset',\n      'header',\n      'footer',\n      'article',\n      'section',\n      'hgroup',\n      'aside',\n      'nav',\n      'figure'\n    ];\n    var headings = [\n      'h1',\n      'h2',\n      'h3',\n      'h4',\n      'h5',\n      'h6'\n    ];\n    var listItems$1 = [\n      'li',\n      'dd',\n      'dt'\n    ];\n    var lists = [\n      'ul',\n      'ol',\n      'dl'\n    ];\n    var wsElements = [\n      'pre',\n      'script',\n      'textarea',\n      'style'\n    ];\n    var lazyLookup = function (items) {\n      var lookup;\n      return function (node) {\n        lookup = lookup ? lookup : mapToObject(items, always);\n        return has$2(lookup, name(node));\n      };\n    };\n    var isHeading = lazyLookup(headings);\n    var isBlock$2 = lazyLookup(blocks);\n    var isTable$2 = function (node) {\n      return name(node) === 'table';\n    };\n    var isInline$1 = function (node) {\n      return isElement$6(node) && !isBlock$2(node);\n    };\n    var isBr$4 = function (node) {\n      return isElement$6(node) && name(node) === 'br';\n    };\n    var isTextBlock$2 = lazyLookup(textBlocks);\n    var isList = lazyLookup(lists);\n    var isListItem = lazyLookup(listItems$1);\n    var isTableSection = lazyLookup(tableSections);\n    var isTableCell$4 = lazyLookup(tableCells);\n    var isWsPreserveElement = lazyLookup(wsElements);\n\n    var ancestor$1 = function (scope, selector, isRoot) {\n      return ancestor$2(scope, selector, isRoot).isSome();\n    };\n\n    var zeroWidth = '\\uFEFF';\n    var nbsp = '\\xA0';\n    var isZwsp$1 = function (char) {\n      return char === zeroWidth;\n    };\n    var removeZwsp = function (s) {\n      return s.replace(/\\uFEFF/g, '');\n    };\n\n    var ZWSP$1 = zeroWidth;\n    var isZwsp = isZwsp$1;\n    var trim$2 = removeZwsp;\n\n    var isElement$4 = isElement$5;\n    var isText$6 = isText$7;\n    var isCaretContainerBlock$1 = function (node) {\n      if (isText$6(node)) {\n        node = node.parentNode;\n      }\n      return isElement$4(node) && node.hasAttribute('data-mce-caret');\n    };\n    var isCaretContainerInline = function (node) {\n      return isText$6(node) && isZwsp(node.data);\n    };\n    var isCaretContainer$2 = function (node) {\n      return isCaretContainerBlock$1(node) || isCaretContainerInline(node);\n    };\n    var hasContent = function (node) {\n      return node.firstChild !== node.lastChild || !isBr$5(node.firstChild);\n    };\n    var insertInline$1 = function (node, before) {\n      var doc = node.ownerDocument;\n      var textNode = doc.createTextNode(ZWSP$1);\n      var parentNode = node.parentNode;\n      if (!before) {\n        var sibling = node.nextSibling;\n        if (isText$6(sibling)) {\n          if (isCaretContainer$2(sibling)) {\n            return sibling;\n          }\n          if (startsWithCaretContainer$1(sibling)) {\n            sibling.splitText(1);\n            return sibling;\n          }\n        }\n        if (node.nextSibling) {\n          parentNode.insertBefore(textNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(textNode);\n        }\n      } else {\n        var sibling = node.previousSibling;\n        if (isText$6(sibling)) {\n          if (isCaretContainer$2(sibling)) {\n            return sibling;\n          }\n          if (endsWithCaretContainer$1(sibling)) {\n            return sibling.splitText(sibling.data.length - 1);\n          }\n        }\n        parentNode.insertBefore(textNode, node);\n      }\n      return textNode;\n    };\n    var isBeforeInline = function (pos) {\n      var container = pos.container();\n      if (!isText$7(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset()) === ZWSP$1 || pos.isAtStart() && isCaretContainerInline(container.previousSibling);\n    };\n    var isAfterInline = function (pos) {\n      var container = pos.container();\n      if (!isText$7(container)) {\n        return false;\n      }\n      return container.data.charAt(pos.offset() - 1) === ZWSP$1 || pos.isAtEnd() && isCaretContainerInline(container.nextSibling);\n    };\n    var createBogusBr = function () {\n      var br = document.createElement('br');\n      br.setAttribute('data-mce-bogus', '1');\n      return br;\n    };\n    var insertBlock$1 = function (blockName, node, before) {\n      var doc = node.ownerDocument;\n      var blockNode = doc.createElement(blockName);\n      blockNode.setAttribute('data-mce-caret', before ? 'before' : 'after');\n      blockNode.setAttribute('data-mce-bogus', 'all');\n      blockNode.appendChild(createBogusBr());\n      var parentNode = node.parentNode;\n      if (!before) {\n        if (node.nextSibling) {\n          parentNode.insertBefore(blockNode, node.nextSibling);\n        } else {\n          parentNode.appendChild(blockNode);\n        }\n      } else {\n        parentNode.insertBefore(blockNode, node);\n      }\n      return blockNode;\n    };\n    var startsWithCaretContainer$1 = function (node) {\n      return isText$6(node) && node.data[0] === ZWSP$1;\n    };\n    var endsWithCaretContainer$1 = function (node) {\n      return isText$6(node) && node.data[node.data.length - 1] === ZWSP$1;\n    };\n    var trimBogusBr = function (elm) {\n      var brs = elm.getElementsByTagName('br');\n      var lastBr = brs[brs.length - 1];\n      if (isBogus$2(lastBr)) {\n        lastBr.parentNode.removeChild(lastBr);\n      }\n    };\n    var showCaretContainerBlock = function (caretContainer) {\n      if (caretContainer && caretContainer.hasAttribute('data-mce-caret')) {\n        trimBogusBr(caretContainer);\n        caretContainer.removeAttribute('data-mce-caret');\n        caretContainer.removeAttribute('data-mce-bogus');\n        caretContainer.removeAttribute('style');\n        caretContainer.removeAttribute('_moz_abspos');\n        return caretContainer;\n      }\n      return null;\n    };\n    var isRangeInCaretContainerBlock = function (range) {\n      return isCaretContainerBlock$1(range.startContainer);\n    };\n\n    var isContentEditableTrue$3 = isContentEditableTrue$4;\n    var isContentEditableFalse$a = isContentEditableFalse$b;\n    var isBr$3 = isBr$5;\n    var isText$5 = isText$7;\n    var isInvalidTextElement = matchNodeNames([\n      'script',\n      'style',\n      'textarea'\n    ]);\n    var isAtomicInline = matchNodeNames([\n      'img',\n      'input',\n      'textarea',\n      'hr',\n      'iframe',\n      'video',\n      'audio',\n      'object',\n      'embed'\n    ]);\n    var isTable$1 = matchNodeNames(['table']);\n    var isCaretContainer$1 = isCaretContainer$2;\n    var isCaretCandidate$3 = function (node) {\n      if (isCaretContainer$1(node)) {\n        return false;\n      }\n      if (isText$5(node)) {\n        return !isInvalidTextElement(node.parentNode);\n      }\n      return isAtomicInline(node) || isBr$3(node) || isTable$1(node) || isNonUiContentEditableFalse(node);\n    };\n    var isUnselectable = function (node) {\n      return isElement$5(node) && node.getAttribute('unselectable') === 'true';\n    };\n    var isNonUiContentEditableFalse = function (node) {\n      return isUnselectable(node) === false && isContentEditableFalse$a(node);\n    };\n    var isInEditable = function (node, root) {\n      for (node = node.parentNode; node && node !== root; node = node.parentNode) {\n        if (isNonUiContentEditableFalse(node)) {\n          return false;\n        }\n        if (isContentEditableTrue$3(node)) {\n          return true;\n        }\n      }\n      return true;\n    };\n    var isAtomicContentEditableFalse = function (node) {\n      if (!isNonUiContentEditableFalse(node)) {\n        return false;\n      }\n      return foldl(from(node.getElementsByTagName('*')), function (result, elm) {\n        return result || isContentEditableTrue$3(elm);\n      }, false) !== true;\n    };\n    var isAtomic$1 = function (node) {\n      return isAtomicInline(node) || isAtomicContentEditableFalse(node);\n    };\n    var isEditableCaretCandidate$1 = function (node, root) {\n      return isCaretCandidate$3(node) && isInEditable(node, root);\n    };\n\n    var whiteSpaceRegExp$1 = /^[ \\t\\r\\n]*$/;\n    var isWhitespaceText = function (text) {\n      return whiteSpaceRegExp$1.test(text);\n    };\n\n    var hasWhitespacePreserveParent = function (node, rootNode) {\n      var rootElement = SugarElement.fromDom(rootNode);\n      var startNode = SugarElement.fromDom(node);\n      return ancestor$1(startNode, 'pre,code', curry(eq, rootElement));\n    };\n    var isWhitespace = function (node, rootNode) {\n      return isText$7(node) && isWhitespaceText(node.data) && hasWhitespacePreserveParent(node, rootNode) === false;\n    };\n    var isNamedAnchor = function (node) {\n      return isElement$5(node) && node.nodeName === 'A' && !node.hasAttribute('href') && (node.hasAttribute('name') || node.hasAttribute('id'));\n    };\n    var isContent$1 = function (node, rootNode) {\n      return isCaretCandidate$3(node) && isWhitespace(node, rootNode) === false || isNamedAnchor(node) || isBookmark(node);\n    };\n    var isBookmark = hasAttribute('data-mce-bookmark');\n    var isBogus$1 = hasAttribute('data-mce-bogus');\n    var isBogusAll = hasAttributeValue('data-mce-bogus', 'all');\n    var isEmptyNode = function (targetNode, skipBogus) {\n      var brCount = 0;\n      if (isContent$1(targetNode, targetNode)) {\n        return false;\n      } else {\n        var node = targetNode.firstChild;\n        if (!node) {\n          return true;\n        }\n        var walker = new DomTreeWalker(node, targetNode);\n        do {\n          if (skipBogus) {\n            if (isBogusAll(node)) {\n              node = walker.next(true);\n              continue;\n            }\n            if (isBogus$1(node)) {\n              node = walker.next();\n              continue;\n            }\n          }\n          if (isBr$5(node)) {\n            brCount++;\n            node = walker.next();\n            continue;\n          }\n          if (isContent$1(node, targetNode)) {\n            return false;\n          }\n          node = walker.next();\n        } while (node);\n        return brCount <= 1;\n      }\n    };\n    var isEmpty$2 = function (elm, skipBogus) {\n      if (skipBogus === void 0) {\n        skipBogus = true;\n      }\n      return isEmptyNode(elm.dom, skipBogus);\n    };\n\n    var isSpan = function (node) {\n      return node.nodeName.toLowerCase() === 'span';\n    };\n    var isInlineContent = function (node, root) {\n      return isNonNullable(node) && (isContent$1(node, root) || isInline$1(SugarElement.fromDom(node)));\n    };\n    var surroundedByInlineContent = function (node, root) {\n      var prev = new DomTreeWalker(node, root).prev(false);\n      var next = new DomTreeWalker(node, root).next(false);\n      var prevIsInline = isUndefined(prev) || isInlineContent(prev, root);\n      var nextIsInline = isUndefined(next) || isInlineContent(next, root);\n      return prevIsInline && nextIsInline;\n    };\n    var isBookmarkNode$2 = function (node) {\n      return isSpan(node) && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n    var isKeepTextNode = function (node, root) {\n      return isText$7(node) && node.data.length > 0 && surroundedByInlineContent(node, root);\n    };\n    var isKeepElement = function (node) {\n      return isElement$5(node) ? node.childNodes.length > 0 : false;\n    };\n    var isDocument = function (node) {\n      return isDocumentFragment(node) || isDocument$1(node);\n    };\n    var trimNode = function (dom, node, root) {\n      var rootNode = root || node;\n      if (isElement$5(node) && isBookmarkNode$2(node)) {\n        return node;\n      }\n      var children = node.childNodes;\n      for (var i = children.length - 1; i >= 0; i--) {\n        trimNode(dom, children[i], rootNode);\n      }\n      if (isElement$5(node)) {\n        var currentChildren = node.childNodes;\n        if (currentChildren.length === 1 && isBookmarkNode$2(currentChildren[0])) {\n          node.parentNode.insertBefore(currentChildren[0], node);\n        }\n      }\n      if (!isDocument(node) && !isContent$1(node, rootNode) && !isKeepElement(node) && !isKeepTextNode(node, rootNode)) {\n        dom.remove(node);\n      }\n      return node;\n    };\n\n    var makeMap$3 = Tools.makeMap;\n    var attrsCharsRegExp = /[&<>\\\"\\u0060\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var textCharsRegExp = /[<>&\\u007E-\\uD7FF\\uE000-\\uFFEF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]/g;\n    var rawCharsRegExp = /[<>&\\\"\\']/g;\n    var entityRegExp = /&#([a-z0-9]+);?|&([a-z0-9]+);/gi;\n    var asciiMap = {\n      128: '\\u20AC',\n      130: '\\u201A',\n      131: '\\u0192',\n      132: '\\u201E',\n      133: '\\u2026',\n      134: '\\u2020',\n      135: '\\u2021',\n      136: '\\u02c6',\n      137: '\\u2030',\n      138: '\\u0160',\n      139: '\\u2039',\n      140: '\\u0152',\n      142: '\\u017d',\n      145: '\\u2018',\n      146: '\\u2019',\n      147: '\\u201C',\n      148: '\\u201D',\n      149: '\\u2022',\n      150: '\\u2013',\n      151: '\\u2014',\n      152: '\\u02DC',\n      153: '\\u2122',\n      154: '\\u0161',\n      155: '\\u203A',\n      156: '\\u0153',\n      158: '\\u017e',\n      159: '\\u0178'\n    };\n    var baseEntities = {\n      '\"': '&quot;',\n      '\\'': '&#39;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '&': '&amp;',\n      '`': '&#96;'\n    };\n    var reverseEntities = {\n      '&lt;': '<',\n      '&gt;': '>',\n      '&amp;': '&',\n      '&quot;': '\"',\n      '&apos;': '\\''\n    };\n    var nativeDecode = function (text) {\n      var elm = SugarElement.fromTag('div').dom;\n      elm.innerHTML = text;\n      return elm.textContent || elm.innerText || text;\n    };\n    var buildEntitiesLookup = function (items, radix) {\n      var i, chr, entity;\n      var lookup = {};\n      if (items) {\n        items = items.split(',');\n        radix = radix || 10;\n        for (i = 0; i < items.length; i += 2) {\n          chr = String.fromCharCode(parseInt(items[i], radix));\n          if (!baseEntities[chr]) {\n            entity = '&' + items[i + 1] + ';';\n            lookup[chr] = entity;\n            lookup[entity] = chr;\n          }\n        }\n        return lookup;\n      }\n    };\n    var namedEntities = buildEntitiesLookup('50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,' + '5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,' + '5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,' + '5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,' + '68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,' + '6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,' + '6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,' + '75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,' + '7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,' + '7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,' + 'sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,' + 'st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,' + 't9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,' + 'tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,' + 'u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,' + '81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,' + '8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,' + '8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,' + '8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,' + '8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,' + 'nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,' + 'rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,' + 'Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,' + '80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,' + '811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro', 32);\n    var encodeRaw = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeAllRaw = function (text) {\n      return ('' + text).replace(rawCharsRegExp, function (chr) {\n        return baseEntities[chr] || chr;\n      });\n    };\n    var encodeNumeric = function (text, attr) {\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        if (chr.length > 1) {\n          return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n        }\n        return baseEntities[chr] || '&#' + chr.charCodeAt(0) + ';';\n      });\n    };\n    var encodeNamed = function (text, attr, entities) {\n      entities = entities || namedEntities;\n      return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n        return baseEntities[chr] || entities[chr] || chr;\n      });\n    };\n    var getEncodeFunc = function (name, entities) {\n      var entitiesMap = buildEntitiesLookup(entities) || namedEntities;\n      var encodeNamedAndNumeric = function (text, attr) {\n        return text.replace(attr ? attrsCharsRegExp : textCharsRegExp, function (chr) {\n          if (baseEntities[chr] !== undefined) {\n            return baseEntities[chr];\n          }\n          if (entitiesMap[chr] !== undefined) {\n            return entitiesMap[chr];\n          }\n          if (chr.length > 1) {\n            return '&#' + ((chr.charCodeAt(0) - 55296) * 1024 + (chr.charCodeAt(1) - 56320) + 65536) + ';';\n          }\n          return '&#' + chr.charCodeAt(0) + ';';\n        });\n      };\n      var encodeCustomNamed = function (text, attr) {\n        return encodeNamed(text, attr, entitiesMap);\n      };\n      var nameMap = makeMap$3(name.replace(/\\+/g, ','));\n      if (nameMap.named && nameMap.numeric) {\n        return encodeNamedAndNumeric;\n      }\n      if (nameMap.named) {\n        if (entities) {\n          return encodeCustomNamed;\n        }\n        return encodeNamed;\n      }\n      if (nameMap.numeric) {\n        return encodeNumeric;\n      }\n      return encodeRaw;\n    };\n    var decode = function (text) {\n      return text.replace(entityRegExp, function (all, numeric) {\n        if (numeric) {\n          if (numeric.charAt(0).toLowerCase() === 'x') {\n            numeric = parseInt(numeric.substr(1), 16);\n          } else {\n            numeric = parseInt(numeric, 10);\n          }\n          if (numeric > 65535) {\n            numeric -= 65536;\n            return String.fromCharCode(55296 + (numeric >> 10), 56320 + (numeric & 1023));\n          }\n          return asciiMap[numeric] || String.fromCharCode(numeric);\n        }\n        return reverseEntities[all] || namedEntities[all] || nativeDecode(all);\n      });\n    };\n    var Entities = {\n      encodeRaw: encodeRaw,\n      encodeAllRaw: encodeAllRaw,\n      encodeNumeric: encodeNumeric,\n      encodeNamed: encodeNamed,\n      getEncodeFunc: getEncodeFunc,\n      decode: decode\n    };\n\n    var mapCache = {}, dummyObj = {};\n    var makeMap$2 = Tools.makeMap, each$h = Tools.each, extend$5 = Tools.extend, explode$3 = Tools.explode, inArray$2 = Tools.inArray;\n    var split$1 = function (items, delim) {\n      items = Tools.trim(items);\n      return items ? items.split(delim || ' ') : [];\n    };\n    var compileSchema = function (type) {\n      var schema = {};\n      var globalAttributes, blockContent;\n      var phrasingContent, flowContent, html4BlockContent, html4PhrasingContent;\n      var add = function (name, attributes, children) {\n        var ni, attributesOrder, element;\n        var arrayToMap = function (array, obj) {\n          var map = {};\n          var i, l;\n          for (i = 0, l = array.length; i < l; i++) {\n            map[array[i]] = obj || {};\n          }\n          return map;\n        };\n        children = children || [];\n        attributes = attributes || '';\n        if (typeof children === 'string') {\n          children = split$1(children);\n        }\n        var names = split$1(name);\n        ni = names.length;\n        while (ni--) {\n          attributesOrder = split$1([\n            globalAttributes,\n            attributes\n          ].join(' '));\n          element = {\n            attributes: arrayToMap(attributesOrder),\n            attributesOrder: attributesOrder,\n            children: arrayToMap(children, dummyObj)\n          };\n          schema[names[ni]] = element;\n        }\n      };\n      var addAttrs = function (name, attributes) {\n        var ni, schemaItem, i, l;\n        var names = split$1(name);\n        ni = names.length;\n        var attrs = split$1(attributes);\n        while (ni--) {\n          schemaItem = schema[names[ni]];\n          for (i = 0, l = attrs.length; i < l; i++) {\n            schemaItem.attributes[attrs[i]] = {};\n            schemaItem.attributesOrder.push(attrs[i]);\n          }\n        }\n      };\n      if (mapCache[type]) {\n        return mapCache[type];\n      }\n      globalAttributes = 'id accesskey class dir lang style tabindex title role';\n      blockContent = 'address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul';\n      phrasingContent = 'a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd ' + 'label map noscript object q s samp script select small span strong sub sup ' + 'textarea u var #text #comment';\n      if (type !== 'html4') {\n        globalAttributes += ' contenteditable contextmenu draggable dropzone ' + 'hidden spellcheck translate';\n        blockContent += ' article aside details dialog figure main header footer hgroup section nav';\n        phrasingContent += ' audio canvas command datalist mark meter output picture ' + 'progress time wbr video ruby bdi keygen';\n      }\n      if (type !== 'html5-strict') {\n        globalAttributes += ' xml:lang';\n        html4PhrasingContent = 'acronym applet basefont big font strike tt';\n        phrasingContent = [\n          phrasingContent,\n          html4PhrasingContent\n        ].join(' ');\n        each$h(split$1(html4PhrasingContent), function (name) {\n          add(name, '', phrasingContent);\n        });\n        html4BlockContent = 'center dir isindex noframes';\n        blockContent = [\n          blockContent,\n          html4BlockContent\n        ].join(' ');\n        flowContent = [\n          blockContent,\n          phrasingContent\n        ].join(' ');\n        each$h(split$1(html4BlockContent), function (name) {\n          add(name, '', flowContent);\n        });\n      }\n      flowContent = flowContent || [\n        blockContent,\n        phrasingContent\n      ].join(' ');\n      add('html', 'manifest', 'head body');\n      add('head', '', 'base command link meta noscript script style title');\n      add('title hr noscript br');\n      add('base', 'href target');\n      add('link', 'href rel media hreflang type sizes hreflang');\n      add('meta', 'name http-equiv content charset');\n      add('style', 'media type scoped');\n      add('script', 'src async defer type charset');\n      add('body', 'onafterprint onbeforeprint onbeforeunload onblur onerror onfocus ' + 'onhashchange onload onmessage onoffline ononline onpagehide onpageshow ' + 'onpopstate onresize onscroll onstorage onunload', flowContent);\n      add('address dt dd div caption', '', flowContent);\n      add('h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn', '', phrasingContent);\n      add('blockquote', 'cite', flowContent);\n      add('ol', 'reversed start type', 'li');\n      add('ul', '', 'li');\n      add('li', 'value', flowContent);\n      add('dl', '', 'dt dd');\n      add('a', 'href target rel media hreflang type', phrasingContent);\n      add('q', 'cite', phrasingContent);\n      add('ins del', 'cite datetime', flowContent);\n      add('img', 'src sizes srcset alt usemap ismap width height');\n      add('iframe', 'src name width height', flowContent);\n      add('embed', 'src type width height');\n      add('object', 'data type typemustmatch name usemap form width height', [\n        flowContent,\n        'param'\n      ].join(' '));\n      add('param', 'name value');\n      add('map', 'name', [\n        flowContent,\n        'area'\n      ].join(' '));\n      add('area', 'alt coords shape href target rel media hreflang type');\n      add('table', 'border', 'caption colgroup thead tfoot tbody tr' + (type === 'html4' ? ' col' : ''));\n      add('colgroup', 'span', 'col');\n      add('col', 'span');\n      add('tbody thead tfoot', '', 'tr');\n      add('tr', '', 'td th');\n      add('td', 'colspan rowspan headers', flowContent);\n      add('th', 'colspan rowspan headers scope abbr', flowContent);\n      add('form', 'accept-charset action autocomplete enctype method name novalidate target', flowContent);\n      add('fieldset', 'disabled form name', [\n        flowContent,\n        'legend'\n      ].join(' '));\n      add('label', 'form for', phrasingContent);\n      add('input', 'accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate ' + 'formtarget height list max maxlength min multiple name pattern readonly required size src step type value width');\n      add('button', 'disabled form formaction formenctype formmethod formnovalidate formtarget name type value', type === 'html4' ? flowContent : phrasingContent);\n      add('select', 'disabled form multiple name required size', 'option optgroup');\n      add('optgroup', 'disabled label', 'option');\n      add('option', 'disabled label selected value');\n      add('textarea', 'cols dirname disabled form maxlength name readonly required rows wrap');\n      add('menu', 'type label', [\n        flowContent,\n        'li'\n      ].join(' '));\n      add('noscript', '', flowContent);\n      if (type !== 'html4') {\n        add('wbr');\n        add('ruby', '', [\n          phrasingContent,\n          'rt rp'\n        ].join(' '));\n        add('figcaption', '', flowContent);\n        add('mark rt rp summary bdi', '', phrasingContent);\n        add('canvas', 'width height', flowContent);\n        add('video', 'src crossorigin poster preload autoplay mediagroup loop ' + 'muted controls width height buffered', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('audio', 'src crossorigin preload autoplay mediagroup loop muted controls ' + 'buffered volume', [\n          flowContent,\n          'track source'\n        ].join(' '));\n        add('picture', '', 'img source');\n        add('source', 'src srcset type media sizes');\n        add('track', 'kind src srclang label default');\n        add('datalist', '', [\n          phrasingContent,\n          'option'\n        ].join(' '));\n        add('article section nav aside main header footer', '', flowContent);\n        add('hgroup', '', 'h1 h2 h3 h4 h5 h6');\n        add('figure', '', [\n          flowContent,\n          'figcaption'\n        ].join(' '));\n        add('time', 'datetime', phrasingContent);\n        add('dialog', 'open', flowContent);\n        add('command', 'type label icon disabled checked radiogroup command');\n        add('output', 'for form name', phrasingContent);\n        add('progress', 'value max', phrasingContent);\n        add('meter', 'value min max low high optimum', phrasingContent);\n        add('details', 'open', [\n          flowContent,\n          'summary'\n        ].join(' '));\n        add('keygen', 'autofocus challenge disabled form keytype name');\n      }\n      if (type !== 'html5-strict') {\n        addAttrs('script', 'language xml:space');\n        addAttrs('style', 'xml:space');\n        addAttrs('object', 'declare classid code codebase codetype archive standby align border hspace vspace');\n        addAttrs('embed', 'align name hspace vspace');\n        addAttrs('param', 'valuetype type');\n        addAttrs('a', 'charset name rev shape coords');\n        addAttrs('br', 'clear');\n        addAttrs('applet', 'codebase archive code object alt name width height align hspace vspace');\n        addAttrs('img', 'name longdesc align border hspace vspace');\n        addAttrs('iframe', 'longdesc frameborder marginwidth marginheight scrolling align');\n        addAttrs('font basefont', 'size color face');\n        addAttrs('input', 'usemap align');\n        addAttrs('select');\n        addAttrs('textarea');\n        addAttrs('h1 h2 h3 h4 h5 h6 div p legend caption', 'align');\n        addAttrs('ul', 'type compact');\n        addAttrs('li', 'type');\n        addAttrs('ol dl menu dir', 'compact');\n        addAttrs('pre', 'width xml:space');\n        addAttrs('hr', 'align noshade size width');\n        addAttrs('isindex', 'prompt');\n        addAttrs('table', 'summary width frame rules cellspacing cellpadding align bgcolor');\n        addAttrs('col', 'width align char charoff valign');\n        addAttrs('colgroup', 'width align char charoff valign');\n        addAttrs('thead', 'align char charoff valign');\n        addAttrs('tr', 'align char charoff valign bgcolor');\n        addAttrs('th', 'axis align char charoff valign nowrap bgcolor width height');\n        addAttrs('form', 'accept');\n        addAttrs('td', 'abbr axis scope align char charoff valign nowrap bgcolor width height');\n        addAttrs('tfoot', 'align char charoff valign');\n        addAttrs('tbody', 'align char charoff valign');\n        addAttrs('area', 'nohref');\n        addAttrs('body', 'background bgcolor text link vlink alink');\n      }\n      if (type !== 'html4') {\n        addAttrs('input button select textarea', 'autofocus');\n        addAttrs('input textarea', 'placeholder');\n        addAttrs('a', 'download');\n        addAttrs('link script img', 'crossorigin');\n        addAttrs('img', 'loading');\n        addAttrs('iframe', 'sandbox seamless allowfullscreen loading');\n      }\n      each$h(split$1('a form meter progress dfn'), function (name) {\n        if (schema[name]) {\n          delete schema[name].children[name];\n        }\n      });\n      delete schema.caption.children.table;\n      delete schema.script;\n      mapCache[type] = schema;\n      return schema;\n    };\n    var compileElementMap = function (value, mode) {\n      var styles;\n      if (value) {\n        styles = {};\n        if (typeof value === 'string') {\n          value = { '*': value };\n        }\n        each$h(value, function (value, key) {\n          styles[key] = styles[key.toUpperCase()] = mode === 'map' ? makeMap$2(value, /[, ]/) : explode$3(value, /[, ]/);\n        });\n      }\n      return styles;\n    };\n    var Schema = function (settings) {\n      var elements = {};\n      var children = {};\n      var patternElements = [];\n      var customElementsMap = {}, specialElements = {};\n      var createLookupTable = function (option, defaultValue, extendWith) {\n        var value = settings[option];\n        if (!value) {\n          value = mapCache[option];\n          if (!value) {\n            value = makeMap$2(defaultValue, ' ', makeMap$2(defaultValue.toUpperCase(), ' '));\n            value = extend$5(value, extendWith);\n            mapCache[option] = value;\n          }\n        } else {\n          value = makeMap$2(value, /[, ]/, makeMap$2(value.toUpperCase(), /[, ]/));\n        }\n        return value;\n      };\n      settings = settings || {};\n      var schemaItems = compileSchema(settings.schema);\n      if (settings.verify_html === false) {\n        settings.valid_elements = '*[*]';\n      }\n      var validStyles = compileElementMap(settings.valid_styles);\n      var invalidStyles = compileElementMap(settings.invalid_styles, 'map');\n      var validClasses = compileElementMap(settings.valid_classes, 'map');\n      var whiteSpaceElementsMap = createLookupTable('whitespace_elements', 'pre script noscript style textarea video audio iframe object code');\n      var selfClosingElementsMap = createLookupTable('self_closing_elements', 'colgroup dd dt li option p td tfoot th thead tr');\n      var shortEndedElementsMap = createLookupTable('short_ended_elements', 'area base basefont br col frame hr img input isindex link ' + 'meta param embed source wbr track');\n      var boolAttrMap = createLookupTable('boolean_attributes', 'checked compact declare defer disabled ismap multiple nohref noresize ' + 'noshade nowrap readonly selected autoplay loop controls');\n      var nonEmptyOrMoveCaretBeforeOnEnter = 'td th iframe video audio object script code';\n      var nonEmptyElementsMap = createLookupTable('non_empty_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' pre', shortEndedElementsMap);\n      var moveCaretBeforeOnEnterElementsMap = createLookupTable('move_caret_before_on_enter_elements', nonEmptyOrMoveCaretBeforeOnEnter + ' table', shortEndedElementsMap);\n      var textBlockElementsMap = createLookupTable('text_block_elements', 'h1 h2 h3 h4 h5 h6 p div address pre form ' + 'blockquote center dir fieldset header footer article section hgroup aside main nav figure');\n      var blockElementsMap = createLookupTable('block_elements', 'hr table tbody thead tfoot ' + 'th tr td li ol ul caption dl dt dd noscript menu isindex option ' + 'datalist select optgroup figcaption details summary', textBlockElementsMap);\n      var textInlineElementsMap = createLookupTable('text_inline_elements', 'span strong b em i font strike u var cite ' + 'dfn code mark q sup sub samp');\n      each$h((settings.special || 'script noscript iframe noframes noembed title style textarea xmp').split(' '), function (name) {\n        specialElements[name] = new RegExp('</' + name + '[^>]*>', 'gi');\n      });\n      var patternToRegExp = function (str) {\n        return new RegExp('^' + str.replace(/([?+*])/g, '.$1') + '$');\n      };\n      var addValidElements = function (validElements) {\n        var ei, el, ai, al, matches, element, attr, attrData, elementName, attrName, attrType, attributes, attributesOrder, prefix, outputName, globalAttributes, globalAttributesOrder, value;\n        var elementRuleRegExp = /^([#+\\-])?([^\\[!\\/]+)(?:\\/([^\\[!]+))?(?:(!?)\\[([^\\]]+)])?$/, attrRuleRegExp = /^([!\\-])?(\\w+[\\\\:]:\\w+|[^=:<]+)?(?:([=:<])(.*))?$/, hasPatternsRegExp = /[*?+]/;\n        if (validElements) {\n          var validElementsArr = split$1(validElements, ',');\n          if (elements['@']) {\n            globalAttributes = elements['@'].attributes;\n            globalAttributesOrder = elements['@'].attributesOrder;\n          }\n          for (ei = 0, el = validElementsArr.length; ei < el; ei++) {\n            matches = elementRuleRegExp.exec(validElementsArr[ei]);\n            if (matches) {\n              prefix = matches[1];\n              elementName = matches[2];\n              outputName = matches[3];\n              attrData = matches[5];\n              attributes = {};\n              attributesOrder = [];\n              element = {\n                attributes: attributes,\n                attributesOrder: attributesOrder\n              };\n              if (prefix === '#') {\n                element.paddEmpty = true;\n              }\n              if (prefix === '-') {\n                element.removeEmpty = true;\n              }\n              if (matches[4] === '!') {\n                element.removeEmptyAttrs = true;\n              }\n              if (globalAttributes) {\n                each$j(globalAttributes, function (value, key) {\n                  attributes[key] = value;\n                });\n                attributesOrder.push.apply(attributesOrder, globalAttributesOrder);\n              }\n              if (attrData) {\n                attrData = split$1(attrData, '|');\n                for (ai = 0, al = attrData.length; ai < al; ai++) {\n                  matches = attrRuleRegExp.exec(attrData[ai]);\n                  if (matches) {\n                    attr = {};\n                    attrType = matches[1];\n                    attrName = matches[2].replace(/[\\\\:]:/g, ':');\n                    prefix = matches[3];\n                    value = matches[4];\n                    if (attrType === '!') {\n                      element.attributesRequired = element.attributesRequired || [];\n                      element.attributesRequired.push(attrName);\n                      attr.required = true;\n                    }\n                    if (attrType === '-') {\n                      delete attributes[attrName];\n                      attributesOrder.splice(inArray$2(attributesOrder, attrName), 1);\n                      continue;\n                    }\n                    if (prefix) {\n                      if (prefix === '=') {\n                        element.attributesDefault = element.attributesDefault || [];\n                        element.attributesDefault.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.defaultValue = value;\n                      }\n                      if (prefix === ':') {\n                        element.attributesForced = element.attributesForced || [];\n                        element.attributesForced.push({\n                          name: attrName,\n                          value: value\n                        });\n                        attr.forcedValue = value;\n                      }\n                      if (prefix === '<') {\n                        attr.validValues = makeMap$2(value, '?');\n                      }\n                    }\n                    if (hasPatternsRegExp.test(attrName)) {\n                      element.attributePatterns = element.attributePatterns || [];\n                      attr.pattern = patternToRegExp(attrName);\n                      element.attributePatterns.push(attr);\n                    } else {\n                      if (!attributes[attrName]) {\n                        attributesOrder.push(attrName);\n                      }\n                      attributes[attrName] = attr;\n                    }\n                  }\n                }\n              }\n              if (!globalAttributes && elementName === '@') {\n                globalAttributes = attributes;\n                globalAttributesOrder = attributesOrder;\n              }\n              if (outputName) {\n                element.outputName = elementName;\n                elements[outputName] = element;\n              }\n              if (hasPatternsRegExp.test(elementName)) {\n                element.pattern = patternToRegExp(elementName);\n                patternElements.push(element);\n              } else {\n                elements[elementName] = element;\n              }\n            }\n          }\n        }\n      };\n      var setValidElements = function (validElements) {\n        elements = {};\n        patternElements = [];\n        addValidElements(validElements);\n        each$h(schemaItems, function (element, name) {\n          children[name] = element.children;\n        });\n      };\n      var addCustomElements = function (customElements) {\n        var customElementRegExp = /^(~)?(.+)$/;\n        if (customElements) {\n          mapCache.text_block_elements = mapCache.block_elements = null;\n          each$h(split$1(customElements, ','), function (rule) {\n            var matches = customElementRegExp.exec(rule), inline = matches[1] === '~', cloneName = inline ? 'span' : 'div', name = matches[2];\n            children[name] = children[cloneName];\n            customElementsMap[name] = cloneName;\n            if (!inline) {\n              blockElementsMap[name.toUpperCase()] = {};\n              blockElementsMap[name] = {};\n            }\n            if (!elements[name]) {\n              var customRule = elements[cloneName];\n              customRule = extend$5({}, customRule);\n              delete customRule.removeEmptyAttrs;\n              delete customRule.removeEmpty;\n              elements[name] = customRule;\n            }\n            each$h(children, function (element, elmName) {\n              if (element[cloneName]) {\n                children[elmName] = element = extend$5({}, children[elmName]);\n                element[name] = element[cloneName];\n              }\n            });\n          });\n        }\n      };\n      var addValidChildren = function (validChildren) {\n        var childRuleRegExp = /^([+\\-]?)([A-Za-z0-9_\\-.\\u00b7\\u00c0-\\u00d6\\u00d8-\\u00f6\\u00f8-\\u037d\\u037f-\\u1fff\\u200c-\\u200d\\u203f-\\u2040\\u2070-\\u218f\\u2c00-\\u2fef\\u3001-\\ud7ff\\uf900-\\ufdcf\\ufdf0-\\ufffd]+)\\[([^\\]]+)]$/;\n        mapCache[settings.schema] = null;\n        if (validChildren) {\n          each$h(split$1(validChildren, ','), function (rule) {\n            var matches = childRuleRegExp.exec(rule);\n            var parent, prefix;\n            if (matches) {\n              prefix = matches[1];\n              if (prefix) {\n                parent = children[matches[2]];\n              } else {\n                parent = children[matches[2]] = { '#comment': {} };\n              }\n              parent = children[matches[2]];\n              each$h(split$1(matches[3], '|'), function (child) {\n                if (prefix === '-') {\n                  delete parent[child];\n                } else {\n                  parent[child] = {};\n                }\n              });\n            }\n          });\n        }\n      };\n      var getElementRule = function (name) {\n        var element = elements[name], i;\n        if (element) {\n          return element;\n        }\n        i = patternElements.length;\n        while (i--) {\n          element = patternElements[i];\n          if (element.pattern.test(name)) {\n            return element;\n          }\n        }\n      };\n      if (!settings.valid_elements) {\n        each$h(schemaItems, function (element, name) {\n          elements[name] = {\n            attributes: element.attributes,\n            attributesOrder: element.attributesOrder\n          };\n          children[name] = element.children;\n        });\n        if (settings.schema !== 'html5') {\n          each$h(split$1('strong/b em/i'), function (item) {\n            var items = split$1(item, '/');\n            elements[items[1]].outputName = items[0];\n          });\n        }\n        each$h(split$1('ol ul sub sup blockquote span font a table tbody strong em b i'), function (name) {\n          if (elements[name]) {\n            elements[name].removeEmpty = true;\n          }\n        });\n        each$h(split$1('p h1 h2 h3 h4 h5 h6 th td pre div address caption li'), function (name) {\n          elements[name].paddEmpty = true;\n        });\n        each$h(split$1('span'), function (name) {\n          elements[name].removeEmptyAttrs = true;\n        });\n      } else {\n        setValidElements(settings.valid_elements);\n      }\n      addCustomElements(settings.custom_elements);\n      addValidChildren(settings.valid_children);\n      addValidElements(settings.extended_valid_elements);\n      addValidChildren('+ol[ul|ol],+ul[ul|ol]');\n      each$h({\n        dd: 'dl',\n        dt: 'dl',\n        li: 'ul ol',\n        td: 'tr',\n        th: 'tr',\n        tr: 'tbody thead tfoot',\n        tbody: 'table',\n        thead: 'table',\n        tfoot: 'table',\n        legend: 'fieldset',\n        area: 'map',\n        param: 'video audio object'\n      }, function (parents, item) {\n        if (elements[item]) {\n          elements[item].parentsRequired = split$1(parents);\n        }\n      });\n      if (settings.invalid_elements) {\n        each$h(explode$3(settings.invalid_elements), function (item) {\n          if (elements[item]) {\n            delete elements[item];\n          }\n        });\n      }\n      if (!getElementRule('span')) {\n        addValidElements('span[!data-mce-type|*]');\n      }\n      var getValidStyles = constant(validStyles);\n      var getInvalidStyles = constant(invalidStyles);\n      var getValidClasses = constant(validClasses);\n      var getBoolAttrs = constant(boolAttrMap);\n      var getBlockElements = constant(blockElementsMap);\n      var getTextBlockElements = constant(textBlockElementsMap);\n      var getTextInlineElements = constant(textInlineElementsMap);\n      var getShortEndedElements = constant(shortEndedElementsMap);\n      var getSelfClosingElements = constant(selfClosingElementsMap);\n      var getNonEmptyElements = constant(nonEmptyElementsMap);\n      var getMoveCaretBeforeOnEnterElements = constant(moveCaretBeforeOnEnterElementsMap);\n      var getWhiteSpaceElements = constant(whiteSpaceElementsMap);\n      var getSpecialElements = constant(specialElements);\n      var isValidChild = function (name, child) {\n        var parent = children[name.toLowerCase()];\n        return !!(parent && parent[child.toLowerCase()]);\n      };\n      var isValid = function (name, attr) {\n        var attrPatterns, i;\n        var rule = getElementRule(name);\n        if (rule) {\n          if (attr) {\n            if (rule.attributes[attr]) {\n              return true;\n            }\n            attrPatterns = rule.attributePatterns;\n            if (attrPatterns) {\n              i = attrPatterns.length;\n              while (i--) {\n                if (attrPatterns[i].pattern.test(name)) {\n                  return true;\n                }\n              }\n            }\n          } else {\n            return true;\n          }\n        }\n        return false;\n      };\n      var getCustomElements = constant(customElementsMap);\n      return {\n        children: children,\n        elements: elements,\n        getValidStyles: getValidStyles,\n        getValidClasses: getValidClasses,\n        getBlockElements: getBlockElements,\n        getInvalidStyles: getInvalidStyles,\n        getShortEndedElements: getShortEndedElements,\n        getTextBlockElements: getTextBlockElements,\n        getTextInlineElements: getTextInlineElements,\n        getBoolAttrs: getBoolAttrs,\n        getElementRule: getElementRule,\n        getSelfClosingElements: getSelfClosingElements,\n        getNonEmptyElements: getNonEmptyElements,\n        getMoveCaretBeforeOnEnterElements: getMoveCaretBeforeOnEnterElements,\n        getWhiteSpaceElements: getWhiteSpaceElements,\n        getSpecialElements: getSpecialElements,\n        isValidChild: isValidChild,\n        isValid: isValid,\n        getCustomElements: getCustomElements,\n        addValidElements: addValidElements,\n        setValidElements: setValidElements,\n        addCustomElements: addCustomElements,\n        addValidChildren: addValidChildren\n      };\n    };\n\n    var toHex = function (match, r, g, b) {\n      var hex = function (val) {\n        val = parseInt(val, 10).toString(16);\n        return val.length > 1 ? val : '0' + val;\n      };\n      return '#' + hex(r) + hex(g) + hex(b);\n    };\n    var Styles = function (settings, schema) {\n      var _this = this;\n      var rgbRegExp = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*\\)/gi;\n      var urlOrStrRegExp = /(?:url(?:(?:\\(\\s*\\\"([^\\\"]+)\\\"\\s*\\))|(?:\\(\\s*\\'([^\\']+)\\'\\s*\\))|(?:\\(\\s*([^)\\s]+)\\s*\\))))|(?:\\'([^\\']+)\\')|(?:\\\"([^\\\"]+)\\\")/gi;\n      var styleRegExp = /\\s*([^:]+):\\s*([^;]+);?/g;\n      var trimRightRegExp = /\\s+$/;\n      var i;\n      var encodingLookup = {};\n      var validStyles;\n      var invalidStyles;\n      var invisibleChar = zeroWidth;\n      settings = settings || {};\n      if (schema) {\n        validStyles = schema.getValidStyles();\n        invalidStyles = schema.getInvalidStyles();\n      }\n      var encodingItems = ('\\\\\" \\\\\\' \\\\; \\\\: ; : ' + invisibleChar).split(' ');\n      for (i = 0; i < encodingItems.length; i++) {\n        encodingLookup[encodingItems[i]] = invisibleChar + i;\n        encodingLookup[invisibleChar + i] = encodingItems[i];\n      }\n      return {\n        toHex: function (color) {\n          return color.replace(rgbRegExp, toHex);\n        },\n        parse: function (css) {\n          var styles = {};\n          var matches, name, value, isEncoded;\n          var urlConverter = settings.url_converter;\n          var urlConverterScope = settings.url_converter_scope || _this;\n          var compress = function (prefix, suffix, noJoin) {\n            var top = styles[prefix + '-top' + suffix];\n            if (!top) {\n              return;\n            }\n            var right = styles[prefix + '-right' + suffix];\n            if (!right) {\n              return;\n            }\n            var bottom = styles[prefix + '-bottom' + suffix];\n            if (!bottom) {\n              return;\n            }\n            var left = styles[prefix + '-left' + suffix];\n            if (!left) {\n              return;\n            }\n            var box = [\n              top,\n              right,\n              bottom,\n              left\n            ];\n            i = box.length - 1;\n            while (i--) {\n              if (box[i] !== box[i + 1]) {\n                break;\n              }\n            }\n            if (i > -1 && noJoin) {\n              return;\n            }\n            styles[prefix + suffix] = i === -1 ? box[0] : box.join(' ');\n            delete styles[prefix + '-top' + suffix];\n            delete styles[prefix + '-right' + suffix];\n            delete styles[prefix + '-bottom' + suffix];\n            delete styles[prefix + '-left' + suffix];\n          };\n          var canCompress = function (key) {\n            var value = styles[key], i;\n            if (!value) {\n              return;\n            }\n            value = value.split(' ');\n            i = value.length;\n            while (i--) {\n              if (value[i] !== value[0]) {\n                return false;\n              }\n            }\n            styles[key] = value[0];\n            return true;\n          };\n          var compress2 = function (target, a, b, c) {\n            if (!canCompress(a)) {\n              return;\n            }\n            if (!canCompress(b)) {\n              return;\n            }\n            if (!canCompress(c)) {\n              return;\n            }\n            styles[target] = styles[a] + ' ' + styles[b] + ' ' + styles[c];\n            delete styles[a];\n            delete styles[b];\n            delete styles[c];\n          };\n          var encode = function (str) {\n            isEncoded = true;\n            return encodingLookup[str];\n          };\n          var decode = function (str, keepSlashes) {\n            if (isEncoded) {\n              str = str.replace(/\\uFEFF[0-9]/g, function (str) {\n                return encodingLookup[str];\n              });\n            }\n            if (!keepSlashes) {\n              str = str.replace(/\\\\([\\'\\\";:])/g, '$1');\n            }\n            return str;\n          };\n          var decodeSingleHexSequence = function (escSeq) {\n            return String.fromCharCode(parseInt(escSeq.slice(1), 16));\n          };\n          var decodeHexSequences = function (value) {\n            return value.replace(/\\\\[0-9a-f]+/gi, decodeSingleHexSequence);\n          };\n          var processUrl = function (match, url, url2, url3, str, str2) {\n            str = str || str2;\n            if (str) {\n              str = decode(str);\n              return '\\'' + str.replace(/\\'/g, '\\\\\\'') + '\\'';\n            }\n            url = decode(url || url2 || url3);\n            if (!settings.allow_script_urls) {\n              var scriptUrl = url.replace(/[\\s\\r\\n]+/g, '');\n              if (/(java|vb)script:/i.test(scriptUrl)) {\n                return '';\n              }\n              if (!settings.allow_svg_data_urls && /^data:image\\/svg/i.test(scriptUrl)) {\n                return '';\n              }\n            }\n            if (urlConverter) {\n              url = urlConverter.call(urlConverterScope, url, 'style');\n            }\n            return 'url(\\'' + url.replace(/\\'/g, '\\\\\\'') + '\\')';\n          };\n          if (css) {\n            css = css.replace(/[\\u0000-\\u001F]/g, '');\n            css = css.replace(/\\\\[\\\"\\';:\\uFEFF]/g, encode).replace(/\\\"[^\\\"]+\\\"|\\'[^\\']+\\'/g, function (str) {\n              return str.replace(/[;:]/g, encode);\n            });\n            while (matches = styleRegExp.exec(css)) {\n              styleRegExp.lastIndex = matches.index + matches[0].length;\n              name = matches[1].replace(trimRightRegExp, '').toLowerCase();\n              value = matches[2].replace(trimRightRegExp, '');\n              if (name && value) {\n                name = decodeHexSequences(name);\n                value = decodeHexSequences(value);\n                if (name.indexOf(invisibleChar) !== -1 || name.indexOf('\"') !== -1) {\n                  continue;\n                }\n                if (!settings.allow_script_urls && (name === 'behavior' || /expression\\s*\\(|\\/\\*|\\*\\//.test(value))) {\n                  continue;\n                }\n                if (name === 'font-weight' && value === '700') {\n                  value = 'bold';\n                } else if (name === 'color' || name === 'background-color') {\n                  value = value.toLowerCase();\n                }\n                value = value.replace(rgbRegExp, toHex);\n                value = value.replace(urlOrStrRegExp, processUrl);\n                styles[name] = isEncoded ? decode(value, true) : value;\n              }\n            }\n            compress('border', '', true);\n            compress('border', '-width');\n            compress('border', '-color');\n            compress('border', '-style');\n            compress('padding', '');\n            compress('margin', '');\n            compress2('border', 'border-width', 'border-style', 'border-color');\n            if (styles.border === 'medium none') {\n              delete styles.border;\n            }\n            if (styles['border-image'] === 'none') {\n              delete styles['border-image'];\n            }\n          }\n          return styles;\n        },\n        serialize: function (styles, elementName) {\n          var css = '';\n          var serializeStyles = function (name) {\n            var value;\n            var styleList = validStyles[name];\n            if (styleList) {\n              for (var i_1 = 0, l = styleList.length; i_1 < l; i_1++) {\n                name = styleList[i_1];\n                value = styles[name];\n                if (value) {\n                  css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n                }\n              }\n            }\n          };\n          var isValid = function (name, elementName) {\n            var styleMap = invalidStyles['*'];\n            if (styleMap && styleMap[name]) {\n              return false;\n            }\n            styleMap = invalidStyles[elementName];\n            return !(styleMap && styleMap[name]);\n          };\n          if (elementName && validStyles) {\n            serializeStyles('*');\n            serializeStyles(elementName);\n          } else {\n            each$j(styles, function (value, name) {\n              if (value && (!invalidStyles || isValid(name, elementName))) {\n                css += (css.length > 0 ? ' ' : '') + name + ': ' + value + ';';\n              }\n            });\n          }\n          return css;\n        }\n      };\n    };\n\n    var deprecated = {\n      keyLocation: true,\n      layerX: true,\n      layerY: true,\n      returnValue: true,\n      webkitMovementX: true,\n      webkitMovementY: true,\n      keyIdentifier: true,\n      mozPressure: true\n    };\n    var isNativeEvent = function (event) {\n      return event instanceof Event || isFunction(event.initEvent);\n    };\n    var hasIsDefaultPrevented = function (event) {\n      return event.isDefaultPrevented === always || event.isDefaultPrevented === never;\n    };\n    var needsNormalizing = function (event) {\n      return isNullable(event.preventDefault) || isNativeEvent(event);\n    };\n    var clone$2 = function (originalEvent, data) {\n      var event = data !== null && data !== void 0 ? data : {};\n      for (var name_1 in originalEvent) {\n        if (!has$2(deprecated, name_1)) {\n          event[name_1] = originalEvent[name_1];\n        }\n      }\n      if (isNonNullable(event.composedPath)) {\n        event.composedPath = function () {\n          return originalEvent.composedPath();\n        };\n      }\n      return event;\n    };\n    var normalize$3 = function (type, originalEvent, fallbackTarget, data) {\n      var _a;\n      var event = clone$2(originalEvent, data);\n      event.type = type;\n      if (isNullable(event.target)) {\n        event.target = (_a = event.srcElement) !== null && _a !== void 0 ? _a : fallbackTarget;\n      }\n      if (needsNormalizing(originalEvent)) {\n        event.preventDefault = function () {\n          event.defaultPrevented = true;\n          event.isDefaultPrevented = always;\n          if (isFunction(originalEvent.preventDefault)) {\n            originalEvent.preventDefault();\n          } else if (isNativeEvent(originalEvent)) {\n            originalEvent.returnValue = false;\n          }\n        };\n        event.stopPropagation = function () {\n          event.cancelBubble = true;\n          event.isPropagationStopped = always;\n          if (isFunction(originalEvent.stopPropagation)) {\n            originalEvent.stopPropagation();\n          } else if (isNativeEvent(originalEvent)) {\n            originalEvent.cancelBubble = true;\n          }\n        };\n        event.stopImmediatePropagation = function () {\n          event.isImmediatePropagationStopped = always;\n          event.stopPropagation();\n        };\n        if (!hasIsDefaultPrevented(event)) {\n          event.isDefaultPrevented = event.defaultPrevented === true ? always : never;\n          event.isPropagationStopped = event.cancelBubble === true ? always : never;\n          event.isImmediatePropagationStopped = never;\n        }\n      }\n      return event;\n    };\n\n    var eventExpandoPrefix = 'mce-data-';\n    var mouseEventRe = /^(?:mouse|contextmenu)|click/;\n    var addEvent = function (target, name, callback, capture) {\n      if (target.addEventListener) {\n        target.addEventListener(name, callback, capture || false);\n      } else if (target.attachEvent) {\n        target.attachEvent('on' + name, callback);\n      }\n    };\n    var removeEvent = function (target, name, callback, capture) {\n      if (target.removeEventListener) {\n        target.removeEventListener(name, callback, capture || false);\n      } else if (target.detachEvent) {\n        target.detachEvent('on' + name, callback);\n      }\n    };\n    var isMouseEvent = function (event) {\n      return isNonNullable(event) && mouseEventRe.test(event.type);\n    };\n    var fix = function (originalEvent, data) {\n      var event = normalize$3(originalEvent.type, originalEvent, document, data);\n      if (isMouseEvent(originalEvent) && isUndefined(originalEvent.pageX) && !isUndefined(originalEvent.clientX)) {\n        var eventDoc = event.target.ownerDocument || document;\n        var doc = eventDoc.documentElement;\n        var body = eventDoc.body;\n        var mouseEvent = event;\n        mouseEvent.pageX = originalEvent.clientX + (doc && doc.scrollLeft || body && body.scrollLeft || 0) - (doc && doc.clientLeft || body && body.clientLeft || 0);\n        mouseEvent.pageY = originalEvent.clientY + (doc && doc.scrollTop || body && body.scrollTop || 0) - (doc && doc.clientTop || body && body.clientTop || 0);\n      }\n      if (isUndefined(event.metaKey)) {\n        event.metaKey = false;\n      }\n      return event;\n    };\n    var bindOnReady = function (win, callback, eventUtils) {\n      var doc = win.document, event = { type: 'ready' };\n      if (eventUtils.domLoaded) {\n        callback(event);\n        return;\n      }\n      var isDocReady = function () {\n        return doc.readyState === 'complete' || doc.readyState === 'interactive' && doc.body;\n      };\n      var readyHandler = function () {\n        removeEvent(win, 'DOMContentLoaded', readyHandler);\n        removeEvent(win, 'load', readyHandler);\n        if (!eventUtils.domLoaded) {\n          eventUtils.domLoaded = true;\n          callback(event);\n        }\n        win = null;\n      };\n      if (isDocReady()) {\n        readyHandler();\n      } else {\n        addEvent(win, 'DOMContentLoaded', readyHandler);\n      }\n      if (!eventUtils.domLoaded) {\n        addEvent(win, 'load', readyHandler);\n      }\n    };\n    var EventUtils = function () {\n      function EventUtils() {\n        this.domLoaded = false;\n        this.events = {};\n        this.count = 1;\n        this.expando = eventExpandoPrefix + (+new Date()).toString(32);\n        this.hasMouseEnterLeave = 'onmouseenter' in document.documentElement;\n        this.hasFocusIn = 'onfocusin' in document.documentElement;\n        this.count = 1;\n      }\n      EventUtils.prototype.bind = function (target, names, callback, scope) {\n        var self = this;\n        var id, callbackList, i, name, fakeName, nativeHandler, capture;\n        var win = window;\n        var defaultNativeHandler = function (evt) {\n          self.executeHandlers(fix(evt || win.event), id);\n        };\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return;\n        }\n        if (!target[self.expando]) {\n          id = self.count++;\n          target[self.expando] = id;\n          self.events[id] = {};\n        } else {\n          id = target[self.expando];\n        }\n        scope = scope || target;\n        var namesList = names.split(' ');\n        i = namesList.length;\n        while (i--) {\n          name = namesList[i];\n          nativeHandler = defaultNativeHandler;\n          fakeName = capture = false;\n          if (name === 'DOMContentLoaded') {\n            name = 'ready';\n          }\n          if (self.domLoaded && name === 'ready' && target.readyState === 'complete') {\n            callback.call(scope, fix({ type: name }));\n            continue;\n          }\n          if (!self.hasMouseEnterLeave) {\n            fakeName = self.mouseEnterLeave[name];\n            if (fakeName) {\n              nativeHandler = function (evt) {\n                var current = evt.currentTarget;\n                var related = evt.relatedTarget;\n                if (related && current.contains) {\n                  related = current.contains(related);\n                } else {\n                  while (related && related !== current) {\n                    related = related.parentNode;\n                  }\n                }\n                if (!related) {\n                  evt = fix(evt || win.event);\n                  evt.type = evt.type === 'mouseout' ? 'mouseleave' : 'mouseenter';\n                  evt.target = current;\n                  self.executeHandlers(evt, id);\n                }\n              };\n            }\n          }\n          if (!self.hasFocusIn && (name === 'focusin' || name === 'focusout')) {\n            capture = true;\n            fakeName = name === 'focusin' ? 'focus' : 'blur';\n            nativeHandler = function (evt) {\n              evt = fix(evt || win.event);\n              evt.type = evt.type === 'focus' ? 'focusin' : 'focusout';\n              self.executeHandlers(evt, id);\n            };\n          }\n          callbackList = self.events[id][name];\n          if (!callbackList) {\n            self.events[id][name] = callbackList = [{\n                func: callback,\n                scope: scope\n              }];\n            callbackList.fakeName = fakeName;\n            callbackList.capture = capture;\n            callbackList.nativeHandler = nativeHandler;\n            if (name === 'ready') {\n              bindOnReady(target, nativeHandler, self);\n            } else {\n              addEvent(target, fakeName || name, nativeHandler, capture);\n            }\n          } else {\n            if (name === 'ready' && self.domLoaded) {\n              callback(fix({ type: name }));\n            } else {\n              callbackList.push({\n                func: callback,\n                scope: scope\n              });\n            }\n          }\n        }\n        target = callbackList = null;\n        return callback;\n      };\n      EventUtils.prototype.unbind = function (target, names, callback) {\n        var callbackList, i, ci, name, eventMap;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var id = target[this.expando];\n        if (id) {\n          eventMap = this.events[id];\n          if (names) {\n            var namesList = names.split(' ');\n            i = namesList.length;\n            while (i--) {\n              name = namesList[i];\n              callbackList = eventMap[name];\n              if (callbackList) {\n                if (callback) {\n                  ci = callbackList.length;\n                  while (ci--) {\n                    if (callbackList[ci].func === callback) {\n                      var nativeHandler = callbackList.nativeHandler;\n                      var fakeName = callbackList.fakeName, capture = callbackList.capture;\n                      callbackList = callbackList.slice(0, ci).concat(callbackList.slice(ci + 1));\n                      callbackList.nativeHandler = nativeHandler;\n                      callbackList.fakeName = fakeName;\n                      callbackList.capture = capture;\n                      eventMap[name] = callbackList;\n                    }\n                  }\n                }\n                if (!callback || callbackList.length === 0) {\n                  delete eventMap[name];\n                  removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n                }\n              }\n            }\n          } else {\n            each$j(eventMap, function (callbackList, name) {\n              removeEvent(target, callbackList.fakeName || name, callbackList.nativeHandler, callbackList.capture);\n            });\n            eventMap = {};\n          }\n          for (name in eventMap) {\n            if (has$2(eventMap, name)) {\n              return this;\n            }\n          }\n          delete this.events[id];\n          try {\n            delete target[this.expando];\n          } catch (ex) {\n            target[this.expando] = null;\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.fire = function (target, name, args) {\n        var id;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        var event = fix({\n          type: name,\n          target: target\n        }, args);\n        do {\n          id = target[this.expando];\n          if (id) {\n            this.executeHandlers(event, id);\n          }\n          target = target.parentNode || target.ownerDocument || target.defaultView || target.parentWindow;\n        } while (target && !event.isPropagationStopped());\n        return this;\n      };\n      EventUtils.prototype.clean = function (target) {\n        var i, children;\n        if (!target || target.nodeType === 3 || target.nodeType === 8) {\n          return this;\n        }\n        if (target[this.expando]) {\n          this.unbind(target);\n        }\n        if (!target.getElementsByTagName) {\n          target = target.document;\n        }\n        if (target && target.getElementsByTagName) {\n          this.unbind(target);\n          children = target.getElementsByTagName('*');\n          i = children.length;\n          while (i--) {\n            target = children[i];\n            if (target[this.expando]) {\n              this.unbind(target);\n            }\n          }\n        }\n        return this;\n      };\n      EventUtils.prototype.destroy = function () {\n        this.events = {};\n      };\n      EventUtils.prototype.cancel = function (e) {\n        if (e) {\n          e.preventDefault();\n          e.stopImmediatePropagation();\n        }\n        return false;\n      };\n      EventUtils.prototype.executeHandlers = function (evt, id) {\n        var container = this.events[id];\n        var callbackList = container && container[evt.type];\n        if (callbackList) {\n          for (var i = 0, l = callbackList.length; i < l; i++) {\n            var callback = callbackList[i];\n            if (callback && callback.func.call(callback.scope, evt) === false) {\n              evt.preventDefault();\n            }\n            if (evt.isImmediatePropagationStopped()) {\n              return;\n            }\n          }\n        }\n      };\n      EventUtils.Event = new EventUtils();\n      return EventUtils;\n    }();\n\n    var support, Expr, getText, isXML, tokenize, compile, select$1, outermostContext, sortInput, hasDuplicate, setDocument, document$1, docElem, documentIsHTML, rbuggyQSA, rbuggyMatches, matches, contains, expando = 'sizzle' + -new Date(), preferredDoc = window.document, dirruns = 0, done = 0, classCache = createCache(), tokenCache = createCache(), compilerCache = createCache(), sortOrder = function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n        }\n        return 0;\n      }, strundefined = typeof undefined, MAX_NEGATIVE = 1 << 31, hasOwn = {}.hasOwnProperty, arr = [], pop = arr.pop, push_native = arr.push, push$1 = arr.push, slice$1 = arr.slice, indexOf = arr.indexOf || function (elem) {\n        var i = 0, len = this.length;\n        for (; i < len; i++) {\n          if (this[i] === elem) {\n            return i;\n          }\n        }\n        return -1;\n      }, booleans = 'checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped', whitespace = '[\\\\x20\\\\t\\\\r\\\\n\\\\f]', identifier = '(?:\\\\\\\\.|[\\\\w-]|[^\\\\x00-\\\\xa0])+', attributes = '\\\\[' + whitespace + '*(' + identifier + ')(?:' + whitespace + '*([*^$|!~]?=)' + whitespace + '*(?:\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\"|(' + identifier + '))|)' + whitespace + '*\\\\]', pseudos = ':(' + identifier + ')(?:\\\\((' + '(\\'((?:\\\\\\\\.|[^\\\\\\\\\\'])*)\\'|\"((?:\\\\\\\\.|[^\\\\\\\\\"])*)\")|' + '((?:\\\\\\\\.|[^\\\\\\\\()[\\\\]]|' + attributes + ')*)|' + '.*' + ')\\\\)|)', rtrim = new RegExp('^' + whitespace + '+|((?:^|[^\\\\\\\\])(?:\\\\\\\\.)*)' + whitespace + '+$', 'g'), rcomma = new RegExp('^' + whitespace + '*,' + whitespace + '*'), rcombinators = new RegExp('^' + whitespace + '*([>+~]|' + whitespace + ')' + whitespace + '*'), rattributeQuotes = new RegExp('=' + whitespace + '*([^\\\\]\\'\"]*?)' + whitespace + '*\\\\]', 'g'), rpseudo = new RegExp(pseudos), ridentifier = new RegExp('^' + identifier + '$'), matchExpr = {\n        ID: new RegExp('^#(' + identifier + ')'),\n        CLASS: new RegExp('^\\\\.(' + identifier + ')'),\n        TAG: new RegExp('^(' + identifier + '|[*])'),\n        ATTR: new RegExp('^' + attributes),\n        PSEUDO: new RegExp('^' + pseudos),\n        CHILD: new RegExp('^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\\\(' + whitespace + '*(even|odd|(([+-]|)(\\\\d*)n|)' + whitespace + '*(?:([+-]|)' + whitespace + '*(\\\\d+)|))' + whitespace + '*\\\\)|)', 'i'),\n        bool: new RegExp('^(?:' + booleans + ')$', 'i'),\n        needsContext: new RegExp('^' + whitespace + '*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\\\(' + whitespace + '*((?:-\\\\d)?\\\\d*)' + whitespace + '*\\\\)|)(?=[^-]|$)', 'i')\n      }, rinputs = /^(?:input|select|textarea|button)$/i, rheader = /^h\\d$/i, rnative = /^[^{]+\\{\\s*\\[native \\w/, rquickExpr$1 = /^(?:#([\\w-]+)|(\\w+)|\\.([\\w-]+))$/, rsibling = /[+~]/, rescape = /'|\\\\/g, runescape = new RegExp('\\\\\\\\([\\\\da-f]{1,6}' + whitespace + '?|(' + whitespace + ')|.)', 'ig'), funescape = function (_, escaped, escapedWhitespace) {\n        var high = '0x' + escaped - 65536;\n        return high !== high || escapedWhitespace ? escaped : high < 0 ? String.fromCharCode(high + 65536) : String.fromCharCode(high >> 10 | 55296, high & 1023 | 56320);\n      };\n    try {\n      push$1.apply(arr = slice$1.call(preferredDoc.childNodes), preferredDoc.childNodes);\n      arr[preferredDoc.childNodes.length].nodeType;\n    } catch (e) {\n      push$1 = {\n        apply: arr.length ? function (target, els) {\n          push_native.apply(target, slice$1.call(els));\n        } : function (target, els) {\n          var j = target.length, i = 0;\n          while (target[j++] = els[i++]) {\n          }\n          target.length = j - 1;\n        }\n      };\n    }\n    var Sizzle = function (selector, context, results, seed) {\n      var match, elem, m, nodeType, i, groups, old, nid, newContext, newSelector;\n      if ((context ? context.ownerDocument || context : preferredDoc) !== document$1) {\n        setDocument(context);\n      }\n      context = context || document$1;\n      results = results || [];\n      if (!selector || typeof selector !== 'string') {\n        return results;\n      }\n      if ((nodeType = context.nodeType) !== 1 && nodeType !== 9) {\n        return [];\n      }\n      if (documentIsHTML && !seed) {\n        if (match = rquickExpr$1.exec(selector)) {\n          if (m = match[1]) {\n            if (nodeType === 9) {\n              elem = context.getElementById(m);\n              if (elem && elem.parentNode) {\n                if (elem.id === m) {\n                  results.push(elem);\n                  return results;\n                }\n              } else {\n                return results;\n              }\n            } else {\n              if (context.ownerDocument && (elem = context.ownerDocument.getElementById(m)) && contains(context, elem) && elem.id === m) {\n                results.push(elem);\n                return results;\n              }\n            }\n          } else if (match[2]) {\n            push$1.apply(results, context.getElementsByTagName(selector));\n            return results;\n          } else if ((m = match[3]) && support.getElementsByClassName) {\n            push$1.apply(results, context.getElementsByClassName(m));\n            return results;\n          }\n        }\n        if (support.qsa && (!rbuggyQSA || !rbuggyQSA.test(selector))) {\n          nid = old = expando;\n          newContext = context;\n          newSelector = nodeType === 9 && selector;\n          if (nodeType === 1 && context.nodeName.toLowerCase() !== 'object') {\n            groups = tokenize(selector);\n            if (old = context.getAttribute('id')) {\n              nid = old.replace(rescape, '\\\\$&');\n            } else {\n              context.setAttribute('id', nid);\n            }\n            nid = '[id=\\'' + nid + '\\'] ';\n            i = groups.length;\n            while (i--) {\n              groups[i] = nid + toSelector(groups[i]);\n            }\n            newContext = rsibling.test(selector) && testContext(context.parentNode) || context;\n            newSelector = groups.join(',');\n          }\n          if (newSelector) {\n            try {\n              push$1.apply(results, newContext.querySelectorAll(newSelector));\n              return results;\n            } catch (qsaError) {\n            } finally {\n              if (!old) {\n                context.removeAttribute('id');\n              }\n            }\n          }\n        }\n      }\n      return select$1(selector.replace(rtrim, '$1'), context, results, seed);\n    };\n    function createCache() {\n      var keys = [];\n      function cache(key, value) {\n        if (keys.push(key + ' ') > Expr.cacheLength) {\n          delete cache[keys.shift()];\n        }\n        return cache[key + ' '] = value;\n      }\n      return cache;\n    }\n    function markFunction(fn) {\n      fn[expando] = true;\n      return fn;\n    }\n    function siblingCheck(a, b) {\n      var cur = b && a, diff = cur && a.nodeType === 1 && b.nodeType === 1 && (~b.sourceIndex || MAX_NEGATIVE) - (~a.sourceIndex || MAX_NEGATIVE);\n      if (diff) {\n        return diff;\n      }\n      if (cur) {\n        while (cur = cur.nextSibling) {\n          if (cur === b) {\n            return -1;\n          }\n        }\n      }\n      return a ? 1 : -1;\n    }\n    function createInputPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return name === 'input' && elem.type === type;\n      };\n    }\n    function createButtonPseudo(type) {\n      return function (elem) {\n        var name = elem.nodeName.toLowerCase();\n        return (name === 'input' || name === 'button') && elem.type === type;\n      };\n    }\n    function createPositionalPseudo(fn) {\n      return markFunction(function (argument) {\n        argument = +argument;\n        return markFunction(function (seed, matches) {\n          var j, matchIndexes = fn([], seed.length, argument), i = matchIndexes.length;\n          while (i--) {\n            if (seed[j = matchIndexes[i]]) {\n              seed[j] = !(matches[j] = seed[j]);\n            }\n          }\n        });\n      });\n    }\n    function testContext(context) {\n      return context && typeof context.getElementsByTagName !== strundefined && context;\n    }\n    support = Sizzle.support = {};\n    isXML = Sizzle.isXML = function (elem) {\n      var documentElement = elem && (elem.ownerDocument || elem).documentElement;\n      return documentElement ? documentElement.nodeName !== 'HTML' : false;\n    };\n    setDocument = Sizzle.setDocument = function (node) {\n      var hasCompare, doc = node ? node.ownerDocument || node : preferredDoc, parent = doc.defaultView;\n      function getTop(win) {\n        try {\n          return win.top;\n        } catch (ex) {\n        }\n        return null;\n      }\n      if (doc === document$1 || doc.nodeType !== 9 || !doc.documentElement) {\n        return document$1;\n      }\n      document$1 = doc;\n      docElem = doc.documentElement;\n      documentIsHTML = !isXML(doc);\n      if (parent && parent !== getTop(parent)) {\n        if (parent.addEventListener) {\n          parent.addEventListener('unload', function () {\n            setDocument();\n          }, false);\n        } else if (parent.attachEvent) {\n          parent.attachEvent('onunload', function () {\n            setDocument();\n          });\n        }\n      }\n      support.attributes = true;\n      support.getElementsByTagName = true;\n      support.getElementsByClassName = rnative.test(doc.getElementsByClassName);\n      support.getById = true;\n      Expr.find.ID = function (id, context) {\n        if (typeof context.getElementById !== strundefined && documentIsHTML) {\n          var m = context.getElementById(id);\n          return m && m.parentNode ? [m] : [];\n        }\n      };\n      Expr.filter.ID = function (id) {\n        var attrId = id.replace(runescape, funescape);\n        return function (elem) {\n          return elem.getAttribute('id') === attrId;\n        };\n      };\n      Expr.find.TAG = support.getElementsByTagName ? function (tag, context) {\n        if (typeof context.getElementsByTagName !== strundefined) {\n          return context.getElementsByTagName(tag);\n        }\n      } : function (tag, context) {\n        var elem, tmp = [], i = 0, results = context.getElementsByTagName(tag);\n        if (tag === '*') {\n          while (elem = results[i++]) {\n            if (elem.nodeType === 1) {\n              tmp.push(elem);\n            }\n          }\n          return tmp;\n        }\n        return results;\n      };\n      Expr.find.CLASS = support.getElementsByClassName && function (className, context) {\n        if (documentIsHTML) {\n          return context.getElementsByClassName(className);\n        }\n      };\n      rbuggyMatches = [];\n      rbuggyQSA = [];\n      support.disconnectedMatch = true;\n      rbuggyQSA = rbuggyQSA.length && new RegExp(rbuggyQSA.join('|'));\n      rbuggyMatches = rbuggyMatches.length && new RegExp(rbuggyMatches.join('|'));\n      hasCompare = rnative.test(docElem.compareDocumentPosition);\n      contains = hasCompare || rnative.test(docElem.contains) ? function (a, b) {\n        var adown = a.nodeType === 9 ? a.documentElement : a, bup = b && b.parentNode;\n        return a === bup || !!(bup && bup.nodeType === 1 && (adown.contains ? adown.contains(bup) : a.compareDocumentPosition && a.compareDocumentPosition(bup) & 16));\n      } : function (a, b) {\n        if (b) {\n          while (b = b.parentNode) {\n            if (b === a) {\n              return true;\n            }\n          }\n        }\n        return false;\n      };\n      sortOrder = hasCompare ? function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var compare = !a.compareDocumentPosition - !b.compareDocumentPosition;\n        if (compare) {\n          return compare;\n        }\n        compare = (a.ownerDocument || a) === (b.ownerDocument || b) ? a.compareDocumentPosition(b) : 1;\n        if (compare & 1 || !support.sortDetached && b.compareDocumentPosition(a) === compare) {\n          if (a === doc || a.ownerDocument === preferredDoc && contains(preferredDoc, a)) {\n            return -1;\n          }\n          if (b === doc || b.ownerDocument === preferredDoc && contains(preferredDoc, b)) {\n            return 1;\n          }\n          return sortInput ? indexOf.call(sortInput, a) - indexOf.call(sortInput, b) : 0;\n        }\n        return compare & 4 ? -1 : 1;\n      } : function (a, b) {\n        if (a === b) {\n          hasDuplicate = true;\n          return 0;\n        }\n        var cur, i = 0, aup = a.parentNode, bup = b.parentNode, ap = [a], bp = [b];\n        if (!aup || !bup) {\n          return a === doc ? -1 : b === doc ? 1 : aup ? -1 : bup ? 1 : sortInput ? indexOf.call(sortInput, a) - indexOf.call(sortInput, b) : 0;\n        } else if (aup === bup) {\n          return siblingCheck(a, b);\n        }\n        cur = a;\n        while (cur = cur.parentNode) {\n          ap.unshift(cur);\n        }\n        cur = b;\n        while (cur = cur.parentNode) {\n          bp.unshift(cur);\n        }\n        while (ap[i] === bp[i]) {\n          i++;\n        }\n        return i ? siblingCheck(ap[i], bp[i]) : ap[i] === preferredDoc ? -1 : bp[i] === preferredDoc ? 1 : 0;\n      };\n      return doc;\n    };\n    Sizzle.matches = function (expr, elements) {\n      return Sizzle(expr, null, null, elements);\n    };\n    Sizzle.matchesSelector = function (elem, expr) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      expr = expr.replace(rattributeQuotes, '=\\'$1\\']');\n      if (support.matchesSelector && documentIsHTML && (!rbuggyMatches || !rbuggyMatches.test(expr)) && (!rbuggyQSA || !rbuggyQSA.test(expr))) {\n        try {\n          var ret = matches.call(elem, expr);\n          if (ret || support.disconnectedMatch || elem.document && elem.document.nodeType !== 11) {\n            return ret;\n          }\n        } catch (e) {\n        }\n      }\n      return Sizzle(expr, document$1, null, [elem]).length > 0;\n    };\n    Sizzle.contains = function (context, elem) {\n      if ((context.ownerDocument || context) !== document$1) {\n        setDocument(context);\n      }\n      return contains(context, elem);\n    };\n    Sizzle.attr = function (elem, name) {\n      if ((elem.ownerDocument || elem) !== document$1) {\n        setDocument(elem);\n      }\n      var fn = Expr.attrHandle[name.toLowerCase()], val = fn && hasOwn.call(Expr.attrHandle, name.toLowerCase()) ? fn(elem, name, !documentIsHTML) : undefined;\n      return val !== undefined ? val : support.attributes || !documentIsHTML ? elem.getAttribute(name) : (val = elem.getAttributeNode(name)) && val.specified ? val.value : null;\n    };\n    Sizzle.error = function (msg) {\n      throw new Error('Syntax error, unrecognized expression: ' + msg);\n    };\n    Sizzle.uniqueSort = function (results) {\n      var elem, duplicates = [], j = 0, i = 0;\n      hasDuplicate = !support.detectDuplicates;\n      sortInput = !support.sortStable && results.slice(0);\n      results.sort(sortOrder);\n      if (hasDuplicate) {\n        while (elem = results[i++]) {\n          if (elem === results[i]) {\n            j = duplicates.push(i);\n          }\n        }\n        while (j--) {\n          results.splice(duplicates[j], 1);\n        }\n      }\n      sortInput = null;\n      return results;\n    };\n    getText = Sizzle.getText = function (elem) {\n      var node, ret = '', i = 0, nodeType = elem.nodeType;\n      if (!nodeType) {\n        while (node = elem[i++]) {\n          ret += getText(node);\n        }\n      } else if (nodeType === 1 || nodeType === 9 || nodeType === 11) {\n        if (typeof elem.textContent === 'string') {\n          return elem.textContent;\n        } else {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            ret += getText(elem);\n          }\n        }\n      } else if (nodeType === 3 || nodeType === 4) {\n        return elem.nodeValue;\n      }\n      return ret;\n    };\n    Expr = Sizzle.selectors = {\n      cacheLength: 50,\n      createPseudo: markFunction,\n      match: matchExpr,\n      attrHandle: {},\n      find: {},\n      relative: {\n        '>': {\n          dir: 'parentNode',\n          first: true\n        },\n        ' ': { dir: 'parentNode' },\n        '+': {\n          dir: 'previousSibling',\n          first: true\n        },\n        '~': { dir: 'previousSibling' }\n      },\n      preFilter: {\n        ATTR: function (match) {\n          match[1] = match[1].replace(runescape, funescape);\n          match[3] = (match[3] || match[4] || match[5] || '').replace(runescape, funescape);\n          if (match[2] === '~=') {\n            match[3] = ' ' + match[3] + ' ';\n          }\n          return match.slice(0, 4);\n        },\n        CHILD: function (match) {\n          match[1] = match[1].toLowerCase();\n          if (match[1].slice(0, 3) === 'nth') {\n            if (!match[3]) {\n              Sizzle.error(match[0]);\n            }\n            match[4] = +(match[4] ? match[5] + (match[6] || 1) : 2 * (match[3] === 'even' || match[3] === 'odd'));\n            match[5] = +(match[7] + match[8] || match[3] === 'odd');\n          } else if (match[3]) {\n            Sizzle.error(match[0]);\n          }\n          return match;\n        },\n        PSEUDO: function (match) {\n          var excess, unquoted = !match[6] && match[2];\n          if (matchExpr.CHILD.test(match[0])) {\n            return null;\n          }\n          if (match[3]) {\n            match[2] = match[4] || match[5] || '';\n          } else if (unquoted && rpseudo.test(unquoted) && (excess = tokenize(unquoted, true)) && (excess = unquoted.indexOf(')', unquoted.length - excess) - unquoted.length)) {\n            match[0] = match[0].slice(0, excess);\n            match[2] = unquoted.slice(0, excess);\n          }\n          return match.slice(0, 3);\n        }\n      },\n      filter: {\n        TAG: function (nodeNameSelector) {\n          var nodeName = nodeNameSelector.replace(runescape, funescape).toLowerCase();\n          return nodeNameSelector === '*' ? function () {\n            return true;\n          } : function (elem) {\n            return elem.nodeName && elem.nodeName.toLowerCase() === nodeName;\n          };\n        },\n        CLASS: function (className) {\n          var pattern = classCache[className + ' '];\n          return pattern || (pattern = new RegExp('(^|' + whitespace + ')' + className + '(' + whitespace + '|$)')) && classCache(className, function (elem) {\n            return pattern.test(typeof elem.className === 'string' && elem.className || typeof elem.getAttribute !== strundefined && elem.getAttribute('class') || '');\n          });\n        },\n        ATTR: function (name, operator, check) {\n          return function (elem) {\n            var result = Sizzle.attr(elem, name);\n            if (result == null) {\n              return operator === '!=';\n            }\n            if (!operator) {\n              return true;\n            }\n            result += '';\n            return operator === '=' ? result === check : operator === '!=' ? result !== check : operator === '^=' ? check && result.indexOf(check) === 0 : operator === '*=' ? check && result.indexOf(check) > -1 : operator === '$=' ? check && result.slice(-check.length) === check : operator === '~=' ? (' ' + result + ' ').indexOf(check) > -1 : operator === '|=' ? result === check || result.slice(0, check.length + 1) === check + '-' : false;\n          };\n        },\n        CHILD: function (type, what, argument, first, last) {\n          var simple = type.slice(0, 3) !== 'nth', forward = type.slice(-4) !== 'last', ofType = what === 'of-type';\n          return first === 1 && last === 0 ? function (elem) {\n            return !!elem.parentNode;\n          } : function (elem, context, xml) {\n            var cache, outerCache, node, diff, nodeIndex, start, dir = simple !== forward ? 'nextSibling' : 'previousSibling', parent = elem.parentNode, name = ofType && elem.nodeName.toLowerCase(), useCache = !xml && !ofType;\n            if (parent) {\n              if (simple) {\n                while (dir) {\n                  node = elem;\n                  while (node = node[dir]) {\n                    if (ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) {\n                      return false;\n                    }\n                  }\n                  start = dir = type === 'only' && !start && 'nextSibling';\n                }\n                return true;\n              }\n              start = [forward ? parent.firstChild : parent.lastChild];\n              if (forward && useCache) {\n                outerCache = parent[expando] || (parent[expando] = {});\n                cache = outerCache[type] || [];\n                nodeIndex = cache[0] === dirruns && cache[1];\n                diff = cache[0] === dirruns && cache[2];\n                node = nodeIndex && parent.childNodes[nodeIndex];\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if (node.nodeType === 1 && ++diff && node === elem) {\n                    outerCache[type] = [\n                      dirruns,\n                      nodeIndex,\n                      diff\n                    ];\n                    break;\n                  }\n                }\n              } else if (useCache && (cache = (elem[expando] || (elem[expando] = {}))[type]) && cache[0] === dirruns) {\n                diff = cache[1];\n              } else {\n                while (node = ++nodeIndex && node && node[dir] || (diff = nodeIndex = 0) || start.pop()) {\n                  if ((ofType ? node.nodeName.toLowerCase() === name : node.nodeType === 1) && ++diff) {\n                    if (useCache) {\n                      (node[expando] || (node[expando] = {}))[type] = [\n                        dirruns,\n                        diff\n                      ];\n                    }\n                    if (node === elem) {\n                      break;\n                    }\n                  }\n                }\n              }\n              diff -= last;\n              return diff === first || diff % first === 0 && diff / first >= 0;\n            }\n          };\n        },\n        PSEUDO: function (pseudo, argument) {\n          var args, fn = Expr.pseudos[pseudo] || Expr.setFilters[pseudo.toLowerCase()] || Sizzle.error('unsupported pseudo: ' + pseudo);\n          if (fn[expando]) {\n            return fn(argument);\n          }\n          if (fn.length > 1) {\n            args = [\n              pseudo,\n              pseudo,\n              '',\n              argument\n            ];\n            return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase()) ? markFunction(function (seed, matches) {\n              var idx, matched = fn(seed, argument), i = matched.length;\n              while (i--) {\n                idx = indexOf.call(seed, matched[i]);\n                seed[idx] = !(matches[idx] = matched[i]);\n              }\n            }) : function (elem) {\n              return fn(elem, 0, args);\n            };\n          }\n          return fn;\n        }\n      },\n      pseudos: {\n        not: markFunction(function (selector) {\n          var input = [], results = [], matcher = compile(selector.replace(rtrim, '$1'));\n          return matcher[expando] ? markFunction(function (seed, matches, context, xml) {\n            var elem, unmatched = matcher(seed, null, xml, []), i = seed.length;\n            while (i--) {\n              if (elem = unmatched[i]) {\n                seed[i] = !(matches[i] = elem);\n              }\n            }\n          }) : function (elem, context, xml) {\n            input[0] = elem;\n            matcher(input, null, xml, results);\n            input[0] = null;\n            return !results.pop();\n          };\n        }),\n        has: markFunction(function (selector) {\n          return function (elem) {\n            return Sizzle(selector, elem).length > 0;\n          };\n        }),\n        contains: markFunction(function (text) {\n          text = text.replace(runescape, funescape);\n          return function (elem) {\n            return (elem.textContent || elem.innerText || getText(elem)).indexOf(text) > -1;\n          };\n        }),\n        lang: markFunction(function (lang) {\n          if (!ridentifier.test(lang || '')) {\n            Sizzle.error('unsupported lang: ' + lang);\n          }\n          lang = lang.replace(runescape, funescape).toLowerCase();\n          return function (elem) {\n            var elemLang;\n            do {\n              if (elemLang = documentIsHTML ? elem.lang : elem.getAttribute('xml:lang') || elem.getAttribute('lang')) {\n                elemLang = elemLang.toLowerCase();\n                return elemLang === lang || elemLang.indexOf(lang + '-') === 0;\n              }\n            } while ((elem = elem.parentNode) && elem.nodeType === 1);\n            return false;\n          };\n        }),\n        target: function (elem) {\n          var hash = window.location && window.location.hash;\n          return hash && hash.slice(1) === elem.id;\n        },\n        root: function (elem) {\n          return elem === docElem;\n        },\n        focus: function (elem) {\n          return elem === document$1.activeElement && (!document$1.hasFocus || document$1.hasFocus()) && !!(elem.type || elem.href || ~elem.tabIndex);\n        },\n        enabled: function (elem) {\n          return elem.disabled === false;\n        },\n        disabled: function (elem) {\n          return elem.disabled === true;\n        },\n        checked: function (elem) {\n          var nodeName = elem.nodeName.toLowerCase();\n          return nodeName === 'input' && !!elem.checked || nodeName === 'option' && !!elem.selected;\n        },\n        selected: function (elem) {\n          if (elem.parentNode) {\n            elem.parentNode.selectedIndex;\n          }\n          return elem.selected === true;\n        },\n        empty: function (elem) {\n          for (elem = elem.firstChild; elem; elem = elem.nextSibling) {\n            if (elem.nodeType < 6) {\n              return false;\n            }\n          }\n          return true;\n        },\n        parent: function (elem) {\n          return !Expr.pseudos.empty(elem);\n        },\n        header: function (elem) {\n          return rheader.test(elem.nodeName);\n        },\n        input: function (elem) {\n          return rinputs.test(elem.nodeName);\n        },\n        button: function (elem) {\n          var name = elem.nodeName.toLowerCase();\n          return name === 'input' && elem.type === 'button' || name === 'button';\n        },\n        text: function (elem) {\n          var attr;\n          return elem.nodeName.toLowerCase() === 'input' && elem.type === 'text' && ((attr = elem.getAttribute('type')) == null || attr.toLowerCase() === 'text');\n        },\n        first: createPositionalPseudo(function () {\n          return [0];\n        }),\n        last: createPositionalPseudo(function (matchIndexes, length) {\n          return [length - 1];\n        }),\n        eq: createPositionalPseudo(function (matchIndexes, length, argument) {\n          return [argument < 0 ? argument + length : argument];\n        }),\n        even: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 0;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        odd: createPositionalPseudo(function (matchIndexes, length) {\n          var i = 1;\n          for (; i < length; i += 2) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        lt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; --i >= 0;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        }),\n        gt: createPositionalPseudo(function (matchIndexes, length, argument) {\n          var i = argument < 0 ? argument + length : argument;\n          for (; ++i < length;) {\n            matchIndexes.push(i);\n          }\n          return matchIndexes;\n        })\n      }\n    };\n    Expr.pseudos.nth = Expr.pseudos.eq;\n    each$k([\n      'radio',\n      'checkbox',\n      'file',\n      'password',\n      'image'\n    ], function (i) {\n      Expr.pseudos[i] = createInputPseudo(i);\n    });\n    each$k([\n      'submit',\n      'reset'\n    ], function (i) {\n      Expr.pseudos[i] = createButtonPseudo(i);\n    });\n    function setFilters() {\n    }\n    setFilters.prototype = Expr.filters = Expr.pseudos;\n    Expr.setFilters = new setFilters();\n    tokenize = Sizzle.tokenize = function (selector, parseOnly) {\n      var matched, match, tokens, type, soFar, groups, preFilters, cached = tokenCache[selector + ' '];\n      if (cached) {\n        return parseOnly ? 0 : cached.slice(0);\n      }\n      soFar = selector;\n      groups = [];\n      preFilters = Expr.preFilter;\n      while (soFar) {\n        if (!matched || (match = rcomma.exec(soFar))) {\n          if (match) {\n            soFar = soFar.slice(match[0].length) || soFar;\n          }\n          groups.push(tokens = []);\n        }\n        matched = false;\n        if (match = rcombinators.exec(soFar)) {\n          matched = match.shift();\n          tokens.push({\n            value: matched,\n            type: match[0].replace(rtrim, ' ')\n          });\n          soFar = soFar.slice(matched.length);\n        }\n        for (type in Expr.filter) {\n          if (!Expr.filter.hasOwnProperty(type)) {\n            continue;\n          }\n          if ((match = matchExpr[type].exec(soFar)) && (!preFilters[type] || (match = preFilters[type](match)))) {\n            matched = match.shift();\n            tokens.push({\n              value: matched,\n              type: type,\n              matches: match\n            });\n            soFar = soFar.slice(matched.length);\n          }\n        }\n        if (!matched) {\n          break;\n        }\n      }\n      return parseOnly ? soFar.length : soFar ? Sizzle.error(selector) : tokenCache(selector, groups).slice(0);\n    };\n    function toSelector(tokens) {\n      var i = 0, len = tokens.length, selector = '';\n      for (; i < len; i++) {\n        selector += tokens[i].value;\n      }\n      return selector;\n    }\n    function addCombinator(matcher, combinator, base) {\n      var dir = combinator.dir, checkNonElements = base && dir === 'parentNode', doneName = done++;\n      return combinator.first ? function (elem, context, xml) {\n        while (elem = elem[dir]) {\n          if (elem.nodeType === 1 || checkNonElements) {\n            return matcher(elem, context, xml);\n          }\n        }\n      } : function (elem, context, xml) {\n        var oldCache, outerCache, newCache = [\n            dirruns,\n            doneName\n          ];\n        if (xml) {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              if (matcher(elem, context, xml)) {\n                return true;\n              }\n            }\n          }\n        } else {\n          while (elem = elem[dir]) {\n            if (elem.nodeType === 1 || checkNonElements) {\n              outerCache = elem[expando] || (elem[expando] = {});\n              if ((oldCache = outerCache[dir]) && oldCache[0] === dirruns && oldCache[1] === doneName) {\n                return newCache[2] = oldCache[2];\n              } else {\n                outerCache[dir] = newCache;\n                if (newCache[2] = matcher(elem, context, xml)) {\n                  return true;\n                }\n              }\n            }\n          }\n        }\n      };\n    }\n    function elementMatcher(matchers) {\n      return matchers.length > 1 ? function (elem, context, xml) {\n        var i = matchers.length;\n        while (i--) {\n          if (!matchers[i](elem, context, xml)) {\n            return false;\n          }\n        }\n        return true;\n      } : matchers[0];\n    }\n    function multipleContexts(selector, contexts, results) {\n      var i = 0, len = contexts.length;\n      for (; i < len; i++) {\n        Sizzle(selector, contexts[i], results);\n      }\n      return results;\n    }\n    function condense(unmatched, map, filter, context, xml) {\n      var elem, newUnmatched = [], i = 0, len = unmatched.length, mapped = map != null;\n      for (; i < len; i++) {\n        if (elem = unmatched[i]) {\n          if (!filter || filter(elem, context, xml)) {\n            newUnmatched.push(elem);\n            if (mapped) {\n              map.push(i);\n            }\n          }\n        }\n      }\n      return newUnmatched;\n    }\n    function setMatcher(preFilter, selector, matcher, postFilter, postFinder, postSelector) {\n      if (postFilter && !postFilter[expando]) {\n        postFilter = setMatcher(postFilter);\n      }\n      if (postFinder && !postFinder[expando]) {\n        postFinder = setMatcher(postFinder, postSelector);\n      }\n      return markFunction(function (seed, results, context, xml) {\n        var temp, i, elem, preMap = [], postMap = [], preexisting = results.length, elems = seed || multipleContexts(selector || '*', context.nodeType ? [context] : context, []), matcherIn = preFilter && (seed || !selector) ? condense(elems, preMap, preFilter, context, xml) : elems, matcherOut = matcher ? postFinder || (seed ? preFilter : preexisting || postFilter) ? [] : results : matcherIn;\n        if (matcher) {\n          matcher(matcherIn, matcherOut, context, xml);\n        }\n        if (postFilter) {\n          temp = condense(matcherOut, postMap);\n          postFilter(temp, [], context, xml);\n          i = temp.length;\n          while (i--) {\n            if (elem = temp[i]) {\n              matcherOut[postMap[i]] = !(matcherIn[postMap[i]] = elem);\n            }\n          }\n        }\n        if (seed) {\n          if (postFinder || preFilter) {\n            if (postFinder) {\n              temp = [];\n              i = matcherOut.length;\n              while (i--) {\n                if (elem = matcherOut[i]) {\n                  temp.push(matcherIn[i] = elem);\n                }\n              }\n              postFinder(null, matcherOut = [], temp, xml);\n            }\n            i = matcherOut.length;\n            while (i--) {\n              if ((elem = matcherOut[i]) && (temp = postFinder ? indexOf.call(seed, elem) : preMap[i]) > -1) {\n                seed[temp] = !(results[temp] = elem);\n              }\n            }\n          }\n        } else {\n          matcherOut = condense(matcherOut === results ? matcherOut.splice(preexisting, matcherOut.length) : matcherOut);\n          if (postFinder) {\n            postFinder(null, results, matcherOut, xml);\n          } else {\n            push$1.apply(results, matcherOut);\n          }\n        }\n      });\n    }\n    function matcherFromTokens(tokens) {\n      var checkContext, matcher, j, len = tokens.length, leadingRelative = Expr.relative[tokens[0].type], implicitRelative = leadingRelative || Expr.relative[' '], i = leadingRelative ? 1 : 0, matchContext = addCombinator(function (elem) {\n          return elem === checkContext;\n        }, implicitRelative, true), matchAnyContext = addCombinator(function (elem) {\n          return indexOf.call(checkContext, elem) > -1;\n        }, implicitRelative, true), matchers = [function (elem, context, xml) {\n            var ret = !leadingRelative && (xml || context !== outermostContext) || ((checkContext = context).nodeType ? matchContext(elem, context, xml) : matchAnyContext(elem, context, xml));\n            checkContext = null;\n            return ret;\n          }];\n      for (; i < len; i++) {\n        if (matcher = Expr.relative[tokens[i].type]) {\n          matchers = [addCombinator(elementMatcher(matchers), matcher)];\n        } else {\n          matcher = Expr.filter[tokens[i].type].apply(null, tokens[i].matches);\n          if (matcher[expando]) {\n            j = ++i;\n            for (; j < len; j++) {\n              if (Expr.relative[tokens[j].type]) {\n                break;\n              }\n            }\n            return setMatcher(i > 1 && elementMatcher(matchers), i > 1 && toSelector(tokens.slice(0, i - 1).concat({ value: tokens[i - 2].type === ' ' ? '*' : '' })).replace(rtrim, '$1'), matcher, i < j && matcherFromTokens(tokens.slice(i, j)), j < len && matcherFromTokens(tokens = tokens.slice(j)), j < len && toSelector(tokens));\n          }\n          matchers.push(matcher);\n        }\n      }\n      return elementMatcher(matchers);\n    }\n    function matcherFromGroupMatchers(elementMatchers, setMatchers) {\n      var bySet = setMatchers.length > 0, byElement = elementMatchers.length > 0, superMatcher = function (seed, context, xml, results, outermost) {\n          var elem, j, matcher, matchedCount = 0, i = '0', unmatched = seed && [], setMatched = [], contextBackup = outermostContext, elems = seed || byElement && Expr.find.TAG('*', outermost), dirrunsUnique = dirruns += contextBackup == null ? 1 : Math.random() || 0.1, len = elems.length;\n          if (outermost) {\n            outermostContext = context !== document$1 && context;\n          }\n          for (; i !== len && (elem = elems[i]) != null; i++) {\n            if (byElement && elem) {\n              j = 0;\n              while (matcher = elementMatchers[j++]) {\n                if (matcher(elem, context, xml)) {\n                  results.push(elem);\n                  break;\n                }\n              }\n              if (outermost) {\n                dirruns = dirrunsUnique;\n              }\n            }\n            if (bySet) {\n              if (elem = !matcher && elem) {\n                matchedCount--;\n              }\n              if (seed) {\n                unmatched.push(elem);\n              }\n            }\n          }\n          matchedCount += i;\n          if (bySet && i !== matchedCount) {\n            j = 0;\n            while (matcher = setMatchers[j++]) {\n              matcher(unmatched, setMatched, context, xml);\n            }\n            if (seed) {\n              if (matchedCount > 0) {\n                while (i--) {\n                  if (!(unmatched[i] || setMatched[i])) {\n                    setMatched[i] = pop.call(results);\n                  }\n                }\n              }\n              setMatched = condense(setMatched);\n            }\n            push$1.apply(results, setMatched);\n            if (outermost && !seed && setMatched.length > 0 && matchedCount + setMatchers.length > 1) {\n              Sizzle.uniqueSort(results);\n            }\n          }\n          if (outermost) {\n            dirruns = dirrunsUnique;\n            outermostContext = contextBackup;\n          }\n          return unmatched;\n        };\n      return bySet ? markFunction(superMatcher) : superMatcher;\n    }\n    compile = Sizzle.compile = function (selector, match) {\n      var i, setMatchers = [], elementMatchers = [], cached = compilerCache[selector + ' '];\n      if (!cached) {\n        if (!match) {\n          match = tokenize(selector);\n        }\n        i = match.length;\n        while (i--) {\n          cached = matcherFromTokens(match[i]);\n          if (cached[expando]) {\n            setMatchers.push(cached);\n          } else {\n            elementMatchers.push(cached);\n          }\n        }\n        cached = compilerCache(selector, matcherFromGroupMatchers(elementMatchers, setMatchers));\n        cached.selector = selector;\n      }\n      return cached;\n    };\n    select$1 = Sizzle.select = function (selector, context, results, seed) {\n      var i, tokens, token, type, find, compiled = typeof selector === 'function' && selector, match = !seed && tokenize(selector = compiled.selector || selector);\n      results = results || [];\n      if (match.length === 1) {\n        tokens = match[0] = match[0].slice(0);\n        if (tokens.length > 2 && (token = tokens[0]).type === 'ID' && support.getById && context.nodeType === 9 && documentIsHTML && Expr.relative[tokens[1].type]) {\n          context = (Expr.find.ID(token.matches[0].replace(runescape, funescape), context) || [])[0];\n          if (!context) {\n            return results;\n          } else if (compiled) {\n            context = context.parentNode;\n          }\n          selector = selector.slice(tokens.shift().value.length);\n        }\n        i = matchExpr.needsContext.test(selector) ? 0 : tokens.length;\n        while (i--) {\n          token = tokens[i];\n          if (Expr.relative[type = token.type]) {\n            break;\n          }\n          if (find = Expr.find[type]) {\n            if (seed = find(token.matches[0].replace(runescape, funescape), rsibling.test(tokens[0].type) && testContext(context.parentNode) || context)) {\n              tokens.splice(i, 1);\n              selector = seed.length && toSelector(tokens);\n              if (!selector) {\n                push$1.apply(results, seed);\n                return results;\n              }\n              break;\n            }\n          }\n        }\n      }\n      (compiled || compile(selector, match))(seed, context, !documentIsHTML, results, rsibling.test(selector) && testContext(context.parentNode) || context);\n      return results;\n    };\n    support.sortStable = expando.split('').sort(sortOrder).join('') === expando;\n    support.detectDuplicates = !!hasDuplicate;\n    setDocument();\n    support.sortDetached = true;\n\n    var doc = document;\n    var push = Array.prototype.push;\n    var slice = Array.prototype.slice;\n    var rquickExpr = /^(?:[^#<]*(<[\\w\\W]+>)[^>]*$|#([\\w\\-]*)$)/;\n    var Event$1 = EventUtils.Event;\n    var skipUniques = Tools.makeMap('children,contents,next,prev');\n    var isDefined = function (obj) {\n      return typeof obj !== 'undefined';\n    };\n    var isString = function (obj) {\n      return typeof obj === 'string';\n    };\n    var isWindow = function (obj) {\n      return obj && obj === obj.window;\n    };\n    var createFragment$1 = function (html, fragDoc) {\n      fragDoc = fragDoc || doc;\n      var container = fragDoc.createElement('div');\n      var frag = fragDoc.createDocumentFragment();\n      container.innerHTML = html;\n      var node;\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var domManipulate = function (targetNodes, sourceItem, callback, reverse) {\n      var i;\n      if (isString(sourceItem)) {\n        sourceItem = createFragment$1(sourceItem, getElementDocument(targetNodes[0]));\n      } else if (sourceItem.length && !sourceItem.nodeType) {\n        sourceItem = DomQuery.makeArray(sourceItem);\n        if (reverse) {\n          for (i = sourceItem.length - 1; i >= 0; i--) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        } else {\n          for (i = 0; i < sourceItem.length; i++) {\n            domManipulate(targetNodes, sourceItem[i], callback, reverse);\n          }\n        }\n        return targetNodes;\n      }\n      if (sourceItem.nodeType) {\n        i = targetNodes.length;\n        while (i--) {\n          callback.call(targetNodes[i], sourceItem);\n        }\n      }\n      return targetNodes;\n    };\n    var hasClass = function (node, className) {\n      return node && className && (' ' + node.className + ' ').indexOf(' ' + className + ' ') !== -1;\n    };\n    var wrap$2 = function (elements, wrapper, all) {\n      var lastParent, newWrapper;\n      wrapper = DomQuery(wrapper)[0];\n      elements.each(function () {\n        var self = this;\n        if (!all || lastParent !== self.parentNode) {\n          lastParent = self.parentNode;\n          newWrapper = wrapper.cloneNode(false);\n          self.parentNode.insertBefore(newWrapper, self);\n          newWrapper.appendChild(self);\n        } else {\n          newWrapper.appendChild(self);\n        }\n      });\n      return elements;\n    };\n    var numericCssMap = Tools.makeMap('fillOpacity fontWeight lineHeight opacity orphans widows zIndex zoom', ' ');\n    var booleanMap = Tools.makeMap('checked compact declare defer disabled ismap multiple nohref noshade nowrap readonly selected', ' ');\n    var propFix = {\n      for: 'htmlFor',\n      class: 'className',\n      readonly: 'readOnly'\n    };\n    var cssFix = { float: 'cssFloat' };\n    var attrHooks = {}, cssHooks = {};\n    var DomQueryConstructor = function (selector, context) {\n      return new DomQuery.fn.init(selector, context);\n    };\n    var inArray$1 = function (item, array) {\n      var i;\n      if (array.indexOf) {\n        return array.indexOf(item);\n      }\n      i = array.length;\n      while (i--) {\n        if (array[i] === item) {\n          return i;\n        }\n      }\n      return -1;\n    };\n    var whiteSpaceRegExp = /^\\s*|\\s*$/g;\n    var trim$1 = function (str) {\n      return str === null || str === undefined ? '' : ('' + str).replace(whiteSpaceRegExp, '');\n    };\n    var each$g = function (obj, callback) {\n      var length, key, i, value;\n      if (obj) {\n        length = obj.length;\n        if (length === undefined) {\n          for (key in obj) {\n            if (obj.hasOwnProperty(key)) {\n              value = obj[key];\n              if (callback.call(value, key, value) === false) {\n                break;\n              }\n            }\n          }\n        } else {\n          for (i = 0; i < length; i++) {\n            value = obj[i];\n            if (callback.call(value, i, value) === false) {\n              break;\n            }\n          }\n        }\n      }\n      return obj;\n    };\n    var grep$2 = function (array, callback) {\n      var out = [];\n      each$g(array, function (i, item) {\n        if (callback(item, i)) {\n          out.push(item);\n        }\n      });\n      return out;\n    };\n    var getElementDocument = function (element) {\n      if (!element) {\n        return doc;\n      }\n      if (element.nodeType === 9) {\n        return element;\n      }\n      return element.ownerDocument;\n    };\n    DomQueryConstructor.fn = DomQueryConstructor.prototype = {\n      constructor: DomQueryConstructor,\n      selector: '',\n      context: null,\n      length: 0,\n      init: function (selector, context) {\n        var self = this;\n        var match, node;\n        if (!selector) {\n          return self;\n        }\n        if (selector.nodeType) {\n          self.context = self[0] = selector;\n          self.length = 1;\n          return self;\n        }\n        if (context && context.nodeType) {\n          self.context = context;\n        } else {\n          if (context) {\n            return DomQuery(selector).attr(context);\n          }\n          self.context = context = document;\n        }\n        if (isString(selector)) {\n          self.selector = selector;\n          if (selector.charAt(0) === '<' && selector.charAt(selector.length - 1) === '>' && selector.length >= 3) {\n            match = [\n              null,\n              selector,\n              null\n            ];\n          } else {\n            match = rquickExpr.exec(selector);\n          }\n          if (match) {\n            if (match[1]) {\n              node = createFragment$1(selector, getElementDocument(context)).firstChild;\n              while (node) {\n                push.call(self, node);\n                node = node.nextSibling;\n              }\n            } else {\n              node = getElementDocument(context).getElementById(match[2]);\n              if (!node) {\n                return self;\n              }\n              if (node.id !== match[2]) {\n                return self.find(selector);\n              }\n              self.length = 1;\n              self[0] = node;\n            }\n          } else {\n            return DomQuery(context).find(selector);\n          }\n        } else {\n          this.add(selector, false);\n        }\n        return self;\n      },\n      toArray: function () {\n        return Tools.toArray(this);\n      },\n      add: function (items, sort) {\n        var self = this;\n        var nodes, i;\n        if (isString(items)) {\n          return self.add(DomQuery(items));\n        }\n        if (sort !== false) {\n          nodes = DomQuery.unique(self.toArray().concat(DomQuery.makeArray(items)));\n          self.length = nodes.length;\n          for (i = 0; i < nodes.length; i++) {\n            self[i] = nodes[i];\n          }\n        } else {\n          push.apply(self, DomQuery.makeArray(items));\n        }\n        return self;\n      },\n      attr: function (name, value) {\n        var self = this;\n        var hook;\n        if (typeof name === 'object') {\n          each$g(name, function (name, value) {\n            self.attr(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            var hook;\n            if (this.nodeType === 1) {\n              hook = attrHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              if (value === null) {\n                this.removeAttribute(name, 2);\n              } else {\n                this.setAttribute(name, value, 2);\n              }\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType === 1) {\n            hook = attrHooks[name];\n            if (hook && hook.get) {\n              return hook.get(self[0], name);\n            }\n            if (booleanMap[name]) {\n              return self.prop(name) ? name : undefined;\n            }\n            value = self[0].getAttribute(name, 2);\n            if (value === null) {\n              value = undefined;\n            }\n          }\n          return value;\n        }\n        return self;\n      },\n      removeAttr: function (name) {\n        return this.attr(name, null);\n      },\n      prop: function (name, value) {\n        var self = this;\n        name = propFix[name] || name;\n        if (typeof name === 'object') {\n          each$g(name, function (name, value) {\n            self.prop(name, value);\n          });\n        } else if (isDefined(value)) {\n          this.each(function () {\n            if (this.nodeType === 1) {\n              this[name] = value;\n            }\n          });\n        } else {\n          if (self[0] && self[0].nodeType && name in self[0]) {\n            return self[0][name];\n          }\n          return value;\n        }\n        return self;\n      },\n      css: function (name, value) {\n        var self = this;\n        var elm, hook;\n        var camel = function (name) {\n          return name.replace(/-(\\D)/g, function (a, b) {\n            return b.toUpperCase();\n          });\n        };\n        var dashed = function (name) {\n          return name.replace(/[A-Z]/g, function (a) {\n            return '-' + a;\n          });\n        };\n        if (typeof name === 'object') {\n          each$g(name, function (name, value) {\n            self.css(name, value);\n          });\n        } else {\n          if (isDefined(value)) {\n            name = camel(name);\n            if (typeof value === 'number' && !numericCssMap[name]) {\n              value = value.toString() + 'px';\n            }\n            self.each(function () {\n              var style = this.style;\n              hook = cssHooks[name];\n              if (hook && hook.set) {\n                hook.set(this, value);\n                return;\n              }\n              try {\n                this.style[cssFix[name] || name] = value;\n              } catch (ex) {\n              }\n              if (value === null || value === '') {\n                if (style.removeProperty) {\n                  style.removeProperty(dashed(name));\n                } else {\n                  style.removeAttribute(name);\n                }\n              }\n            });\n          } else {\n            elm = self[0];\n            hook = cssHooks[name];\n            if (hook && hook.get) {\n              return hook.get(elm);\n            }\n            if (elm.ownerDocument.defaultView) {\n              try {\n                return elm.ownerDocument.defaultView.getComputedStyle(elm, null).getPropertyValue(dashed(name));\n              } catch (ex) {\n                return undefined;\n              }\n            } else if (elm.currentStyle) {\n              return elm.currentStyle[camel(name)];\n            } else {\n              return '';\n            }\n          }\n        }\n        return self;\n      },\n      remove: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          Event$1.clean(node);\n          if (node.parentNode) {\n            node.parentNode.removeChild(node);\n          }\n        }\n        return this;\n      },\n      empty: function () {\n        var self = this;\n        var node, i = this.length;\n        while (i--) {\n          node = self[i];\n          while (node.firstChild) {\n            node.removeChild(node.firstChild);\n          }\n        }\n        return this;\n      },\n      html: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          try {\n            while (i--) {\n              self[i].innerHTML = value;\n            }\n          } catch (ex) {\n            DomQuery(self[i]).empty().append(value);\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerHTML : '';\n      },\n      text: function (value) {\n        var self = this;\n        var i;\n        if (isDefined(value)) {\n          i = self.length;\n          while (i--) {\n            if ('innerText' in self[i]) {\n              self[i].innerText = value;\n            } else {\n              self[0].textContent = value;\n            }\n          }\n          return self;\n        }\n        return self[0] ? self[0].innerText || self[0].textContent : '';\n      },\n      append: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.appendChild(node);\n          }\n        });\n      },\n      prepend: function () {\n        return domManipulate(this, arguments, function (node) {\n          if (this.nodeType === 1 || this.host && this.host.nodeType === 1) {\n            this.insertBefore(node, this.firstChild);\n          }\n        }, true);\n      },\n      before: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this);\n          });\n        }\n        return self;\n      },\n      after: function () {\n        var self = this;\n        if (self[0] && self[0].parentNode) {\n          return domManipulate(self, arguments, function (node) {\n            this.parentNode.insertBefore(node, this.nextSibling);\n          }, true);\n        }\n        return self;\n      },\n      appendTo: function (val) {\n        DomQuery(val).append(this);\n        return this;\n      },\n      prependTo: function (val) {\n        DomQuery(val).prepend(this);\n        return this;\n      },\n      replaceWith: function (content) {\n        return this.before(content).remove();\n      },\n      wrap: function (content) {\n        return wrap$2(this, content);\n      },\n      wrapAll: function (content) {\n        return wrap$2(this, content, true);\n      },\n      wrapInner: function (content) {\n        this.each(function () {\n          DomQuery(this).contents().wrapAll(content);\n        });\n        return this;\n      },\n      unwrap: function () {\n        return this.parent().each(function () {\n          DomQuery(this).replaceWith(this.childNodes);\n        });\n      },\n      clone: function () {\n        var result = [];\n        this.each(function () {\n          result.push(this.cloneNode(true));\n        });\n        return DomQuery(result);\n      },\n      addClass: function (className) {\n        return this.toggleClass(className, true);\n      },\n      removeClass: function (className) {\n        return this.toggleClass(className, false);\n      },\n      toggleClass: function (className, state) {\n        var self = this;\n        if (typeof className !== 'string') {\n          return self;\n        }\n        if (className.indexOf(' ') !== -1) {\n          each$g(className.split(' '), function () {\n            self.toggleClass(this, state);\n          });\n        } else {\n          self.each(function (index, node) {\n            var classState = hasClass(node, className);\n            if (classState !== state) {\n              var existingClassName = node.className;\n              if (classState) {\n                node.className = trim$1((' ' + existingClassName + ' ').replace(' ' + className + ' ', ' '));\n              } else {\n                node.className += existingClassName ? ' ' + className : className;\n              }\n            }\n          });\n        }\n        return self;\n      },\n      hasClass: function (className) {\n        return hasClass(this[0], className);\n      },\n      each: function (callback) {\n        return each$g(this, callback);\n      },\n      on: function (name, callback) {\n        return this.each(function () {\n          Event$1.bind(this, name, callback);\n        });\n      },\n      off: function (name, callback) {\n        return this.each(function () {\n          Event$1.unbind(this, name, callback);\n        });\n      },\n      trigger: function (name) {\n        return this.each(function () {\n          if (typeof name === 'object') {\n            Event$1.fire(this, name.type, name);\n          } else {\n            Event$1.fire(this, name);\n          }\n        });\n      },\n      show: function () {\n        return this.css('display', '');\n      },\n      hide: function () {\n        return this.css('display', 'none');\n      },\n      slice: function () {\n        return DomQuery(slice.apply(this, arguments));\n      },\n      eq: function (index) {\n        return index === -1 ? this.slice(index) : this.slice(index, +index + 1);\n      },\n      first: function () {\n        return this.eq(0);\n      },\n      last: function () {\n        return this.eq(-1);\n      },\n      find: function (selector) {\n        var i, l;\n        var ret = [];\n        for (i = 0, l = this.length; i < l; i++) {\n          DomQuery.find(selector, this[i], ret);\n        }\n        return DomQuery(ret);\n      },\n      filter: function (selector) {\n        if (typeof selector === 'function') {\n          return DomQuery(grep$2(this.toArray(), function (item, i) {\n            return selector(i, item);\n          }));\n        }\n        return DomQuery(DomQuery.filter(selector, this.toArray()));\n      },\n      closest: function (selector) {\n        var result = [];\n        if (selector instanceof DomQuery) {\n          selector = selector[0];\n        }\n        this.each(function (i, node) {\n          while (node) {\n            if (typeof selector === 'string' && DomQuery(node).is(selector)) {\n              result.push(node);\n              break;\n            } else if (node === selector) {\n              result.push(node);\n              break;\n            }\n            node = node.parentNode;\n          }\n        });\n        return DomQuery(result);\n      },\n      offset: function (offset) {\n        var elm, doc, docElm;\n        var x = 0, y = 0, pos;\n        if (!offset) {\n          elm = this[0];\n          if (elm) {\n            doc = elm.ownerDocument;\n            docElm = doc.documentElement;\n            if (elm.getBoundingClientRect) {\n              pos = elm.getBoundingClientRect();\n              x = pos.left + (docElm.scrollLeft || doc.body.scrollLeft) - docElm.clientLeft;\n              y = pos.top + (docElm.scrollTop || doc.body.scrollTop) - docElm.clientTop;\n            }\n          }\n          return {\n            left: x,\n            top: y\n          };\n        }\n        return this.css(offset);\n      },\n      push: push,\n      sort: Array.prototype.sort,\n      splice: Array.prototype.splice\n    };\n    Tools.extend(DomQueryConstructor, {\n      extend: Tools.extend,\n      makeArray: function (object) {\n        if (isWindow(object) || object.nodeType) {\n          return [object];\n        }\n        return Tools.toArray(object);\n      },\n      inArray: inArray$1,\n      isArray: Tools.isArray,\n      each: each$g,\n      trim: trim$1,\n      grep: grep$2,\n      find: Sizzle,\n      expr: Sizzle.selectors,\n      unique: Sizzle.uniqueSort,\n      text: Sizzle.getText,\n      contains: Sizzle.contains,\n      filter: function (expr, elems, not) {\n        var i = elems.length;\n        if (not) {\n          expr = ':not(' + expr + ')';\n        }\n        while (i--) {\n          if (elems[i].nodeType !== 1) {\n            elems.splice(i, 1);\n          }\n        }\n        if (elems.length === 1) {\n          elems = DomQuery.find.matchesSelector(elems[0], expr) ? [elems[0]] : [];\n        } else {\n          elems = DomQuery.find.matches(expr, elems);\n        }\n        return elems;\n      }\n    });\n    var dir = function (el, prop, until) {\n      var matched = [];\n      var cur = el[prop];\n      if (typeof until !== 'string' && until instanceof DomQuery) {\n        until = until[0];\n      }\n      while (cur && cur.nodeType !== 9) {\n        if (until !== undefined) {\n          if (cur === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(cur).is(until)) {\n            break;\n          }\n        }\n        if (cur.nodeType === 1) {\n          matched.push(cur);\n        }\n        cur = cur[prop];\n      }\n      return matched;\n    };\n    var sibling$1 = function (node, siblingName, nodeType, until) {\n      var result = [];\n      if (until instanceof DomQuery) {\n        until = until[0];\n      }\n      for (; node; node = node[siblingName]) {\n        if (nodeType && node.nodeType !== nodeType) {\n          continue;\n        }\n        if (until !== undefined) {\n          if (node === until) {\n            break;\n          }\n          if (typeof until === 'string' && DomQuery(node).is(until)) {\n            break;\n          }\n        }\n        result.push(node);\n      }\n      return result;\n    };\n    var firstSibling = function (node, siblingName, nodeType) {\n      for (node = node[siblingName]; node; node = node[siblingName]) {\n        if (node.nodeType === nodeType) {\n          return node;\n        }\n      }\n      return null;\n    };\n    each$g({\n      parent: function (node) {\n        var parent = node.parentNode;\n        return parent && parent.nodeType !== 11 ? parent : null;\n      },\n      parents: function (node) {\n        return dir(node, 'parentNode');\n      },\n      next: function (node) {\n        return firstSibling(node, 'nextSibling', 1);\n      },\n      prev: function (node) {\n        return firstSibling(node, 'previousSibling', 1);\n      },\n      children: function (node) {\n        return sibling$1(node.firstChild, 'nextSibling', 1);\n      },\n      contents: function (node) {\n        return Tools.toArray((node.nodeName === 'iframe' ? node.contentDocument || node.contentWindow.document : node).childNodes);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          if (!skipUniques[name]) {\n            result = DomQuery.unique(result);\n          }\n          if (name.indexOf('parents') === 0) {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (selector) {\n          return wrappedResult.filter(selector);\n        }\n        return wrappedResult;\n      };\n    });\n    each$g({\n      parentsUntil: function (node, until) {\n        return dir(node, 'parentNode', until);\n      },\n      nextUntil: function (node, until) {\n        return sibling$1(node, 'nextSibling', 1, until).slice(1);\n      },\n      prevUntil: function (node, until) {\n        return sibling$1(node, 'previousSibling', 1, until).slice(1);\n      }\n    }, function (name, fn) {\n      DomQueryConstructor.fn[name] = function (selector, filter) {\n        var self = this;\n        var result = [];\n        self.each(function () {\n          var nodes = fn.call(result, this, selector, result);\n          if (nodes) {\n            if (DomQuery.isArray(nodes)) {\n              result.push.apply(result, nodes);\n            } else {\n              result.push(nodes);\n            }\n          }\n        });\n        if (this.length > 1) {\n          result = DomQuery.unique(result);\n          if (name.indexOf('parents') === 0 || name === 'prevUntil') {\n            result = result.reverse();\n          }\n        }\n        var wrappedResult = DomQuery(result);\n        if (filter) {\n          return wrappedResult.filter(filter);\n        }\n        return wrappedResult;\n      };\n    });\n    DomQueryConstructor.fn.is = function (selector) {\n      return !!selector && this.filter(selector).length > 0;\n    };\n    DomQueryConstructor.fn.init.prototype = DomQueryConstructor.fn;\n    DomQueryConstructor.overrideDefaults = function (callback) {\n      var defaults;\n      var sub = function (selector, context) {\n        defaults = defaults || callback();\n        if (arguments.length === 0) {\n          selector = defaults.element;\n        }\n        if (!context) {\n          context = defaults.context;\n        }\n        return new sub.fn.init(selector, context);\n      };\n      DomQuery.extend(sub, this);\n      return sub;\n    };\n    DomQueryConstructor.attrHooks = attrHooks;\n    DomQueryConstructor.cssHooks = cssHooks;\n    var DomQuery = DomQueryConstructor;\n\n    var each$f = Tools.each;\n    var grep$1 = Tools.grep;\n    var isIE = Env.ie;\n    var simpleSelectorRe = /^([a-z0-9],?)+$/i;\n    var setupAttrHooks = function (styles, settings, getContext) {\n      var keepValues = settings.keep_values;\n      var keepUrlHook = {\n        set: function ($elm, value, name) {\n          if (settings.url_converter && value !== null) {\n            value = settings.url_converter.call(settings.url_converter_scope || getContext(), value, name, $elm[0]);\n          }\n          $elm.attr('data-mce-' + name, value).attr(name, value);\n        },\n        get: function ($elm, name) {\n          return $elm.attr('data-mce-' + name) || $elm.attr(name);\n        }\n      };\n      var attrHooks = {\n        style: {\n          set: function ($elm, value) {\n            if (value !== null && typeof value === 'object') {\n              $elm.css(value);\n              return;\n            }\n            if (keepValues) {\n              $elm.attr('data-mce-style', value);\n            }\n            if (value !== null && typeof value === 'string') {\n              $elm.removeAttr('style');\n              $elm.css(styles.parse(value));\n            } else {\n              $elm.attr('style', value);\n            }\n          },\n          get: function ($elm) {\n            var value = $elm.attr('data-mce-style') || $elm.attr('style');\n            value = styles.serialize(styles.parse(value), $elm[0].nodeName);\n            return value;\n          }\n        }\n      };\n      if (keepValues) {\n        attrHooks.href = attrHooks.src = keepUrlHook;\n      }\n      return attrHooks;\n    };\n    var updateInternalStyleAttr = function (styles, $elm) {\n      var rawValue = $elm.attr('style');\n      var value = styles.serialize(styles.parse(rawValue), $elm[0].nodeName);\n      if (!value) {\n        value = null;\n      }\n      $elm.attr('data-mce-style', value);\n    };\n    var findNodeIndex = function (node, normalized) {\n      var idx = 0, lastNodeType, nodeType;\n      if (node) {\n        for (lastNodeType = node.nodeType, node = node.previousSibling; node; node = node.previousSibling) {\n          nodeType = node.nodeType;\n          if (normalized && nodeType === 3) {\n            if (nodeType === lastNodeType || !node.nodeValue.length) {\n              continue;\n            }\n          }\n          idx++;\n          lastNodeType = nodeType;\n        }\n      }\n      return idx;\n    };\n    var DOMUtils = function (doc, settings) {\n      if (settings === void 0) {\n        settings = {};\n      }\n      var addedStyles = {};\n      var win = window;\n      var files = {};\n      var counter = 0;\n      var stdMode = true;\n      var boxModel = true;\n      var styleSheetLoader = instance.forElement(SugarElement.fromDom(doc), {\n        contentCssCors: settings.contentCssCors,\n        referrerPolicy: settings.referrerPolicy\n      });\n      var boundEvents = [];\n      var schema = settings.schema ? settings.schema : Schema({});\n      var styles = Styles({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope\n      }, settings.schema);\n      var events = settings.ownEvents ? new EventUtils() : EventUtils.Event;\n      var blockElementsMap = schema.getBlockElements();\n      var $ = DomQuery.overrideDefaults(function () {\n        return {\n          context: doc,\n          element: self.getRoot()\n        };\n      });\n      var isBlock = function (node) {\n        if (typeof node === 'string') {\n          return !!blockElementsMap[node];\n        } else if (node) {\n          var type = node.nodeType;\n          if (type) {\n            return !!(type === 1 && blockElementsMap[node.nodeName]);\n          }\n        }\n        return false;\n      };\n      var get = function (elm) {\n        return elm && doc && isString$1(elm) ? doc.getElementById(elm) : elm;\n      };\n      var $$ = function (elm) {\n        return $(typeof elm === 'string' ? get(elm) : elm);\n      };\n      var getAttrib = function (elm, name, defaultVal) {\n        var hook, value;\n        var $elm = $$(elm);\n        if ($elm.length) {\n          hook = attrHooks[name];\n          if (hook && hook.get) {\n            value = hook.get($elm, name);\n          } else {\n            value = $elm.attr(name);\n          }\n        }\n        if (typeof value === 'undefined') {\n          value = defaultVal || '';\n        }\n        return value;\n      };\n      var getAttribs = function (elm) {\n        var node = get(elm);\n        if (!node) {\n          return [];\n        }\n        return node.attributes;\n      };\n      var setAttrib = function (elm, name, value) {\n        if (value === '') {\n          value = null;\n        }\n        var $elm = $$(elm);\n        var originalValue = $elm.attr(name);\n        if (!$elm.length) {\n          return;\n        }\n        var hook = attrHooks[name];\n        if (hook && hook.set) {\n          hook.set($elm, value, name);\n        } else {\n          $elm.attr(name, value);\n        }\n        if (originalValue !== value && settings.onSetAttrib) {\n          settings.onSetAttrib({\n            attrElm: $elm,\n            attrName: name,\n            attrValue: value\n          });\n        }\n      };\n      var clone = function (node, deep) {\n        if (!isIE || node.nodeType !== 1 || deep) {\n          return node.cloneNode(deep);\n        } else {\n          var clone_1 = doc.createElement(node.nodeName);\n          each$f(getAttribs(node), function (attr) {\n            setAttrib(clone_1, attr.nodeName, getAttrib(node, attr.nodeName));\n          });\n          return clone_1;\n        }\n      };\n      var getRoot = function () {\n        return settings.root_element || doc.body;\n      };\n      var getViewPort = function (argWin) {\n        var vp = getBounds(argWin);\n        return {\n          x: vp.x,\n          y: vp.y,\n          w: vp.width,\n          h: vp.height\n        };\n      };\n      var getPos$1 = function (elm, rootElm) {\n        return getPos(doc.body, get(elm), rootElm);\n      };\n      var setStyle = function (elm, name, value) {\n        var $elm = isString$1(name) ? $$(elm).css(name, value) : $$(elm).css(name);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var setStyles = function (elm, stylesArg) {\n        var $elm = $$(elm).css(stylesArg);\n        if (settings.update_styles) {\n          updateInternalStyleAttr(styles, $elm);\n        }\n      };\n      var getStyle = function (elm, name, computed) {\n        var $elm = $$(elm);\n        if (computed) {\n          return $elm.css(name);\n        }\n        name = name.replace(/-(\\D)/g, function (a, b) {\n          return b.toUpperCase();\n        });\n        if (name === 'float') {\n          name = Env.browser.isIE() ? 'styleFloat' : 'cssFloat';\n        }\n        return $elm[0] && $elm[0].style ? $elm[0].style[name] : undefined;\n      };\n      var getSize = function (elm) {\n        var w, h;\n        elm = get(elm);\n        w = getStyle(elm, 'width');\n        h = getStyle(elm, 'height');\n        if (w.indexOf('px') === -1) {\n          w = 0;\n        }\n        if (h.indexOf('px') === -1) {\n          h = 0;\n        }\n        return {\n          w: parseInt(w, 10) || elm.offsetWidth || elm.clientWidth,\n          h: parseInt(h, 10) || elm.offsetHeight || elm.clientHeight\n        };\n      };\n      var getRect = function (elm) {\n        elm = get(elm);\n        var pos = getPos$1(elm);\n        var size = getSize(elm);\n        return {\n          x: pos.x,\n          y: pos.y,\n          w: size.w,\n          h: size.h\n        };\n      };\n      var is = function (elm, selector) {\n        var i;\n        if (!elm) {\n          return false;\n        }\n        if (!Array.isArray(elm)) {\n          if (selector === '*') {\n            return elm.nodeType === 1;\n          }\n          if (simpleSelectorRe.test(selector)) {\n            var selectors = selector.toLowerCase().split(/,/);\n            var elmName = elm.nodeName.toLowerCase();\n            for (i = selectors.length - 1; i >= 0; i--) {\n              if (selectors[i] === elmName) {\n                return true;\n              }\n            }\n            return false;\n          }\n          if (elm.nodeType && elm.nodeType !== 1) {\n            return false;\n          }\n        }\n        var elms = !Array.isArray(elm) ? [elm] : elm;\n        return Sizzle(selector, elms[0].ownerDocument || elms[0], null, elms).length > 0;\n      };\n      var getParents = function (elm, selector, root, collect) {\n        var result = [];\n        var selectorVal;\n        var node = get(elm);\n        collect = collect === undefined;\n        root = root || (getRoot().nodeName !== 'BODY' ? getRoot().parentNode : null);\n        if (Tools.is(selector, 'string')) {\n          selectorVal = selector;\n          if (selector === '*') {\n            selector = function (node) {\n              return node.nodeType === 1;\n            };\n          } else {\n            selector = function (node) {\n              return is(node, selectorVal);\n            };\n          }\n        }\n        while (node) {\n          if (node === root || isNullable(node.nodeType) || isDocument$1(node) || isDocumentFragment(node)) {\n            break;\n          }\n          if (!selector || typeof selector === 'function' && selector(node)) {\n            if (collect) {\n              result.push(node);\n            } else {\n              return [node];\n            }\n          }\n          node = node.parentNode;\n        }\n        return collect ? result : null;\n      };\n      var getParent = function (node, selector, root) {\n        var parents = getParents(node, selector, root, false);\n        return parents && parents.length > 0 ? parents[0] : null;\n      };\n      var _findSib = function (node, selector, name) {\n        var func = selector;\n        if (node) {\n          if (typeof selector === 'string') {\n            func = function (node) {\n              return is(node, selector);\n            };\n          }\n          for (node = node[name]; node; node = node[name]) {\n            if (typeof func === 'function' && func(node)) {\n              return node;\n            }\n          }\n        }\n        return null;\n      };\n      var getNext = function (node, selector) {\n        return _findSib(node, selector, 'nextSibling');\n      };\n      var getPrev = function (node, selector) {\n        return _findSib(node, selector, 'previousSibling');\n      };\n      var select = function (selector, scope) {\n        return Sizzle(selector, get(scope) || settings.root_element || doc, []);\n      };\n      var run = function (elm, func, scope) {\n        var result;\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        if (!node) {\n          return false;\n        }\n        if (Tools.isArray(node) && (node.length || node.length === 0)) {\n          result = [];\n          each$f(node, function (elm, i) {\n            if (elm) {\n              result.push(func.call(scope, typeof elm === 'string' ? get(elm) : elm, i));\n            }\n          });\n          return result;\n        }\n        var context = scope ? scope : this;\n        return func.call(context, node);\n      };\n      var setAttribs = function (elm, attrs) {\n        $$(elm).each(function (i, node) {\n          each$f(attrs, function (value, name) {\n            setAttrib(node, name, value);\n          });\n        });\n      };\n      var setHTML = function (elm, html) {\n        var $elm = $$(elm);\n        if (isIE) {\n          $elm.each(function (i, target) {\n            if (target.canHaveHTML === false) {\n              return;\n            }\n            while (target.firstChild) {\n              target.removeChild(target.firstChild);\n            }\n            try {\n              target.innerHTML = '<br>' + html;\n              target.removeChild(target.firstChild);\n            } catch (ex) {\n              DomQuery('<div></div>').html('<br>' + html).contents().slice(1).appendTo(target);\n            }\n            return html;\n          });\n        } else {\n          $elm.html(html);\n        }\n      };\n      var add = function (parentElm, name, attrs, html, create) {\n        return run(parentElm, function (parentElm) {\n          var newElm = typeof name === 'string' ? doc.createElement(name) : name;\n          setAttribs(newElm, attrs);\n          if (html) {\n            if (typeof html !== 'string' && html.nodeType) {\n              newElm.appendChild(html);\n            } else if (typeof html === 'string') {\n              setHTML(newElm, html);\n            }\n          }\n          return !create ? parentElm.appendChild(newElm) : newElm;\n        });\n      };\n      var create = function (name, attrs, html) {\n        return add(doc.createElement(name), name, attrs, html, true);\n      };\n      var decode = Entities.decode;\n      var encode = Entities.encodeAllRaw;\n      var createHTML = function (name, attrs, html) {\n        var outHtml = '', key;\n        outHtml += '<' + name;\n        for (key in attrs) {\n          if (hasNonNullableKey(attrs, key)) {\n            outHtml += ' ' + key + '=\"' + encode(attrs[key]) + '\"';\n          }\n        }\n        if (typeof html !== 'undefined') {\n          return outHtml + '>' + html + '</' + name + '>';\n        }\n        return outHtml + ' />';\n      };\n      var createFragment = function (html) {\n        var node;\n        var container = doc.createElement('div');\n        var frag = doc.createDocumentFragment();\n        frag.appendChild(container);\n        if (html) {\n          container.innerHTML = html;\n        }\n        while (node = container.firstChild) {\n          frag.appendChild(node);\n        }\n        frag.removeChild(container);\n        return frag;\n      };\n      var remove = function (node, keepChildren) {\n        var $node = $$(node);\n        if (keepChildren) {\n          $node.each(function () {\n            var child;\n            while (child = this.firstChild) {\n              if (child.nodeType === 3 && child.data.length === 0) {\n                this.removeChild(child);\n              } else {\n                this.parentNode.insertBefore(child, this);\n              }\n            }\n          }).remove();\n        } else {\n          $node.remove();\n        }\n        return $node.length > 1 ? $node.toArray() : $node[0];\n      };\n      var removeAllAttribs = function (e) {\n        return run(e, function (e) {\n          var i;\n          var attrs = e.attributes;\n          for (i = attrs.length - 1; i >= 0; i--) {\n            e.removeAttributeNode(attrs.item(i));\n          }\n        });\n      };\n      var parseStyle = function (cssText) {\n        return styles.parse(cssText);\n      };\n      var serializeStyle = function (stylesArg, name) {\n        return styles.serialize(stylesArg, name);\n      };\n      var addStyle = function (cssText) {\n        var head, styleElm;\n        if (self !== DOMUtils.DOM && doc === document) {\n          if (addedStyles[cssText]) {\n            return;\n          }\n          addedStyles[cssText] = true;\n        }\n        styleElm = doc.getElementById('mceDefaultStyles');\n        if (!styleElm) {\n          styleElm = doc.createElement('style');\n          styleElm.id = 'mceDefaultStyles';\n          styleElm.type = 'text/css';\n          head = doc.getElementsByTagName('head')[0];\n          if (head.firstChild) {\n            head.insertBefore(styleElm, head.firstChild);\n          } else {\n            head.appendChild(styleElm);\n          }\n        }\n        if (styleElm.styleSheet) {\n          styleElm.styleSheet.cssText += cssText;\n        } else {\n          styleElm.appendChild(doc.createTextNode(cssText));\n        }\n      };\n      var loadCSS = function (urls) {\n        if (!urls) {\n          urls = '';\n        }\n        each$k(urls.split(','), function (url) {\n          files[url] = true;\n          styleSheetLoader.load(url, noop);\n        });\n      };\n      var toggleClass = function (elm, cls, state) {\n        $$(elm).toggleClass(cls, state).each(function () {\n          if (this.className === '') {\n            DomQuery(this).attr('class', null);\n          }\n        });\n      };\n      var addClass = function (elm, cls) {\n        $$(elm).addClass(cls);\n      };\n      var removeClass = function (elm, cls) {\n        toggleClass(elm, cls, false);\n      };\n      var hasClass = function (elm, cls) {\n        return $$(elm).hasClass(cls);\n      };\n      var show = function (elm) {\n        $$(elm).show();\n      };\n      var hide = function (elm) {\n        $$(elm).hide();\n      };\n      var isHidden = function (elm) {\n        return $$(elm).css('display') === 'none';\n      };\n      var uniqueId = function (prefix) {\n        return (!prefix ? 'mce_' : prefix) + counter++;\n      };\n      var getOuterHTML = function (elm) {\n        var node = typeof elm === 'string' ? get(elm) : elm;\n        return isElement$5(node) ? node.outerHTML : DomQuery('<div></div>').append(DomQuery(node).clone()).html();\n      };\n      var setOuterHTML = function (elm, html) {\n        $$(elm).each(function () {\n          try {\n            if ('outerHTML' in this) {\n              this.outerHTML = html;\n              return;\n            }\n          } catch (ex) {\n          }\n          remove(DomQuery(this).html(html), true);\n        });\n      };\n      var insertAfter = function (node, reference) {\n        var referenceNode = get(reference);\n        return run(node, function (node) {\n          var parent = referenceNode.parentNode;\n          var nextSibling = referenceNode.nextSibling;\n          if (nextSibling) {\n            parent.insertBefore(node, nextSibling);\n          } else {\n            parent.appendChild(node);\n          }\n          return node;\n        });\n      };\n      var replace = function (newElm, oldElm, keepChildren) {\n        return run(oldElm, function (oldElm) {\n          if (Tools.is(oldElm, 'array')) {\n            newElm = newElm.cloneNode(true);\n          }\n          if (keepChildren) {\n            each$f(grep$1(oldElm.childNodes), function (node) {\n              newElm.appendChild(node);\n            });\n          }\n          return oldElm.parentNode.replaceChild(newElm, oldElm);\n        });\n      };\n      var rename = function (elm, name) {\n        var newElm;\n        if (elm.nodeName !== name.toUpperCase()) {\n          newElm = create(name);\n          each$f(getAttribs(elm), function (attrNode) {\n            setAttrib(newElm, attrNode.nodeName, getAttrib(elm, attrNode.nodeName));\n          });\n          replace(newElm, elm, true);\n        }\n        return newElm || elm;\n      };\n      var findCommonAncestor = function (a, b) {\n        var ps = a, pe;\n        while (ps) {\n          pe = b;\n          while (pe && ps !== pe) {\n            pe = pe.parentNode;\n          }\n          if (ps === pe) {\n            break;\n          }\n          ps = ps.parentNode;\n        }\n        if (!ps && a.ownerDocument) {\n          return a.ownerDocument.documentElement;\n        }\n        return ps;\n      };\n      var toHex = function (rgbVal) {\n        return styles.toHex(Tools.trim(rgbVal));\n      };\n      var isNonEmptyElement = function (node) {\n        if (isElement$5(node)) {\n          var isNamedAnchor = node.nodeName.toLowerCase() === 'a' && !getAttrib(node, 'href') && getAttrib(node, 'id');\n          if (getAttrib(node, 'name') || getAttrib(node, 'data-mce-bookmark') || isNamedAnchor) {\n            return true;\n          }\n        }\n        return false;\n      };\n      var isEmpty = function (node, elements) {\n        var type, name, brCount = 0;\n        if (isNonEmptyElement(node)) {\n          return false;\n        }\n        node = node.firstChild;\n        if (node) {\n          var walker = new DomTreeWalker(node, node.parentNode);\n          var whitespace = schema ? schema.getWhiteSpaceElements() : {};\n          elements = elements || (schema ? schema.getNonEmptyElements() : null);\n          do {\n            type = node.nodeType;\n            if (isElement$5(node)) {\n              var bogusVal = node.getAttribute('data-mce-bogus');\n              if (bogusVal) {\n                node = walker.next(bogusVal === 'all');\n                continue;\n              }\n              name = node.nodeName.toLowerCase();\n              if (elements && elements[name]) {\n                if (name === 'br') {\n                  brCount++;\n                  node = walker.next();\n                  continue;\n                }\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (type === 8) {\n              return false;\n            }\n            if (type === 3 && !isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            if (type === 3 && node.parentNode && whitespace[node.parentNode.nodeName] && isWhitespaceText(node.nodeValue)) {\n              return false;\n            }\n            node = walker.next();\n          } while (node);\n        }\n        return brCount <= 1;\n      };\n      var createRng = function () {\n        return doc.createRange();\n      };\n      var split = function (parentElm, splitElm, replacementElm) {\n        var range = createRng();\n        var beforeFragment;\n        var afterFragment;\n        var parentNode;\n        if (parentElm && splitElm) {\n          range.setStart(parentElm.parentNode, findNodeIndex(parentElm));\n          range.setEnd(splitElm.parentNode, findNodeIndex(splitElm));\n          beforeFragment = range.extractContents();\n          range = createRng();\n          range.setStart(splitElm.parentNode, findNodeIndex(splitElm) + 1);\n          range.setEnd(parentElm.parentNode, findNodeIndex(parentElm) + 1);\n          afterFragment = range.extractContents();\n          parentNode = parentElm.parentNode;\n          parentNode.insertBefore(trimNode(self, beforeFragment), parentElm);\n          if (replacementElm) {\n            parentNode.insertBefore(replacementElm, parentElm);\n          } else {\n            parentNode.insertBefore(splitElm, parentElm);\n          }\n          parentNode.insertBefore(trimNode(self, afterFragment), parentElm);\n          remove(parentElm);\n          return replacementElm || splitElm;\n        }\n      };\n      var bind = function (target, name, func, scope) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = bind(target[i], name, func, scope);\n          }\n          return rv;\n        }\n        if (settings.collect && (target === doc || target === win)) {\n          boundEvents.push([\n            target,\n            name,\n            func,\n            scope\n          ]);\n        }\n        var output = events.bind(target, name, func, scope || self);\n        return output;\n      };\n      var unbind = function (target, name, func) {\n        if (Tools.isArray(target)) {\n          var i = target.length;\n          var rv = [];\n          while (i--) {\n            rv[i] = unbind(target[i], name, func);\n          }\n          return rv;\n        } else {\n          if (boundEvents.length > 0 && (target === doc || target === win)) {\n            var i = boundEvents.length;\n            while (i--) {\n              var item = boundEvents[i];\n              if (target === item[0] && (!name || name === item[1]) && (!func || func === item[2])) {\n                events.unbind(item[0], item[1], item[2]);\n              }\n            }\n          }\n          return events.unbind(target, name, func);\n        }\n      };\n      var fire = function (target, name, evt) {\n        return events.fire(target, name, evt);\n      };\n      var getContentEditable = function (node) {\n        if (node && isElement$5(node)) {\n          var contentEditable = node.getAttribute('data-mce-contenteditable');\n          if (contentEditable && contentEditable !== 'inherit') {\n            return contentEditable;\n          }\n          return node.contentEditable !== 'inherit' ? node.contentEditable : null;\n        } else {\n          return null;\n        }\n      };\n      var getContentEditableParent = function (node) {\n        var root = getRoot();\n        var state = null;\n        for (; node && node !== root; node = node.parentNode) {\n          state = getContentEditable(node);\n          if (state !== null) {\n            break;\n          }\n        }\n        return state;\n      };\n      var destroy = function () {\n        if (boundEvents.length > 0) {\n          var i = boundEvents.length;\n          while (i--) {\n            var item = boundEvents[i];\n            events.unbind(item[0], item[1], item[2]);\n          }\n        }\n        each$j(files, function (_, url) {\n          styleSheetLoader.unload(url);\n          delete files[url];\n        });\n        if (Sizzle.setDocument) {\n          Sizzle.setDocument();\n        }\n      };\n      var isChildOf = function (node, parent) {\n        if (!isIE) {\n          return node === parent || parent.contains(node);\n        } else {\n          while (node) {\n            if (parent === node) {\n              return true;\n            }\n            node = node.parentNode;\n          }\n          return false;\n        }\n      };\n      var dumpRng = function (r) {\n        return 'startContainer: ' + r.startContainer.nodeName + ', startOffset: ' + r.startOffset + ', endContainer: ' + r.endContainer.nodeName + ', endOffset: ' + r.endOffset;\n      };\n      var self = {\n        doc: doc,\n        settings: settings,\n        win: win,\n        files: files,\n        stdMode: stdMode,\n        boxModel: boxModel,\n        styleSheetLoader: styleSheetLoader,\n        boundEvents: boundEvents,\n        styles: styles,\n        schema: schema,\n        events: events,\n        isBlock: isBlock,\n        $: $,\n        $$: $$,\n        root: null,\n        clone: clone,\n        getRoot: getRoot,\n        getViewPort: getViewPort,\n        getRect: getRect,\n        getSize: getSize,\n        getParent: getParent,\n        getParents: getParents,\n        get: get,\n        getNext: getNext,\n        getPrev: getPrev,\n        select: select,\n        is: is,\n        add: add,\n        create: create,\n        createHTML: createHTML,\n        createFragment: createFragment,\n        remove: remove,\n        setStyle: setStyle,\n        getStyle: getStyle,\n        setStyles: setStyles,\n        removeAllAttribs: removeAllAttribs,\n        setAttrib: setAttrib,\n        setAttribs: setAttribs,\n        getAttrib: getAttrib,\n        getPos: getPos$1,\n        parseStyle: parseStyle,\n        serializeStyle: serializeStyle,\n        addStyle: addStyle,\n        loadCSS: loadCSS,\n        addClass: addClass,\n        removeClass: removeClass,\n        hasClass: hasClass,\n        toggleClass: toggleClass,\n        show: show,\n        hide: hide,\n        isHidden: isHidden,\n        uniqueId: uniqueId,\n        setHTML: setHTML,\n        getOuterHTML: getOuterHTML,\n        setOuterHTML: setOuterHTML,\n        decode: decode,\n        encode: encode,\n        insertAfter: insertAfter,\n        replace: replace,\n        rename: rename,\n        findCommonAncestor: findCommonAncestor,\n        toHex: toHex,\n        run: run,\n        getAttribs: getAttribs,\n        isEmpty: isEmpty,\n        createRng: createRng,\n        nodeIndex: findNodeIndex,\n        split: split,\n        bind: bind,\n        unbind: unbind,\n        fire: fire,\n        getContentEditable: getContentEditable,\n        getContentEditableParent: getContentEditableParent,\n        destroy: destroy,\n        isChildOf: isChildOf,\n        dumpRng: dumpRng\n      };\n      var attrHooks = setupAttrHooks(styles, settings, constant(self));\n      return self;\n    };\n    DOMUtils.DOM = DOMUtils(document);\n    DOMUtils.nodeIndex = findNodeIndex;\n\n    var DOM$a = DOMUtils.DOM;\n    var each$e = Tools.each, grep = Tools.grep;\n    var QUEUED = 0;\n    var LOADING = 1;\n    var LOADED = 2;\n    var FAILED = 3;\n    var ScriptLoader = function () {\n      function ScriptLoader(settings) {\n        if (settings === void 0) {\n          settings = {};\n        }\n        this.states = {};\n        this.queue = [];\n        this.scriptLoadedCallbacks = {};\n        this.queueLoadedCallbacks = [];\n        this.loading = 0;\n        this.settings = settings;\n      }\n      ScriptLoader.prototype._setReferrerPolicy = function (referrerPolicy) {\n        this.settings.referrerPolicy = referrerPolicy;\n      };\n      ScriptLoader.prototype.loadScript = function (url, success, failure) {\n        var dom = DOM$a;\n        var elm;\n        var cleanup = function () {\n          dom.remove(id);\n          if (elm) {\n            elm.onerror = elm.onload = elm = null;\n          }\n        };\n        var done = function () {\n          cleanup();\n          success();\n        };\n        var error = function () {\n          cleanup();\n          if (isFunction(failure)) {\n            failure();\n          } else {\n            if (typeof console !== 'undefined' && console.log) {\n              console.log('Failed to load script: ' + url);\n            }\n          }\n        };\n        var id = dom.uniqueId();\n        elm = document.createElement('script');\n        elm.id = id;\n        elm.type = 'text/javascript';\n        elm.src = Tools._addCacheSuffix(url);\n        if (this.settings.referrerPolicy) {\n          dom.setAttrib(elm, 'referrerpolicy', this.settings.referrerPolicy);\n        }\n        elm.onload = done;\n        elm.onerror = error;\n        (document.getElementsByTagName('head')[0] || document.body).appendChild(elm);\n      };\n      ScriptLoader.prototype.isDone = function (url) {\n        return this.states[url] === LOADED;\n      };\n      ScriptLoader.prototype.markDone = function (url) {\n        this.states[url] = LOADED;\n      };\n      ScriptLoader.prototype.add = function (url, success, scope, failure) {\n        var state = this.states[url];\n        this.queue.push(url);\n        if (state === undefined) {\n          this.states[url] = QUEUED;\n        }\n        if (success) {\n          if (!this.scriptLoadedCallbacks[url]) {\n            this.scriptLoadedCallbacks[url] = [];\n          }\n          this.scriptLoadedCallbacks[url].push({\n            success: success,\n            failure: failure,\n            scope: scope || this\n          });\n        }\n      };\n      ScriptLoader.prototype.load = function (url, success, scope, failure) {\n        return this.add(url, success, scope, failure);\n      };\n      ScriptLoader.prototype.remove = function (url) {\n        delete this.states[url];\n        delete this.scriptLoadedCallbacks[url];\n      };\n      ScriptLoader.prototype.loadQueue = function (success, scope, failure) {\n        this.loadScripts(this.queue, success, scope, failure);\n      };\n      ScriptLoader.prototype.loadScripts = function (scripts, success, scope, failure) {\n        var self = this;\n        var failures = [];\n        var execCallbacks = function (name, url) {\n          each$e(self.scriptLoadedCallbacks[url], function (callback) {\n            if (isFunction(callback[name])) {\n              callback[name].call(callback.scope);\n            }\n          });\n          self.scriptLoadedCallbacks[url] = undefined;\n        };\n        self.queueLoadedCallbacks.push({\n          success: success,\n          failure: failure,\n          scope: scope || this\n        });\n        var loadScripts = function () {\n          var loadingScripts = grep(scripts);\n          scripts.length = 0;\n          each$e(loadingScripts, function (url) {\n            if (self.states[url] === LOADED) {\n              execCallbacks('success', url);\n              return;\n            }\n            if (self.states[url] === FAILED) {\n              execCallbacks('failure', url);\n              return;\n            }\n            if (self.states[url] !== LOADING) {\n              self.states[url] = LOADING;\n              self.loading++;\n              self.loadScript(url, function () {\n                self.states[url] = LOADED;\n                self.loading--;\n                execCallbacks('success', url);\n                loadScripts();\n              }, function () {\n                self.states[url] = FAILED;\n                self.loading--;\n                failures.push(url);\n                execCallbacks('failure', url);\n                loadScripts();\n              });\n            }\n          });\n          if (!self.loading) {\n            var notifyCallbacks = self.queueLoadedCallbacks.slice(0);\n            self.queueLoadedCallbacks.length = 0;\n            each$e(notifyCallbacks, function (callback) {\n              if (failures.length === 0) {\n                if (isFunction(callback.success)) {\n                  callback.success.call(callback.scope);\n                }\n              } else {\n                if (isFunction(callback.failure)) {\n                  callback.failure.call(callback.scope, failures);\n                }\n              }\n            });\n          }\n        };\n        loadScripts();\n      };\n      ScriptLoader.ScriptLoader = new ScriptLoader();\n      return ScriptLoader;\n    }();\n\n    var Cell = function (initial) {\n      var value = initial;\n      var get = function () {\n        return value;\n      };\n      var set = function (v) {\n        value = v;\n      };\n      return {\n        get: get,\n        set: set\n      };\n    };\n\n    var isRaw = function (str) {\n      return isObject(str) && has$2(str, 'raw');\n    };\n    var isTokenised = function (str) {\n      return isArray$1(str) && str.length > 1;\n    };\n    var data = {};\n    var currentCode = Cell('en');\n    var getLanguageData = function () {\n      return get$9(data, currentCode.get());\n    };\n    var getData = function () {\n      return map$2(data, function (value) {\n        return __assign({}, value);\n      });\n    };\n    var setCode = function (newCode) {\n      if (newCode) {\n        currentCode.set(newCode);\n      }\n    };\n    var getCode = function () {\n      return currentCode.get();\n    };\n    var add$4 = function (code, items) {\n      var langData = data[code];\n      if (!langData) {\n        data[code] = langData = {};\n      }\n      each$j(items, function (translation, name) {\n        langData[name.toLowerCase()] = translation;\n      });\n    };\n    var translate = function (text) {\n      var langData = getLanguageData().getOr({});\n      var toString = function (obj) {\n        if (isFunction(obj)) {\n          return Object.prototype.toString.call(obj);\n        }\n        return !isEmpty(obj) ? '' + obj : '';\n      };\n      var isEmpty = function (text) {\n        return text === '' || text === null || text === undefined;\n      };\n      var getLangData = function (text) {\n        var textstr = toString(text);\n        return get$9(langData, textstr.toLowerCase()).map(toString).getOr(textstr);\n      };\n      var removeContext = function (str) {\n        return str.replace(/{context:\\w+}$/, '');\n      };\n      if (isEmpty(text)) {\n        return '';\n      }\n      if (isRaw(text)) {\n        return toString(text.raw);\n      }\n      if (isTokenised(text)) {\n        var values_1 = text.slice(1);\n        var substitued = getLangData(text[0]).replace(/\\{([0-9]+)\\}/g, function ($1, $2) {\n          return has$2(values_1, $2) ? toString(values_1[$2]) : $1;\n        });\n        return removeContext(substitued);\n      }\n      return removeContext(getLangData(text));\n    };\n    var isRtl$1 = function () {\n      return getLanguageData().bind(function (items) {\n        return get$9(items, '_dir');\n      }).exists(function (dir) {\n        return dir === 'rtl';\n      });\n    };\n    var hasCode = function (code) {\n      return has$2(data, code);\n    };\n    var I18n = {\n      getData: getData,\n      setCode: setCode,\n      getCode: getCode,\n      add: add$4,\n      translate: translate,\n      isRtl: isRtl$1,\n      hasCode: hasCode\n    };\n\n    var AddOnManager = function () {\n      var items = [];\n      var urls = {};\n      var lookup = {};\n      var _listeners = [];\n      var runListeners = function (name, state) {\n        var matchedListeners = filter$4(_listeners, function (listener) {\n          return listener.name === name && listener.state === state;\n        });\n        each$k(matchedListeners, function (listener) {\n          return listener.callback();\n        });\n      };\n      var get = function (name) {\n        if (lookup[name]) {\n          return lookup[name].instance;\n        }\n        return undefined;\n      };\n      var dependencies = function (name) {\n        var result;\n        if (lookup[name]) {\n          result = lookup[name].dependencies;\n        }\n        return result || [];\n      };\n      var requireLangPack = function (name, languages) {\n        if (AddOnManager.languageLoad !== false) {\n          waitFor(name, function () {\n            var language = I18n.getCode();\n            var wrappedLanguages = ',' + (languages || '') + ',';\n            if (!language || languages && wrappedLanguages.indexOf(',' + language + ',') === -1) {\n              return;\n            }\n            ScriptLoader.ScriptLoader.add(urls[name] + '/langs/' + language + '.js');\n          }, 'loaded');\n        }\n      };\n      var add = function (id, addOn, dependencies) {\n        var addOnConstructor = addOn;\n        items.push(addOnConstructor);\n        lookup[id] = {\n          instance: addOnConstructor,\n          dependencies: dependencies\n        };\n        runListeners(id, 'added');\n        return addOnConstructor;\n      };\n      var remove = function (name) {\n        delete urls[name];\n        delete lookup[name];\n      };\n      var createUrl = function (baseUrl, dep) {\n        if (typeof dep === 'object') {\n          return dep;\n        }\n        return typeof baseUrl === 'string' ? {\n          prefix: '',\n          resource: dep,\n          suffix: ''\n        } : {\n          prefix: baseUrl.prefix,\n          resource: dep,\n          suffix: baseUrl.suffix\n        };\n      };\n      var addComponents = function (pluginName, scripts) {\n        var pluginUrl = urls[pluginName];\n        each$k(scripts, function (script) {\n          ScriptLoader.ScriptLoader.add(pluginUrl + '/' + script);\n        });\n      };\n      var loadDependencies = function (name, addOnUrl, success, scope) {\n        var deps = dependencies(name);\n        each$k(deps, function (dep) {\n          var newUrl = createUrl(addOnUrl, dep);\n          load(newUrl.resource, newUrl, undefined, undefined);\n        });\n        if (success) {\n          if (scope) {\n            success.call(scope);\n          } else {\n            success.call(ScriptLoader);\n          }\n        }\n      };\n      var load = function (name, addOnUrl, success, scope, failure) {\n        if (urls[name]) {\n          return;\n        }\n        var urlString = typeof addOnUrl === 'string' ? addOnUrl : addOnUrl.prefix + addOnUrl.resource + addOnUrl.suffix;\n        if (urlString.indexOf('/') !== 0 && urlString.indexOf('://') === -1) {\n          urlString = AddOnManager.baseURL + '/' + urlString;\n        }\n        urls[name] = urlString.substring(0, urlString.lastIndexOf('/'));\n        var done = function () {\n          runListeners(name, 'loaded');\n          loadDependencies(name, addOnUrl, success, scope);\n        };\n        if (lookup[name]) {\n          done();\n        } else {\n          ScriptLoader.ScriptLoader.add(urlString, done, scope, failure);\n        }\n      };\n      var waitFor = function (name, callback, state) {\n        if (state === void 0) {\n          state = 'added';\n        }\n        if (has$2(lookup, name) && state === 'added') {\n          callback();\n        } else if (has$2(urls, name) && state === 'loaded') {\n          callback();\n        } else {\n          _listeners.push({\n            name: name,\n            state: state,\n            callback: callback\n          });\n        }\n      };\n      return {\n        items: items,\n        urls: urls,\n        lookup: lookup,\n        _listeners: _listeners,\n        get: get,\n        dependencies: dependencies,\n        requireLangPack: requireLangPack,\n        add: add,\n        remove: remove,\n        createUrl: createUrl,\n        addComponents: addComponents,\n        load: load,\n        waitFor: waitFor\n      };\n    };\n    AddOnManager.languageLoad = true;\n    AddOnManager.baseURL = '';\n    AddOnManager.PluginManager = AddOnManager();\n    AddOnManager.ThemeManager = AddOnManager();\n\n    var singleton = function (doRevoke) {\n      var subject = Cell(Optional.none());\n      var revoke = function () {\n        return subject.get().each(doRevoke);\n      };\n      var clear = function () {\n        revoke();\n        subject.set(Optional.none());\n      };\n      var isSet = function () {\n        return subject.get().isSome();\n      };\n      var get = function () {\n        return subject.get();\n      };\n      var set = function (s) {\n        revoke();\n        subject.set(Optional.some(s));\n      };\n      return {\n        clear: clear,\n        isSet: isSet,\n        get: get,\n        set: set\n      };\n    };\n    var value = function () {\n      var subject = singleton(noop);\n      var on = function (f) {\n        return subject.get().each(f);\n      };\n      return __assign(__assign({}, subject), { on: on });\n    };\n\n    var first = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (!isNull(timer)) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (isNull(timer)) {\n          timer = setTimeout(function () {\n            timer = null;\n            fn.apply(null, args);\n          }, rate);\n        }\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n    var last = function (fn, rate) {\n      var timer = null;\n      var cancel = function () {\n        if (!isNull(timer)) {\n          clearTimeout(timer);\n          timer = null;\n        }\n      };\n      var throttle = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        cancel();\n        timer = setTimeout(function () {\n          timer = null;\n          fn.apply(null, args);\n        }, rate);\n      };\n      return {\n        cancel: cancel,\n        throttle: throttle\n      };\n    };\n\n    var read$4 = function (element, attr) {\n      var value = get$6(element, attr);\n      return value === undefined || value === '' ? [] : value.split(' ');\n    };\n    var add$3 = function (element, attr, id) {\n      var old = read$4(element, attr);\n      var nu = old.concat([id]);\n      set$1(element, attr, nu.join(' '));\n      return true;\n    };\n    var remove$5 = function (element, attr, id) {\n      var nu = filter$4(read$4(element, attr), function (v) {\n        return v !== id;\n      });\n      if (nu.length > 0) {\n        set$1(element, attr, nu.join(' '));\n      } else {\n        remove$6(element, attr);\n      }\n      return false;\n    };\n\n    var supports = function (element) {\n      return element.dom.classList !== undefined;\n    };\n    var get$4 = function (element) {\n      return read$4(element, 'class');\n    };\n    var add$2 = function (element, clazz) {\n      return add$3(element, 'class', clazz);\n    };\n    var remove$4 = function (element, clazz) {\n      return remove$5(element, 'class', clazz);\n    };\n\n    var add$1 = function (element, clazz) {\n      if (supports(element)) {\n        element.dom.classList.add(clazz);\n      } else {\n        add$2(element, clazz);\n      }\n    };\n    var cleanClass = function (element) {\n      var classList = supports(element) ? element.dom.classList : get$4(element);\n      if (classList.length === 0) {\n        remove$6(element, 'class');\n      }\n    };\n    var remove$3 = function (element, clazz) {\n      if (supports(element)) {\n        var classList = element.dom.classList;\n        classList.remove(clazz);\n      } else {\n        remove$4(element, clazz);\n      }\n      cleanClass(element);\n    };\n    var has = function (element, clazz) {\n      return supports(element) && element.dom.classList.contains(clazz);\n    };\n\n    var descendants$1 = function (scope, predicate) {\n      var result = [];\n      each$k(children(scope), function (x) {\n        if (predicate(x)) {\n          result = result.concat([x]);\n        }\n        result = result.concat(descendants$1(x, predicate));\n      });\n      return result;\n    };\n\n    var descendants = function (scope, selector) {\n      return all(selector, scope);\n    };\n\n    var annotation = constant('mce-annotation');\n    var dataAnnotation = constant('data-mce-annotation');\n    var dataAnnotationId = constant('data-mce-annotation-uid');\n\n    var identify = function (editor, annotationName) {\n      var rng = editor.selection.getRng();\n      var start = SugarElement.fromDom(rng.startContainer);\n      var root = SugarElement.fromDom(editor.getBody());\n      var selector = annotationName.fold(function () {\n        return '.' + annotation();\n      }, function (an) {\n        return '[' + dataAnnotation() + '=\"' + an + '\"]';\n      });\n      var newStart = child$1(start, rng.startOffset).getOr(start);\n      var closest = closest$2(newStart, selector, function (n) {\n        return eq(n, root);\n      });\n      var getAttr = function (c, property) {\n        if (has$1(c, property)) {\n          return Optional.some(get$6(c, property));\n        } else {\n          return Optional.none();\n        }\n      };\n      return closest.bind(function (c) {\n        return getAttr(c, '' + dataAnnotationId()).bind(function (uid) {\n          return getAttr(c, '' + dataAnnotation()).map(function (name) {\n            var elements = findMarkers(editor, uid);\n            return {\n              uid: uid,\n              name: name,\n              elements: elements\n            };\n          });\n        });\n      });\n    };\n    var isAnnotation = function (elem) {\n      return isElement$6(elem) && has(elem, annotation());\n    };\n    var findMarkers = function (editor, uid) {\n      var body = SugarElement.fromDom(editor.getBody());\n      return descendants(body, '[' + dataAnnotationId() + '=\"' + uid + '\"]');\n    };\n    var findAll = function (editor, name) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var markers = descendants(body, '[' + dataAnnotation() + '=\"' + name + '\"]');\n      var directory = {};\n      each$k(markers, function (m) {\n        var uid = get$6(m, dataAnnotationId());\n        var nodesAlready = get$9(directory, uid).getOr([]);\n        directory[uid] = nodesAlready.concat([m]);\n      });\n      return directory;\n    };\n\n    var setup$n = function (editor, _registry) {\n      var changeCallbacks = Cell({});\n      var initData = function () {\n        return {\n          listeners: [],\n          previous: value()\n        };\n      };\n      var withCallbacks = function (name, f) {\n        updateCallbacks(name, function (data) {\n          f(data);\n          return data;\n        });\n      };\n      var updateCallbacks = function (name, f) {\n        var callbackMap = changeCallbacks.get();\n        var data = get$9(callbackMap, name).getOrThunk(initData);\n        var outputData = f(data);\n        callbackMap[name] = outputData;\n        changeCallbacks.set(callbackMap);\n      };\n      var fireCallbacks = function (name, uid, elements) {\n        withCallbacks(name, function (data) {\n          each$k(data.listeners, function (f) {\n            return f(true, name, {\n              uid: uid,\n              nodes: map$3(elements, function (elem) {\n                return elem.dom;\n              })\n            });\n          });\n        });\n      };\n      var fireNoAnnotation = function (name) {\n        withCallbacks(name, function (data) {\n          each$k(data.listeners, function (f) {\n            return f(false, name);\n          });\n        });\n      };\n      var onNodeChange = last(function () {\n        var callbackMap = changeCallbacks.get();\n        var annotations = sort(keys(callbackMap));\n        each$k(annotations, function (name) {\n          updateCallbacks(name, function (data) {\n            var prev = data.previous.get();\n            identify(editor, Optional.some(name)).fold(function () {\n              if (prev.isSome()) {\n                fireNoAnnotation(name);\n                data.previous.clear();\n              }\n            }, function (_a) {\n              var uid = _a.uid, name = _a.name, elements = _a.elements;\n              if (!is$1(prev, uid)) {\n                fireCallbacks(name, uid, elements);\n                data.previous.set(uid);\n              }\n            });\n            return {\n              previous: data.previous,\n              listeners: data.listeners\n            };\n          });\n        });\n      }, 30);\n      editor.on('remove', function () {\n        onNodeChange.cancel();\n      });\n      editor.on('NodeChange', function () {\n        onNodeChange.throttle();\n      });\n      var addListener = function (name, f) {\n        updateCallbacks(name, function (data) {\n          return {\n            previous: data.previous,\n            listeners: data.listeners.concat([f])\n          };\n        });\n      };\n      return { addListener: addListener };\n    };\n\n    var setup$m = function (editor, registry) {\n      var identifyParserNode = function (span) {\n        return Optional.from(span.attr(dataAnnotation())).bind(registry.lookup);\n      };\n      editor.on('init', function () {\n        editor.serializer.addNodeFilter('span', function (spans) {\n          each$k(spans, function (span) {\n            identifyParserNode(span).each(function (settings) {\n              if (settings.persistent === false) {\n                span.unwrap();\n              }\n            });\n          });\n        });\n      });\n    };\n\n    var create$7 = function () {\n      var annotations = {};\n      var register = function (name, settings) {\n        annotations[name] = {\n          name: name,\n          settings: settings\n        };\n      };\n      var lookup = function (name) {\n        return get$9(annotations, name).map(function (a) {\n          return a.settings;\n        });\n      };\n      return {\n        register: register,\n        lookup: lookup\n      };\n    };\n\n    var unique = 0;\n    var generate = function (prefix) {\n      var date = new Date();\n      var time = date.getTime();\n      var random = Math.floor(Math.random() * 1000000000);\n      unique++;\n      return prefix + '_' + random + unique + String(time);\n    };\n\n    var add = function (element, classes) {\n      each$k(classes, function (x) {\n        add$1(element, x);\n      });\n    };\n\n    var fromHtml = function (html, scope) {\n      var doc = scope || document;\n      var div = doc.createElement('div');\n      div.innerHTML = html;\n      return children(SugarElement.fromDom(div));\n    };\n    var fromDom$1 = function (nodes) {\n      return map$3(nodes, SugarElement.fromDom);\n    };\n\n    var get$3 = function (element) {\n      return element.dom.innerHTML;\n    };\n    var set = function (element, content) {\n      var owner = owner$1(element);\n      var docDom = owner.dom;\n      var fragment = SugarElement.fromDom(docDom.createDocumentFragment());\n      var contentElements = fromHtml(content, docDom);\n      append(fragment, contentElements);\n      empty(element);\n      append$1(element, fragment);\n    };\n\n    var clone$1 = function (original, isDeep) {\n      return SugarElement.fromDom(original.dom.cloneNode(isDeep));\n    };\n    var shallow = function (original) {\n      return clone$1(original, false);\n    };\n    var deep$1 = function (original) {\n      return clone$1(original, true);\n    };\n\n    var TextWalker = function (startNode, rootNode, isBoundary) {\n      if (isBoundary === void 0) {\n        isBoundary = never;\n      }\n      var walker = new DomTreeWalker(startNode, rootNode);\n      var walk = function (direction) {\n        var next;\n        do {\n          next = walker[direction]();\n        } while (next && !isText$7(next) && !isBoundary(next));\n        return Optional.from(next).filter(isText$7);\n      };\n      return {\n        current: function () {\n          return Optional.from(walker.current()).filter(isText$7);\n        },\n        next: function () {\n          return walk('next');\n        },\n        prev: function () {\n          return walk('prev');\n        },\n        prev2: function () {\n          return walk('prev2');\n        }\n      };\n    };\n\n    var TextSeeker = function (dom, isBoundary) {\n      var isBlockBoundary = isBoundary ? isBoundary : function (node) {\n        return dom.isBlock(node) || isBr$5(node) || isContentEditableFalse$b(node);\n      };\n      var walk = function (node, offset, walker, process) {\n        if (isText$7(node)) {\n          var newOffset = process(node, offset, node.data);\n          if (newOffset !== -1) {\n            return Optional.some({\n              container: node,\n              offset: newOffset\n            });\n          }\n        }\n        return walker().bind(function (next) {\n          return walk(next.container, next.offset, walker, process);\n        });\n      };\n      var backwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.prev().map(function (prev) {\n            return {\n              container: prev,\n              offset: prev.length\n            };\n          });\n        }, process).getOrNull();\n      };\n      var forwards = function (node, offset, process, root) {\n        var walker = TextWalker(node, root, isBlockBoundary);\n        return walk(node, offset, function () {\n          return walker.next().map(function (next) {\n            return {\n              container: next,\n              offset: 0\n            };\n          });\n        }, process).getOrNull();\n      };\n      return {\n        backwards: backwards,\n        forwards: forwards\n      };\n    };\n\n    var round$2 = Math.round;\n    var clone = function (rect) {\n      if (!rect) {\n        return {\n          left: 0,\n          top: 0,\n          bottom: 0,\n          right: 0,\n          width: 0,\n          height: 0\n        };\n      }\n      return {\n        left: round$2(rect.left),\n        top: round$2(rect.top),\n        bottom: round$2(rect.bottom),\n        right: round$2(rect.right),\n        width: round$2(rect.width),\n        height: round$2(rect.height)\n      };\n    };\n    var collapse = function (rect, toStart) {\n      rect = clone(rect);\n      if (toStart) {\n        rect.right = rect.left;\n      } else {\n        rect.left = rect.left + rect.width;\n        rect.right = rect.left;\n      }\n      rect.width = 0;\n      return rect;\n    };\n    var isEqual = function (rect1, rect2) {\n      return rect1.left === rect2.left && rect1.top === rect2.top && rect1.bottom === rect2.bottom && rect1.right === rect2.right;\n    };\n    var isValidOverflow = function (overflowY, rect1, rect2) {\n      return overflowY >= 0 && overflowY <= Math.min(rect1.height, rect2.height) / 2;\n    };\n    var isAbove$1 = function (rect1, rect2) {\n      var halfHeight = Math.min(rect2.height / 2, rect1.height / 2);\n      if (rect1.bottom - halfHeight < rect2.top) {\n        return true;\n      }\n      if (rect1.top > rect2.bottom) {\n        return false;\n      }\n      return isValidOverflow(rect2.top - rect1.bottom, rect1, rect2);\n    };\n    var isBelow$1 = function (rect1, rect2) {\n      if (rect1.top > rect2.bottom) {\n        return true;\n      }\n      if (rect1.bottom < rect2.top) {\n        return false;\n      }\n      return isValidOverflow(rect2.bottom - rect1.top, rect1, rect2);\n    };\n    var containsXY = function (rect, clientX, clientY) {\n      return clientX >= rect.left && clientX <= rect.right && clientY >= rect.top && clientY <= rect.bottom;\n    };\n\n    var clamp$2 = function (value, min, max) {\n      return Math.min(Math.max(value, min), max);\n    };\n\n    var getSelectedNode = function (range) {\n      var startContainer = range.startContainer, startOffset = range.startOffset;\n      if (startContainer.hasChildNodes() && range.endOffset === startOffset + 1) {\n        return startContainer.childNodes[startOffset];\n      }\n      return null;\n    };\n    var getNode$1 = function (container, offset) {\n      if (isElement$5(container) && container.hasChildNodes()) {\n        var childNodes = container.childNodes;\n        var safeOffset = clamp$2(offset, 0, childNodes.length - 1);\n        return childNodes[safeOffset];\n      } else {\n        return container;\n      }\n    };\n    var getNodeUnsafe = function (container, offset) {\n      if (offset < 0 && isElement$5(container) && container.hasChildNodes()) {\n        return undefined;\n      } else {\n        return getNode$1(container, offset);\n      }\n    };\n\n    var extendingChars = new RegExp('[\\u0300-\\u036f\\u0483-\\u0487\\u0488-\\u0489\\u0591-\\u05bd\\u05bf\\u05c1-\\u05c2\\u05c4-\\u05c5\\u05c7\\u0610-\\u061a' + '\\u064b-\\u065f\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7-\\u06e8\\u06ea-\\u06ed\\u0711\\u0730-\\u074a\\u07a6-\\u07b0' + '\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e3-\\u0902\\u093a\\u093c' + '\\u0941-\\u0948\\u094d\\u0951-\\u0957\\u0962-\\u0963\\u0981\\u09bc\\u09be\\u09c1-\\u09c4\\u09cd\\u09d7\\u09e2-\\u09e3' + '\\u0a01-\\u0a02\\u0a3c\\u0a41-\\u0a42\\u0a47-\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a70-\\u0a71\\u0a75\\u0a81-\\u0a82\\u0abc' + '\\u0ac1-\\u0ac5\\u0ac7-\\u0ac8\\u0acd\\u0ae2-\\u0ae3\\u0b01\\u0b3c\\u0b3e\\u0b3f\\u0b41-\\u0b44\\u0b4d\\u0b56\\u0b57' + '\\u0b62-\\u0b63\\u0b82\\u0bbe\\u0bc0\\u0bcd\\u0bd7\\u0c00\\u0c3e-\\u0c40\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55-\\u0c56' + '\\u0c62-\\u0c63\\u0c81\\u0cbc\\u0cbf\\u0cc2\\u0cc6\\u0ccc-\\u0ccd\\u0cd5-\\u0cd6\\u0ce2-\\u0ce3\\u0d01\\u0d3e\\u0d41-\\u0d44' + '\\u0d4d\\u0d57\\u0d62-\\u0d63\\u0dca\\u0dcf\\u0dd2-\\u0dd4\\u0dd6\\u0ddf\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0eb1\\u0eb4-\\u0eb9' + '\\u0ebb-\\u0ebc\\u0ec8-\\u0ecd\\u0f18-\\u0f19\\u0f35\\u0f37\\u0f39\\u0f71-\\u0f7e\\u0f80-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97' + '\\u0f99-\\u0fbc\\u0fc6\\u102d-\\u1030\\u1032-\\u1037\\u1039-\\u103a\\u103d-\\u103e\\u1058-\\u1059\\u105e-\\u1060\\u1071-\\u1074' + '\\u1082\\u1085-\\u1086\\u108d\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752-\\u1753\\u1772-\\u1773\\u17b4-\\u17b5' + '\\u17b7-\\u17bd\\u17c6\\u17c9-\\u17d3\\u17dd\\u180b-\\u180d\\u18a9\\u1920-\\u1922\\u1927-\\u1928\\u1932\\u1939-\\u193b\\u1a17-\\u1a18' + '\\u1a1b\\u1a56\\u1a58-\\u1a5e\\u1a60\\u1a62\\u1a65-\\u1a6c\\u1a73-\\u1a7c\\u1a7f\\u1ab0-\\u1abd\\u1ABE\\u1b00-\\u1b03\\u1b34' + '\\u1b36-\\u1b3a\\u1b3c\\u1b42\\u1b6b-\\u1b73\\u1b80-\\u1b81\\u1ba2-\\u1ba5\\u1ba8-\\u1ba9\\u1bab-\\u1bad\\u1be6\\u1be8-\\u1be9' + '\\u1bed\\u1bef-\\u1bf1\\u1c2c-\\u1c33\\u1c36-\\u1c37\\u1cd0-\\u1cd2\\u1cd4-\\u1ce0\\u1ce2-\\u1ce8\\u1ced\\u1cf4\\u1cf8-\\u1cf9' + '\\u1dc0-\\u1df5\\u1dfc-\\u1dff\\u200c-\\u200d\\u20d0-\\u20dc\\u20DD-\\u20E0\\u20e1\\u20E2-\\u20E4\\u20e5-\\u20f0\\u2cef-\\u2cf1' + '\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302d\\u302e-\\u302f\\u3099-\\u309a\\ua66f\\uA670-\\uA672\\ua674-\\ua67d\\ua69e-\\ua69f\\ua6f0-\\ua6f1' + '\\ua802\\ua806\\ua80b\\ua825-\\ua826\\ua8c4\\ua8e0-\\ua8f1\\ua926-\\ua92d\\ua947-\\ua951\\ua980-\\ua982\\ua9b3\\ua9b6-\\ua9b9\\ua9bc' + '\\ua9e5\\uaa29-\\uaa2e\\uaa31-\\uaa32\\uaa35-\\uaa36\\uaa43\\uaa4c\\uaa7c\\uaab0\\uaab2-\\uaab4\\uaab7-\\uaab8\\uaabe-\\uaabf\\uaac1' + '\\uaaec-\\uaaed\\uaaf6\\uabe5\\uabe8\\uabed\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe2f\\uff9e-\\uff9f]');\n    var isExtendingChar = function (ch) {\n      return typeof ch === 'string' && ch.charCodeAt(0) >= 768 && extendingChars.test(ch);\n    };\n\n    var or = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (args[i](x)) {\n            return true;\n          }\n        }\n        return false;\n      };\n    };\n    var and = function () {\n      var args = [];\n      for (var _i = 0; _i < arguments.length; _i++) {\n        args[_i] = arguments[_i];\n      }\n      return function (x) {\n        for (var i = 0; i < args.length; i++) {\n          if (!args[i](x)) {\n            return false;\n          }\n        }\n        return true;\n      };\n    };\n\n    var isElement$3 = isElement$5;\n    var isCaretCandidate$2 = isCaretCandidate$3;\n    var isBlock$1 = matchStyleValues('display', 'block table');\n    var isFloated = matchStyleValues('float', 'left right');\n    var isValidElementCaretCandidate = and(isElement$3, isCaretCandidate$2, not(isFloated));\n    var isNotPre = not(matchStyleValues('white-space', 'pre pre-line pre-wrap'));\n    var isText$4 = isText$7;\n    var isBr$2 = isBr$5;\n    var nodeIndex$1 = DOMUtils.nodeIndex;\n    var resolveIndex$1 = getNodeUnsafe;\n    var createRange$1 = function (doc) {\n      return 'createRange' in doc ? doc.createRange() : DOMUtils.DOM.createRng();\n    };\n    var isWhiteSpace$1 = function (chr) {\n      return chr && /[\\r\\n\\t ]/.test(chr);\n    };\n    var isRange = function (rng) {\n      return !!rng.setStart && !!rng.setEnd;\n    };\n    var isHiddenWhiteSpaceRange = function (range) {\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      if (isWhiteSpace$1(range.toString()) && isNotPre(container.parentNode) && isText$7(container)) {\n        var text = container.data;\n        if (isWhiteSpace$1(text[offset - 1]) || isWhiteSpace$1(text[offset + 1])) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var getBrClientRect = function (brNode) {\n      var doc = brNode.ownerDocument;\n      var rng = createRange$1(doc);\n      var nbsp$1 = doc.createTextNode(nbsp);\n      var parentNode = brNode.parentNode;\n      parentNode.insertBefore(nbsp$1, brNode);\n      rng.setStart(nbsp$1, 0);\n      rng.setEnd(nbsp$1, 1);\n      var clientRect = clone(rng.getBoundingClientRect());\n      parentNode.removeChild(nbsp$1);\n      return clientRect;\n    };\n    var getBoundingClientRectWebKitText = function (rng) {\n      var sc = rng.startContainer;\n      var ec = rng.endContainer;\n      var so = rng.startOffset;\n      var eo = rng.endOffset;\n      if (sc === ec && isText$7(ec) && so === 0 && eo === 1) {\n        var newRng = rng.cloneRange();\n        newRng.setEndAfter(ec);\n        return getBoundingClientRect$1(newRng);\n      } else {\n        return null;\n      }\n    };\n    var isZeroRect = function (r) {\n      return r.left === 0 && r.right === 0 && r.top === 0 && r.bottom === 0;\n    };\n    var getBoundingClientRect$1 = function (item) {\n      var clientRect;\n      var clientRects = item.getClientRects();\n      if (clientRects.length > 0) {\n        clientRect = clone(clientRects[0]);\n      } else {\n        clientRect = clone(item.getBoundingClientRect());\n      }\n      if (!isRange(item) && isBr$2(item) && isZeroRect(clientRect)) {\n        return getBrClientRect(item);\n      }\n      if (isZeroRect(clientRect) && isRange(item)) {\n        return getBoundingClientRectWebKitText(item);\n      }\n      return clientRect;\n    };\n    var collapseAndInflateWidth = function (clientRect, toStart) {\n      var newClientRect = collapse(clientRect, toStart);\n      newClientRect.width = 1;\n      newClientRect.right = newClientRect.left + 1;\n      return newClientRect;\n    };\n    var getCaretPositionClientRects = function (caretPosition) {\n      var clientRects = [];\n      var addUniqueAndValidRect = function (clientRect) {\n        if (clientRect.height === 0) {\n          return;\n        }\n        if (clientRects.length > 0) {\n          if (isEqual(clientRect, clientRects[clientRects.length - 1])) {\n            return;\n          }\n        }\n        clientRects.push(clientRect);\n      };\n      var addCharacterOffset = function (container, offset) {\n        var range = createRange$1(container.ownerDocument);\n        if (offset < container.data.length) {\n          if (isExtendingChar(container.data[offset])) {\n            return clientRects;\n          }\n          if (isExtendingChar(container.data[offset - 1])) {\n            range.setStart(container, offset);\n            range.setEnd(container, offset + 1);\n            if (!isHiddenWhiteSpaceRange(range)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), false));\n              return clientRects;\n            }\n          }\n        }\n        if (offset > 0) {\n          range.setStart(container, offset - 1);\n          range.setEnd(container, offset);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), false));\n          }\n        }\n        if (offset < container.data.length) {\n          range.setStart(container, offset);\n          range.setEnd(container, offset + 1);\n          if (!isHiddenWhiteSpaceRange(range)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(range), true));\n          }\n        }\n      };\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$4(container)) {\n        addCharacterOffset(container, offset);\n        return clientRects;\n      }\n      if (isElement$3(container)) {\n        if (caretPosition.isAtEnd()) {\n          var node = resolveIndex$1(container, offset);\n          if (isText$4(node)) {\n            addCharacterOffset(node, node.data.length);\n          }\n          if (isValidElementCaretCandidate(node) && !isBr$2(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), false));\n          }\n        } else {\n          var node = resolveIndex$1(container, offset);\n          if (isText$4(node)) {\n            addCharacterOffset(node, 0);\n          }\n          if (isValidElementCaretCandidate(node) && caretPosition.isAtEnd()) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), false));\n            return clientRects;\n          }\n          var beforeNode = resolveIndex$1(caretPosition.container(), caretPosition.offset() - 1);\n          if (isValidElementCaretCandidate(beforeNode) && !isBr$2(beforeNode)) {\n            if (isBlock$1(beforeNode) || isBlock$1(node) || !isValidElementCaretCandidate(node)) {\n              addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(beforeNode), false));\n            }\n          }\n          if (isValidElementCaretCandidate(node)) {\n            addUniqueAndValidRect(collapseAndInflateWidth(getBoundingClientRect$1(node), true));\n          }\n        }\n      }\n      return clientRects;\n    };\n    var CaretPosition = function (container, offset, clientRects) {\n      var isAtStart = function () {\n        if (isText$4(container)) {\n          return offset === 0;\n        }\n        return offset === 0;\n      };\n      var isAtEnd = function () {\n        if (isText$4(container)) {\n          return offset >= container.data.length;\n        }\n        return offset >= container.childNodes.length;\n      };\n      var toRange = function () {\n        var range = createRange$1(container.ownerDocument);\n        range.setStart(container, offset);\n        range.setEnd(container, offset);\n        return range;\n      };\n      var getClientRects = function () {\n        if (!clientRects) {\n          clientRects = getCaretPositionClientRects(CaretPosition(container, offset));\n        }\n        return clientRects;\n      };\n      var isVisible = function () {\n        return getClientRects().length > 0;\n      };\n      var isEqual = function (caretPosition) {\n        return caretPosition && container === caretPosition.container() && offset === caretPosition.offset();\n      };\n      var getNode = function (before) {\n        return resolveIndex$1(container, before ? offset - 1 : offset);\n      };\n      return {\n        container: constant(container),\n        offset: constant(offset),\n        toRange: toRange,\n        getClientRects: getClientRects,\n        isVisible: isVisible,\n        isAtStart: isAtStart,\n        isAtEnd: isAtEnd,\n        isEqual: isEqual,\n        getNode: getNode\n      };\n    };\n    CaretPosition.fromRangeStart = function (range) {\n      return CaretPosition(range.startContainer, range.startOffset);\n    };\n    CaretPosition.fromRangeEnd = function (range) {\n      return CaretPosition(range.endContainer, range.endOffset);\n    };\n    CaretPosition.after = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex$1(node) + 1);\n    };\n    CaretPosition.before = function (node) {\n      return CaretPosition(node.parentNode, nodeIndex$1(node));\n    };\n    CaretPosition.isAbove = function (pos1, pos2) {\n      return lift2(head(pos2.getClientRects()), last$2(pos1.getClientRects()), isAbove$1).getOr(false);\n    };\n    CaretPosition.isBelow = function (pos1, pos2) {\n      return lift2(last$2(pos2.getClientRects()), head(pos1.getClientRects()), isBelow$1).getOr(false);\n    };\n    CaretPosition.isAtStart = function (pos) {\n      return pos ? pos.isAtStart() : false;\n    };\n    CaretPosition.isAtEnd = function (pos) {\n      return pos ? pos.isAtEnd() : false;\n    };\n    CaretPosition.isTextPosition = function (pos) {\n      return pos ? isText$7(pos.container()) : false;\n    };\n    CaretPosition.isElementPosition = function (pos) {\n      return CaretPosition.isTextPosition(pos) === false;\n    };\n\n    var trimEmptyTextNode$1 = function (dom, node) {\n      if (isText$7(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var insertNode = function (dom, rng, node) {\n      rng.insertNode(node);\n      trimEmptyTextNode$1(dom, node.previousSibling);\n      trimEmptyTextNode$1(dom, node.nextSibling);\n    };\n    var insertFragment = function (dom, rng, frag) {\n      var firstChild = Optional.from(frag.firstChild);\n      var lastChild = Optional.from(frag.lastChild);\n      rng.insertNode(frag);\n      firstChild.each(function (child) {\n        return trimEmptyTextNode$1(dom, child.previousSibling);\n      });\n      lastChild.each(function (child) {\n        return trimEmptyTextNode$1(dom, child.nextSibling);\n      });\n    };\n    var rangeInsertNode = function (dom, rng, node) {\n      if (isDocumentFragment(node)) {\n        insertFragment(dom, rng, node);\n      } else {\n        insertNode(dom, rng, node);\n      }\n    };\n\n    var isText$3 = isText$7;\n    var isBogus = isBogus$2;\n    var nodeIndex = DOMUtils.nodeIndex;\n    var normalizedParent = function (node) {\n      var parentNode = node.parentNode;\n      if (isBogus(parentNode)) {\n        return normalizedParent(parentNode);\n      }\n      return parentNode;\n    };\n    var getChildNodes = function (node) {\n      if (!node) {\n        return [];\n      }\n      return reduce(node.childNodes, function (result, node) {\n        if (isBogus(node) && node.nodeName !== 'BR') {\n          result = result.concat(getChildNodes(node));\n        } else {\n          result.push(node);\n        }\n        return result;\n      }, []);\n    };\n    var normalizedTextOffset = function (node, offset) {\n      while (node = node.previousSibling) {\n        if (!isText$3(node)) {\n          break;\n        }\n        offset += node.data.length;\n      }\n      return offset;\n    };\n    var equal = function (a) {\n      return function (b) {\n        return a === b;\n      };\n    };\n    var normalizedNodeIndex = function (node) {\n      var nodes, index;\n      nodes = getChildNodes(normalizedParent(node));\n      index = findIndex$1(nodes, equal(node), node);\n      nodes = nodes.slice(0, index + 1);\n      var numTextFragments = reduce(nodes, function (result, node, i) {\n        if (isText$3(node) && isText$3(nodes[i - 1])) {\n          result++;\n        }\n        return result;\n      }, 0);\n      nodes = filter$2(nodes, matchNodeNames([node.nodeName]));\n      index = findIndex$1(nodes, equal(node), node);\n      return index - numTextFragments;\n    };\n    var createPathItem = function (node) {\n      var name;\n      if (isText$3(node)) {\n        name = 'text()';\n      } else {\n        name = node.nodeName.toLowerCase();\n      }\n      return name + '[' + normalizedNodeIndex(node) + ']';\n    };\n    var parentsUntil$1 = function (root, node, predicate) {\n      var parents = [];\n      for (node = node.parentNode; node !== root; node = node.parentNode) {\n        if (predicate && predicate(node)) {\n          break;\n        }\n        parents.push(node);\n      }\n      return parents;\n    };\n    var create$6 = function (root, caretPosition) {\n      var container, offset, path = [], outputOffset, childNodes, parents;\n      container = caretPosition.container();\n      offset = caretPosition.offset();\n      if (isText$3(container)) {\n        outputOffset = normalizedTextOffset(container, offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length) {\n          outputOffset = 'after';\n          offset = childNodes.length - 1;\n        } else {\n          outputOffset = 'before';\n        }\n        container = childNodes[offset];\n      }\n      path.push(createPathItem(container));\n      parents = parentsUntil$1(root, container);\n      parents = filter$2(parents, not(isBogus$2));\n      path = path.concat(map$1(parents, function (node) {\n        return createPathItem(node);\n      }));\n      return path.reverse().join('/') + ',' + outputOffset;\n    };\n    var resolvePathItem = function (node, name, index) {\n      var nodes = getChildNodes(node);\n      nodes = filter$2(nodes, function (node, index) {\n        return !isText$3(node) || !isText$3(nodes[index - 1]);\n      });\n      nodes = filter$2(nodes, matchNodeNames([name]));\n      return nodes[index];\n    };\n    var findTextPosition = function (container, offset) {\n      var node = container, targetOffset = 0, dataLen;\n      while (isText$3(node)) {\n        dataLen = node.data.length;\n        if (offset >= targetOffset && offset <= targetOffset + dataLen) {\n          container = node;\n          offset = offset - targetOffset;\n          break;\n        }\n        if (!isText$3(node.nextSibling)) {\n          container = node;\n          offset = dataLen;\n          break;\n        }\n        targetOffset += dataLen;\n        node = node.nextSibling;\n      }\n      if (isText$3(container) && offset > container.data.length) {\n        offset = container.data.length;\n      }\n      return CaretPosition(container, offset);\n    };\n    var resolve$2 = function (root, path) {\n      var offset;\n      if (!path) {\n        return null;\n      }\n      var parts = path.split(',');\n      var paths = parts[0].split('/');\n      offset = parts.length > 1 ? parts[1] : 'before';\n      var container = reduce(paths, function (result, value) {\n        var match = /([\\w\\-\\(\\)]+)\\[([0-9]+)\\]/.exec(value);\n        if (!match) {\n          return null;\n        }\n        if (match[1] === 'text()') {\n          match[1] = '#text';\n        }\n        return resolvePathItem(result, match[1], parseInt(match[2], 10));\n      }, root);\n      if (!container) {\n        return null;\n      }\n      if (!isText$3(container)) {\n        if (offset === 'after') {\n          offset = nodeIndex(container) + 1;\n        } else {\n          offset = nodeIndex(container);\n        }\n        return CaretPosition(container.parentNode, offset);\n      }\n      return findTextPosition(container, parseInt(offset, 10));\n    };\n\n    var isContentEditableFalse$9 = isContentEditableFalse$b;\n    var getNormalizedTextOffset = function (trim, container, offset) {\n      var node, trimmedOffset;\n      trimmedOffset = trim(container.data.slice(0, offset)).length;\n      for (node = container.previousSibling; node && isText$7(node); node = node.previousSibling) {\n        trimmedOffset += trim(node.data).length;\n      }\n      return trimmedOffset;\n    };\n    var getPoint = function (dom, trim, normalized, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      var point = [];\n      var childNodes, after = 0;\n      var root = dom.getRoot();\n      if (isText$7(container)) {\n        point.push(normalized ? getNormalizedTextOffset(trim, container, offset) : offset);\n      } else {\n        childNodes = container.childNodes;\n        if (offset >= childNodes.length && childNodes.length) {\n          after = 1;\n          offset = Math.max(0, childNodes.length - 1);\n        }\n        point.push(dom.nodeIndex(childNodes[offset], normalized) + after);\n      }\n      for (; container && container !== root; container = container.parentNode) {\n        point.push(dom.nodeIndex(container, normalized));\n      }\n      return point;\n    };\n    var getLocation = function (trim, selection, normalized, rng) {\n      var dom = selection.dom, bookmark = {};\n      bookmark.start = getPoint(dom, trim, normalized, rng, true);\n      if (!selection.isCollapsed()) {\n        bookmark.end = getPoint(dom, trim, normalized, rng, false);\n      }\n      if (isRangeInCaretContainerBlock(rng)) {\n        bookmark.isFakeCaret = true;\n      }\n      return bookmark;\n    };\n    var findIndex = function (dom, name, element) {\n      var count = 0;\n      Tools.each(dom.select(name), function (node) {\n        if (node.getAttribute('data-mce-bogus') === 'all') {\n          return;\n        }\n        if (node === element) {\n          return false;\n        }\n        count++;\n      });\n      return count;\n    };\n    var moveEndPoint$1 = function (rng, start) {\n      var container, offset, childNodes;\n      var prefix = start ? 'start' : 'end';\n      container = rng[prefix + 'Container'];\n      offset = rng[prefix + 'Offset'];\n      if (isElement$5(container) && container.nodeName === 'TR') {\n        childNodes = container.childNodes;\n        container = childNodes[Math.min(start ? offset : offset - 1, childNodes.length - 1)];\n        if (container) {\n          offset = start ? 0 : container.childNodes.length;\n          rng['set' + (start ? 'Start' : 'End')](container, offset);\n        }\n      }\n    };\n    var normalizeTableCellSelection = function (rng) {\n      moveEndPoint$1(rng, true);\n      moveEndPoint$1(rng, false);\n      return rng;\n    };\n    var findSibling = function (node, offset) {\n      var sibling;\n      if (isElement$5(node)) {\n        node = getNode$1(node, offset);\n        if (isContentEditableFalse$9(node)) {\n          return node;\n        }\n      }\n      if (isCaretContainer$2(node)) {\n        if (isText$7(node) && isCaretContainerBlock$1(node)) {\n          node = node.parentNode;\n        }\n        sibling = node.previousSibling;\n        if (isContentEditableFalse$9(sibling)) {\n          return sibling;\n        }\n        sibling = node.nextSibling;\n        if (isContentEditableFalse$9(sibling)) {\n          return sibling;\n        }\n      }\n    };\n    var findAdjacentContentEditableFalseElm = function (rng) {\n      return findSibling(rng.startContainer, rng.startOffset) || findSibling(rng.endContainer, rng.endOffset);\n    };\n    var getOffsetBookmark = function (trim, normalized, selection) {\n      var element = selection.getNode();\n      var name = element ? element.nodeName : null;\n      var rng = selection.getRng();\n      if (isContentEditableFalse$9(element) || name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex(selection.dom, name, element)\n        };\n      }\n      var sibling = findAdjacentContentEditableFalseElm(rng);\n      if (sibling) {\n        name = sibling.tagName;\n        return {\n          name: name,\n          index: findIndex(selection.dom, name, sibling)\n        };\n      }\n      return getLocation(trim, selection, normalized, rng);\n    };\n    var getCaretBookmark = function (selection) {\n      var rng = selection.getRng();\n      return {\n        start: create$6(selection.dom.getRoot(), CaretPosition.fromRangeStart(rng)),\n        end: create$6(selection.dom.getRoot(), CaretPosition.fromRangeEnd(rng))\n      };\n    };\n    var getRangeBookmark = function (selection) {\n      return { rng: selection.getRng() };\n    };\n    var createBookmarkSpan = function (dom, id, filled) {\n      var args = {\n        'data-mce-type': 'bookmark',\n        id: id,\n        'style': 'overflow:hidden;line-height:0px'\n      };\n      return filled ? dom.create('span', args, '&#xFEFF;') : dom.create('span', args);\n    };\n    var getPersistentBookmark = function (selection, filled) {\n      var dom = selection.dom;\n      var rng = selection.getRng();\n      var id = dom.uniqueId();\n      var collapsed = selection.isCollapsed();\n      var element = selection.getNode();\n      var name = element.nodeName;\n      if (name === 'IMG') {\n        return {\n          name: name,\n          index: findIndex(dom, name, element)\n        };\n      }\n      var rng2 = normalizeTableCellSelection(rng.cloneRange());\n      if (!collapsed) {\n        rng2.collapse(false);\n        var endBookmarkNode = createBookmarkSpan(dom, id + '_end', filled);\n        rangeInsertNode(dom, rng2, endBookmarkNode);\n      }\n      rng = normalizeTableCellSelection(rng);\n      rng.collapse(true);\n      var startBookmarkNode = createBookmarkSpan(dom, id + '_start', filled);\n      rangeInsertNode(dom, rng, startBookmarkNode);\n      selection.moveToBookmark({\n        id: id,\n        keep: true\n      });\n      return { id: id };\n    };\n    var getBookmark$2 = function (selection, type, normalized) {\n      if (type === 2) {\n        return getOffsetBookmark(trim$2, normalized, selection);\n      } else if (type === 3) {\n        return getCaretBookmark(selection);\n      } else if (type) {\n        return getRangeBookmark(selection);\n      } else {\n        return getPersistentBookmark(selection, false);\n      }\n    };\n    var getUndoBookmark = curry(getOffsetBookmark, identity, true);\n\n    var DOM$9 = DOMUtils.DOM;\n    var defaultPreviewStyles = 'font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow';\n    var getBodySetting = function (editor, name, defaultValue) {\n      var value = editor.getParam(name, defaultValue);\n      if (value.indexOf('=') !== -1) {\n        var bodyObj = editor.getParam(name, '', 'hash');\n        return get$9(bodyObj, editor.id).getOr(defaultValue);\n      } else {\n        return value;\n      }\n    };\n    var getIframeAttrs = function (editor) {\n      return editor.getParam('iframe_attrs', {});\n    };\n    var getDocType = function (editor) {\n      return editor.getParam('doctype', '<!DOCTYPE html>');\n    };\n    var getDocumentBaseUrl = function (editor) {\n      return editor.getParam('document_base_url', '');\n    };\n    var getBodyId = function (editor) {\n      return getBodySetting(editor, 'body_id', 'tinymce');\n    };\n    var getBodyClass = function (editor) {\n      return getBodySetting(editor, 'body_class', '');\n    };\n    var getContentSecurityPolicy = function (editor) {\n      return editor.getParam('content_security_policy', '');\n    };\n    var shouldPutBrInPre$1 = function (editor) {\n      return editor.getParam('br_in_pre', true);\n    };\n    var getForcedRootBlock = function (editor) {\n      if (editor.getParam('force_p_newlines', false)) {\n        return 'p';\n      }\n      var block = editor.getParam('forced_root_block', 'p');\n      if (block === false) {\n        return '';\n      } else if (block === true) {\n        return 'p';\n      } else {\n        return block;\n      }\n    };\n    var getForcedRootBlockAttrs = function (editor) {\n      return editor.getParam('forced_root_block_attrs', {});\n    };\n    var getBrNewLineSelector = function (editor) {\n      return editor.getParam('br_newline_selector', '.mce-toc h2,figcaption,caption');\n    };\n    var getNoNewLineSelector = function (editor) {\n      return editor.getParam('no_newline_selector', '');\n    };\n    var shouldKeepStyles = function (editor) {\n      return editor.getParam('keep_styles', true);\n    };\n    var shouldEndContainerOnEmptyBlock = function (editor) {\n      return editor.getParam('end_container_on_empty_block', false);\n    };\n    var getFontStyleValues = function (editor) {\n      return Tools.explode(editor.getParam('font_size_style_values', 'xx-small,x-small,small,medium,large,x-large,xx-large'));\n    };\n    var getFontSizeClasses = function (editor) {\n      return Tools.explode(editor.getParam('font_size_classes', ''));\n    };\n    var getImagesDataImgFilter = function (editor) {\n      return editor.getParam('images_dataimg_filter', always, 'function');\n    };\n    var isAutomaticUploadsEnabled = function (editor) {\n      return editor.getParam('automatic_uploads', true, 'boolean');\n    };\n    var shouldReuseFileName = function (editor) {\n      return editor.getParam('images_reuse_filename', false, 'boolean');\n    };\n    var shouldReplaceBlobUris = function (editor) {\n      return editor.getParam('images_replace_blob_uris', true, 'boolean');\n    };\n    var getIconPackName = function (editor) {\n      return editor.getParam('icons', '', 'string');\n    };\n    var getIconsUrl = function (editor) {\n      return editor.getParam('icons_url', '', 'string');\n    };\n    var getImageUploadUrl = function (editor) {\n      return editor.getParam('images_upload_url', '', 'string');\n    };\n    var getImageUploadBasePath = function (editor) {\n      return editor.getParam('images_upload_base_path', '', 'string');\n    };\n    var getImagesUploadCredentials = function (editor) {\n      return editor.getParam('images_upload_credentials', false, 'boolean');\n    };\n    var getImagesUploadHandler = function (editor) {\n      return editor.getParam('images_upload_handler', null, 'function');\n    };\n    var shouldUseContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors', false, 'boolean');\n    };\n    var getReferrerPolicy = function (editor) {\n      return editor.getParam('referrer_policy', '', 'string');\n    };\n    var getLanguageCode = function (editor) {\n      return editor.getParam('language', 'en', 'string');\n    };\n    var getLanguageUrl = function (editor) {\n      return editor.getParam('language_url', '', 'string');\n    };\n    var shouldIndentUseMargin = function (editor) {\n      return editor.getParam('indent_use_margin', false);\n    };\n    var getIndentation = function (editor) {\n      return editor.getParam('indentation', '40px', 'string');\n    };\n    var getContentCss = function (editor) {\n      var contentCss = editor.getParam('content_css');\n      if (isString$1(contentCss)) {\n        return map$3(contentCss.split(','), trim$4);\n      } else if (isArray$1(contentCss)) {\n        return contentCss;\n      } else if (contentCss === false || editor.inline) {\n        return [];\n      } else {\n        return ['default'];\n      }\n    };\n    var getFontCss = function (editor) {\n      var fontCss = editor.getParam('font_css', []);\n      return isArray$1(fontCss) ? fontCss : map$3(fontCss.split(','), trim$4);\n    };\n    var getDirectionality = function (editor) {\n      return editor.getParam('directionality', I18n.isRtl() ? 'rtl' : undefined);\n    };\n    var getInlineBoundarySelector = function (editor) {\n      return editor.getParam('inline_boundaries_selector', 'a[href],code,.mce-annotation', 'string');\n    };\n    var getObjectResizing = function (editor) {\n      var selector = editor.getParam('object_resizing');\n      if (selector === false || Env.iOS) {\n        return false;\n      } else {\n        return isString$1(selector) ? selector : 'table,img,figure.image,div,video,iframe';\n      }\n    };\n    var getResizeImgProportional = function (editor) {\n      return editor.getParam('resize_img_proportional', true, 'boolean');\n    };\n    var getPlaceholder = function (editor) {\n      return editor.getParam('placeholder', DOM$9.getAttrib(editor.getElement(), 'placeholder'), 'string');\n    };\n    var getEventRoot = function (editor) {\n      return editor.getParam('event_root');\n    };\n    var getServiceMessage = function (editor) {\n      return editor.getParam('service_message');\n    };\n    var getTheme = function (editor) {\n      return editor.getParam('theme');\n    };\n    var shouldValidate = function (editor) {\n      return editor.getParam('validate');\n    };\n    var isInlineBoundariesEnabled = function (editor) {\n      return editor.getParam('inline_boundaries') !== false;\n    };\n    var getFormats = function (editor) {\n      return editor.getParam('formats');\n    };\n    var getPreviewStyles = function (editor) {\n      var style = editor.getParam('preview_styles', defaultPreviewStyles);\n      if (isString$1(style)) {\n        return style;\n      } else {\n        return '';\n      }\n    };\n    var canFormatEmptyLines = function (editor) {\n      return editor.getParam('format_empty_lines', false, 'boolean');\n    };\n    var getCustomUiSelector = function (editor) {\n      return editor.getParam('custom_ui_selector', '', 'string');\n    };\n    var getThemeUrl = function (editor) {\n      return editor.getParam('theme_url');\n    };\n    var isInline = function (editor) {\n      return editor.getParam('inline');\n    };\n    var hasHiddenInput = function (editor) {\n      return editor.getParam('hidden_input');\n    };\n    var shouldPatchSubmit = function (editor) {\n      return editor.getParam('submit_patch');\n    };\n    var isEncodingXml = function (editor) {\n      return editor.getParam('encoding') === 'xml';\n    };\n    var shouldAddFormSubmitTrigger = function (editor) {\n      return editor.getParam('add_form_submit_trigger');\n    };\n    var shouldAddUnloadTrigger = function (editor) {\n      return editor.getParam('add_unload_trigger');\n    };\n    var hasForcedRootBlock = function (editor) {\n      return getForcedRootBlock(editor) !== '';\n    };\n    var getCustomUndoRedoLevels = function (editor) {\n      return editor.getParam('custom_undo_redo_levels', 0, 'number');\n    };\n    var shouldDisableNodeChange = function (editor) {\n      return editor.getParam('disable_nodechange');\n    };\n    var isReadOnly$1 = function (editor) {\n      return editor.getParam('readonly');\n    };\n    var hasContentCssCors = function (editor) {\n      return editor.getParam('content_css_cors');\n    };\n    var getPlugins = function (editor) {\n      return editor.getParam('plugins', '', 'string');\n    };\n    var getExternalPlugins$1 = function (editor) {\n      return editor.getParam('external_plugins');\n    };\n    var shouldBlockUnsupportedDrop = function (editor) {\n      return editor.getParam('block_unsupported_drop', true, 'boolean');\n    };\n    var isVisualAidsEnabled = function (editor) {\n      return editor.getParam('visual', true, 'boolean');\n    };\n    var getVisualAidsTableClass = function (editor) {\n      return editor.getParam('visual_table_class', 'mce-item-table', 'string');\n    };\n    var getVisualAidsAnchorClass = function (editor) {\n      return editor.getParam('visual_anchor_class', 'mce-item-anchor', 'string');\n    };\n    var getIframeAriaText = function (editor) {\n      return editor.getParam('iframe_aria_text', 'Rich Text Area. Press ALT-0 for help.', 'string');\n    };\n\n    var isElement$2 = isElement$5;\n    var isText$2 = isText$7;\n    var removeNode$1 = function (node) {\n      var parentNode = node.parentNode;\n      if (parentNode) {\n        parentNode.removeChild(node);\n      }\n    };\n    var trimCount = function (text) {\n      var trimmedText = trim$2(text);\n      return {\n        count: text.length - trimmedText.length,\n        text: trimmedText\n      };\n    };\n    var deleteZwspChars = function (caretContainer) {\n      var idx;\n      while ((idx = caretContainer.data.lastIndexOf(ZWSP$1)) !== -1) {\n        caretContainer.deleteData(idx, 1);\n      }\n    };\n    var removeUnchanged = function (caretContainer, pos) {\n      remove$2(caretContainer);\n      return pos;\n    };\n    var removeTextAndReposition = function (caretContainer, pos) {\n      var before = trimCount(caretContainer.data.substr(0, pos.offset()));\n      var after = trimCount(caretContainer.data.substr(pos.offset()));\n      var text = before.text + after.text;\n      if (text.length > 0) {\n        deleteZwspChars(caretContainer);\n        return CaretPosition(caretContainer, pos.offset() - before.count);\n      } else {\n        return pos;\n      }\n    };\n    var removeElementAndReposition = function (caretContainer, pos) {\n      var parentNode = pos.container();\n      var newPosition = indexOf$2(from(parentNode.childNodes), caretContainer).map(function (index) {\n        return index < pos.offset() ? CaretPosition(parentNode, pos.offset() - 1) : pos;\n      }).getOr(pos);\n      remove$2(caretContainer);\n      return newPosition;\n    };\n    var removeTextCaretContainer = function (caretContainer, pos) {\n      return isText$2(caretContainer) && pos.container() === caretContainer ? removeTextAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeElementCaretContainer = function (caretContainer, pos) {\n      return pos.container() === caretContainer.parentNode ? removeElementAndReposition(caretContainer, pos) : removeUnchanged(caretContainer, pos);\n    };\n    var removeAndReposition = function (container, pos) {\n      return CaretPosition.isTextPosition(pos) ? removeTextCaretContainer(container, pos) : removeElementCaretContainer(container, pos);\n    };\n    var remove$2 = function (caretContainerNode) {\n      if (isElement$2(caretContainerNode) && isCaretContainer$2(caretContainerNode)) {\n        if (hasContent(caretContainerNode)) {\n          caretContainerNode.removeAttribute('data-mce-caret');\n        } else {\n          removeNode$1(caretContainerNode);\n        }\n      }\n      if (isText$2(caretContainerNode)) {\n        deleteZwspChars(caretContainerNode);\n        if (caretContainerNode.data.length === 0) {\n          removeNode$1(caretContainerNode);\n        }\n      }\n    };\n\n    var browser$2 = detect().browser;\n    var isContentEditableFalse$8 = isContentEditableFalse$b;\n    var isMedia$1 = isMedia$2;\n    var isTableCell$3 = isTableCell$5;\n    var inlineFakeCaretSelector = '*[contentEditable=false],video,audio,embed,object';\n    var getAbsoluteClientRect = function (root, element, before) {\n      var clientRect = collapse(element.getBoundingClientRect(), before);\n      var scrollX;\n      var scrollY;\n      if (root.tagName === 'BODY') {\n        var docElm = root.ownerDocument.documentElement;\n        scrollX = root.scrollLeft || docElm.scrollLeft;\n        scrollY = root.scrollTop || docElm.scrollTop;\n      } else {\n        var rootRect = root.getBoundingClientRect();\n        scrollX = root.scrollLeft - rootRect.left;\n        scrollY = root.scrollTop - rootRect.top;\n      }\n      clientRect.left += scrollX;\n      clientRect.right += scrollX;\n      clientRect.top += scrollY;\n      clientRect.bottom += scrollY;\n      clientRect.width = 1;\n      var margin = element.offsetWidth - element.clientWidth;\n      if (margin > 0) {\n        if (before) {\n          margin *= -1;\n        }\n        clientRect.left += margin;\n        clientRect.right += margin;\n      }\n      return clientRect;\n    };\n    var trimInlineCaretContainers = function (root) {\n      var fakeCaretTargetNodes = descendants(SugarElement.fromDom(root), inlineFakeCaretSelector);\n      for (var i = 0; i < fakeCaretTargetNodes.length; i++) {\n        var node = fakeCaretTargetNodes[i].dom;\n        var sibling = node.previousSibling;\n        if (endsWithCaretContainer$1(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(data.length - 1, 1);\n          }\n        }\n        sibling = node.nextSibling;\n        if (startsWithCaretContainer$1(sibling)) {\n          var data = sibling.data;\n          if (data.length === 1) {\n            sibling.parentNode.removeChild(sibling);\n          } else {\n            sibling.deleteData(0, 1);\n          }\n        }\n      }\n    };\n    var FakeCaret = function (editor, root, isBlock, hasFocus) {\n      var lastVisualCaret = value();\n      var cursorInterval;\n      var caretContainerNode;\n      var rootBlock = getForcedRootBlock(editor);\n      var caretBlock = rootBlock.length > 0 ? rootBlock : 'p';\n      var show = function (before, element) {\n        var rng;\n        hide();\n        if (isTableCell$3(element)) {\n          return null;\n        }\n        if (isBlock(element)) {\n          caretContainerNode = insertBlock$1(caretBlock, element, before);\n          var clientRect = getAbsoluteClientRect(root, element, before);\n          DomQuery(caretContainerNode).css('top', clientRect.top);\n          var caret = DomQuery('<div class=\"mce-visual-caret\" data-mce-bogus=\"all\"></div>').css(__assign({}, clientRect)).appendTo(root)[0];\n          lastVisualCaret.set({\n            caret: caret,\n            element: element,\n            before: before\n          });\n          if (before) {\n            DomQuery(caret).addClass('mce-visual-caret-before');\n          }\n          startBlink();\n          rng = element.ownerDocument.createRange();\n          rng.setStart(caretContainerNode, 0);\n          rng.setEnd(caretContainerNode, 0);\n        } else {\n          caretContainerNode = insertInline$1(element, before);\n          rng = element.ownerDocument.createRange();\n          if (isInlineFakeCaretTarget(caretContainerNode.nextSibling)) {\n            rng.setStart(caretContainerNode, 0);\n            rng.setEnd(caretContainerNode, 0);\n          } else {\n            rng.setStart(caretContainerNode, 1);\n            rng.setEnd(caretContainerNode, 1);\n          }\n          return rng;\n        }\n        return rng;\n      };\n      var hide = function () {\n        trimInlineCaretContainers(root);\n        if (caretContainerNode) {\n          remove$2(caretContainerNode);\n          caretContainerNode = null;\n        }\n        lastVisualCaret.on(function (caretState) {\n          DomQuery(caretState.caret).remove();\n          lastVisualCaret.clear();\n        });\n        if (cursorInterval) {\n          Delay.clearInterval(cursorInterval);\n          cursorInterval = undefined;\n        }\n      };\n      var startBlink = function () {\n        cursorInterval = Delay.setInterval(function () {\n          if (hasFocus()) {\n            DomQuery('div.mce-visual-caret', root).toggleClass('mce-visual-caret-hidden');\n          } else {\n            DomQuery('div.mce-visual-caret', root).addClass('mce-visual-caret-hidden');\n          }\n        }, 500);\n      };\n      var reposition = function () {\n        lastVisualCaret.on(function (caretState) {\n          var clientRect = getAbsoluteClientRect(root, caretState.element, caretState.before);\n          DomQuery(caretState.caret).css(__assign({}, clientRect));\n        });\n      };\n      var destroy = function () {\n        return Delay.clearInterval(cursorInterval);\n      };\n      var getCss = function () {\n        return '.mce-visual-caret {' + 'position: absolute;' + 'background-color: black;' + 'background-color: currentcolor;' + '}' + '.mce-visual-caret-hidden {' + 'display: none;' + '}' + '*[data-mce-caret] {' + 'position: absolute;' + 'left: -1000px;' + 'right: auto;' + 'top: 0;' + 'margin: 0;' + 'padding: 0;' + '}';\n      };\n      return {\n        show: show,\n        hide: hide,\n        getCss: getCss,\n        reposition: reposition,\n        destroy: destroy\n      };\n    };\n    var isFakeCaretTableBrowser = function () {\n      return browser$2.isIE() || browser$2.isEdge() || browser$2.isFirefox();\n    };\n    var isInlineFakeCaretTarget = function (node) {\n      return isContentEditableFalse$8(node) || isMedia$1(node);\n    };\n    var isFakeCaretTarget = function (node) {\n      return isInlineFakeCaretTarget(node) || isTable$3(node) && isFakeCaretTableBrowser();\n    };\n\n    var isContentEditableFalse$7 = isContentEditableFalse$b;\n    var isMedia = isMedia$2;\n    var isBlockLike = matchStyleValues('display', 'block table table-cell table-caption list-item');\n    var isCaretContainer = isCaretContainer$2;\n    var isCaretContainerBlock = isCaretContainerBlock$1;\n    var isElement$1 = isElement$5;\n    var isCaretCandidate$1 = isCaretCandidate$3;\n    var isForwards = function (direction) {\n      return direction > 0;\n    };\n    var isBackwards = function (direction) {\n      return direction < 0;\n    };\n    var skipCaretContainers = function (walk, shallow) {\n      var node;\n      while (node = walk(shallow)) {\n        if (!isCaretContainerBlock(node)) {\n          return node;\n        }\n      }\n      return null;\n    };\n    var findNode$1 = function (node, direction, predicateFn, rootNode, shallow) {\n      var walker = new DomTreeWalker(node, rootNode);\n      var isCefOrCaretContainer = isContentEditableFalse$7(node) || isCaretContainerBlock(node);\n      if (isBackwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.prev.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.prev.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      if (isForwards(direction)) {\n        if (isCefOrCaretContainer) {\n          node = skipCaretContainers(walker.next.bind(walker), true);\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n        while (node = skipCaretContainers(walker.next.bind(walker), shallow)) {\n          if (predicateFn(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var getParentBlock$2 = function (node, rootNode) {\n      while (node && node !== rootNode) {\n        if (isBlockLike(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var isInSameBlock = function (caretPosition1, caretPosition2, rootNode) {\n      return getParentBlock$2(caretPosition1.container(), rootNode) === getParentBlock$2(caretPosition2.container(), rootNode);\n    };\n    var getChildNodeAtRelativeOffset = function (relativeOffset, caretPosition) {\n      if (!caretPosition) {\n        return null;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (!isElement$1(container)) {\n        return null;\n      }\n      return container.childNodes[offset + relativeOffset];\n    };\n    var beforeAfter = function (before, node) {\n      var range = node.ownerDocument.createRange();\n      if (before) {\n        range.setStartBefore(node);\n        range.setEndBefore(node);\n      } else {\n        range.setStartAfter(node);\n        range.setEndAfter(node);\n      }\n      return range;\n    };\n    var isNodesInSameBlock = function (root, node1, node2) {\n      return getParentBlock$2(node1, root) === getParentBlock$2(node2, root);\n    };\n    var lean = function (left, root, node) {\n      var siblingName = left ? 'previousSibling' : 'nextSibling';\n      while (node && node !== root) {\n        var sibling = node[siblingName];\n        if (isCaretContainer(sibling)) {\n          sibling = sibling[siblingName];\n        }\n        if (isContentEditableFalse$7(sibling) || isMedia(sibling)) {\n          if (isNodesInSameBlock(root, sibling, node)) {\n            return sibling;\n          }\n          break;\n        }\n        if (isCaretCandidate$1(sibling)) {\n          break;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var before$2 = curry(beforeAfter, true);\n    var after$2 = curry(beforeAfter, false);\n    var normalizeRange = function (direction, root, range) {\n      var node;\n      var leanLeft = curry(lean, true, root);\n      var leanRight = curry(lean, false, root);\n      var container = range.startContainer;\n      var offset = range.startOffset;\n      if (isCaretContainerBlock$1(container)) {\n        if (!isElement$1(container)) {\n          container = container.parentNode;\n        }\n        var location_1 = container.getAttribute('data-mce-caret');\n        if (location_1 === 'before') {\n          node = container.nextSibling;\n          if (isFakeCaretTarget(node)) {\n            return before$2(node);\n          }\n        }\n        if (location_1 === 'after') {\n          node = container.previousSibling;\n          if (isFakeCaretTarget(node)) {\n            return after$2(node);\n          }\n        }\n      }\n      if (!range.collapsed) {\n        return range;\n      }\n      if (isText$7(container)) {\n        if (isCaretContainer(container)) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n            node = leanLeft(container);\n            if (node) {\n              return after$2(node);\n            }\n          }\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$2(node);\n            }\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (endsWithCaretContainer$1(container) && offset >= container.data.length - 1) {\n          if (direction === 1) {\n            node = leanRight(container);\n            if (node) {\n              return before$2(node);\n            }\n          }\n          return range;\n        }\n        if (startsWithCaretContainer$1(container) && offset <= 1) {\n          if (direction === -1) {\n            node = leanLeft(container);\n            if (node) {\n              return after$2(node);\n            }\n          }\n          return range;\n        }\n        if (offset === container.data.length) {\n          node = leanRight(container);\n          if (node) {\n            return before$2(node);\n          }\n          return range;\n        }\n        if (offset === 0) {\n          node = leanLeft(container);\n          if (node) {\n            return after$2(node);\n          }\n          return range;\n        }\n      }\n      return range;\n    };\n    var getRelativeCefElm = function (forward, caretPosition) {\n      return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, caretPosition)).filter(isContentEditableFalse$7);\n    };\n    var getNormalizedRangeEndPoint = function (direction, root, range) {\n      var normalizedRange = normalizeRange(direction, root, range);\n      if (direction === -1) {\n        return CaretPosition.fromRangeStart(normalizedRange);\n      }\n      return CaretPosition.fromRangeEnd(normalizedRange);\n    };\n    var getElementFromPosition = function (pos) {\n      return Optional.from(pos.getNode()).map(SugarElement.fromDom);\n    };\n    var getElementFromPrevPosition = function (pos) {\n      return Optional.from(pos.getNode(true)).map(SugarElement.fromDom);\n    };\n    var getVisualCaretPosition = function (walkFn, caretPosition) {\n      while (caretPosition = walkFn(caretPosition)) {\n        if (caretPosition.isVisible()) {\n          return caretPosition;\n        }\n      }\n      return caretPosition;\n    };\n    var isMoveInsideSameBlock = function (from, to) {\n      var inSameBlock = isInSameBlock(from, to);\n      if (!inSameBlock && isBr$5(from.getNode())) {\n        return true;\n      }\n      return inSameBlock;\n    };\n\n    var HDirection;\n    (function (HDirection) {\n      HDirection[HDirection['Backwards'] = -1] = 'Backwards';\n      HDirection[HDirection['Forwards'] = 1] = 'Forwards';\n    }(HDirection || (HDirection = {})));\n    var isContentEditableFalse$6 = isContentEditableFalse$b;\n    var isText$1 = isText$7;\n    var isElement = isElement$5;\n    var isBr$1 = isBr$5;\n    var isCaretCandidate = isCaretCandidate$3;\n    var isAtomic = isAtomic$1;\n    var isEditableCaretCandidate = isEditableCaretCandidate$1;\n    var getParents$3 = function (node, root) {\n      var parents = [];\n      while (node && node !== root) {\n        parents.push(node);\n        node = node.parentNode;\n      }\n      return parents;\n    };\n    var nodeAtIndex = function (container, offset) {\n      if (container.hasChildNodes() && offset < container.childNodes.length) {\n        return container.childNodes[offset];\n      }\n      return null;\n    };\n    var getCaretCandidatePosition = function (direction, node) {\n      if (isForwards(direction)) {\n        if (isCaretCandidate(node.previousSibling) && !isText$1(node.previousSibling)) {\n          return CaretPosition.before(node);\n        }\n        if (isText$1(node)) {\n          return CaretPosition(node, 0);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isCaretCandidate(node.nextSibling) && !isText$1(node.nextSibling)) {\n          return CaretPosition.after(node);\n        }\n        if (isText$1(node)) {\n          return CaretPosition(node, node.data.length);\n        }\n      }\n      if (isBackwards(direction)) {\n        if (isBr$1(node)) {\n          return CaretPosition.before(node);\n        }\n        return CaretPosition.after(node);\n      }\n      return CaretPosition.before(node);\n    };\n    var moveForwardFromBr = function (root, nextNode) {\n      var nextSibling = nextNode.nextSibling;\n      if (nextSibling && isCaretCandidate(nextSibling)) {\n        if (isText$1(nextSibling)) {\n          return CaretPosition(nextSibling, 0);\n        } else {\n          return CaretPosition.before(nextSibling);\n        }\n      } else {\n        return findCaretPosition$1(HDirection.Forwards, CaretPosition.after(nextNode), root);\n      }\n    };\n    var findCaretPosition$1 = function (direction, startPos, root) {\n      var node;\n      var nextNode;\n      var innerNode;\n      var caretPosition;\n      if (!isElement(root) || !startPos) {\n        return null;\n      }\n      if (startPos.isEqual(CaretPosition.after(root)) && root.lastChild) {\n        caretPosition = CaretPosition.after(root.lastChild);\n        if (isBackwards(direction) && isCaretCandidate(root.lastChild) && isElement(root.lastChild)) {\n          return isBr$1(root.lastChild) ? CaretPosition.before(root.lastChild) : caretPosition;\n        }\n      } else {\n        caretPosition = startPos;\n      }\n      var container = caretPosition.container();\n      var offset = caretPosition.offset();\n      if (isText$1(container)) {\n        if (isBackwards(direction) && offset > 0) {\n          return CaretPosition(container, --offset);\n        }\n        if (isForwards(direction) && offset < container.length) {\n          return CaretPosition(container, ++offset);\n        }\n        node = container;\n      } else {\n        if (isBackwards(direction) && offset > 0) {\n          nextNode = nodeAtIndex(container, offset - 1);\n          if (isCaretCandidate(nextNode)) {\n            if (!isAtomic(nextNode)) {\n              innerNode = findNode$1(nextNode, direction, isEditableCaretCandidate, nextNode);\n              if (innerNode) {\n                if (isText$1(innerNode)) {\n                  return CaretPosition(innerNode, innerNode.data.length);\n                }\n                return CaretPosition.after(innerNode);\n              }\n            }\n            if (isText$1(nextNode)) {\n              return CaretPosition(nextNode, nextNode.data.length);\n            }\n            return CaretPosition.before(nextNode);\n          }\n        }\n        if (isForwards(direction) && offset < container.childNodes.length) {\n          nextNode = nodeAtIndex(container, offset);\n          if (isCaretCandidate(nextNode)) {\n            if (isBr$1(nextNode)) {\n              return moveForwardFromBr(root, nextNode);\n            }\n            if (!isAtomic(nextNode)) {\n              innerNode = findNode$1(nextNode, direction, isEditableCaretCandidate, nextNode);\n              if (innerNode) {\n                if (isText$1(innerNode)) {\n                  return CaretPosition(innerNode, 0);\n                }\n                return CaretPosition.before(innerNode);\n              }\n            }\n            if (isText$1(nextNode)) {\n              return CaretPosition(nextNode, 0);\n            }\n            return CaretPosition.after(nextNode);\n          }\n        }\n        node = nextNode ? nextNode : caretPosition.getNode();\n      }\n      if (isForwards(direction) && caretPosition.isAtEnd() || isBackwards(direction) && caretPosition.isAtStart()) {\n        node = findNode$1(node, direction, always, root, true);\n        if (isEditableCaretCandidate(node, root)) {\n          return getCaretCandidatePosition(direction, node);\n        }\n      }\n      nextNode = findNode$1(node, direction, isEditableCaretCandidate, root);\n      var rootContentEditableFalseElm = last$1(filter$4(getParents$3(container, root), isContentEditableFalse$6));\n      if (rootContentEditableFalseElm && (!nextNode || !rootContentEditableFalseElm.contains(nextNode))) {\n        if (isForwards(direction)) {\n          caretPosition = CaretPosition.after(rootContentEditableFalseElm);\n        } else {\n          caretPosition = CaretPosition.before(rootContentEditableFalseElm);\n        }\n        return caretPosition;\n      }\n      if (nextNode) {\n        return getCaretCandidatePosition(direction, nextNode);\n      }\n      return null;\n    };\n    var CaretWalker = function (root) {\n      return {\n        next: function (caretPosition) {\n          return findCaretPosition$1(HDirection.Forwards, caretPosition, root);\n        },\n        prev: function (caretPosition) {\n          return findCaretPosition$1(HDirection.Backwards, caretPosition, root);\n        }\n      };\n    };\n\n    var walkToPositionIn = function (forward, root, start) {\n      var position = forward ? CaretPosition.before(start) : CaretPosition.after(start);\n      return fromPosition(forward, root, position);\n    };\n    var afterElement = function (node) {\n      return isBr$5(node) ? CaretPosition.before(node) : CaretPosition.after(node);\n    };\n    var isBeforeOrStart = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        return position.offset() === 0;\n      } else {\n        return isCaretCandidate$3(position.getNode());\n      }\n    };\n    var isAfterOrEnd = function (position) {\n      if (CaretPosition.isTextPosition(position)) {\n        var container = position.container();\n        return position.offset() === container.data.length;\n      } else {\n        return isCaretCandidate$3(position.getNode(true));\n      }\n    };\n    var isBeforeAfterSameElement = function (from, to) {\n      return !CaretPosition.isTextPosition(from) && !CaretPosition.isTextPosition(to) && from.getNode() === to.getNode(true);\n    };\n    var isAtBr = function (position) {\n      return !CaretPosition.isTextPosition(position) && isBr$5(position.getNode());\n    };\n    var shouldSkipPosition = function (forward, from, to) {\n      if (forward) {\n        return !isBeforeAfterSameElement(from, to) && !isAtBr(from) && isAfterOrEnd(from) && isBeforeOrStart(to);\n      } else {\n        return !isBeforeAfterSameElement(to, from) && isBeforeOrStart(from) && isAfterOrEnd(to);\n      }\n    };\n    var fromPosition = function (forward, root, pos) {\n      var walker = CaretWalker(root);\n      return Optional.from(forward ? walker.next(pos) : walker.prev(pos));\n    };\n    var navigate = function (forward, root, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isInSameBlock(from, to, root) && shouldSkipPosition(forward, from, to)) {\n          return fromPosition(forward, root, to);\n        } else {\n          return Optional.some(to);\n        }\n      });\n    };\n    var navigateIgnore = function (forward, root, from, ignoreFilter) {\n      return navigate(forward, root, from).bind(function (pos) {\n        return ignoreFilter(pos) ? navigateIgnore(forward, root, pos, ignoreFilter) : Optional.some(pos);\n      });\n    };\n    var positionIn = function (forward, element) {\n      var startNode = forward ? element.firstChild : element.lastChild;\n      if (isText$7(startNode)) {\n        return Optional.some(CaretPosition(startNode, forward ? 0 : startNode.data.length));\n      } else if (startNode) {\n        if (isCaretCandidate$3(startNode)) {\n          return Optional.some(forward ? CaretPosition.before(startNode) : afterElement(startNode));\n        } else {\n          return walkToPositionIn(forward, element, startNode);\n        }\n      } else {\n        return Optional.none();\n      }\n    };\n    var nextPosition = curry(fromPosition, true);\n    var prevPosition = curry(fromPosition, false);\n    var firstPositionIn = curry(positionIn, true);\n    var lastPositionIn = curry(positionIn, false);\n\n    var CARET_ID$1 = '_mce_caret';\n    var isCaretNode = function (node) {\n      return isElement$5(node) && node.id === CARET_ID$1;\n    };\n    var getParentCaretContainer = function (body, node) {\n      while (node && node !== body) {\n        if (node.id === CARET_ID$1) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isStringPathBookmark = function (bookmark) {\n      return isString$1(bookmark.start);\n    };\n    var isRangeBookmark = function (bookmark) {\n      return has$2(bookmark, 'rng');\n    };\n    var isIdBookmark = function (bookmark) {\n      return has$2(bookmark, 'id');\n    };\n    var isIndexBookmark = function (bookmark) {\n      return has$2(bookmark, 'name');\n    };\n    var isPathBookmark = function (bookmark) {\n      return Tools.isArray(bookmark.start);\n    };\n\n    var addBogus = function (dom, node) {\n      if (isElement$5(node) && dom.isBlock(node) && !node.innerHTML && !Env.ie) {\n        node.innerHTML = '<br data-mce-bogus=\"1\" />';\n      }\n      return node;\n    };\n    var resolveCaretPositionBookmark = function (dom, bookmark) {\n      var pos;\n      var rng = dom.createRng();\n      pos = resolve$2(dom.getRoot(), bookmark.start);\n      rng.setStart(pos.container(), pos.offset());\n      pos = resolve$2(dom.getRoot(), bookmark.end);\n      rng.setEnd(pos.container(), pos.offset());\n      return rng;\n    };\n    var insertZwsp = function (node, rng) {\n      var textNode = node.ownerDocument.createTextNode(ZWSP$1);\n      node.appendChild(textNode);\n      rng.setStart(textNode, 0);\n      rng.setEnd(textNode, 0);\n    };\n    var isEmpty$1 = function (node) {\n      return node.hasChildNodes() === false;\n    };\n    var tryFindRangePosition = function (node, rng) {\n      return lastPositionIn(node).fold(never, function (pos) {\n        rng.setStart(pos.container(), pos.offset());\n        rng.setEnd(pos.container(), pos.offset());\n        return true;\n      });\n    };\n    var padEmptyCaretContainer = function (root, node, rng) {\n      if (isEmpty$1(node) && getParentCaretContainer(root, node)) {\n        insertZwsp(node, rng);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var setEndPoint = function (dom, start, bookmark, rng) {\n      var point = bookmark[start ? 'start' : 'end'];\n      var i, node, offset, children;\n      var root = dom.getRoot();\n      if (point) {\n        offset = point[0];\n        for (node = root, i = point.length - 1; i >= 1; i--) {\n          children = node.childNodes;\n          if (padEmptyCaretContainer(root, node, rng)) {\n            return true;\n          }\n          if (point[i] > children.length - 1) {\n            if (padEmptyCaretContainer(root, node, rng)) {\n              return true;\n            }\n            return tryFindRangePosition(node, rng);\n          }\n          node = children[point[i]];\n        }\n        if (node.nodeType === 3) {\n          offset = Math.min(point[0], node.nodeValue.length);\n        }\n        if (node.nodeType === 1) {\n          offset = Math.min(point[0], node.childNodes.length);\n        }\n        if (start) {\n          rng.setStart(node, offset);\n        } else {\n          rng.setEnd(node, offset);\n        }\n      }\n      return true;\n    };\n    var isValidTextNode = function (node) {\n      return isText$7(node) && node.data.length > 0;\n    };\n    var restoreEndPoint = function (dom, suffix, bookmark) {\n      var marker = dom.get(bookmark.id + '_' + suffix), node, idx, next, prev;\n      var keep = bookmark.keep;\n      var container, offset;\n      if (marker) {\n        node = marker.parentNode;\n        if (suffix === 'start') {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.nextSibling)) {\n              node = marker.nextSibling;\n              idx = 0;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker) + 1;\n            }\n          }\n          container = node;\n          offset = idx;\n        } else {\n          if (!keep) {\n            idx = dom.nodeIndex(marker);\n          } else {\n            if (marker.hasChildNodes()) {\n              node = marker.firstChild;\n              idx = 1;\n            } else if (isValidTextNode(marker.previousSibling)) {\n              node = marker.previousSibling;\n              idx = marker.previousSibling.data.length;\n            } else {\n              node = marker.parentNode;\n              idx = dom.nodeIndex(marker);\n            }\n          }\n          container = node;\n          offset = idx;\n        }\n        if (!keep) {\n          prev = marker.previousSibling;\n          next = marker.nextSibling;\n          Tools.each(Tools.grep(marker.childNodes), function (node) {\n            if (isText$7(node)) {\n              node.nodeValue = node.nodeValue.replace(/\\uFEFF/g, '');\n            }\n          });\n          while (marker = dom.get(bookmark.id + '_' + suffix)) {\n            dom.remove(marker, true);\n          }\n          if (prev && next && prev.nodeType === next.nodeType && isText$7(prev) && !Env.opera) {\n            idx = prev.nodeValue.length;\n            prev.appendData(next.nodeValue);\n            dom.remove(next);\n            container = prev;\n            offset = idx;\n          }\n        }\n        return Optional.some(CaretPosition(container, offset));\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolvePaths = function (dom, bookmark) {\n      var rng = dom.createRng();\n      if (setEndPoint(dom, true, bookmark, rng) && setEndPoint(dom, false, bookmark, rng)) {\n        return Optional.some(rng);\n      } else {\n        return Optional.none();\n      }\n    };\n    var resolveId = function (dom, bookmark) {\n      var startPos = restoreEndPoint(dom, 'start', bookmark);\n      var endPos = restoreEndPoint(dom, 'end', bookmark);\n      return lift2(startPos, endPos.or(startPos), function (spos, epos) {\n        var rng = dom.createRng();\n        rng.setStart(addBogus(dom, spos.container()), spos.offset());\n        rng.setEnd(addBogus(dom, epos.container()), epos.offset());\n        return rng;\n      });\n    };\n    var resolveIndex = function (dom, bookmark) {\n      return Optional.from(dom.select(bookmark.name)[bookmark.index]).map(function (elm) {\n        var rng = dom.createRng();\n        rng.selectNode(elm);\n        return rng;\n      });\n    };\n    var resolve$1 = function (selection, bookmark) {\n      var dom = selection.dom;\n      if (bookmark) {\n        if (isPathBookmark(bookmark)) {\n          return resolvePaths(dom, bookmark);\n        } else if (isStringPathBookmark(bookmark)) {\n          return Optional.some(resolveCaretPositionBookmark(dom, bookmark));\n        } else if (isIdBookmark(bookmark)) {\n          return resolveId(dom, bookmark);\n        } else if (isIndexBookmark(bookmark)) {\n          return resolveIndex(dom, bookmark);\n        } else if (isRangeBookmark(bookmark)) {\n          return Optional.some(bookmark.rng);\n        }\n      }\n      return Optional.none();\n    };\n\n    var getBookmark$1 = function (selection, type, normalized) {\n      return getBookmark$2(selection, type, normalized);\n    };\n    var moveToBookmark = function (selection, bookmark) {\n      resolve$1(selection, bookmark).each(function (rng) {\n        selection.setRng(rng);\n      });\n    };\n    var isBookmarkNode$1 = function (node) {\n      return isElement$5(node) && node.tagName === 'SPAN' && node.getAttribute('data-mce-type') === 'bookmark';\n    };\n\n    var is = function (expected) {\n      return function (actual) {\n        return expected === actual;\n      };\n    };\n    var isNbsp = is(nbsp);\n    var isWhiteSpace = function (chr) {\n      return chr !== '' && ' \\f\\n\\r\\t\\x0B'.indexOf(chr) !== -1;\n    };\n    var isContent = function (chr) {\n      return !isWhiteSpace(chr) && !isNbsp(chr);\n    };\n\n    var isNode = function (node) {\n      return !!node.nodeType;\n    };\n    var isInlineBlock = function (node) {\n      return node && /^(IMG)$/.test(node.nodeName);\n    };\n    var moveStart = function (dom, selection, rng) {\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container === rng.endContainer) {\n        if (isInlineBlock(container.childNodes[offset])) {\n          return;\n        }\n      }\n      if (isElement$5(container)) {\n        var nodes = container.childNodes;\n        var walker = void 0;\n        if (offset < nodes.length) {\n          container = nodes[offset];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n        } else {\n          container = nodes[nodes.length - 1];\n          walker = new DomTreeWalker(container, dom.getParent(container, dom.isBlock));\n          walker.next(true);\n        }\n        for (var node = walker.current(); node; node = walker.next()) {\n          if (isText$7(node) && !isWhiteSpaceNode$1(node)) {\n            rng.setStart(node, 0);\n            selection.setRng(rng);\n            return;\n          }\n        }\n      }\n    };\n    var getNonWhiteSpaceSibling = function (node, next, inc) {\n      if (node) {\n        var nextName = next ? 'nextSibling' : 'previousSibling';\n        for (node = inc ? node : node[nextName]; node; node = node[nextName]) {\n          if (isElement$5(node) || !isWhiteSpaceNode$1(node)) {\n            return node;\n          }\n        }\n      }\n    };\n    var isTextBlock$1 = function (editor, name) {\n      if (isNode(name)) {\n        name = name.nodeName;\n      }\n      return !!editor.schema.getTextBlockElements()[name.toLowerCase()];\n    };\n    var isValid = function (ed, parent, child) {\n      return ed.schema.isValidChild(parent, child);\n    };\n    var isWhiteSpaceNode$1 = function (node, allowSpaces) {\n      if (allowSpaces === void 0) {\n        allowSpaces = false;\n      }\n      if (isNonNullable(node) && isText$7(node)) {\n        var data = allowSpaces ? node.data.replace(/ /g, '\\xA0') : node.data;\n        return isWhitespaceText(data);\n      } else {\n        return false;\n      }\n    };\n    var isEmptyTextNode$1 = function (node) {\n      return isNonNullable(node) && isText$7(node) && node.length === 0;\n    };\n    var replaceVars = function (value, vars) {\n      if (isFunction(value)) {\n        value = value(vars);\n      } else if (isNonNullable(vars)) {\n        value = value.replace(/%(\\w+)/g, function (str, name) {\n          return vars[name] || str;\n        });\n      }\n      return value;\n    };\n    var isEq$5 = function (str1, str2) {\n      str1 = str1 || '';\n      str2 = str2 || '';\n      str1 = '' + (str1.nodeName || str1);\n      str2 = '' + (str2.nodeName || str2);\n      return str1.toLowerCase() === str2.toLowerCase();\n    };\n    var normalizeStyleValue = function (dom, value, name) {\n      if (name === 'color' || name === 'backgroundColor') {\n        value = dom.toHex(value);\n      }\n      if (name === 'fontWeight' && value === 700) {\n        value = 'bold';\n      }\n      if (name === 'fontFamily') {\n        value = value.replace(/[\\'\\\"]/g, '').replace(/,\\s+/g, ',');\n      }\n      return '' + value;\n    };\n    var getStyle = function (dom, node, name) {\n      return normalizeStyleValue(dom, dom.getStyle(node, name), name);\n    };\n    var getTextDecoration = function (dom, node) {\n      var decoration;\n      dom.getParent(node, function (n) {\n        decoration = dom.getStyle(n, 'text-decoration');\n        return decoration && decoration !== 'none';\n      });\n      return decoration;\n    };\n    var getParents$2 = function (dom, node, selector) {\n      return dom.getParents(node, selector, dom.getRoot());\n    };\n    var isVariableFormatName = function (editor, formatName) {\n      var hasVariableValues = function (format) {\n        var isVariableValue = function (val) {\n          return val.length > 1 && val.charAt(0) === '%';\n        };\n        return exists([\n          'styles',\n          'attributes'\n        ], function (key) {\n          return get$9(format, key).exists(function (field) {\n            var fieldValues = isArray$1(field) ? field : values(field);\n            return exists(fieldValues, isVariableValue);\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), hasVariableValues);\n    };\n    var areSimilarFormats = function (editor, formatName, otherFormatName) {\n      var validKeys = [\n        'inline',\n        'block',\n        'selector',\n        'attributes',\n        'styles',\n        'classes'\n      ];\n      var filterObj = function (format) {\n        return filter$3(format, function (_, key) {\n          return exists(validKeys, function (validKey) {\n            return validKey === key;\n          });\n        });\n      };\n      return exists(editor.formatter.get(formatName), function (fmt1) {\n        var filteredFmt1 = filterObj(fmt1);\n        return exists(editor.formatter.get(otherFormatName), function (fmt2) {\n          var filteredFmt2 = filterObj(fmt2);\n          return equal$1(filteredFmt1, filteredFmt2);\n        });\n      });\n    };\n    var isBlockFormat = function (format) {\n      return hasNonNullableKey(format, 'block');\n    };\n    var isSelectorFormat = function (format) {\n      return hasNonNullableKey(format, 'selector');\n    };\n    var isInlineFormat = function (format) {\n      return hasNonNullableKey(format, 'inline');\n    };\n    var isMixedFormat = function (format) {\n      return isSelectorFormat(format) && isInlineFormat(format) && is$1(get$9(format, 'mixed'), true);\n    };\n    var shouldExpandToSelector = function (format) {\n      return isSelectorFormat(format) && format.expand !== false && !isInlineFormat(format);\n    };\n\n    var isBookmarkNode = isBookmarkNode$1;\n    var getParents$1 = getParents$2;\n    var isWhiteSpaceNode = isWhiteSpaceNode$1;\n    var isTextBlock = isTextBlock$1;\n    var isBogusBr = function (node) {\n      return isBr$5(node) && node.getAttribute('data-mce-bogus') && !node.nextSibling;\n    };\n    var findParentContentEditable = function (dom, node) {\n      var parent = node;\n      while (parent) {\n        if (isElement$5(parent) && dom.getContentEditable(parent)) {\n          return dom.getContentEditable(parent) === 'false' ? parent : node;\n        }\n        parent = parent.parentNode;\n      }\n      return node;\n    };\n    var walkText = function (start, node, offset, predicate) {\n      var str = node.data;\n      for (var i = offset; start ? i >= 0 : i < str.length; start ? i-- : i++) {\n        if (predicate(str.charAt(i))) {\n          return start ? i + 1 : i;\n        }\n      }\n      return -1;\n    };\n    var findSpace = function (start, node, offset) {\n      return walkText(start, node, offset, function (c) {\n        return isNbsp(c) || isWhiteSpace(c);\n      });\n    };\n    var findContent = function (start, node, offset) {\n      return walkText(start, node, offset, isContent);\n    };\n    var findWordEndPoint = function (dom, body, container, offset, start, includeTrailingSpaces) {\n      var lastTextNode;\n      var rootNode = dom.getParent(container, dom.isBlock) || body;\n      var walk = function (container, offset, pred) {\n        var textSeeker = TextSeeker(dom);\n        var walker = start ? textSeeker.backwards : textSeeker.forwards;\n        return Optional.from(walker(container, offset, function (text, textOffset) {\n          if (isBookmarkNode(text.parentNode)) {\n            return -1;\n          } else {\n            lastTextNode = text;\n            return pred(start, text, textOffset);\n          }\n        }, rootNode));\n      };\n      var spaceResult = walk(container, offset, findSpace);\n      return spaceResult.bind(function (result) {\n        return includeTrailingSpaces ? walk(result.container, result.offset + (start ? -1 : 0), findContent) : Optional.some(result);\n      }).orThunk(function () {\n        return lastTextNode ? Optional.some({\n          container: lastTextNode,\n          offset: start ? 0 : lastTextNode.length\n        }) : Optional.none();\n      });\n    };\n    var findSelectorEndPoint = function (dom, formatList, rng, container, siblingName) {\n      if (isText$7(container) && isEmpty$3(container.data) && container[siblingName]) {\n        container = container[siblingName];\n      }\n      var parents = getParents$1(dom, container);\n      for (var i = 0; i < parents.length; i++) {\n        for (var y = 0; y < formatList.length; y++) {\n          var curFormat = formatList[y];\n          if (isNonNullable(curFormat.collapsed) && curFormat.collapsed !== rng.collapsed) {\n            continue;\n          }\n          if (isSelectorFormat(curFormat) && dom.is(parents[i], curFormat.selector)) {\n            return parents[i];\n          }\n        }\n      }\n      return container;\n    };\n    var findBlockEndPoint = function (editor, formatList, container, siblingName) {\n      var node = container;\n      var dom = editor.dom;\n      var root = dom.getRoot();\n      var format = formatList[0];\n      if (isBlockFormat(format)) {\n        node = format.wrapper ? null : dom.getParent(container, format.block, root);\n      }\n      if (!node) {\n        var scopeRoot = dom.getParent(container, 'LI,TD,TH');\n        node = dom.getParent(isText$7(container) ? container.parentNode : container, function (node) {\n          return node !== root && isTextBlock(editor, node);\n        }, scopeRoot);\n      }\n      if (node && isBlockFormat(format) && format.wrapper) {\n        node = getParents$1(dom, node, 'ul,ol').reverse()[0] || node;\n      }\n      if (!node) {\n        node = container;\n        while (node[siblingName] && !dom.isBlock(node[siblingName])) {\n          node = node[siblingName];\n          if (isEq$5(node, 'br')) {\n            break;\n          }\n        }\n      }\n      return node || container;\n    };\n    var isAtBlockBoundary$1 = function (dom, root, container, siblingName) {\n      var parent = container.parentNode;\n      if (isNonNullable(container[siblingName])) {\n        return false;\n      } else if (parent === root || isNullable(parent) || dom.isBlock(parent)) {\n        return true;\n      } else {\n        return isAtBlockBoundary$1(dom, root, parent, siblingName);\n      }\n    };\n    var findParentContainer = function (dom, formatList, container, offset, start) {\n      var parent = container;\n      var siblingName = start ? 'previousSibling' : 'nextSibling';\n      var root = dom.getRoot();\n      if (isText$7(container) && !isWhiteSpaceNode(container)) {\n        if (start ? offset > 0 : offset < container.data.length) {\n          return container;\n        }\n      }\n      while (true) {\n        if (!formatList[0].block_expand && dom.isBlock(parent)) {\n          return parent;\n        }\n        for (var sibling = parent[siblingName]; sibling; sibling = sibling[siblingName]) {\n          var allowSpaces = isText$7(sibling) && !isAtBlockBoundary$1(dom, root, sibling, siblingName);\n          if (!isBookmarkNode(sibling) && !isBogusBr(sibling) && !isWhiteSpaceNode(sibling, allowSpaces)) {\n            return parent;\n          }\n        }\n        if (parent === root || parent.parentNode === root) {\n          container = parent;\n          break;\n        }\n        parent = parent.parentNode;\n      }\n      return container;\n    };\n    var isSelfOrParentBookmark = function (container) {\n      return isBookmarkNode(container.parentNode) || isBookmarkNode(container);\n    };\n    var expandRng = function (editor, rng, formatList, includeTrailingSpace) {\n      if (includeTrailingSpace === void 0) {\n        includeTrailingSpace = false;\n      }\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      var dom = editor.dom;\n      var format = formatList[0];\n      if (isElement$5(startContainer) && startContainer.hasChildNodes()) {\n        startContainer = getNode$1(startContainer, startOffset);\n        if (isText$7(startContainer)) {\n          startOffset = 0;\n        }\n      }\n      if (isElement$5(endContainer) && endContainer.hasChildNodes()) {\n        endContainer = getNode$1(endContainer, rng.collapsed ? endOffset : endOffset - 1);\n        if (isText$7(endContainer)) {\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      startContainer = findParentContentEditable(dom, startContainer);\n      endContainer = findParentContentEditable(dom, endContainer);\n      if (isSelfOrParentBookmark(startContainer)) {\n        startContainer = isBookmarkNode(startContainer) ? startContainer : startContainer.parentNode;\n        if (rng.collapsed) {\n          startContainer = startContainer.previousSibling || startContainer;\n        } else {\n          startContainer = startContainer.nextSibling || startContainer;\n        }\n        if (isText$7(startContainer)) {\n          startOffset = rng.collapsed ? startContainer.length : 0;\n        }\n      }\n      if (isSelfOrParentBookmark(endContainer)) {\n        endContainer = isBookmarkNode(endContainer) ? endContainer : endContainer.parentNode;\n        if (rng.collapsed) {\n          endContainer = endContainer.nextSibling || endContainer;\n        } else {\n          endContainer = endContainer.previousSibling || endContainer;\n        }\n        if (isText$7(endContainer)) {\n          endOffset = rng.collapsed ? 0 : endContainer.length;\n        }\n      }\n      if (rng.collapsed) {\n        var startPoint = findWordEndPoint(dom, editor.getBody(), startContainer, startOffset, true, includeTrailingSpace);\n        startPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          startContainer = container;\n          startOffset = offset;\n        });\n        var endPoint = findWordEndPoint(dom, editor.getBody(), endContainer, endOffset, false, includeTrailingSpace);\n        endPoint.each(function (_a) {\n          var container = _a.container, offset = _a.offset;\n          endContainer = container;\n          endOffset = offset;\n        });\n      }\n      if (isInlineFormat(format) || format.block_expand) {\n        if (!isInlineFormat(format) || (!isText$7(startContainer) || startOffset === 0)) {\n          startContainer = findParentContainer(dom, formatList, startContainer, startOffset, true);\n        }\n        if (!isInlineFormat(format) || (!isText$7(endContainer) || endOffset === endContainer.nodeValue.length)) {\n          endContainer = findParentContainer(dom, formatList, endContainer, endOffset, false);\n        }\n      }\n      if (shouldExpandToSelector(format)) {\n        startContainer = findSelectorEndPoint(dom, formatList, rng, startContainer, 'previousSibling');\n        endContainer = findSelectorEndPoint(dom, formatList, rng, endContainer, 'nextSibling');\n      }\n      if (isBlockFormat(format) || isSelectorFormat(format)) {\n        startContainer = findBlockEndPoint(editor, formatList, startContainer, 'previousSibling');\n        endContainer = findBlockEndPoint(editor, formatList, endContainer, 'nextSibling');\n        if (isBlockFormat(format)) {\n          if (!dom.isBlock(startContainer)) {\n            startContainer = findParentContainer(dom, formatList, startContainer, startOffset, true);\n          }\n          if (!dom.isBlock(endContainer)) {\n            endContainer = findParentContainer(dom, formatList, endContainer, endOffset, false);\n          }\n        }\n      }\n      if (isElement$5(startContainer)) {\n        startOffset = dom.nodeIndex(startContainer);\n        startContainer = startContainer.parentNode;\n      }\n      if (isElement$5(endContainer)) {\n        endOffset = dom.nodeIndex(endContainer) + 1;\n        endContainer = endContainer.parentNode;\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var walk$2 = function (dom, rng, callback) {\n      var startOffset = rng.startOffset;\n      var startContainer = getNode$1(rng.startContainer, startOffset);\n      var endOffset = rng.endOffset;\n      var endContainer = getNode$1(rng.endContainer, endOffset - 1);\n      var exclude = function (nodes) {\n        var firstNode = nodes[0];\n        if (isText$7(firstNode) && firstNode === startContainer && startOffset >= firstNode.data.length) {\n          nodes.splice(0, 1);\n        }\n        var lastNode = nodes[nodes.length - 1];\n        if (endOffset === 0 && nodes.length > 0 && lastNode === endContainer && isText$7(lastNode)) {\n          nodes.splice(nodes.length - 1, 1);\n        }\n        return nodes;\n      };\n      var collectSiblings = function (node, name, endNode) {\n        var siblings = [];\n        for (; node && node !== endNode; node = node[name]) {\n          siblings.push(node);\n        }\n        return siblings;\n      };\n      var findEndPoint = function (node, root) {\n        return dom.getParent(node, function (node) {\n          return node.parentNode === root;\n        }, root);\n      };\n      var walkBoundary = function (startNode, endNode, next) {\n        var siblingName = next ? 'nextSibling' : 'previousSibling';\n        for (var node = startNode, parent_1 = node.parentNode; node && node !== endNode; node = parent_1) {\n          parent_1 = node.parentNode;\n          var siblings_1 = collectSiblings(node === startNode ? node : node[siblingName], siblingName);\n          if (siblings_1.length) {\n            if (!next) {\n              siblings_1.reverse();\n            }\n            callback(exclude(siblings_1));\n          }\n        }\n      };\n      if (startContainer === endContainer) {\n        return callback(exclude([startContainer]));\n      }\n      var ancestor = dom.findCommonAncestor(startContainer, endContainer);\n      if (dom.isChildOf(startContainer, endContainer)) {\n        return walkBoundary(startContainer, ancestor, true);\n      }\n      if (dom.isChildOf(endContainer, startContainer)) {\n        return walkBoundary(endContainer, ancestor);\n      }\n      var startPoint = findEndPoint(startContainer, ancestor) || startContainer;\n      var endPoint = findEndPoint(endContainer, ancestor) || endContainer;\n      walkBoundary(startContainer, startPoint, true);\n      var siblings = collectSiblings(startPoint === startContainer ? startPoint : startPoint.nextSibling, 'nextSibling', endPoint === endContainer ? endPoint.nextSibling : endPoint);\n      if (siblings.length) {\n        callback(exclude(siblings));\n      }\n      walkBoundary(endContainer, endPoint);\n    };\n\n    var getRanges = function (selection) {\n      var ranges = [];\n      if (selection) {\n        for (var i = 0; i < selection.rangeCount; i++) {\n          ranges.push(selection.getRangeAt(i));\n        }\n      }\n      return ranges;\n    };\n    var getSelectedNodes = function (ranges) {\n      return bind(ranges, function (range) {\n        var node = getSelectedNode(range);\n        return node ? [SugarElement.fromDom(node)] : [];\n      });\n    };\n    var hasMultipleRanges = function (selection) {\n      return getRanges(selection).length > 1;\n    };\n\n    var getCellsFromRanges = function (ranges) {\n      return filter$4(getSelectedNodes(ranges), isTableCell$4);\n    };\n    var getCellsFromElement = function (elm) {\n      return descendants(elm, 'td[data-mce-selected],th[data-mce-selected]');\n    };\n    var getCellsFromElementOrRanges = function (ranges, element) {\n      var selectedCells = getCellsFromElement(element);\n      return selectedCells.length > 0 ? selectedCells : getCellsFromRanges(ranges);\n    };\n    var getCellsFromEditor = function (editor) {\n      return getCellsFromElementOrRanges(getRanges(editor.selection.getSel()), SugarElement.fromDom(editor.getBody()));\n    };\n    var getClosestTable = function (cell, isRoot) {\n      return ancestor$2(cell, 'table', isRoot);\n    };\n\n    var getStartNode = function (rng) {\n      var sc = rng.startContainer, so = rng.startOffset;\n      if (isText$7(sc)) {\n        return so === 0 ? Optional.some(SugarElement.fromDom(sc)) : Optional.none();\n      } else {\n        return Optional.from(sc.childNodes[so]).map(SugarElement.fromDom);\n      }\n    };\n    var getEndNode = function (rng) {\n      var ec = rng.endContainer, eo = rng.endOffset;\n      if (isText$7(ec)) {\n        return eo === ec.data.length ? Optional.some(SugarElement.fromDom(ec)) : Optional.none();\n      } else {\n        return Optional.from(ec.childNodes[eo - 1]).map(SugarElement.fromDom);\n      }\n    };\n    var getFirstChildren = function (node) {\n      return firstChild(node).fold(constant([node]), function (child) {\n        return [node].concat(getFirstChildren(child));\n      });\n    };\n    var getLastChildren$1 = function (node) {\n      return lastChild(node).fold(constant([node]), function (child) {\n        if (name(child) === 'br') {\n          return prevSibling(child).map(function (sibling) {\n            return [node].concat(getLastChildren$1(sibling));\n          }).getOr([]);\n        } else {\n          return [node].concat(getLastChildren$1(child));\n        }\n      });\n    };\n    var hasAllContentsSelected = function (elm, rng) {\n      return lift2(getStartNode(rng), getEndNode(rng), function (startNode, endNode) {\n        var start = find$3(getFirstChildren(elm), curry(eq, startNode));\n        var end = find$3(getLastChildren$1(elm), curry(eq, endNode));\n        return start.isSome() && end.isSome();\n      }).getOr(false);\n    };\n    var moveEndPoint = function (dom, rng, node, start) {\n      var root = node, walker = new DomTreeWalker(node, root);\n      var moveCaretBeforeOnEnterElementsMap = filter$3(dom.schema.getMoveCaretBeforeOnEnterElements(), function (_, name) {\n        return !contains$3([\n          'td',\n          'th',\n          'table'\n        ], name.toLowerCase());\n      });\n      do {\n        if (isText$7(node) && Tools.trim(node.nodeValue).length !== 0) {\n          if (start) {\n            rng.setStart(node, 0);\n          } else {\n            rng.setEnd(node, node.nodeValue.length);\n          }\n          return;\n        }\n        if (moveCaretBeforeOnEnterElementsMap[node.nodeName]) {\n          if (start) {\n            rng.setStartBefore(node);\n          } else {\n            if (node.nodeName === 'BR') {\n              rng.setEndBefore(node);\n            } else {\n              rng.setEndAfter(node);\n            }\n          }\n          return;\n        }\n      } while (node = start ? walker.next() : walker.prev());\n      if (root.nodeName === 'BODY') {\n        if (start) {\n          rng.setStart(root, 0);\n        } else {\n          rng.setEnd(root, root.childNodes.length);\n        }\n      }\n    };\n    var hasAnyRanges = function (editor) {\n      var sel = editor.selection.getSel();\n      return sel && sel.rangeCount > 0;\n    };\n    var runOnRanges = function (editor, executor) {\n      var fakeSelectionNodes = getCellsFromEditor(editor);\n      if (fakeSelectionNodes.length > 0) {\n        each$k(fakeSelectionNodes, function (elem) {\n          var node = elem.dom;\n          var fakeNodeRng = editor.dom.createRng();\n          fakeNodeRng.setStartBefore(node);\n          fakeNodeRng.setEndAfter(node);\n          executor(fakeNodeRng, true);\n        });\n      } else {\n        executor(editor.selection.getRng(), false);\n      }\n    };\n    var preserve = function (selection, fillBookmark, executor) {\n      var bookmark = getPersistentBookmark(selection, fillBookmark);\n      executor(bookmark);\n      selection.moveToBookmark(bookmark);\n    };\n\n    var NodeValue = function (is, name) {\n      var get = function (element) {\n        if (!is(element)) {\n          throw new Error('Can only get ' + name + ' value of a ' + name + ' node');\n        }\n        return getOption(element).getOr('');\n      };\n      var getOption = function (element) {\n        return is(element) ? Optional.from(element.dom.nodeValue) : Optional.none();\n      };\n      var set = function (element, value) {\n        if (!is(element)) {\n          throw new Error('Can only set raw ' + name + ' value of a ' + name + ' node');\n        }\n        element.dom.nodeValue = value;\n      };\n      return {\n        get: get,\n        getOption: getOption,\n        set: set\n      };\n    };\n\n    var api$1 = NodeValue(isText$8, 'text');\n    var get$2 = function (element) {\n      return api$1.get(element);\n    };\n\n    var isZeroWidth = function (elem) {\n      return isText$8(elem) && get$2(elem) === ZWSP$1;\n    };\n    var context = function (editor, elem, wrapName, nodeName) {\n      return parent(elem).fold(function () {\n        return 'skipping';\n      }, function (parent) {\n        if (nodeName === 'br' || isZeroWidth(elem)) {\n          return 'valid';\n        } else if (isAnnotation(elem)) {\n          return 'existing';\n        } else if (isCaretNode(elem.dom)) {\n          return 'caret';\n        } else if (!isValid(editor, wrapName, nodeName) || !isValid(editor, name(parent), wrapName)) {\n          return 'invalid-child';\n        } else {\n          return 'valid';\n        }\n      });\n    };\n\n    var applyWordGrab = function (editor, rng) {\n      var r = expandRng(editor, rng, [{ inline: 'span' }]);\n      rng.setStart(r.startContainer, r.startOffset);\n      rng.setEnd(r.endContainer, r.endOffset);\n      editor.selection.setRng(rng);\n    };\n    var makeAnnotation = function (eDoc, _a, annotationName, decorate) {\n      var _b = _a.uid, uid = _b === void 0 ? generate('mce-annotation') : _b, data = __rest(_a, ['uid']);\n      var master = SugarElement.fromTag('span', eDoc);\n      add$1(master, annotation());\n      set$1(master, '' + dataAnnotationId(), uid);\n      set$1(master, '' + dataAnnotation(), annotationName);\n      var _c = decorate(uid, data), _d = _c.attributes, attributes = _d === void 0 ? {} : _d, _e = _c.classes, classes = _e === void 0 ? [] : _e;\n      setAll$1(master, attributes);\n      add(master, classes);\n      return master;\n    };\n    var annotate = function (editor, rng, annotationName, decorate, data) {\n      var newWrappers = [];\n      var master = makeAnnotation(editor.getDoc(), data, annotationName, decorate);\n      var wrapper = value();\n      var finishWrapper = function () {\n        wrapper.clear();\n      };\n      var getOrOpenWrapper = function () {\n        return wrapper.get().getOrThunk(function () {\n          var nu = shallow(master);\n          newWrappers.push(nu);\n          wrapper.set(nu);\n          return nu;\n        });\n      };\n      var processElements = function (elems) {\n        each$k(elems, processElement);\n      };\n      var processElement = function (elem) {\n        var ctx = context(editor, elem, 'span', name(elem));\n        switch (ctx) {\n        case 'invalid-child': {\n            finishWrapper();\n            var children$1 = children(elem);\n            processElements(children$1);\n            finishWrapper();\n            break;\n          }\n        case 'valid': {\n            var w = getOrOpenWrapper();\n            wrap$3(elem, w);\n            break;\n          }\n        }\n      };\n      var processNodes = function (nodes) {\n        var elems = map$3(nodes, SugarElement.fromDom);\n        processElements(elems);\n      };\n      walk$2(editor.dom, rng, function (nodes) {\n        finishWrapper();\n        processNodes(nodes);\n      });\n      return newWrappers;\n    };\n    var annotateWithBookmark = function (editor, name, settings, data) {\n      editor.undoManager.transact(function () {\n        var selection = editor.selection;\n        var initialRng = selection.getRng();\n        var hasFakeSelection = getCellsFromEditor(editor).length > 0;\n        if (initialRng.collapsed && !hasFakeSelection) {\n          applyWordGrab(editor, initialRng);\n        }\n        if (selection.getRng().collapsed && !hasFakeSelection) {\n          var wrapper = makeAnnotation(editor.getDoc(), data, name, settings.decorate);\n          set(wrapper, nbsp);\n          selection.getRng().insertNode(wrapper.dom);\n          selection.select(wrapper.dom);\n        } else {\n          preserve(selection, false, function () {\n            runOnRanges(editor, function (selectionRng) {\n              annotate(editor, selectionRng, name, settings.decorate, data);\n            });\n          });\n        }\n      });\n    };\n\n    var Annotator = function (editor) {\n      var registry = create$7();\n      setup$m(editor, registry);\n      var changes = setup$n(editor);\n      return {\n        register: function (name, settings) {\n          registry.register(name, settings);\n        },\n        annotate: function (name, data) {\n          registry.lookup(name).each(function (settings) {\n            annotateWithBookmark(editor, name, settings, data);\n          });\n        },\n        annotationChanged: function (name, callback) {\n          changes.addListener(name, callback);\n        },\n        remove: function (name) {\n          identify(editor, Optional.some(name)).each(function (_a) {\n            var elements = _a.elements;\n            each$k(elements, unwrap);\n          });\n        },\n        getAll: function (name) {\n          var directory = findAll(editor, name);\n          return map$2(directory, function (elems) {\n            return map$3(elems, function (elem) {\n              return elem.dom;\n            });\n          });\n        }\n      };\n    };\n\n    var BookmarkManager = function (selection) {\n      return {\n        getBookmark: curry(getBookmark$1, selection),\n        moveToBookmark: curry(moveToBookmark, selection)\n      };\n    };\n    BookmarkManager.isBookmarkNode = isBookmarkNode$1;\n\n    var getContentEditableRoot$1 = function (root, node) {\n      while (node && node !== root) {\n        if (isContentEditableTrue$4(node) || isContentEditableFalse$b(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n\n    var isXYWithinRange = function (clientX, clientY, range) {\n      if (range.collapsed) {\n        return false;\n      }\n      if (Env.browser.isIE() && range.startOffset === range.endOffset - 1 && range.startContainer === range.endContainer) {\n        var elm = range.startContainer.childNodes[range.startOffset];\n        if (isElement$5(elm)) {\n          return exists(elm.getClientRects(), function (rect) {\n            return containsXY(rect, clientX, clientY);\n          });\n        }\n      }\n      return exists(range.getClientRects(), function (rect) {\n        return containsXY(rect, clientX, clientY);\n      });\n    };\n\n    var firePreProcess = function (editor, args) {\n      return editor.fire('PreProcess', args);\n    };\n    var firePostProcess = function (editor, args) {\n      return editor.fire('PostProcess', args);\n    };\n    var fireRemove = function (editor) {\n      return editor.fire('remove');\n    };\n    var fireDetach = function (editor) {\n      return editor.fire('detach');\n    };\n    var fireSwitchMode = function (editor, mode) {\n      return editor.fire('SwitchMode', { mode: mode });\n    };\n    var fireObjectResizeStart = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResizeStart', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var fireObjectResized = function (editor, target, width, height, origin) {\n      editor.fire('ObjectResized', {\n        target: target,\n        width: width,\n        height: height,\n        origin: origin\n      });\n    };\n    var firePreInit = function (editor) {\n      return editor.fire('PreInit');\n    };\n    var firePostRender = function (editor) {\n      return editor.fire('PostRender');\n    };\n    var fireInit = function (editor) {\n      return editor.fire('Init');\n    };\n    var firePlaceholderToggle = function (editor, state) {\n      return editor.fire('PlaceholderToggle', { state: state });\n    };\n    var fireError = function (editor, errorType, error) {\n      return editor.fire(errorType, error);\n    };\n    var fireFormatApply = function (editor, format, node, vars) {\n      return editor.fire('FormatApply', {\n        format: format,\n        node: node,\n        vars: vars\n      });\n    };\n    var fireFormatRemove = function (editor, format, node, vars) {\n      return editor.fire('FormatRemove', {\n        format: format,\n        node: node,\n        vars: vars\n      });\n    };\n\n    var VK = {\n      BACKSPACE: 8,\n      DELETE: 46,\n      DOWN: 40,\n      ENTER: 13,\n      ESC: 27,\n      LEFT: 37,\n      RIGHT: 39,\n      SPACEBAR: 32,\n      TAB: 9,\n      UP: 38,\n      PAGE_UP: 33,\n      PAGE_DOWN: 34,\n      END: 35,\n      HOME: 36,\n      modifierPressed: function (e) {\n        return e.shiftKey || e.ctrlKey || e.altKey || VK.metaKeyPressed(e);\n      },\n      metaKeyPressed: function (e) {\n        return Env.mac ? e.metaKey : e.ctrlKey && !e.altKey;\n      }\n    };\n\n    var isContentEditableFalse$5 = isContentEditableFalse$b;\n    var ControlSelection = function (selection, editor) {\n      var elementSelectionAttr = 'data-mce-selected';\n      var dom = editor.dom, each = Tools.each;\n      var selectedElm, selectedElmGhost, resizeHelper, selectedHandle, resizeBackdrop;\n      var startX, startY, selectedElmX, selectedElmY, startW, startH, ratio, resizeStarted;\n      var width, height;\n      var editableDoc = editor.getDoc(), rootDocument = document;\n      var abs = Math.abs, round = Math.round, rootElement = editor.getBody();\n      var startScrollWidth, startScrollHeight;\n      var resizeHandles = {\n        nw: [\n          0,\n          0,\n          -1,\n          -1\n        ],\n        ne: [\n          1,\n          0,\n          1,\n          -1\n        ],\n        se: [\n          1,\n          1,\n          1,\n          1\n        ],\n        sw: [\n          0,\n          1,\n          -1,\n          1\n        ]\n      };\n      var isImage = function (elm) {\n        return elm && (elm.nodeName === 'IMG' || editor.dom.is(elm, 'figure.image'));\n      };\n      var isMedia = function (elm) {\n        return isMedia$2(elm) || dom.hasClass(elm, 'mce-preview-object');\n      };\n      var isEventOnImageOutsideRange = function (evt, range) {\n        if (evt.type === 'longpress' || evt.type.indexOf('touch') === 0) {\n          var touch = evt.touches[0];\n          return isImage(evt.target) && !isXYWithinRange(touch.clientX, touch.clientY, range);\n        } else {\n          return isImage(evt.target) && !isXYWithinRange(evt.clientX, evt.clientY, range);\n        }\n      };\n      var contextMenuSelectImage = function (evt) {\n        var target = evt.target;\n        if (isEventOnImageOutsideRange(evt, editor.selection.getRng()) && !evt.isDefaultPrevented()) {\n          editor.selection.select(target);\n        }\n      };\n      var getResizeTargets = function (elm) {\n        if (dom.is(elm, 'figure.image')) {\n          return [elm.querySelector('img')];\n        } else if (dom.hasClass(elm, 'mce-preview-object') && isNonNullable(elm.firstElementChild)) {\n          return [\n            elm,\n            elm.firstElementChild\n          ];\n        } else {\n          return [elm];\n        }\n      };\n      var isResizable = function (elm) {\n        var selector = getObjectResizing(editor);\n        if (!selector) {\n          return false;\n        }\n        if (elm.getAttribute('data-mce-resize') === 'false') {\n          return false;\n        }\n        if (elm === editor.getBody()) {\n          return false;\n        }\n        if (dom.hasClass(elm, 'mce-preview-object')) {\n          return is$2(SugarElement.fromDom(elm.firstElementChild), selector);\n        } else {\n          return is$2(SugarElement.fromDom(elm), selector);\n        }\n      };\n      var createGhostElement = function (elm) {\n        if (isMedia(elm)) {\n          return dom.create('img', { src: Env.transparentSrc });\n        } else {\n          return elm.cloneNode(true);\n        }\n      };\n      var setSizeProp = function (element, name, value) {\n        if (isNonNullable(value)) {\n          var targets = getResizeTargets(element);\n          each$k(targets, function (target) {\n            if (target.style[name] || !editor.schema.isValid(target.nodeName.toLowerCase(), name)) {\n              dom.setStyle(target, name, value);\n            } else {\n              dom.setAttrib(target, name, '' + value);\n            }\n          });\n        }\n      };\n      var setGhostElmSize = function (ghostElm, width, height) {\n        setSizeProp(ghostElm, 'width', width);\n        setSizeProp(ghostElm, 'height', height);\n      };\n      var resizeGhostElement = function (e) {\n        var deltaX, deltaY, proportional;\n        var resizeHelperX, resizeHelperY;\n        deltaX = e.screenX - startX;\n        deltaY = e.screenY - startY;\n        width = deltaX * selectedHandle[2] + startW;\n        height = deltaY * selectedHandle[3] + startH;\n        width = width < 5 ? 5 : width;\n        height = height < 5 ? 5 : height;\n        if ((isImage(selectedElm) || isMedia(selectedElm)) && getResizeImgProportional(editor) !== false) {\n          proportional = !VK.modifierPressed(e);\n        } else {\n          proportional = VK.modifierPressed(e);\n        }\n        if (proportional) {\n          if (abs(deltaX) > abs(deltaY)) {\n            height = round(width * ratio);\n            width = round(height / ratio);\n          } else {\n            width = round(height / ratio);\n            height = round(width * ratio);\n          }\n        }\n        setGhostElmSize(selectedElmGhost, width, height);\n        resizeHelperX = selectedHandle.startPos.x + deltaX;\n        resizeHelperY = selectedHandle.startPos.y + deltaY;\n        resizeHelperX = resizeHelperX > 0 ? resizeHelperX : 0;\n        resizeHelperY = resizeHelperY > 0 ? resizeHelperY : 0;\n        dom.setStyles(resizeHelper, {\n          left: resizeHelperX,\n          top: resizeHelperY,\n          display: 'block'\n        });\n        resizeHelper.innerHTML = width + ' &times; ' + height;\n        if (selectedHandle[2] < 0 && selectedElmGhost.clientWidth <= width) {\n          dom.setStyle(selectedElmGhost, 'left', selectedElmX + (startW - width));\n        }\n        if (selectedHandle[3] < 0 && selectedElmGhost.clientHeight <= height) {\n          dom.setStyle(selectedElmGhost, 'top', selectedElmY + (startH - height));\n        }\n        deltaX = rootElement.scrollWidth - startScrollWidth;\n        deltaY = rootElement.scrollHeight - startScrollHeight;\n        if (deltaX + deltaY !== 0) {\n          dom.setStyles(resizeHelper, {\n            left: resizeHelperX - deltaX,\n            top: resizeHelperY - deltaY\n          });\n        }\n        if (!resizeStarted) {\n          fireObjectResizeStart(editor, selectedElm, startW, startH, 'corner-' + selectedHandle.name);\n          resizeStarted = true;\n        }\n      };\n      var endGhostResize = function () {\n        var wasResizeStarted = resizeStarted;\n        resizeStarted = false;\n        if (wasResizeStarted) {\n          setSizeProp(selectedElm, 'width', width);\n          setSizeProp(selectedElm, 'height', height);\n        }\n        dom.unbind(editableDoc, 'mousemove', resizeGhostElement);\n        dom.unbind(editableDoc, 'mouseup', endGhostResize);\n        if (rootDocument !== editableDoc) {\n          dom.unbind(rootDocument, 'mousemove', resizeGhostElement);\n          dom.unbind(rootDocument, 'mouseup', endGhostResize);\n        }\n        dom.remove(selectedElmGhost);\n        dom.remove(resizeHelper);\n        dom.remove(resizeBackdrop);\n        showResizeRect(selectedElm);\n        if (wasResizeStarted) {\n          fireObjectResized(editor, selectedElm, width, height, 'corner-' + selectedHandle.name);\n          dom.setAttrib(selectedElm, 'style', dom.getAttrib(selectedElm, 'style'));\n        }\n        editor.nodeChanged();\n      };\n      var showResizeRect = function (targetElm) {\n        unbindResizeHandleEvents();\n        var position = dom.getPos(targetElm, rootElement);\n        var selectedElmX = position.x;\n        var selectedElmY = position.y;\n        var rect = targetElm.getBoundingClientRect();\n        var targetWidth = rect.width || rect.right - rect.left;\n        var targetHeight = rect.height || rect.bottom - rect.top;\n        if (selectedElm !== targetElm) {\n          hideResizeRect();\n          selectedElm = targetElm;\n          width = height = 0;\n        }\n        var e = editor.fire('ObjectSelected', { target: targetElm });\n        var selectedValue = dom.getAttrib(selectedElm, elementSelectionAttr, '1');\n        if (isResizable(targetElm) && !e.isDefaultPrevented()) {\n          each(resizeHandles, function (handle, name) {\n            var handleElm;\n            var startDrag = function (e) {\n              var target = getResizeTargets(selectedElm)[0];\n              startX = e.screenX;\n              startY = e.screenY;\n              startW = target.clientWidth;\n              startH = target.clientHeight;\n              ratio = startH / startW;\n              selectedHandle = handle;\n              selectedHandle.name = name;\n              selectedHandle.startPos = {\n                x: targetWidth * handle[0] + selectedElmX,\n                y: targetHeight * handle[1] + selectedElmY\n              };\n              startScrollWidth = rootElement.scrollWidth;\n              startScrollHeight = rootElement.scrollHeight;\n              resizeBackdrop = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-backdrop',\n                'data-mce-bogus': 'all'\n              });\n              dom.setStyles(resizeBackdrop, {\n                position: 'fixed',\n                left: '0',\n                top: '0',\n                width: '100%',\n                height: '100%'\n              });\n              selectedElmGhost = createGhostElement(selectedElm);\n              dom.addClass(selectedElmGhost, 'mce-clonedresizable');\n              dom.setAttrib(selectedElmGhost, 'data-mce-bogus', 'all');\n              selectedElmGhost.contentEditable = 'false';\n              dom.setStyles(selectedElmGhost, {\n                left: selectedElmX,\n                top: selectedElmY,\n                margin: 0\n              });\n              setGhostElmSize(selectedElmGhost, targetWidth, targetHeight);\n              selectedElmGhost.removeAttribute(elementSelectionAttr);\n              rootElement.appendChild(selectedElmGhost);\n              dom.bind(editableDoc, 'mousemove', resizeGhostElement);\n              dom.bind(editableDoc, 'mouseup', endGhostResize);\n              if (rootDocument !== editableDoc) {\n                dom.bind(rootDocument, 'mousemove', resizeGhostElement);\n                dom.bind(rootDocument, 'mouseup', endGhostResize);\n              }\n              resizeHelper = dom.add(rootElement, 'div', {\n                'class': 'mce-resize-helper',\n                'data-mce-bogus': 'all'\n              }, startW + ' &times; ' + startH);\n            };\n            handleElm = dom.get('mceResizeHandle' + name);\n            if (handleElm) {\n              dom.remove(handleElm);\n            }\n            handleElm = dom.add(rootElement, 'div', {\n              'id': 'mceResizeHandle' + name,\n              'data-mce-bogus': 'all',\n              'class': 'mce-resizehandle',\n              'unselectable': true,\n              'style': 'cursor:' + name + '-resize; margin:0; padding:0'\n            });\n            if (Env.ie === 11) {\n              handleElm.contentEditable = false;\n            }\n            dom.bind(handleElm, 'mousedown', function (e) {\n              e.stopImmediatePropagation();\n              e.preventDefault();\n              startDrag(e);\n            });\n            handle.elm = handleElm;\n            dom.setStyles(handleElm, {\n              left: targetWidth * handle[0] + selectedElmX - handleElm.offsetWidth / 2,\n              top: targetHeight * handle[1] + selectedElmY - handleElm.offsetHeight / 2\n            });\n          });\n        } else {\n          hideResizeRect();\n        }\n        if (!dom.getAttrib(selectedElm, elementSelectionAttr)) {\n          selectedElm.setAttribute(elementSelectionAttr, selectedValue);\n        }\n      };\n      var hideResizeRect = function () {\n        unbindResizeHandleEvents();\n        if (selectedElm) {\n          selectedElm.removeAttribute(elementSelectionAttr);\n        }\n        each$j(resizeHandles, function (value, name) {\n          var handleElm = dom.get('mceResizeHandle' + name);\n          if (handleElm) {\n            dom.unbind(handleElm);\n            dom.remove(handleElm);\n          }\n        });\n      };\n      var updateResizeRect = function (e) {\n        var startElm, controlElm;\n        var isChildOrEqual = function (node, parent) {\n          if (node) {\n            do {\n              if (node === parent) {\n                return true;\n              }\n            } while (node = node.parentNode);\n          }\n        };\n        if (resizeStarted || editor.removed) {\n          return;\n        }\n        each(dom.select('img[data-mce-selected],hr[data-mce-selected]'), function (img) {\n          img.removeAttribute(elementSelectionAttr);\n        });\n        controlElm = e.type === 'mousedown' ? e.target : selection.getNode();\n        controlElm = dom.$(controlElm).closest('table,img,figure.image,hr,video,span.mce-preview-object')[0];\n        if (isChildOrEqual(controlElm, rootElement)) {\n          disableGeckoResize();\n          startElm = selection.getStart(true);\n          if (isChildOrEqual(startElm, controlElm) && isChildOrEqual(selection.getEnd(true), controlElm)) {\n            showResizeRect(controlElm);\n            return;\n          }\n        }\n        hideResizeRect();\n      };\n      var isWithinContentEditableFalse = function (elm) {\n        return isContentEditableFalse$5(getContentEditableRoot$1(editor.getBody(), elm));\n      };\n      var unbindResizeHandleEvents = function () {\n        each$j(resizeHandles, function (handle) {\n          if (handle.elm) {\n            dom.unbind(handle.elm);\n            delete handle.elm;\n          }\n        });\n      };\n      var disableGeckoResize = function () {\n        try {\n          editor.getDoc().execCommand('enableObjectResizing', false, 'false');\n        } catch (ex) {\n        }\n      };\n      editor.on('init', function () {\n        disableGeckoResize();\n        if (Env.browser.isIE() || Env.browser.isEdge()) {\n          editor.on('mousedown click', function (e) {\n            var target = e.target, nodeName = target.nodeName;\n            if (!resizeStarted && /^(TABLE|IMG|HR)$/.test(nodeName) && !isWithinContentEditableFalse(target)) {\n              if (e.button !== 2) {\n                editor.selection.select(target, nodeName === 'TABLE');\n              }\n              if (e.type === 'mousedown') {\n                editor.nodeChanged();\n              }\n            }\n          });\n          var handleMSControlSelect_1 = function (e) {\n            var delayedSelect = function (node) {\n              Delay.setEditorTimeout(editor, function () {\n                return editor.selection.select(node);\n              });\n            };\n            if (isWithinContentEditableFalse(e.target) || isMedia$2(e.target)) {\n              e.preventDefault();\n              delayedSelect(e.target);\n              return;\n            }\n            if (/^(TABLE|IMG|HR)$/.test(e.target.nodeName)) {\n              e.preventDefault();\n              if (e.target.tagName === 'IMG') {\n                delayedSelect(e.target);\n              }\n            }\n          };\n          dom.bind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          editor.on('remove', function () {\n            return dom.unbind(rootElement, 'mscontrolselect', handleMSControlSelect_1);\n          });\n        }\n        var throttledUpdateResizeRect = Delay.throttle(function (e) {\n          if (!editor.composing) {\n            updateResizeRect(e);\n          }\n        });\n        editor.on('nodechange ResizeEditor ResizeWindow ResizeContent drop FullscreenStateChanged', throttledUpdateResizeRect);\n        editor.on('keyup compositionend', function (e) {\n          if (selectedElm && selectedElm.nodeName === 'TABLE') {\n            throttledUpdateResizeRect(e);\n          }\n        });\n        editor.on('hide blur', hideResizeRect);\n        editor.on('contextmenu longpress', contextMenuSelectImage, true);\n      });\n      editor.on('remove', unbindResizeHandleEvents);\n      var destroy = function () {\n        selectedElm = selectedElmGhost = resizeBackdrop = null;\n      };\n      return {\n        isResizable: isResizable,\n        showResizeRect: showResizeRect,\n        hideResizeRect: hideResizeRect,\n        updateResizeRect: updateResizeRect,\n        destroy: destroy\n      };\n    };\n\n    var hasCeProperty = function (node) {\n      return isContentEditableTrue$4(node) || isContentEditableFalse$b(node);\n    };\n    var findParent$1 = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var findClosestIeRange = function (clientX, clientY, doc) {\n      var rects;\n      var element = doc.elementFromPoint(clientX, clientY);\n      var rng = doc.body.createTextRange();\n      if (!element || element.tagName === 'HTML') {\n        element = doc.body;\n      }\n      rng.moveToElementText(element);\n      rects = Tools.toArray(rng.getClientRects());\n      rects = rects.sort(function (a, b) {\n        a = Math.abs(Math.max(a.top - clientY, a.bottom - clientY));\n        b = Math.abs(Math.max(b.top - clientY, b.bottom - clientY));\n        return a - b;\n      });\n      if (rects.length > 0) {\n        clientY = (rects[0].bottom + rects[0].top) / 2;\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n          return rng;\n        } catch (ex) {\n        }\n      }\n      return null;\n    };\n    var moveOutOfContentEditableFalse = function (rng, rootNode) {\n      var parentElement = rng && rng.parentElement ? rng.parentElement() : null;\n      return isContentEditableFalse$b(findParent$1(parentElement, rootNode, hasCeProperty)) ? null : rng;\n    };\n    var fromPoint = function (clientX, clientY, doc) {\n      var rng, point;\n      var pointDoc = doc;\n      if (pointDoc.caretPositionFromPoint) {\n        point = pointDoc.caretPositionFromPoint(clientX, clientY);\n        if (point) {\n          rng = doc.createRange();\n          rng.setStart(point.offsetNode, point.offset);\n          rng.collapse(true);\n        }\n      } else if (pointDoc.caretRangeFromPoint) {\n        rng = pointDoc.caretRangeFromPoint(clientX, clientY);\n      } else if (pointDoc.body.createTextRange) {\n        rng = pointDoc.body.createTextRange();\n        try {\n          rng.moveToPoint(clientX, clientY);\n          rng.collapse(true);\n        } catch (ex) {\n          rng = findClosestIeRange(clientX, clientY, doc);\n        }\n        return moveOutOfContentEditableFalse(rng, doc.body);\n      }\n      return rng;\n    };\n\n    var isEq$4 = function (rng1, rng2) {\n      return rng1 && rng2 && (rng1.startContainer === rng2.startContainer && rng1.startOffset === rng2.startOffset) && (rng1.endContainer === rng2.endContainer && rng1.endOffset === rng2.endOffset);\n    };\n\n    var findParent = function (node, rootNode, predicate) {\n      while (node && node !== rootNode) {\n        if (predicate(node)) {\n          return node;\n        }\n        node = node.parentNode;\n      }\n      return null;\n    };\n    var hasParent$1 = function (node, rootNode, predicate) {\n      return findParent(node, rootNode, predicate) !== null;\n    };\n    var hasParentWithName = function (node, rootNode, name) {\n      return hasParent$1(node, rootNode, function (node) {\n        return node.nodeName === name;\n      });\n    };\n    var isTable = function (node) {\n      return node && node.nodeName === 'TABLE';\n    };\n    var isTableCell$2 = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var isCeFalseCaretContainer = function (node, rootNode) {\n      return isCaretContainer$2(node) && hasParent$1(node, rootNode, isCaretNode) === false;\n    };\n    var hasBrBeforeAfter = function (dom, node, left) {\n      var walker = new DomTreeWalker(node, dom.getParent(node.parentNode, dom.isBlock) || dom.getRoot());\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (isBr$5(node)) {\n          return true;\n        }\n      }\n    };\n    var isPrevNode = function (node, name) {\n      return node.previousSibling && node.previousSibling.nodeName === name;\n    };\n    var hasContentEditableFalseParent = function (body, node) {\n      while (node && node !== body) {\n        if (isContentEditableFalse$b(node)) {\n          return true;\n        }\n        node = node.parentNode;\n      }\n      return false;\n    };\n    var findTextNodeRelative = function (dom, isAfterNode, collapsed, left, startNode) {\n      var lastInlineElement;\n      var body = dom.getRoot();\n      var node;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      var parentBlockContainer = dom.getParent(startNode.parentNode, dom.isBlock) || body;\n      if (left && isBr$5(startNode) && isAfterNode && dom.isEmpty(parentBlockContainer)) {\n        return Optional.some(CaretPosition(startNode.parentNode, dom.nodeIndex(startNode)));\n      }\n      var walker = new DomTreeWalker(startNode, parentBlockContainer);\n      while (node = walker[left ? 'prev' : 'next']()) {\n        if (dom.getContentEditableParent(node) === 'false' || isCeFalseCaretContainer(node, body)) {\n          return Optional.none();\n        }\n        if (isText$7(node) && node.nodeValue.length > 0) {\n          if (hasParentWithName(node, body, 'A') === false) {\n            return Optional.some(CaretPosition(node, left ? node.nodeValue.length : 0));\n          }\n          return Optional.none();\n        }\n        if (dom.isBlock(node) || nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          return Optional.none();\n        }\n        lastInlineElement = node;\n      }\n      if (collapsed && lastInlineElement) {\n        return Optional.some(CaretPosition(lastInlineElement, 0));\n      }\n      return Optional.none();\n    };\n    var normalizeEndPoint = function (dom, collapsed, start, rng) {\n      var container, offset;\n      var body = dom.getRoot();\n      var node;\n      var directionLeft, normalized = false;\n      container = rng[(start ? 'start' : 'end') + 'Container'];\n      offset = rng[(start ? 'start' : 'end') + 'Offset'];\n      var isAfterNode = isElement$5(container) && offset === container.childNodes.length;\n      var nonEmptyElementsMap = dom.schema.getNonEmptyElements();\n      directionLeft = start;\n      if (isCaretContainer$2(container)) {\n        return Optional.none();\n      }\n      if (isElement$5(container) && offset > container.childNodes.length - 1) {\n        directionLeft = false;\n      }\n      if (isDocument$1(container)) {\n        container = body;\n        offset = 0;\n      }\n      if (container === body) {\n        if (directionLeft) {\n          node = container.childNodes[offset > 0 ? offset - 1 : 0];\n          if (node) {\n            if (isCaretContainer$2(node)) {\n              return Optional.none();\n            }\n            if (nonEmptyElementsMap[node.nodeName] || isTable(node)) {\n              return Optional.none();\n            }\n          }\n        }\n        if (container.hasChildNodes()) {\n          offset = Math.min(!directionLeft && offset > 0 ? offset - 1 : offset, container.childNodes.length - 1);\n          container = container.childNodes[offset];\n          offset = isText$7(container) && isAfterNode ? container.data.length : 0;\n          if (!collapsed && container === body.lastChild && isTable(container)) {\n            return Optional.none();\n          }\n          if (hasContentEditableFalseParent(body, container) || isCaretContainer$2(container)) {\n            return Optional.none();\n          }\n          if (container.hasChildNodes() && isTable(container) === false) {\n            node = container;\n            var walker = new DomTreeWalker(container, body);\n            do {\n              if (isContentEditableFalse$b(node) || isCaretContainer$2(node)) {\n                normalized = false;\n                break;\n              }\n              if (isText$7(node) && node.nodeValue.length > 0) {\n                offset = directionLeft ? 0 : node.nodeValue.length;\n                container = node;\n                normalized = true;\n                break;\n              }\n              if (nonEmptyElementsMap[node.nodeName.toLowerCase()] && !isTableCell$2(node)) {\n                offset = dom.nodeIndex(node);\n                container = node.parentNode;\n                if (!directionLeft) {\n                  offset++;\n                }\n                normalized = true;\n                break;\n              }\n            } while (node = directionLeft ? walker.next() : walker.prev());\n          }\n        }\n      }\n      if (collapsed) {\n        if (isText$7(container) && offset === 0) {\n          findTextNodeRelative(dom, isAfterNode, collapsed, true, container).each(function (pos) {\n            container = pos.container();\n            offset = pos.offset();\n            normalized = true;\n          });\n        }\n        if (isElement$5(container)) {\n          node = container.childNodes[offset];\n          if (!node) {\n            node = container.childNodes[offset - 1];\n          }\n          if (node && isBr$5(node) && !isPrevNode(node, 'A') && !hasBrBeforeAfter(dom, node, false) && !hasBrBeforeAfter(dom, node, true)) {\n            findTextNodeRelative(dom, isAfterNode, collapsed, true, node).each(function (pos) {\n              container = pos.container();\n              offset = pos.offset();\n              normalized = true;\n            });\n          }\n        }\n      }\n      if (directionLeft && !collapsed && isText$7(container) && offset === container.nodeValue.length) {\n        findTextNodeRelative(dom, isAfterNode, collapsed, false, container).each(function (pos) {\n          container = pos.container();\n          offset = pos.offset();\n          normalized = true;\n        });\n      }\n      return normalized ? Optional.some(CaretPosition(container, offset)) : Optional.none();\n    };\n    var normalize$2 = function (dom, rng) {\n      var collapsed = rng.collapsed, normRng = rng.cloneRange();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      normalizeEndPoint(dom, collapsed, true, normRng).each(function (pos) {\n        if (!collapsed || !CaretPosition.isAbove(startPos, pos)) {\n          normRng.setStart(pos.container(), pos.offset());\n        }\n      });\n      if (!collapsed) {\n        normalizeEndPoint(dom, collapsed, false, normRng).each(function (pos) {\n          normRng.setEnd(pos.container(), pos.offset());\n        });\n      }\n      if (collapsed) {\n        normRng.collapse(true);\n      }\n      return isEq$4(rng, normRng) ? Optional.none() : Optional.some(normRng);\n    };\n\n    var splitText = function (node, offset) {\n      return node.splitText(offset);\n    };\n    var split = function (rng) {\n      var startContainer = rng.startContainer, startOffset = rng.startOffset, endContainer = rng.endContainer, endOffset = rng.endOffset;\n      if (startContainer === endContainer && isText$7(startContainer)) {\n        if (startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          endContainer = splitText(startContainer, startOffset);\n          startContainer = endContainer.previousSibling;\n          if (endOffset > startOffset) {\n            endOffset = endOffset - startOffset;\n            startContainer = endContainer = splitText(endContainer, endOffset).previousSibling;\n            endOffset = endContainer.nodeValue.length;\n            startOffset = 0;\n          } else {\n            endOffset = 0;\n          }\n        }\n      } else {\n        if (isText$7(startContainer) && startOffset > 0 && startOffset < startContainer.nodeValue.length) {\n          startContainer = splitText(startContainer, startOffset);\n          startOffset = 0;\n        }\n        if (isText$7(endContainer) && endOffset > 0 && endOffset < endContainer.nodeValue.length) {\n          endContainer = splitText(endContainer, endOffset).previousSibling;\n          endOffset = endContainer.nodeValue.length;\n        }\n      }\n      return {\n        startContainer: startContainer,\n        startOffset: startOffset,\n        endContainer: endContainer,\n        endOffset: endOffset\n      };\n    };\n\n    var RangeUtils = function (dom) {\n      var walk = function (rng, callback) {\n        return walk$2(dom, rng, callback);\n      };\n      var split$1 = split;\n      var normalize = function (rng) {\n        return normalize$2(dom, rng).fold(never, function (normalizedRng) {\n          rng.setStart(normalizedRng.startContainer, normalizedRng.startOffset);\n          rng.setEnd(normalizedRng.endContainer, normalizedRng.endOffset);\n          return true;\n        });\n      };\n      return {\n        walk: walk,\n        split: split$1,\n        normalize: normalize\n      };\n    };\n    RangeUtils.compareRanges = isEq$4;\n    RangeUtils.getCaretRangeFromPoint = fromPoint;\n    RangeUtils.getSelectedNode = getSelectedNode;\n    RangeUtils.getNode = getNode$1;\n\n    var Dimension = function (name, getOffset) {\n      var set = function (element, h) {\n        if (!isNumber(h) && !h.match(/^[0-9]+$/)) {\n          throw new Error(name + '.set accepts only positive integer values. Value was ' + h);\n        }\n        var dom = element.dom;\n        if (isSupported(dom)) {\n          dom.style[name] = h + 'px';\n        }\n      };\n      var get = function (element) {\n        var r = getOffset(element);\n        if (r <= 0 || r === null) {\n          var css = get$5(element, name);\n          return parseFloat(css) || 0;\n        }\n        return r;\n      };\n      var getOuter = get;\n      var aggregate = function (element, properties) {\n        return foldl(properties, function (acc, property) {\n          var val = get$5(element, property);\n          var value = val === undefined ? 0 : parseInt(val, 10);\n          return isNaN(value) ? acc : acc + value;\n        }, 0);\n      };\n      var max = function (element, value, properties) {\n        var cumulativeInclusions = aggregate(element, properties);\n        var absoluteMax = value > cumulativeInclusions ? value - cumulativeInclusions : 0;\n        return absoluteMax;\n      };\n      return {\n        set: set,\n        get: get,\n        getOuter: getOuter,\n        aggregate: aggregate,\n        max: max\n      };\n    };\n\n    var api = Dimension('height', function (element) {\n      var dom = element.dom;\n      return inBody(element) ? dom.getBoundingClientRect().height : dom.offsetHeight;\n    });\n    var get$1 = function (element) {\n      return api.get(element);\n    };\n\n    var walkUp = function (navigation, doc) {\n      var frame = navigation.view(doc);\n      return frame.fold(constant([]), function (f) {\n        var parent = navigation.owner(f);\n        var rest = walkUp(navigation, parent);\n        return [f].concat(rest);\n      });\n    };\n    var pathTo = function (element, navigation) {\n      var d = navigation.owner(element);\n      return walkUp(navigation, d);\n    };\n\n    var view = function (doc) {\n      var _a;\n      var element = doc.dom === document ? Optional.none() : Optional.from((_a = doc.dom.defaultView) === null || _a === void 0 ? void 0 : _a.frameElement);\n      return element.map(SugarElement.fromDom);\n    };\n    var owner = function (element) {\n      return documentOrOwner(element);\n    };\n\n    var Navigation = /*#__PURE__*/Object.freeze({\n        __proto__: null,\n        view: view,\n        owner: owner\n    });\n\n    var find$1 = function (element) {\n      var doc = SugarElement.fromDom(document);\n      var scroll = get$8(doc);\n      var frames = pathTo(element, Navigation);\n      var offset = viewport(element);\n      var r = foldr(frames, function (b, a) {\n        var loc = viewport(a);\n        return {\n          left: b.left + loc.left,\n          top: b.top + loc.top\n        };\n      }, {\n        left: 0,\n        top: 0\n      });\n      return SugarPosition(r.left + offset.left + scroll.left, r.top + offset.top + scroll.top);\n    };\n\n    var excludeFromDescend = function (element) {\n      return name(element) === 'textarea';\n    };\n    var fireScrollIntoViewEvent = function (editor, data) {\n      var scrollEvent = editor.fire('ScrollIntoView', data);\n      return scrollEvent.isDefaultPrevented();\n    };\n    var fireAfterScrollIntoViewEvent = function (editor, data) {\n      editor.fire('AfterScrollIntoView', data);\n    };\n    var descend = function (element, offset) {\n      var children$1 = children(element);\n      if (children$1.length === 0 || excludeFromDescend(element)) {\n        return {\n          element: element,\n          offset: offset\n        };\n      } else if (offset < children$1.length && !excludeFromDescend(children$1[offset])) {\n        return {\n          element: children$1[offset],\n          offset: 0\n        };\n      } else {\n        var last = children$1[children$1.length - 1];\n        if (excludeFromDescend(last)) {\n          return {\n            element: element,\n            offset: offset\n          };\n        } else {\n          if (name(last) === 'img') {\n            return {\n              element: last,\n              offset: 1\n            };\n          } else if (isText$8(last)) {\n            return {\n              element: last,\n              offset: get$2(last).length\n            };\n          } else {\n            return {\n              element: last,\n              offset: children(last).length\n            };\n          }\n        }\n      }\n    };\n    var markerInfo = function (element, cleanupFun) {\n      var pos = absolute(element);\n      var height = get$1(element);\n      return {\n        element: element,\n        bottom: pos.top + height,\n        height: height,\n        pos: pos,\n        cleanup: cleanupFun\n      };\n    };\n    var createMarker = function (element, offset) {\n      var startPoint = descend(element, offset);\n      var span = SugarElement.fromHtml('<span data-mce-bogus=\"all\" style=\"display: inline-block;\">' + ZWSP$1 + '</span>');\n      before$4(startPoint.element, span);\n      return markerInfo(span, function () {\n        return remove$7(span);\n      });\n    };\n    var elementMarker = function (element) {\n      return markerInfo(SugarElement.fromDom(element), noop);\n    };\n    var withMarker = function (editor, f, rng, alignToTop) {\n      preserveWith(editor, function (_s, _e) {\n        return applyWithMarker(editor, f, rng, alignToTop);\n      }, rng);\n    };\n    var withScrollEvents = function (editor, doc, f, marker, alignToTop) {\n      var data = {\n        elm: marker.element.dom,\n        alignToTop: alignToTop\n      };\n      if (fireScrollIntoViewEvent(editor, data)) {\n        return;\n      }\n      var scrollTop = get$8(doc).top;\n      f(doc, scrollTop, marker, alignToTop);\n      fireAfterScrollIntoViewEvent(editor, data);\n    };\n    var applyWithMarker = function (editor, f, rng, alignToTop) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var doc = SugarElement.fromDom(editor.getDoc());\n      reflow(body);\n      var marker = createMarker(SugarElement.fromDom(rng.startContainer), rng.startOffset);\n      withScrollEvents(editor, doc, f, marker, alignToTop);\n      marker.cleanup();\n    };\n    var withElement = function (editor, element, f, alignToTop) {\n      var doc = SugarElement.fromDom(editor.getDoc());\n      withScrollEvents(editor, doc, f, elementMarker(element), alignToTop);\n    };\n    var preserveWith = function (editor, f, rng) {\n      var startElement = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endElement = rng.endContainer;\n      var endOffset = rng.endOffset;\n      f(SugarElement.fromDom(startElement), SugarElement.fromDom(endElement));\n      var newRng = editor.dom.createRng();\n      newRng.setStart(startElement, startOffset);\n      newRng.setEnd(endElement, endOffset);\n      editor.selection.setRng(rng);\n    };\n    var scrollToMarker = function (marker, viewHeight, alignToTop, doc) {\n      var pos = marker.pos;\n      if (alignToTop) {\n        to(pos.left, pos.top, doc);\n      } else {\n        var y = pos.top - viewHeight + marker.height;\n        to(pos.left, y, doc);\n      }\n    };\n    var intoWindowIfNeeded = function (doc, scrollTop, viewHeight, marker, alignToTop) {\n      var viewportBottom = viewHeight + scrollTop;\n      var markerTop = marker.pos.top;\n      var markerBottom = marker.bottom;\n      var largerThanViewport = markerBottom - markerTop >= viewHeight;\n      if (markerTop < scrollTop) {\n        scrollToMarker(marker, viewHeight, alignToTop !== false, doc);\n      } else if (markerTop > viewportBottom) {\n        var align = largerThanViewport ? alignToTop !== false : alignToTop === true;\n        scrollToMarker(marker, viewHeight, align, doc);\n      } else if (markerBottom > viewportBottom && !largerThanViewport) {\n        scrollToMarker(marker, viewHeight, alignToTop === true, doc);\n      }\n    };\n    var intoWindow = function (doc, scrollTop, marker, alignToTop) {\n      var viewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, viewHeight, marker, alignToTop);\n    };\n    var intoFrame = function (doc, scrollTop, marker, alignToTop) {\n      var frameViewHeight = doc.dom.defaultView.innerHeight;\n      intoWindowIfNeeded(doc, scrollTop, frameViewHeight, marker, alignToTop);\n      var op = find$1(marker.element);\n      var viewportBounds = getBounds(window);\n      if (op.top < viewportBounds.y) {\n        intoView(marker.element, alignToTop !== false);\n      } else if (op.top > viewportBounds.bottom) {\n        intoView(marker.element, alignToTop === true);\n      }\n    };\n    var rangeIntoWindow = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoWindow, rng, alignToTop);\n    };\n    var elementIntoWindow = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoWindow, alignToTop);\n    };\n    var rangeIntoFrame = function (editor, rng, alignToTop) {\n      return withMarker(editor, intoFrame, rng, alignToTop);\n    };\n    var elementIntoFrame = function (editor, element, alignToTop) {\n      return withElement(editor, element, intoFrame, alignToTop);\n    };\n    var scrollElementIntoView = function (editor, element, alignToTop) {\n      var scroller = editor.inline ? elementIntoWindow : elementIntoFrame;\n      scroller(editor, element, alignToTop);\n    };\n    var scrollRangeIntoView = function (editor, rng, alignToTop) {\n      var scroller = editor.inline ? rangeIntoWindow : rangeIntoFrame;\n      scroller(editor, rng, alignToTop);\n    };\n\n    var getDocument = function () {\n      return SugarElement.fromDom(document);\n    };\n\n    var focus$1 = function (element) {\n      return element.dom.focus();\n    };\n    var hasFocus$1 = function (element) {\n      var root = getRootNode(element).dom;\n      return element.dom === root.activeElement;\n    };\n    var active = function (root) {\n      if (root === void 0) {\n        root = getDocument();\n      }\n      return Optional.from(root.dom.activeElement).map(SugarElement.fromDom);\n    };\n    var search = function (element) {\n      return active(getRootNode(element)).filter(function (e) {\n        return element.dom.contains(e.dom);\n      });\n    };\n\n    var create$5 = function (start, soffset, finish, foffset) {\n      return {\n        start: start,\n        soffset: soffset,\n        finish: finish,\n        foffset: foffset\n      };\n    };\n    var SimRange = { create: create$5 };\n\n    var adt$1 = Adt.generate([\n      { before: ['element'] },\n      {\n        on: [\n          'element',\n          'offset'\n        ]\n      },\n      { after: ['element'] }\n    ]);\n    var cata = function (subject, onBefore, onOn, onAfter) {\n      return subject.fold(onBefore, onOn, onAfter);\n    };\n    var getStart$2 = function (situ) {\n      return situ.fold(identity, identity, identity);\n    };\n    var before$1 = adt$1.before;\n    var on = adt$1.on;\n    var after$1 = adt$1.after;\n    var Situ = {\n      before: before$1,\n      on: on,\n      after: after$1,\n      cata: cata,\n      getStart: getStart$2\n    };\n\n    var adt = Adt.generate([\n      { domRange: ['rng'] },\n      {\n        relative: [\n          'startSitu',\n          'finishSitu'\n        ]\n      },\n      {\n        exact: [\n          'start',\n          'soffset',\n          'finish',\n          'foffset'\n        ]\n      }\n    ]);\n    var exactFromRange = function (simRange) {\n      return adt.exact(simRange.start, simRange.soffset, simRange.finish, simRange.foffset);\n    };\n    var getStart$1 = function (selection) {\n      return selection.match({\n        domRange: function (rng) {\n          return SugarElement.fromDom(rng.startContainer);\n        },\n        relative: function (startSitu, _finishSitu) {\n          return Situ.getStart(startSitu);\n        },\n        exact: function (start, _soffset, _finish, _foffset) {\n          return start;\n        }\n      });\n    };\n    var domRange = adt.domRange;\n    var relative = adt.relative;\n    var exact = adt.exact;\n    var getWin = function (selection) {\n      var start = getStart$1(selection);\n      return defaultView(start);\n    };\n    var range = SimRange.create;\n    var SimSelection = {\n      domRange: domRange,\n      relative: relative,\n      exact: exact,\n      exactFromRange: exactFromRange,\n      getWin: getWin,\n      range: range\n    };\n\n    var browser$1 = detect().browser;\n    var clamp$1 = function (offset, element) {\n      var max = isText$8(element) ? get$2(element).length : children(element).length + 1;\n      if (offset > max) {\n        return max;\n      } else if (offset < 0) {\n        return 0;\n      }\n      return offset;\n    };\n    var normalizeRng = function (rng) {\n      return SimSelection.range(rng.start, clamp$1(rng.soffset, rng.start), rng.finish, clamp$1(rng.foffset, rng.finish));\n    };\n    var isOrContains = function (root, elm) {\n      return !isRestrictedNode(elm.dom) && (contains$1(root, elm) || eq(root, elm));\n    };\n    var isRngInRoot = function (root) {\n      return function (rng) {\n        return isOrContains(root, rng.start) && isOrContains(root, rng.finish);\n      };\n    };\n    var shouldStore = function (editor) {\n      return editor.inline === true || browser$1.isIE();\n    };\n    var nativeRangeToSelectionRange = function (r) {\n      return SimSelection.range(SugarElement.fromDom(r.startContainer), r.startOffset, SugarElement.fromDom(r.endContainer), r.endOffset);\n    };\n    var readRange = function (win) {\n      var selection = win.getSelection();\n      var rng = !selection || selection.rangeCount === 0 ? Optional.none() : Optional.from(selection.getRangeAt(0));\n      return rng.map(nativeRangeToSelectionRange);\n    };\n    var getBookmark = function (root) {\n      var win = defaultView(root);\n      return readRange(win.dom).filter(isRngInRoot(root));\n    };\n    var validate = function (root, bookmark) {\n      return Optional.from(bookmark).filter(isRngInRoot(root)).map(normalizeRng);\n    };\n    var bookmarkToNativeRng = function (bookmark) {\n      var rng = document.createRange();\n      try {\n        rng.setStart(bookmark.start.dom, bookmark.soffset);\n        rng.setEnd(bookmark.finish.dom, bookmark.foffset);\n        return Optional.some(rng);\n      } catch (_) {\n        return Optional.none();\n      }\n    };\n    var store = function (editor) {\n      var newBookmark = shouldStore(editor) ? getBookmark(SugarElement.fromDom(editor.getBody())) : Optional.none();\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var storeNative = function (editor, rng) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var range = shouldStore(editor) ? Optional.from(rng) : Optional.none();\n      var newBookmark = range.map(nativeRangeToSelectionRange).filter(isRngInRoot(root));\n      editor.bookmark = newBookmark.isSome() ? newBookmark : editor.bookmark;\n    };\n    var getRng = function (editor) {\n      var bookmark = editor.bookmark ? editor.bookmark : Optional.none();\n      return bookmark.bind(function (x) {\n        return validate(SugarElement.fromDom(editor.getBody()), x);\n      }).bind(bookmarkToNativeRng);\n    };\n    var restore = function (editor) {\n      getRng(editor).each(function (rng) {\n        return editor.selection.setRng(rng);\n      });\n    };\n\n    var isEditorUIElement$1 = function (elm) {\n      var className = elm.className.toString();\n      return className.indexOf('tox-') !== -1 || className.indexOf('mce-') !== -1;\n    };\n    var FocusManager = { isEditorUIElement: isEditorUIElement$1 };\n\n    var isManualNodeChange = function (e) {\n      return e.type === 'nodechange' && e.selectionChange;\n    };\n    var registerPageMouseUp = function (editor, throttledStore) {\n      var mouseUpPage = function () {\n        throttledStore.throttle();\n      };\n      DOMUtils.DOM.bind(document, 'mouseup', mouseUpPage);\n      editor.on('remove', function () {\n        DOMUtils.DOM.unbind(document, 'mouseup', mouseUpPage);\n      });\n    };\n    var registerFocusOut = function (editor) {\n      editor.on('focusout', function () {\n        store(editor);\n      });\n    };\n    var registerMouseUp = function (editor, throttledStore) {\n      editor.on('mouseup touchend', function (_e) {\n        throttledStore.throttle();\n      });\n    };\n    var registerEditorEvents = function (editor, throttledStore) {\n      var browser = detect().browser;\n      if (browser.isIE()) {\n        registerFocusOut(editor);\n      } else {\n        registerMouseUp(editor, throttledStore);\n      }\n      editor.on('keyup NodeChange', function (e) {\n        if (!isManualNodeChange(e)) {\n          store(editor);\n        }\n      });\n    };\n    var register$3 = function (editor) {\n      var throttledStore = first(function () {\n        store(editor);\n      }, 0);\n      editor.on('init', function () {\n        if (editor.inline) {\n          registerPageMouseUp(editor, throttledStore);\n        }\n        registerEditorEvents(editor, throttledStore);\n      });\n      editor.on('remove', function () {\n        throttledStore.cancel();\n      });\n    };\n\n    var documentFocusInHandler;\n    var DOM$8 = DOMUtils.DOM;\n    var isEditorUIElement = function (elm) {\n      return FocusManager.isEditorUIElement(elm);\n    };\n    var isEditorContentAreaElement = function (elm) {\n      var classList = elm.classList;\n      if (classList !== undefined) {\n        return classList.contains('tox-edit-area') || classList.contains('tox-edit-area__iframe') || classList.contains('mce-content-body');\n      } else {\n        return false;\n      }\n    };\n    var isUIElement = function (editor, elm) {\n      var customSelector = getCustomUiSelector(editor);\n      var parent = DOM$8.getParent(elm, function (elm) {\n        return isEditorUIElement(elm) || (customSelector ? editor.dom.is(elm, customSelector) : false);\n      });\n      return parent !== null;\n    };\n    var getActiveElement = function (editor) {\n      try {\n        var root = getRootNode(SugarElement.fromDom(editor.getElement()));\n        return active(root).fold(function () {\n          return document.body;\n        }, function (x) {\n          return x.dom;\n        });\n      } catch (ex) {\n        return document.body;\n      }\n    };\n    var registerEvents$1 = function (editorManager, e) {\n      var editor = e.editor;\n      register$3(editor);\n      editor.on('focusin', function () {\n        var focusedEditor = editorManager.focusedEditor;\n        if (focusedEditor !== editor) {\n          if (focusedEditor) {\n            focusedEditor.fire('blur', { focusedEditor: editor });\n          }\n          editorManager.setActive(editor);\n          editorManager.focusedEditor = editor;\n          editor.fire('focus', { blurredEditor: focusedEditor });\n          editor.focus(true);\n        }\n      });\n      editor.on('focusout', function () {\n        Delay.setEditorTimeout(editor, function () {\n          var focusedEditor = editorManager.focusedEditor;\n          if (!isUIElement(editor, getActiveElement(editor)) && focusedEditor === editor) {\n            editor.fire('blur', { focusedEditor: null });\n            editorManager.focusedEditor = null;\n          }\n        });\n      });\n      if (!documentFocusInHandler) {\n        documentFocusInHandler = function (e) {\n          var activeEditor = editorManager.activeEditor;\n          if (activeEditor) {\n            getOriginalEventTarget(e).each(function (target) {\n              if (target.ownerDocument === document) {\n                if (target !== document.body && !isUIElement(activeEditor, target) && editorManager.focusedEditor === activeEditor) {\n                  activeEditor.fire('blur', { focusedEditor: null });\n                  editorManager.focusedEditor = null;\n                }\n              }\n            });\n          }\n        };\n        DOM$8.bind(document, 'focusin', documentFocusInHandler);\n      }\n    };\n    var unregisterDocumentEvents = function (editorManager, e) {\n      if (editorManager.focusedEditor === e.editor) {\n        editorManager.focusedEditor = null;\n      }\n      if (!editorManager.activeEditor) {\n        DOM$8.unbind(document, 'focusin', documentFocusInHandler);\n        documentFocusInHandler = null;\n      }\n    };\n    var setup$l = function (editorManager) {\n      editorManager.on('AddEditor', curry(registerEvents$1, editorManager));\n      editorManager.on('RemoveEditor', curry(unregisterDocumentEvents, editorManager));\n    };\n\n    var getContentEditableHost = function (editor, node) {\n      return editor.dom.getParent(node, function (node) {\n        return editor.dom.getContentEditable(node) === 'true';\n      });\n    };\n    var getCollapsedNode = function (rng) {\n      return rng.collapsed ? Optional.from(getNode$1(rng.startContainer, rng.startOffset)).map(SugarElement.fromDom) : Optional.none();\n    };\n    var getFocusInElement = function (root, rng) {\n      return getCollapsedNode(rng).bind(function (node) {\n        if (isTableSection(node)) {\n          return Optional.some(node);\n        } else if (contains$1(root, node) === false) {\n          return Optional.some(root);\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var normalizeSelection$1 = function (editor, rng) {\n      getFocusInElement(SugarElement.fromDom(editor.getBody()), rng).bind(function (elm) {\n        return firstPositionIn(elm.dom);\n      }).fold(function () {\n        editor.selection.normalize();\n        return;\n      }, function (caretPos) {\n        return editor.selection.setRng(caretPos.toRange());\n      });\n    };\n    var focusBody = function (body) {\n      if (body.setActive) {\n        try {\n          body.setActive();\n        } catch (ex) {\n          body.focus();\n        }\n      } else {\n        body.focus();\n      }\n    };\n    var hasElementFocus = function (elm) {\n      return hasFocus$1(elm) || search(elm).isSome();\n    };\n    var hasIframeFocus = function (editor) {\n      return editor.iframeElement && hasFocus$1(SugarElement.fromDom(editor.iframeElement));\n    };\n    var hasInlineFocus = function (editor) {\n      var rawBody = editor.getBody();\n      return rawBody && hasElementFocus(SugarElement.fromDom(rawBody));\n    };\n    var hasUiFocus = function (editor) {\n      var dos = getRootNode(SugarElement.fromDom(editor.getElement()));\n      return active(dos).filter(function (elem) {\n        return !isEditorContentAreaElement(elem.dom) && isUIElement(editor, elem.dom);\n      }).isSome();\n    };\n    var hasFocus = function (editor) {\n      return editor.inline ? hasInlineFocus(editor) : hasIframeFocus(editor);\n    };\n    var hasEditorOrUiFocus = function (editor) {\n      return hasFocus(editor) || hasUiFocus(editor);\n    };\n    var focusEditor = function (editor) {\n      var selection = editor.selection;\n      var body = editor.getBody();\n      var rng = selection.getRng();\n      editor.quirks.refreshContentEditable();\n      if (editor.bookmark !== undefined && hasFocus(editor) === false) {\n        getRng(editor).each(function (bookmarkRng) {\n          editor.selection.setRng(bookmarkRng);\n          rng = bookmarkRng;\n        });\n      }\n      var contentEditableHost = getContentEditableHost(editor, selection.getNode());\n      if (editor.$.contains(body, contentEditableHost)) {\n        focusBody(contentEditableHost);\n        normalizeSelection$1(editor, rng);\n        activateEditor(editor);\n        return;\n      }\n      if (!editor.inline) {\n        if (!Env.opera) {\n          focusBody(body);\n        }\n        editor.getWin().focus();\n      }\n      if (Env.gecko || editor.inline) {\n        focusBody(body);\n        normalizeSelection$1(editor, rng);\n      }\n      activateEditor(editor);\n    };\n    var activateEditor = function (editor) {\n      return editor.editorManager.setActive(editor);\n    };\n    var focus = function (editor, skipFocus) {\n      if (editor.removed) {\n        return;\n      }\n      if (skipFocus) {\n        activateEditor(editor);\n      } else {\n        focusEditor(editor);\n      }\n    };\n\n    var getEndpointElement = function (root, rng, start, real, resolve) {\n      var container = start ? rng.startContainer : rng.endContainer;\n      var offset = start ? rng.startOffset : rng.endOffset;\n      return Optional.from(container).map(SugarElement.fromDom).map(function (elm) {\n        return !real || !rng.collapsed ? child$1(elm, resolve(elm, offset)).getOr(elm) : elm;\n      }).bind(function (elm) {\n        return isElement$6(elm) ? Optional.some(elm) : parent(elm).filter(isElement$6);\n      }).map(function (elm) {\n        return elm.dom;\n      }).getOr(root);\n    };\n    var getStart = function (root, rng, real) {\n      return getEndpointElement(root, rng, true, real, function (elm, offset) {\n        return Math.min(childNodesCount(elm), offset);\n      });\n    };\n    var getEnd = function (root, rng, real) {\n      return getEndpointElement(root, rng, false, real, function (elm, offset) {\n        return offset > 0 ? offset - 1 : offset;\n      });\n    };\n    var skipEmptyTextNodes = function (node, forwards) {\n      var orig = node;\n      while (node && isText$7(node) && node.length === 0) {\n        node = forwards ? node.nextSibling : node.previousSibling;\n      }\n      return node || orig;\n    };\n    var getNode = function (root, rng) {\n      var elm, startContainer, endContainer;\n      if (!rng) {\n        return root;\n      }\n      startContainer = rng.startContainer;\n      endContainer = rng.endContainer;\n      var startOffset = rng.startOffset;\n      var endOffset = rng.endOffset;\n      elm = rng.commonAncestorContainer;\n      if (!rng.collapsed) {\n        if (startContainer === endContainer) {\n          if (endOffset - startOffset < 2) {\n            if (startContainer.hasChildNodes()) {\n              elm = startContainer.childNodes[startOffset];\n            }\n          }\n        }\n        if (startContainer.nodeType === 3 && endContainer.nodeType === 3) {\n          if (startContainer.length === startOffset) {\n            startContainer = skipEmptyTextNodes(startContainer.nextSibling, true);\n          } else {\n            startContainer = startContainer.parentNode;\n          }\n          if (endOffset === 0) {\n            endContainer = skipEmptyTextNodes(endContainer.previousSibling, false);\n          } else {\n            endContainer = endContainer.parentNode;\n          }\n          if (startContainer && startContainer === endContainer) {\n            return startContainer;\n          }\n        }\n      }\n      if (elm && elm.nodeType === 3) {\n        return elm.parentNode;\n      }\n      return elm;\n    };\n    var getSelectedBlocks = function (dom, rng, startElm, endElm) {\n      var node;\n      var selectedBlocks = [];\n      var root = dom.getRoot();\n      startElm = dom.getParent(startElm || getStart(root, rng, rng.collapsed), dom.isBlock);\n      endElm = dom.getParent(endElm || getEnd(root, rng, rng.collapsed), dom.isBlock);\n      if (startElm && startElm !== root) {\n        selectedBlocks.push(startElm);\n      }\n      if (startElm && endElm && startElm !== endElm) {\n        node = startElm;\n        var walker = new DomTreeWalker(startElm, root);\n        while ((node = walker.next()) && node !== endElm) {\n          if (dom.isBlock(node)) {\n            selectedBlocks.push(node);\n          }\n        }\n      }\n      if (endElm && startElm !== endElm && endElm !== root) {\n        selectedBlocks.push(endElm);\n      }\n      return selectedBlocks;\n    };\n    var select = function (dom, node, content) {\n      return Optional.from(node).map(function (node) {\n        var idx = dom.nodeIndex(node);\n        var rng = dom.createRng();\n        rng.setStart(node.parentNode, idx);\n        rng.setEnd(node.parentNode, idx + 1);\n        if (content) {\n          moveEndPoint(dom, rng, node, true);\n          moveEndPoint(dom, rng, node, false);\n        }\n        return rng;\n      });\n    };\n\n    var processRanges = function (editor, ranges) {\n      return map$3(ranges, function (range) {\n        var evt = editor.fire('GetSelectionRange', { range: range });\n        return evt.range !== range ? evt.range : range;\n      });\n    };\n\n    var typeLookup = {\n      '#text': 3,\n      '#comment': 8,\n      '#cdata': 4,\n      '#pi': 7,\n      '#doctype': 10,\n      '#document-fragment': 11\n    };\n    var walk$1 = function (node, root, prev) {\n      var startName = prev ? 'lastChild' : 'firstChild';\n      var siblingName = prev ? 'prev' : 'next';\n      if (node[startName]) {\n        return node[startName];\n      }\n      if (node !== root) {\n        var sibling = node[siblingName];\n        if (sibling) {\n          return sibling;\n        }\n        for (var parent_1 = node.parent; parent_1 && parent_1 !== root; parent_1 = parent_1.parent) {\n          sibling = parent_1[siblingName];\n          if (sibling) {\n            return sibling;\n          }\n        }\n      }\n    };\n    var isEmptyTextNode = function (node) {\n      if (!isWhitespaceText(node.value)) {\n        return false;\n      }\n      var parentNode = node.parent;\n      if (parentNode && (parentNode.name !== 'span' || parentNode.attr('style')) && /^[ ]+$/.test(node.value)) {\n        return false;\n      }\n      return true;\n    };\n    var isNonEmptyElement = function (node) {\n      var isNamedAnchor = node.name === 'a' && !node.attr('href') && node.attr('id');\n      return node.attr('name') || node.attr('id') && !node.firstChild || node.attr('data-mce-bookmark') || isNamedAnchor;\n    };\n    var AstNode = function () {\n      function AstNode(name, type) {\n        this.name = name;\n        this.type = type;\n        if (type === 1) {\n          this.attributes = [];\n          this.attributes.map = {};\n        }\n      }\n      AstNode.create = function (name, attrs) {\n        var node = new AstNode(name, typeLookup[name] || 1);\n        if (attrs) {\n          each$j(attrs, function (value, attrName) {\n            node.attr(attrName, value);\n          });\n        }\n        return node;\n      };\n      AstNode.prototype.replace = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        self.insert(node, self);\n        self.remove();\n        return self;\n      };\n      AstNode.prototype.attr = function (name, value) {\n        var self = this;\n        var attrs;\n        if (typeof name !== 'string') {\n          if (name !== undefined && name !== null) {\n            each$j(name, function (value, key) {\n              self.attr(key, value);\n            });\n          }\n          return self;\n        }\n        if (attrs = self.attributes) {\n          if (value !== undefined) {\n            if (value === null) {\n              if (name in attrs.map) {\n                delete attrs.map[name];\n                var i = attrs.length;\n                while (i--) {\n                  if (attrs[i].name === name) {\n                    attrs.splice(i, 1);\n                    return self;\n                  }\n                }\n              }\n              return self;\n            }\n            if (name in attrs.map) {\n              var i = attrs.length;\n              while (i--) {\n                if (attrs[i].name === name) {\n                  attrs[i].value = value;\n                  break;\n                }\n              }\n            } else {\n              attrs.push({\n                name: name,\n                value: value\n              });\n            }\n            attrs.map[name] = value;\n            return self;\n          }\n          return attrs.map[name];\n        }\n      };\n      AstNode.prototype.clone = function () {\n        var self = this;\n        var clone = new AstNode(self.name, self.type);\n        var selfAttrs;\n        if (selfAttrs = self.attributes) {\n          var cloneAttrs = [];\n          cloneAttrs.map = {};\n          for (var i = 0, l = selfAttrs.length; i < l; i++) {\n            var selfAttr = selfAttrs[i];\n            if (selfAttr.name !== 'id') {\n              cloneAttrs[cloneAttrs.length] = {\n                name: selfAttr.name,\n                value: selfAttr.value\n              };\n              cloneAttrs.map[selfAttr.name] = selfAttr.value;\n            }\n          }\n          clone.attributes = cloneAttrs;\n        }\n        clone.value = self.value;\n        clone.shortEnded = self.shortEnded;\n        return clone;\n      };\n      AstNode.prototype.wrap = function (wrapper) {\n        var self = this;\n        self.parent.insert(wrapper, self);\n        wrapper.append(self);\n        return self;\n      };\n      AstNode.prototype.unwrap = function () {\n        var self = this;\n        for (var node = self.firstChild; node;) {\n          var next = node.next;\n          self.insert(node, self, true);\n          node = next;\n        }\n        self.remove();\n      };\n      AstNode.prototype.remove = function () {\n        var self = this, parent = self.parent, next = self.next, prev = self.prev;\n        if (parent) {\n          if (parent.firstChild === self) {\n            parent.firstChild = next;\n            if (next) {\n              next.prev = null;\n            }\n          } else {\n            prev.next = next;\n          }\n          if (parent.lastChild === self) {\n            parent.lastChild = prev;\n            if (prev) {\n              prev.next = null;\n            }\n          } else {\n            next.prev = prev;\n          }\n          self.parent = self.next = self.prev = null;\n        }\n        return self;\n      };\n      AstNode.prototype.append = function (node) {\n        var self = this;\n        if (node.parent) {\n          node.remove();\n        }\n        var last = self.lastChild;\n        if (last) {\n          last.next = node;\n          node.prev = last;\n          self.lastChild = node;\n        } else {\n          self.lastChild = self.firstChild = node;\n        }\n        node.parent = self;\n        return node;\n      };\n      AstNode.prototype.insert = function (node, refNode, before) {\n        if (node.parent) {\n          node.remove();\n        }\n        var parent = refNode.parent || this;\n        if (before) {\n          if (refNode === parent.firstChild) {\n            parent.firstChild = node;\n          } else {\n            refNode.prev.next = node;\n          }\n          node.prev = refNode.prev;\n          node.next = refNode;\n          refNode.prev = node;\n        } else {\n          if (refNode === parent.lastChild) {\n            parent.lastChild = node;\n          } else {\n            refNode.next.prev = node;\n          }\n          node.next = refNode.next;\n          node.prev = refNode;\n          refNode.next = node;\n        }\n        node.parent = parent;\n        return node;\n      };\n      AstNode.prototype.getAll = function (name) {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = walk$1(node, self)) {\n          if (node.name === name) {\n            collection.push(node);\n          }\n        }\n        return collection;\n      };\n      AstNode.prototype.children = function () {\n        var self = this;\n        var collection = [];\n        for (var node = self.firstChild; node; node = node.next) {\n          collection.push(node);\n        }\n        return collection;\n      };\n      AstNode.prototype.empty = function () {\n        var self = this;\n        if (self.firstChild) {\n          var nodes = [];\n          for (var node = self.firstChild; node; node = walk$1(node, self)) {\n            nodes.push(node);\n          }\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.parent = node.firstChild = node.lastChild = node.next = node.prev = null;\n          }\n        }\n        self.firstChild = self.lastChild = null;\n        return self;\n      };\n      AstNode.prototype.isEmpty = function (elements, whitespace, predicate) {\n        if (whitespace === void 0) {\n          whitespace = {};\n        }\n        var self = this;\n        var node = self.firstChild;\n        if (isNonEmptyElement(self)) {\n          return false;\n        }\n        if (node) {\n          do {\n            if (node.type === 1) {\n              if (node.attr('data-mce-bogus')) {\n                continue;\n              }\n              if (elements[node.name]) {\n                return false;\n              }\n              if (isNonEmptyElement(node)) {\n                return false;\n              }\n            }\n            if (node.type === 8) {\n              return false;\n            }\n            if (node.type === 3 && !isEmptyTextNode(node)) {\n              return false;\n            }\n            if (node.type === 3 && node.parent && whitespace[node.parent.name] && isWhitespaceText(node.value)) {\n              return false;\n            }\n            if (predicate && predicate(node)) {\n              return false;\n            }\n          } while (node = walk$1(node, self));\n        }\n        return true;\n      };\n      AstNode.prototype.walk = function (prev) {\n        return walk$1(this, null, prev);\n      };\n      return AstNode;\n    }();\n\n    var extractBase64DataUris = function (html) {\n      var dataImageUri = /data:[^;]+;base64,([a-z0-9\\+\\/=\\s]+)/gi;\n      var chunks = [];\n      var uris = {};\n      var prefix = generate('img');\n      var matches;\n      var index = 0;\n      var count = 0;\n      while (matches = dataImageUri.exec(html)) {\n        var uri = matches[0];\n        var imageId = prefix + '_' + count++;\n        uris[imageId] = uri;\n        if (index < matches.index) {\n          chunks.push(html.substr(index, matches.index - index));\n        }\n        chunks.push(imageId);\n        index = matches.index + uri.length;\n      }\n      var re = new RegExp(prefix + '_[0-9]+', 'g');\n      if (index === 0) {\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: html,\n          re: re\n        };\n      } else {\n        if (index < html.length) {\n          chunks.push(html.substr(index));\n        }\n        return {\n          prefix: prefix,\n          uris: uris,\n          html: chunks.join(''),\n          re: re\n        };\n      }\n    };\n    var restoreDataUris = function (html, result) {\n      return html.replace(result.re, function (imageId) {\n        return get$9(result.uris, imageId).getOr(imageId);\n      });\n    };\n    var parseDataUri$1 = function (uri) {\n      var matches = /data:([^;]+);base64,([a-z0-9\\+\\/=\\s]+)/i.exec(uri);\n      if (matches) {\n        return Optional.some({\n          type: matches[1],\n          data: decodeURIComponent(matches[2])\n        });\n      } else {\n        return Optional.none();\n      }\n    };\n\n    var each$d = Tools.each, trim = Tools.trim;\n    var queryParts = 'source protocol authority userInfo user password host port relative path directory file query anchor'.split(' ');\n    var DEFAULT_PORTS = {\n      ftp: 21,\n      http: 80,\n      https: 443,\n      mailto: 25\n    };\n    var safeSvgDataUrlElements = [\n      'img',\n      'video'\n    ];\n    var blockSvgDataUris = function (allowSvgDataUrls, tagName) {\n      if (isNonNullable(allowSvgDataUrls)) {\n        return !allowSvgDataUrls;\n      } else {\n        return isNonNullable(tagName) ? !contains$3(safeSvgDataUrlElements, tagName) : true;\n      }\n    };\n    var isInvalidUri = function (settings, uri, tagName) {\n      if (settings.allow_html_data_urls) {\n        return false;\n      } else if (/^data:image\\//i.test(uri)) {\n        return blockSvgDataUris(settings.allow_svg_data_urls, tagName) && /^data:image\\/svg\\+xml/i.test(uri);\n      } else {\n        return /^data:/i.test(uri);\n      }\n    };\n    var URI = function () {\n      function URI(url, settings) {\n        url = trim(url);\n        this.settings = settings || {};\n        var baseUri = this.settings.base_uri;\n        var self = this;\n        if (/^([\\w\\-]+):([^\\/]{2})/i.test(url) || /^\\s*#/.test(url)) {\n          self.source = url;\n          return;\n        }\n        var isProtocolRelative = url.indexOf('//') === 0;\n        if (url.indexOf('/') === 0 && !isProtocolRelative) {\n          url = (baseUri ? baseUri.protocol || 'http' : 'http') + '://mce_host' + url;\n        }\n        if (!/^[\\w\\-]*:?\\/\\//.test(url)) {\n          var baseUrl = this.settings.base_uri ? this.settings.base_uri.path : new URI(document.location.href).directory;\n          if (this.settings.base_uri && this.settings.base_uri.protocol == '') {\n            url = '//mce_host' + self.toAbsPath(baseUrl, url);\n          } else {\n            var match = /([^#?]*)([#?]?.*)/.exec(url);\n            url = (baseUri && baseUri.protocol || 'http') + '://mce_host' + self.toAbsPath(baseUrl, match[1]) + match[2];\n          }\n        }\n        url = url.replace(/@@/g, '(mce_at)');\n        var urlMatch = /^(?:(?![^:@]+:[^:@\\/]*@)([^:\\/?#.]+):)?(?:\\/\\/)?((?:(([^:@\\/]*):?([^:@\\/]*))?@)?(\\[[a-zA-Z0-9:.%]+\\]|[^:\\/?#]*)(?::(\\d*))?)(((\\/(?:[^?#](?![^?#\\/]*\\.[^?#\\/.]+(?:[?#]|$)))*\\/?)?([^?#\\/]*))(?:\\?([^#]*))?(?:#(.*))?)/.exec(url);\n        each$d(queryParts, function (v, i) {\n          var part = urlMatch[i];\n          if (part) {\n            part = part.replace(/\\(mce_at\\)/g, '@@');\n          }\n          self[v] = part;\n        });\n        if (baseUri) {\n          if (!self.protocol) {\n            self.protocol = baseUri.protocol;\n          }\n          if (!self.userInfo) {\n            self.userInfo = baseUri.userInfo;\n          }\n          if (!self.port && self.host === 'mce_host') {\n            self.port = baseUri.port;\n          }\n          if (!self.host || self.host === 'mce_host') {\n            self.host = baseUri.host;\n          }\n          self.source = '';\n        }\n        if (isProtocolRelative) {\n          self.protocol = '';\n        }\n      }\n      URI.parseDataUri = function (uri) {\n        var type;\n        var uriComponents = decodeURIComponent(uri).split(',');\n        var matches = /data:([^;]+)/.exec(uriComponents[0]);\n        if (matches) {\n          type = matches[1];\n        }\n        return {\n          type: type,\n          data: uriComponents[1]\n        };\n      };\n      URI.isDomSafe = function (uri, context, options) {\n        if (options === void 0) {\n          options = {};\n        }\n        if (options.allow_script_urls) {\n          return true;\n        } else {\n          var decodedUri = Entities.decode(uri).replace(/[\\s\\u0000-\\u001F]+/g, '');\n          try {\n            decodedUri = decodeURIComponent(decodedUri);\n          } catch (ex) {\n            decodedUri = unescape(decodedUri);\n          }\n          if (/((java|vb)script|mhtml):/i.test(decodedUri)) {\n            return false;\n          }\n          return !isInvalidUri(options, decodedUri, context);\n        }\n      };\n      URI.getDocumentBaseUrl = function (loc) {\n        var baseUrl;\n        if (loc.protocol.indexOf('http') !== 0 && loc.protocol !== 'file:') {\n          baseUrl = loc.href;\n        } else {\n          baseUrl = loc.protocol + '//' + loc.host + loc.pathname;\n        }\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(baseUrl)) {\n          baseUrl = baseUrl.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(baseUrl)) {\n            baseUrl += '/';\n          }\n        }\n        return baseUrl;\n      };\n      URI.prototype.setPath = function (path) {\n        var pathMatch = /^(.*?)\\/?(\\w+)?$/.exec(path);\n        this.path = pathMatch[0];\n        this.directory = pathMatch[1];\n        this.file = pathMatch[2];\n        this.source = '';\n        this.getURI();\n      };\n      URI.prototype.toRelative = function (uri) {\n        var output;\n        if (uri === './') {\n          return uri;\n        }\n        var relativeUri = new URI(uri, { base_uri: this });\n        if (relativeUri.host !== 'mce_host' && this.host !== relativeUri.host && relativeUri.host || this.port !== relativeUri.port || this.protocol !== relativeUri.protocol && relativeUri.protocol !== '') {\n          return relativeUri.getURI();\n        }\n        var tu = this.getURI(), uu = relativeUri.getURI();\n        if (tu === uu || tu.charAt(tu.length - 1) === '/' && tu.substr(0, tu.length - 1) === uu) {\n          return tu;\n        }\n        output = this.toRelPath(this.path, relativeUri.path);\n        if (relativeUri.query) {\n          output += '?' + relativeUri.query;\n        }\n        if (relativeUri.anchor) {\n          output += '#' + relativeUri.anchor;\n        }\n        return output;\n      };\n      URI.prototype.toAbsolute = function (uri, noHost) {\n        var absoluteUri = new URI(uri, { base_uri: this });\n        return absoluteUri.getURI(noHost && this.isSameOrigin(absoluteUri));\n      };\n      URI.prototype.isSameOrigin = function (uri) {\n        if (this.host == uri.host && this.protocol == uri.protocol) {\n          if (this.port == uri.port) {\n            return true;\n          }\n          var defaultPort = DEFAULT_PORTS[this.protocol];\n          if (defaultPort && (this.port || defaultPort) == (uri.port || defaultPort)) {\n            return true;\n          }\n        }\n        return false;\n      };\n      URI.prototype.toRelPath = function (base, path) {\n        var breakPoint = 0, out = '', i, l;\n        var normalizedBase = base.substring(0, base.lastIndexOf('/')).split('/');\n        var items = path.split('/');\n        if (normalizedBase.length >= items.length) {\n          for (i = 0, l = normalizedBase.length; i < l; i++) {\n            if (i >= items.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (normalizedBase.length < items.length) {\n          for (i = 0, l = items.length; i < l; i++) {\n            if (i >= normalizedBase.length || normalizedBase[i] !== items[i]) {\n              breakPoint = i + 1;\n              break;\n            }\n          }\n        }\n        if (breakPoint === 1) {\n          return path;\n        }\n        for (i = 0, l = normalizedBase.length - (breakPoint - 1); i < l; i++) {\n          out += '../';\n        }\n        for (i = breakPoint - 1, l = items.length; i < l; i++) {\n          if (i !== breakPoint - 1) {\n            out += '/' + items[i];\n          } else {\n            out += items[i];\n          }\n        }\n        return out;\n      };\n      URI.prototype.toAbsPath = function (base, path) {\n        var i, nb = 0, o = [], outPath;\n        var tr = /\\/$/.test(path) ? '/' : '';\n        var normalizedBase = base.split('/');\n        var normalizedPath = path.split('/');\n        each$d(normalizedBase, function (k) {\n          if (k) {\n            o.push(k);\n          }\n        });\n        normalizedBase = o;\n        for (i = normalizedPath.length - 1, o = []; i >= 0; i--) {\n          if (normalizedPath[i].length === 0 || normalizedPath[i] === '.') {\n            continue;\n          }\n          if (normalizedPath[i] === '..') {\n            nb++;\n            continue;\n          }\n          if (nb > 0) {\n            nb--;\n            continue;\n          }\n          o.push(normalizedPath[i]);\n        }\n        i = normalizedBase.length - nb;\n        if (i <= 0) {\n          outPath = reverse(o).join('/');\n        } else {\n          outPath = normalizedBase.slice(0, i).join('/') + '/' + reverse(o).join('/');\n        }\n        if (outPath.indexOf('/') !== 0) {\n          outPath = '/' + outPath;\n        }\n        if (tr && outPath.lastIndexOf('/') !== outPath.length - 1) {\n          outPath += tr;\n        }\n        return outPath;\n      };\n      URI.prototype.getURI = function (noProtoHost) {\n        if (noProtoHost === void 0) {\n          noProtoHost = false;\n        }\n        var s;\n        if (!this.source || noProtoHost) {\n          s = '';\n          if (!noProtoHost) {\n            if (this.protocol) {\n              s += this.protocol + '://';\n            } else {\n              s += '//';\n            }\n            if (this.userInfo) {\n              s += this.userInfo + '@';\n            }\n            if (this.host) {\n              s += this.host;\n            }\n            if (this.port) {\n              s += ':' + this.port;\n            }\n          }\n          if (this.path) {\n            s += this.path;\n          }\n          if (this.query) {\n            s += '?' + this.query;\n          }\n          if (this.anchor) {\n            s += '#' + this.anchor;\n          }\n          this.source = s;\n        }\n        return this.source;\n      };\n      return URI;\n    }();\n\n    var filteredClobberElements = Tools.makeMap('button,fieldset,form,iframe,img,image,input,object,output,select,textarea');\n    var isValidPrefixAttrName = function (name) {\n      return name.indexOf('data-') === 0 || name.indexOf('aria-') === 0;\n    };\n    var findMatchingEndTagIndex = function (schema, html, startIndex) {\n      var startTagRegExp = /<([!?\\/])?([A-Za-z0-9\\-_:.]+)/g;\n      var endTagRegExp = /(?:\\s(?:[^'\">]+(?:\"[^\"]*\"|'[^']*'))*[^\"'>]*(?:\"[^\">]*|'[^'>]*)?|\\s*|\\/)>/g;\n      var shortEndedElements = schema.getShortEndedElements();\n      var count = 1, index = startIndex;\n      while (count !== 0) {\n        startTagRegExp.lastIndex = index;\n        while (true) {\n          var startMatch = startTagRegExp.exec(html);\n          if (startMatch === null) {\n            return index;\n          } else if (startMatch[1] === '!') {\n            if (startsWith(startMatch[2], '--')) {\n              index = findCommentEndIndex(html, false, startMatch.index + '!--'.length);\n            } else {\n              index = findCommentEndIndex(html, true, startMatch.index + 1);\n            }\n            break;\n          } else {\n            endTagRegExp.lastIndex = startTagRegExp.lastIndex;\n            var endMatch = endTagRegExp.exec(html);\n            if (isNull(endMatch) || endMatch.index !== startTagRegExp.lastIndex) {\n              continue;\n            }\n            if (startMatch[1] === '/') {\n              count -= 1;\n            } else if (!has$2(shortEndedElements, startMatch[2])) {\n              count += 1;\n            }\n            index = startTagRegExp.lastIndex + endMatch[0].length;\n            break;\n          }\n        }\n      }\n      return index;\n    };\n    var isConditionalComment = function (html, startIndex) {\n      return /^\\s*\\[if [\\w\\W]+\\]>.*<!\\[endif\\](--!?)?>/.test(html.substr(startIndex));\n    };\n    var findCommentEndIndex = function (html, isBogus, startIndex) {\n      if (startIndex === void 0) {\n        startIndex = 0;\n      }\n      var lcHtml = html.toLowerCase();\n      if (lcHtml.indexOf('[if ', startIndex) !== -1 && isConditionalComment(lcHtml, startIndex)) {\n        var endIfIndex = lcHtml.indexOf('[endif]', startIndex);\n        return lcHtml.indexOf('>', endIfIndex);\n      } else {\n        if (isBogus) {\n          var endIndex = lcHtml.indexOf('>', startIndex);\n          return endIndex !== -1 ? endIndex : lcHtml.length;\n        } else {\n          var endCommentRegexp = /--!?>/g;\n          endCommentRegexp.lastIndex = startIndex;\n          var match = endCommentRegexp.exec(html);\n          return match ? match.index + match[0].length : lcHtml.length;\n        }\n      }\n    };\n    var checkBogusAttribute = function (regExp, attrString) {\n      var matches = regExp.exec(attrString);\n      if (matches) {\n        var name_1 = matches[1];\n        var value = matches[2];\n        return typeof name_1 === 'string' && name_1.toLowerCase() === 'data-mce-bogus' ? value : null;\n      } else {\n        return null;\n      }\n    };\n    var SaxParser = function (settings, schema) {\n      var _a;\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      settings = settings || {};\n      var doc = (_a = settings.document) !== null && _a !== void 0 ? _a : document;\n      var form = doc.createElement('form');\n      if (settings.fix_self_closing !== false) {\n        settings.fix_self_closing = true;\n      }\n      var comment = settings.comment ? settings.comment : noop;\n      var cdata = settings.cdata ? settings.cdata : noop;\n      var text = settings.text ? settings.text : noop;\n      var start = settings.start ? settings.start : noop;\n      var end = settings.end ? settings.end : noop;\n      var pi = settings.pi ? settings.pi : noop;\n      var doctype = settings.doctype ? settings.doctype : noop;\n      var parseInternal = function (base64Extract, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        var html = base64Extract.html;\n        var matches, index = 0, value, endRegExp;\n        var stack = [];\n        var attrList, i, textData, name;\n        var isInternalElement, isShortEnded;\n        var elementRule, isValidElement, attr, attribsValue, validAttributesMap, validAttributePatterns;\n        var attributesRequired, attributesDefault, attributesForced;\n        var anyAttributesRequired, attrValue, idCount = 0;\n        var decode = Entities.decode;\n        var filteredUrlAttrs = Tools.makeMap('src,href,data,background,action,formaction,poster,xlink:href');\n        var parsingMode = format === 'html' ? 0 : 1;\n        var processEndTag = function (name) {\n          var pos, i;\n          pos = stack.length;\n          while (pos--) {\n            if (stack[pos].name === name) {\n              break;\n            }\n          }\n          if (pos >= 0) {\n            for (i = stack.length - 1; i >= pos; i--) {\n              name = stack[i];\n              if (name.valid) {\n                end(name.name);\n              }\n            }\n            stack.length = pos;\n          }\n        };\n        var processText = function (value, raw) {\n          return text(restoreDataUris(value, base64Extract), raw);\n        };\n        var processComment = function (value) {\n          if (value === '') {\n            return;\n          }\n          if (value.charAt(0) === '>') {\n            value = ' ' + value;\n          }\n          if (!settings.allow_conditional_comments && value.substr(0, 3).toLowerCase() === '[if') {\n            value = ' ' + value;\n          }\n          comment(restoreDataUris(value, base64Extract));\n        };\n        var processAttr = function (value) {\n          return restoreDataUris(value, base64Extract);\n        };\n        var processMalformedComment = function (value, startIndex) {\n          var startTag = value || '';\n          var isBogus = !startsWith(startTag, '--');\n          var endIndex = findCommentEndIndex(html, isBogus, startIndex);\n          value = html.substr(startIndex, endIndex - startIndex);\n          processComment(isBogus ? startTag + value : value);\n          return endIndex + 1;\n        };\n        var parseAttribute = function (tagName, name, value, val2, val3) {\n          name = name.toLowerCase();\n          value = processAttr(name in fillAttrsMap ? name : decode(value || val2 || val3 || ''));\n          if (validate && !isInternalElement && isValidPrefixAttrName(name) === false) {\n            var attrRule = validAttributesMap[name];\n            if (!attrRule && validAttributePatterns) {\n              var i_1 = validAttributePatterns.length;\n              while (i_1--) {\n                attrRule = validAttributePatterns[i_1];\n                if (attrRule.pattern.test(name)) {\n                  break;\n                }\n              }\n              if (i_1 === -1) {\n                attrRule = null;\n              }\n            }\n            if (!attrRule) {\n              return;\n            }\n            if (attrRule.validValues && !(value in attrRule.validValues)) {\n              return;\n            }\n          }\n          var isNameOrId = name === 'name' || name === 'id';\n          if (isNameOrId && tagName in filteredClobberElements && (value in doc || value in form)) {\n            return;\n          }\n          if (filteredUrlAttrs[name] && !URI.isDomSafe(value, tagName, settings)) {\n            return;\n          }\n          if (isInternalElement && (name in filteredUrlAttrs || name.indexOf('on') === 0)) {\n            return;\n          }\n          attrList.map[name] = value;\n          attrList.push({\n            name: name,\n            value: value\n          });\n        };\n        var tokenRegExp = new RegExp('<(?:' + '(?:!--([\\\\w\\\\W]*?)--!?>)|' + '(?:!\\\\[CDATA\\\\[([\\\\w\\\\W]*?)\\\\]\\\\]>)|' + '(?:![Dd][Oo][Cc][Tt][Yy][Pp][Ee]([\\\\w\\\\W]*?)>)|' + '(?:!(--)?)|' + '(?:\\\\?([^\\\\s\\\\/<>]+) ?([\\\\w\\\\W]*?)[?/]>)|' + '(?:\\\\/([A-Za-z][A-Za-z0-9\\\\-_\\\\:\\\\.]*)>)|' + '(?:([A-Za-z][A-Za-z0-9\\\\-_:.]*)(\\\\s(?:[^\\'\">]+(?:\"[^\"]*\"|\\'[^\\']*\\'))*[^\"\\'>]*(?:\"[^\">]*|\\'[^\\'>]*)?|\\\\s*|\\\\/)>)' + ')', 'g');\n        var attrRegExp = /([\\w:\\-]+)(?:\\s*=\\s*(?:(?:\\\"((?:[^\\\"])*)\\\")|(?:\\'((?:[^\\'])*)\\')|([^>\\s]+)))?/g;\n        var shortEndedElements = schema.getShortEndedElements();\n        var selfClosing = settings.self_closing_elements || schema.getSelfClosingElements();\n        var fillAttrsMap = schema.getBoolAttrs();\n        var validate = settings.validate;\n        var removeInternalElements = settings.remove_internals;\n        var fixSelfClosing = settings.fix_self_closing;\n        var specialElements = schema.getSpecialElements();\n        var processHtml = html + '>';\n        while (matches = tokenRegExp.exec(processHtml)) {\n          var matchText = matches[0];\n          if (index < matches.index) {\n            processText(decode(html.substr(index, matches.index - index)));\n          }\n          if (value = matches[7]) {\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            processEndTag(value);\n          } else if (value = matches[8]) {\n            if (matches.index + matchText.length > html.length) {\n              processText(decode(html.substr(matches.index)));\n              index = matches.index + matchText.length;\n              continue;\n            }\n            value = value.toLowerCase();\n            if (value.charAt(0) === ':') {\n              value = value.substr(1);\n            }\n            isShortEnded = value in shortEndedElements;\n            if (fixSelfClosing && selfClosing[value] && stack.length > 0 && stack[stack.length - 1].name === value) {\n              processEndTag(value);\n            }\n            var bogusValue = checkBogusAttribute(attrRegExp, matches[9]);\n            if (bogusValue !== null) {\n              if (bogusValue === 'all') {\n                index = findMatchingEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                tokenRegExp.lastIndex = index;\n                continue;\n              }\n              isValidElement = false;\n            }\n            if (!validate || (elementRule = schema.getElementRule(value))) {\n              isValidElement = true;\n              if (validate) {\n                validAttributesMap = elementRule.attributes;\n                validAttributePatterns = elementRule.attributePatterns;\n              }\n              if (attribsValue = matches[9]) {\n                isInternalElement = attribsValue.indexOf('data-mce-type') !== -1;\n                if (isInternalElement && removeInternalElements) {\n                  isValidElement = false;\n                }\n                attrList = [];\n                attrList.map = {};\n                attribsValue.replace(attrRegExp, function (match, name, val, val2, val3) {\n                  parseAttribute(value, name, val, val2, val3);\n                  return '';\n                });\n              } else {\n                attrList = [];\n                attrList.map = {};\n              }\n              if (validate && !isInternalElement) {\n                attributesRequired = elementRule.attributesRequired;\n                attributesDefault = elementRule.attributesDefault;\n                attributesForced = elementRule.attributesForced;\n                anyAttributesRequired = elementRule.removeEmptyAttrs;\n                if (anyAttributesRequired && !attrList.length) {\n                  isValidElement = false;\n                }\n                if (attributesForced) {\n                  i = attributesForced.length;\n                  while (i--) {\n                    attr = attributesForced[i];\n                    name = attr.name;\n                    attrValue = attr.value;\n                    if (attrValue === '{$uid}') {\n                      attrValue = 'mce_' + idCount++;\n                    }\n                    attrList.map[name] = attrValue;\n                    attrList.push({\n                      name: name,\n                      value: attrValue\n                    });\n                  }\n                }\n                if (attributesDefault) {\n                  i = attributesDefault.length;\n                  while (i--) {\n                    attr = attributesDefault[i];\n                    name = attr.name;\n                    if (!(name in attrList.map)) {\n                      attrValue = attr.value;\n                      if (attrValue === '{$uid}') {\n                        attrValue = 'mce_' + idCount++;\n                      }\n                      attrList.map[name] = attrValue;\n                      attrList.push({\n                        name: name,\n                        value: attrValue\n                      });\n                    }\n                  }\n                }\n                if (attributesRequired) {\n                  i = attributesRequired.length;\n                  while (i--) {\n                    if (attributesRequired[i] in attrList.map) {\n                      break;\n                    }\n                  }\n                  if (i === -1) {\n                    isValidElement = false;\n                  }\n                }\n                if (attr = attrList.map['data-mce-bogus']) {\n                  if (attr === 'all') {\n                    index = findMatchingEndTagIndex(schema, html, tokenRegExp.lastIndex);\n                    tokenRegExp.lastIndex = index;\n                    continue;\n                  }\n                  isValidElement = false;\n                }\n              }\n              if (isValidElement) {\n                start(value, attrList, isShortEnded);\n              }\n            } else {\n              isValidElement = false;\n            }\n            if (endRegExp = specialElements[value]) {\n              endRegExp.lastIndex = index = matches.index + matchText.length;\n              if (matches = endRegExp.exec(html)) {\n                if (isValidElement) {\n                  textData = html.substr(index, matches.index - index);\n                }\n                index = matches.index + matches[0].length;\n              } else {\n                textData = html.substr(index);\n                index = html.length;\n              }\n              if (isValidElement) {\n                if (textData.length > 0) {\n                  processText(textData, true);\n                }\n                end(value);\n              }\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n            if (!isShortEnded) {\n              if (!attribsValue || attribsValue.indexOf('/') !== attribsValue.length - 1) {\n                stack.push({\n                  name: value,\n                  valid: isValidElement\n                });\n              } else if (isValidElement) {\n                end(value);\n              }\n            }\n          } else if (value = matches[1]) {\n            processComment(value);\n          } else if (value = matches[2]) {\n            var isValidCdataSection = parsingMode === 1 || settings.preserve_cdata || stack.length > 0 && schema.isValidChild(stack[stack.length - 1].name, '#cdata');\n            if (isValidCdataSection) {\n              cdata(value);\n            } else {\n              index = processMalformedComment('', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          } else if (value = matches[3]) {\n            doctype(value);\n          } else if ((value = matches[4]) || matchText === '<!') {\n            index = processMalformedComment(value, matches.index + matchText.length);\n            tokenRegExp.lastIndex = index;\n            continue;\n          } else if (value = matches[5]) {\n            if (parsingMode === 1) {\n              pi(value, matches[6]);\n            } else {\n              index = processMalformedComment('?', matches.index + 2);\n              tokenRegExp.lastIndex = index;\n              continue;\n            }\n          }\n          index = matches.index + matchText.length;\n        }\n        if (index < html.length) {\n          processText(decode(html.substr(index)));\n        }\n        for (i = stack.length - 1; i >= 0; i--) {\n          value = stack[i];\n          if (value.valid) {\n            end(value.name);\n          }\n        }\n      };\n      var parse = function (html, format) {\n        if (format === void 0) {\n          format = 'html';\n        }\n        parseInternal(extractBase64DataUris(html), format);\n      };\n      return { parse: parse };\n    };\n    SaxParser.findEndTag = findMatchingEndTagIndex;\n\n    var trimHtml = function (tempAttrs, html) {\n      var trimContentRegExp = new RegExp(['\\\\s?(' + tempAttrs.join('|') + ')=\"[^\"]+\"'].join('|'), 'gi');\n      return html.replace(trimContentRegExp, '');\n    };\n    var trimInternal = function (serializer, html) {\n      var bogusAllRegExp = /<(\\w+) [^>]*data-mce-bogus=\"all\"[^>]*>/g;\n      var schema = serializer.schema;\n      var content = trimHtml(serializer.getTempAttrs(), html);\n      var shortEndedElements = schema.getShortEndedElements();\n      var matches;\n      while (matches = bogusAllRegExp.exec(content)) {\n        var index = bogusAllRegExp.lastIndex;\n        var matchLength = matches[0].length;\n        var endTagIndex = void 0;\n        if (shortEndedElements[matches[1]]) {\n          endTagIndex = index;\n        } else {\n          endTagIndex = SaxParser.findEndTag(schema, content, index);\n        }\n        content = content.substring(0, index - matchLength) + content.substring(endTagIndex);\n        bogusAllRegExp.lastIndex = index - matchLength;\n      }\n      return trim$2(content);\n    };\n    var trimExternal = trimInternal;\n\n    var trimEmptyContents = function (editor, html) {\n      var blockName = getForcedRootBlock(editor);\n      var emptyRegExp = new RegExp('^(<' + blockName + '[^>]*>(&nbsp;|&#160;|\\\\s|\\xA0|<br \\\\/>|)<\\\\/' + blockName + '>[\\r\\n]*|<br \\\\/>[\\r\\n]*)$');\n      return html.replace(emptyRegExp, '');\n    };\n    var setupArgs$3 = function (args, format) {\n      return __assign(__assign({}, args), {\n        format: format,\n        get: true,\n        getInner: true\n      });\n    };\n    var getContentFromBody = function (editor, args, format, body) {\n      var defaultedArgs = setupArgs$3(args, format);\n      var updatedArgs = args.no_events ? defaultedArgs : editor.fire('BeforeGetContent', defaultedArgs);\n      var content;\n      if (updatedArgs.format === 'raw') {\n        content = Tools.trim(trimExternal(editor.serializer, body.innerHTML));\n      } else if (updatedArgs.format === 'text') {\n        content = editor.dom.isEmpty(body) ? '' : trim$2(body.innerText || body.textContent);\n      } else if (updatedArgs.format === 'tree') {\n        content = editor.serializer.serialize(body, updatedArgs);\n      } else {\n        content = trimEmptyContents(editor, editor.serializer.serialize(body, updatedArgs));\n      }\n      if (!contains$3([\n          'text',\n          'tree'\n        ], updatedArgs.format) && !isWsPreserveElement(SugarElement.fromDom(body))) {\n        updatedArgs.content = Tools.trim(content);\n      } else {\n        updatedArgs.content = content;\n      }\n      if (updatedArgs.no_events) {\n        return updatedArgs.content;\n      } else {\n        return editor.fire('GetContent', updatedArgs).content;\n      }\n    };\n    var getContentInternal = function (editor, args, format) {\n      return Optional.from(editor.getBody()).fold(constant(args.format === 'tree' ? new AstNode('body', 11) : ''), function (body) {\n        return getContentFromBody(editor, args, format, body);\n      });\n    };\n\n    var each$c = Tools.each;\n    var ElementUtils = function (dom) {\n      var compare = function (node1, node2) {\n        if (node1.nodeName !== node2.nodeName) {\n          return false;\n        }\n        var getAttribs = function (node) {\n          var attribs = {};\n          each$c(dom.getAttribs(node), function (attr) {\n            var name = attr.nodeName.toLowerCase();\n            if (name.indexOf('_') !== 0 && name !== 'style' && name.indexOf('data-') !== 0) {\n              attribs[name] = dom.getAttrib(node, name);\n            }\n          });\n          return attribs;\n        };\n        var compareObjects = function (obj1, obj2) {\n          var value, name;\n          for (name in obj1) {\n            if (has$2(obj1, name)) {\n              value = obj2[name];\n              if (typeof value === 'undefined') {\n                return false;\n              }\n              if (obj1[name] !== value) {\n                return false;\n              }\n              delete obj2[name];\n            }\n          }\n          for (name in obj2) {\n            if (has$2(obj2, name)) {\n              return false;\n            }\n          }\n          return true;\n        };\n        if (!compareObjects(getAttribs(node1), getAttribs(node2))) {\n          return false;\n        }\n        if (!compareObjects(dom.parseStyle(dom.getAttrib(node1, 'style')), dom.parseStyle(dom.getAttrib(node2, 'style')))) {\n          return false;\n        }\n        return !isBookmarkNode$1(node1) && !isBookmarkNode$1(node2);\n      };\n      return { compare: compare };\n    };\n\n    var makeMap$1 = Tools.makeMap;\n    var Writer = function (settings) {\n      var html = [];\n      settings = settings || {};\n      var indent = settings.indent;\n      var indentBefore = makeMap$1(settings.indent_before || '');\n      var indentAfter = makeMap$1(settings.indent_after || '');\n      var encode = Entities.getEncodeFunc(settings.entity_encoding || 'raw', settings.entities);\n      var htmlOutput = settings.element_format === 'html';\n      return {\n        start: function (name, attrs, empty) {\n          var i, l, attr, value;\n          if (indent && indentBefore[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n          html.push('<', name);\n          if (attrs) {\n            for (i = 0, l = attrs.length; i < l; i++) {\n              attr = attrs[i];\n              html.push(' ', attr.name, '=\"', encode(attr.value, true), '\"');\n            }\n          }\n          if (!empty || htmlOutput) {\n            html[html.length] = '>';\n          } else {\n            html[html.length] = ' />';\n          }\n          if (empty && indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        end: function (name) {\n          var value;\n          html.push('</', name, '>');\n          if (indent && indentAfter[name] && html.length > 0) {\n            value = html[html.length - 1];\n            if (value.length > 0 && value !== '\\n') {\n              html.push('\\n');\n            }\n          }\n        },\n        text: function (text, raw) {\n          if (text.length > 0) {\n            html[html.length] = raw ? text : encode(text);\n          }\n        },\n        cdata: function (text) {\n          html.push('<![CDATA[', text, ']]>');\n        },\n        comment: function (text) {\n          html.push('<!--', text, '-->');\n        },\n        pi: function (name, text) {\n          if (text) {\n            html.push('<?', name, ' ', encode(text), '?>');\n          } else {\n            html.push('<?', name, '?>');\n          }\n          if (indent) {\n            html.push('\\n');\n          }\n        },\n        doctype: function (text) {\n          html.push('<!DOCTYPE', text, '>', indent ? '\\n' : '');\n        },\n        reset: function () {\n          html.length = 0;\n        },\n        getContent: function () {\n          return html.join('').replace(/\\n$/, '');\n        }\n      };\n    };\n\n    var HtmlSerializer = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var writer = Writer(settings);\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      var serialize = function (node) {\n        var validate = settings.validate;\n        var handlers = {\n          3: function (node) {\n            writer.text(node.value, node.raw);\n          },\n          8: function (node) {\n            writer.comment(node.value);\n          },\n          7: function (node) {\n            writer.pi(node.name, node.value);\n          },\n          10: function (node) {\n            writer.doctype(node.value);\n          },\n          4: function (node) {\n            writer.cdata(node.value);\n          },\n          11: function (node) {\n            if (node = node.firstChild) {\n              do {\n                walk(node);\n              } while (node = node.next);\n            }\n          }\n        };\n        writer.reset();\n        var walk = function (node) {\n          var handler = handlers[node.type];\n          if (!handler) {\n            var name_1 = node.name;\n            var isEmpty = node.shortEnded;\n            var attrs = node.attributes;\n            if (validate && attrs && attrs.length > 1) {\n              var sortedAttrs = [];\n              sortedAttrs.map = {};\n              var elementRule = schema.getElementRule(node.name);\n              if (elementRule) {\n                for (var i = 0, l = elementRule.attributesOrder.length; i < l; i++) {\n                  var attrName = elementRule.attributesOrder[i];\n                  if (attrName in attrs.map) {\n                    var attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                for (var i = 0, l = attrs.length; i < l; i++) {\n                  var attrName = attrs[i].name;\n                  if (!(attrName in sortedAttrs.map)) {\n                    var attrValue = attrs.map[attrName];\n                    sortedAttrs.map[attrName] = attrValue;\n                    sortedAttrs.push({\n                      name: attrName,\n                      value: attrValue\n                    });\n                  }\n                }\n                attrs = sortedAttrs;\n              }\n            }\n            writer.start(node.name, attrs, isEmpty);\n            if (!isEmpty) {\n              if (node = node.firstChild) {\n                do {\n                  walk(node);\n                } while (node = node.next);\n              }\n              writer.end(name_1);\n            }\n          } else {\n            handler(node);\n          }\n        };\n        if (node.type === 1 && !settings.inner) {\n          walk(node);\n        } else {\n          handlers[11](node);\n        }\n        return writer.getContent();\n      };\n      return { serialize: serialize };\n    };\n\n    var nonInheritableStyles = new Set();\n    (function () {\n      var nonInheritableStylesArr = [\n        'margin',\n        'margin-left',\n        'margin-right',\n        'margin-top',\n        'margin-bottom',\n        'padding',\n        'padding-left',\n        'padding-right',\n        'padding-top',\n        'padding-bottom',\n        'border',\n        'border-width',\n        'border-style',\n        'border-color',\n        'background',\n        'background-attachment',\n        'background-clip',\n        'background-color',\n        'background-image',\n        'background-origin',\n        'background-position',\n        'background-repeat',\n        'background-size',\n        'float',\n        'position',\n        'left',\n        'right',\n        'top',\n        'bottom',\n        'z-index',\n        'display',\n        'transform',\n        'width',\n        'max-width',\n        'min-width',\n        'height',\n        'max-height',\n        'min-height',\n        'overflow',\n        'overflow-x',\n        'overflow-y',\n        'text-overflow',\n        'vertical-align',\n        'transition',\n        'transition-delay',\n        'transition-duration',\n        'transition-property',\n        'transition-timing-function'\n      ];\n      each$k(nonInheritableStylesArr, function (style) {\n        nonInheritableStyles.add(style);\n      });\n    }());\n    var shorthandStyleProps = [\n      'font',\n      'text-decoration',\n      'text-emphasis'\n    ];\n    var getStyleProps = function (dom, node) {\n      return keys(dom.parseStyle(dom.getAttrib(node, 'style')));\n    };\n    var isNonInheritableStyle = function (style) {\n      return nonInheritableStyles.has(style);\n    };\n    var hasInheritableStyles = function (dom, node) {\n      return forall(getStyleProps(dom, node), function (style) {\n        return !isNonInheritableStyle(style);\n      });\n    };\n    var getLonghandStyleProps = function (styles) {\n      return filter$4(styles, function (style) {\n        return exists(shorthandStyleProps, function (prop) {\n          return startsWith(style, prop);\n        });\n      });\n    };\n    var hasStyleConflict = function (dom, node, parentNode) {\n      var nodeStyleProps = getStyleProps(dom, node);\n      var parentNodeStyleProps = getStyleProps(dom, parentNode);\n      var valueMismatch = function (prop) {\n        var nodeValue = dom.getStyle(node, prop);\n        var parentValue = dom.getStyle(parentNode, prop);\n        return isNotEmpty(nodeValue) && isNotEmpty(parentValue) && nodeValue !== parentValue;\n      };\n      return exists(nodeStyleProps, function (nodeStyleProp) {\n        var propExists = function (props) {\n          return exists(props, function (prop) {\n            return prop === nodeStyleProp;\n          });\n        };\n        if (!propExists(parentNodeStyleProps) && propExists(shorthandStyleProps)) {\n          var longhandProps = getLonghandStyleProps(parentNodeStyleProps);\n          return exists(longhandProps, valueMismatch);\n        } else {\n          return valueMismatch(nodeStyleProp);\n        }\n      });\n    };\n\n    var isChar = function (forward, predicate, pos) {\n      return Optional.from(pos.container()).filter(isText$7).exists(function (text) {\n        var delta = forward ? 0 : -1;\n        return predicate(text.data.charAt(pos.offset() + delta));\n      });\n    };\n    var isBeforeSpace = curry(isChar, true, isWhiteSpace);\n    var isAfterSpace = curry(isChar, false, isWhiteSpace);\n    var isEmptyText = function (pos) {\n      var container = pos.container();\n      return isText$7(container) && (container.data.length === 0 || isZwsp(container.data) && BookmarkManager.isBookmarkNode(container.parentNode));\n    };\n    var matchesElementPosition = function (before, predicate) {\n      return function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(before ? 0 : -1, pos)).filter(predicate).isSome();\n      };\n    };\n    var isImageBlock = function (node) {\n      return isImg(node) && get$5(SugarElement.fromDom(node), 'display') === 'block';\n    };\n    var isCefNode = function (node) {\n      return isContentEditableFalse$b(node) && !isBogusAll$1(node);\n    };\n    var isBeforeImageBlock = matchesElementPosition(true, isImageBlock);\n    var isAfterImageBlock = matchesElementPosition(false, isImageBlock);\n    var isBeforeMedia = matchesElementPosition(true, isMedia$2);\n    var isAfterMedia = matchesElementPosition(false, isMedia$2);\n    var isBeforeTable = matchesElementPosition(true, isTable$3);\n    var isAfterTable = matchesElementPosition(false, isTable$3);\n    var isBeforeContentEditableFalse = matchesElementPosition(true, isCefNode);\n    var isAfterContentEditableFalse = matchesElementPosition(false, isCefNode);\n\n    var getLastChildren = function (elm) {\n      var children = [];\n      var rawNode = elm.dom;\n      while (rawNode) {\n        children.push(SugarElement.fromDom(rawNode));\n        rawNode = rawNode.lastChild;\n      }\n      return children;\n    };\n    var removeTrailingBr = function (elm) {\n      var allBrs = descendants(elm, 'br');\n      var brs = filter$4(getLastChildren(elm).slice(-1), isBr$4);\n      if (allBrs.length === brs.length) {\n        each$k(brs, remove$7);\n      }\n    };\n    var fillWithPaddingBr = function (elm) {\n      empty(elm);\n      append$1(elm, SugarElement.fromHtml('<br data-mce-bogus=\"1\">'));\n    };\n    var trimBlockTrailingBr = function (elm) {\n      lastChild(elm).each(function (lastChild) {\n        prevSibling(lastChild).each(function (lastChildPrevSibling) {\n          if (isBlock$2(elm) && isBr$4(lastChild) && isBlock$2(lastChildPrevSibling)) {\n            remove$7(lastChild);\n          }\n        });\n      });\n    };\n\n    var dropLast = function (xs) {\n      return xs.slice(0, -1);\n    };\n    var parentsUntil = function (start, root, predicate) {\n      if (contains$1(root, start)) {\n        return dropLast(parents$1(start, function (elm) {\n          return predicate(elm) || eq(elm, root);\n        }));\n      } else {\n        return [];\n      }\n    };\n    var parents = function (start, root) {\n      return parentsUntil(start, root, never);\n    };\n    var parentsAndSelf = function (start, root) {\n      return [start].concat(parents(start, root));\n    };\n\n    var navigateIgnoreEmptyTextNodes = function (forward, root, from) {\n      return navigateIgnore(forward, root, from, isEmptyText);\n    };\n    var getClosestBlock$1 = function (root, pos) {\n      return find$3(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n    };\n    var isAtBeforeAfterBlockBoundary = function (forward, root, pos) {\n      return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n        return getClosestBlock$1(root, pos).fold(function () {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        }, function (fromBlock) {\n          return isInSameBlock(newPos, pos, root.dom) === false && contains$1(fromBlock, SugarElement.fromDom(newPos.container()));\n        });\n      });\n    };\n    var isAtBlockBoundary = function (forward, root, pos) {\n      return getClosestBlock$1(root, pos).fold(function () {\n        return navigateIgnoreEmptyTextNodes(forward, root.dom, pos).forall(function (newPos) {\n          return isInSameBlock(newPos, pos, root.dom) === false;\n        });\n      }, function (parent) {\n        return navigateIgnoreEmptyTextNodes(forward, parent.dom, pos).isNone();\n      });\n    };\n    var isAtStartOfBlock = curry(isAtBlockBoundary, false);\n    var isAtEndOfBlock = curry(isAtBlockBoundary, true);\n    var isBeforeBlock = curry(isAtBeforeAfterBlockBoundary, false);\n    var isAfterBlock = curry(isAtBeforeAfterBlockBoundary, true);\n\n    var isBr = function (pos) {\n      return getElementFromPosition(pos).exists(isBr$4);\n    };\n    var findBr = function (forward, root, pos) {\n      var parentBlocks = filter$4(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n      var scope = head(parentBlocks).getOr(root);\n      return fromPosition(forward, scope.dom, pos).filter(isBr);\n    };\n    var isBeforeBr$1 = function (root, pos) {\n      return getElementFromPosition(pos).exists(isBr$4) || findBr(true, root, pos).isSome();\n    };\n    var isAfterBr = function (root, pos) {\n      return getElementFromPrevPosition(pos).exists(isBr$4) || findBr(false, root, pos).isSome();\n    };\n    var findPreviousBr = curry(findBr, false);\n    var findNextBr = curry(findBr, true);\n\n    var isInMiddleOfText = function (pos) {\n      return CaretPosition.isTextPosition(pos) && !pos.isAtStart() && !pos.isAtEnd();\n    };\n    var getClosestBlock = function (root, pos) {\n      var parentBlocks = filter$4(parentsAndSelf(SugarElement.fromDom(pos.container()), root), isBlock$2);\n      return head(parentBlocks).getOr(root);\n    };\n    var hasSpaceBefore = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isAfterSpace(pos);\n      } else {\n        return isAfterSpace(pos) || prevPosition(getClosestBlock(root, pos).dom, pos).exists(isAfterSpace);\n      }\n    };\n    var hasSpaceAfter = function (root, pos) {\n      if (isInMiddleOfText(pos)) {\n        return isBeforeSpace(pos);\n      } else {\n        return isBeforeSpace(pos) || nextPosition(getClosestBlock(root, pos).dom, pos).exists(isBeforeSpace);\n      }\n    };\n    var isPreValue = function (value) {\n      return contains$3([\n        'pre',\n        'pre-wrap'\n      ], value);\n    };\n    var isInPre = function (pos) {\n      return getElementFromPosition(pos).bind(function (elm) {\n        return closest$3(elm, isElement$6);\n      }).exists(function (elm) {\n        return isPreValue(get$5(elm, 'white-space'));\n      });\n    };\n    var isAtBeginningOfBody = function (root, pos) {\n      return prevPosition(root.dom, pos).isNone();\n    };\n    var isAtEndOfBody = function (root, pos) {\n      return nextPosition(root.dom, pos).isNone();\n    };\n    var isAtLineBoundary = function (root, pos) {\n      return isAtBeginningOfBody(root, pos) || isAtEndOfBody(root, pos) || isAtStartOfBlock(root, pos) || isAtEndOfBlock(root, pos) || isAfterBr(root, pos) || isBeforeBr$1(root, pos);\n    };\n    var needsToHaveNbsp = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtLineBoundary(root, pos) || hasSpaceBefore(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbspLeft = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtStartOfBlock(root, pos) || isBeforeBlock(root, pos) || isAfterBr(root, pos) || hasSpaceBefore(root, pos);\n      }\n    };\n    var leanRight = function (pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$7(container) && offset < container.data.length) {\n        return CaretPosition(container, offset + 1);\n      } else {\n        return pos;\n      }\n    };\n    var needsToBeNbspRight = function (root, pos) {\n      if (isInPre(pos)) {\n        return false;\n      } else {\n        return isAtEndOfBlock(root, pos) || isAfterBlock(root, pos) || isBeforeBr$1(root, pos) || hasSpaceAfter(root, pos);\n      }\n    };\n    var needsToBeNbsp = function (root, pos) {\n      return needsToBeNbspLeft(root, pos) || needsToBeNbspRight(root, leanRight(pos));\n    };\n    var isNbspAt = function (text, offset) {\n      return isNbsp(text.charAt(offset));\n    };\n    var hasNbsp = function (pos) {\n      var container = pos.container();\n      return isText$7(container) && contains$2(container.data, nbsp);\n    };\n    var normalizeNbspMiddle = function (text) {\n      var chars = text.split('');\n      return map$3(chars, function (chr, i) {\n        if (isNbsp(chr) && i > 0 && i < chars.length - 1 && isContent(chars[i - 1]) && isContent(chars[i + 1])) {\n          return ' ';\n        } else {\n          return chr;\n        }\n      }).join('');\n    };\n    var normalizeNbspAtStart = function (root, node) {\n      var text = node.data;\n      var firstPos = CaretPosition(node, 0);\n      if (isNbspAt(text, 0) && !needsToBeNbsp(root, firstPos)) {\n        node.data = ' ' + text.slice(1);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspInMiddleOfTextNode = function (node) {\n      var text = node.data;\n      var newText = normalizeNbspMiddle(text);\n      if (newText !== text) {\n        node.data = newText;\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbspAtEnd = function (root, node) {\n      var text = node.data;\n      var lastPos = CaretPosition(node, text.length - 1);\n      if (isNbspAt(text, text.length - 1) && !needsToBeNbsp(root, lastPos)) {\n        node.data = text.slice(0, -1) + ' ';\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var normalizeNbsps = function (root, pos) {\n      return Optional.some(pos).filter(hasNbsp).bind(function (pos) {\n        var container = pos.container();\n        var normalized = normalizeNbspAtStart(root, container) || normalizeNbspInMiddleOfTextNode(container) || normalizeNbspAtEnd(root, container);\n        return normalized ? Optional.some(pos) : Optional.none();\n      });\n    };\n    var normalizeNbspsInEditor = function (editor) {\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        normalizeNbsps(root, CaretPosition.fromRangeStart(editor.selection.getRng())).each(function (pos) {\n          editor.selection.setRng(pos.toRange());\n        });\n      }\n    };\n\n    var normalizeContent = function (content, isStartOfContent, isEndOfContent) {\n      var result = foldl(content, function (acc, c) {\n        if (isWhiteSpace(c) || isNbsp(c)) {\n          if (acc.previousCharIsSpace || acc.str === '' && isStartOfContent || acc.str.length === content.length - 1 && isEndOfContent) {\n            return {\n              previousCharIsSpace: false,\n              str: acc.str + nbsp\n            };\n          } else {\n            return {\n              previousCharIsSpace: true,\n              str: acc.str + ' '\n            };\n          }\n        } else {\n          return {\n            previousCharIsSpace: false,\n            str: acc.str + c\n          };\n        }\n      }, {\n        previousCharIsSpace: false,\n        str: ''\n      });\n      return result.str;\n    };\n    var normalize$1 = function (node, offset, count) {\n      if (count === 0) {\n        return;\n      }\n      var elm = SugarElement.fromDom(node);\n      var root = ancestor$3(elm, isBlock$2).getOr(elm);\n      var whitespace = node.data.slice(offset, offset + count);\n      var isEndOfContent = offset + count >= node.data.length && needsToBeNbspRight(root, CaretPosition(node, node.data.length));\n      var isStartOfContent = offset === 0 && needsToBeNbspLeft(root, CaretPosition(node, 0));\n      node.replaceData(offset, count, normalizeContent(whitespace, isStartOfContent, isEndOfContent));\n    };\n    var normalizeWhitespaceAfter = function (node, offset) {\n      var content = node.data.slice(offset);\n      var whitespaceCount = content.length - lTrim(content).length;\n      normalize$1(node, offset, whitespaceCount);\n    };\n    var normalizeWhitespaceBefore = function (node, offset) {\n      var content = node.data.slice(0, offset);\n      var whitespaceCount = content.length - rTrim(content).length;\n      normalize$1(node, offset - whitespaceCount, whitespaceCount);\n    };\n    var mergeTextNodes = function (prevNode, nextNode, normalizeWhitespace, mergeToPrev) {\n      if (mergeToPrev === void 0) {\n        mergeToPrev = true;\n      }\n      var whitespaceOffset = rTrim(prevNode.data).length;\n      var newNode = mergeToPrev ? prevNode : nextNode;\n      var removeNode = mergeToPrev ? nextNode : prevNode;\n      if (mergeToPrev) {\n        newNode.appendData(removeNode.data);\n      } else {\n        newNode.insertData(0, removeNode.data);\n      }\n      remove$7(SugarElement.fromDom(removeNode));\n      if (normalizeWhitespace) {\n        normalizeWhitespaceAfter(newNode, whitespaceOffset);\n      }\n      return newNode;\n    };\n\n    var needsReposition = function (pos, elm) {\n      var container = pos.container();\n      var offset = pos.offset();\n      return CaretPosition.isTextPosition(pos) === false && container === elm.parentNode && offset > CaretPosition.before(elm).offset();\n    };\n    var reposition = function (elm, pos) {\n      return needsReposition(pos, elm) ? CaretPosition(pos.container(), pos.offset() - 1) : pos;\n    };\n    var beforeOrStartOf = function (node) {\n      return isText$7(node) ? CaretPosition(node, 0) : CaretPosition.before(node);\n    };\n    var afterOrEndOf = function (node) {\n      return isText$7(node) ? CaretPosition(node, node.data.length) : CaretPosition.after(node);\n    };\n    var getPreviousSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate$3(elm.previousSibling)) {\n        return Optional.some(afterOrEndOf(elm.previousSibling));\n      } else {\n        return elm.previousSibling ? lastPositionIn(elm.previousSibling) : Optional.none();\n      }\n    };\n    var getNextSiblingCaretPosition = function (elm) {\n      if (isCaretCandidate$3(elm.nextSibling)) {\n        return Optional.some(beforeOrStartOf(elm.nextSibling));\n      } else {\n        return elm.nextSibling ? firstPositionIn(elm.nextSibling) : Optional.none();\n      }\n    };\n    var findCaretPositionBackwardsFromElm = function (rootElement, elm) {\n      var startPosition = CaretPosition.before(elm.previousSibling ? elm.previousSibling : elm.parentNode);\n      return prevPosition(rootElement, startPosition).fold(function () {\n        return nextPosition(rootElement, CaretPosition.after(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionForwardsFromElm = function (rootElement, elm) {\n      return nextPosition(rootElement, CaretPosition.after(elm)).fold(function () {\n        return prevPosition(rootElement, CaretPosition.before(elm));\n      }, Optional.some);\n    };\n    var findCaretPositionBackwards = function (rootElement, elm) {\n      return getPreviousSiblingCaretPosition(elm).orThunk(function () {\n        return getNextSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionBackwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPositionForward = function (rootElement, elm) {\n      return getNextSiblingCaretPosition(elm).orThunk(function () {\n        return getPreviousSiblingCaretPosition(elm);\n      }).orThunk(function () {\n        return findCaretPositionForwardsFromElm(rootElement, elm);\n      });\n    };\n    var findCaretPosition = function (forward, rootElement, elm) {\n      return forward ? findCaretPositionForward(rootElement, elm) : findCaretPositionBackwards(rootElement, elm);\n    };\n    var findCaretPosOutsideElmAfterDelete = function (forward, rootElement, elm) {\n      return findCaretPosition(forward, rootElement, elm).map(curry(reposition, elm));\n    };\n    var setSelection$1 = function (editor, forward, pos) {\n      pos.fold(function () {\n        editor.focus();\n      }, function (pos) {\n        editor.selection.setRng(pos.toRange(), forward);\n      });\n    };\n    var eqRawNode = function (rawNode) {\n      return function (elm) {\n        return elm.dom === rawNode;\n      };\n    };\n    var isBlock = function (editor, elm) {\n      return elm && has$2(editor.schema.getBlockElements(), name(elm));\n    };\n    var paddEmptyBlock = function (elm) {\n      if (isEmpty$2(elm)) {\n        var br = SugarElement.fromHtml('<br data-mce-bogus=\"1\">');\n        empty(elm);\n        append$1(elm, br);\n        return Optional.some(CaretPosition.before(br.dom));\n      } else {\n        return Optional.none();\n      }\n    };\n    var deleteNormalized = function (elm, afterDeletePosOpt, normalizeWhitespace) {\n      var prevTextOpt = prevSibling(elm).filter(isText$8);\n      var nextTextOpt = nextSibling(elm).filter(isText$8);\n      remove$7(elm);\n      return lift3(prevTextOpt, nextTextOpt, afterDeletePosOpt, function (prev, next, pos) {\n        var prevNode = prev.dom, nextNode = next.dom;\n        var offset = prevNode.data.length;\n        mergeTextNodes(prevNode, nextNode, normalizeWhitespace);\n        return pos.container() === nextNode ? CaretPosition(prevNode, offset) : pos;\n      }).orThunk(function () {\n        if (normalizeWhitespace) {\n          prevTextOpt.each(function (elm) {\n            return normalizeWhitespaceBefore(elm.dom, elm.dom.length);\n          });\n          nextTextOpt.each(function (elm) {\n            return normalizeWhitespaceAfter(elm.dom, 0);\n          });\n        }\n        return afterDeletePosOpt;\n      });\n    };\n    var isInlineElement = function (editor, element) {\n      return has$2(editor.schema.getTextInlineElements(), name(element));\n    };\n    var deleteElement$2 = function (editor, forward, elm, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var afterDeletePos = findCaretPosOutsideElmAfterDelete(forward, editor.getBody(), elm.dom);\n      var parentBlock = ancestor$3(elm, curry(isBlock, editor), eqRawNode(editor.getBody()));\n      var normalizedAfterDeletePos = deleteNormalized(elm, afterDeletePos, isInlineElement(editor, elm));\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        editor.selection.setCursorLocation();\n      } else {\n        parentBlock.bind(paddEmptyBlock).fold(function () {\n          if (moveCaret) {\n            setSelection$1(editor, forward, normalizedAfterDeletePos);\n          }\n        }, function (paddPos) {\n          if (moveCaret) {\n            setSelection$1(editor, forward, Optional.some(paddPos));\n          }\n        });\n      }\n    };\n\n    var isRootFromElement = function (root) {\n      return function (cur) {\n        return eq(root, cur);\n      };\n    };\n    var getTableCells = function (table) {\n      return descendants(table, 'td,th');\n    };\n    var getTableDetailsFromRange = function (rng, isRoot) {\n      var getTable = function (node) {\n        return getClosestTable(SugarElement.fromDom(node), isRoot);\n      };\n      var startTable = getTable(rng.startContainer);\n      var endTable = getTable(rng.endContainer);\n      var isStartInTable = startTable.isSome();\n      var isEndInTable = endTable.isSome();\n      var isSameTable = lift2(startTable, endTable, eq).getOr(false);\n      var isMultiTable = !isSameTable && isStartInTable && isEndInTable;\n      return {\n        startTable: startTable,\n        endTable: endTable,\n        isStartInTable: isStartInTable,\n        isEndInTable: isEndInTable,\n        isSameTable: isSameTable,\n        isMultiTable: isMultiTable\n      };\n    };\n\n    var tableCellRng = function (start, end) {\n      return {\n        start: start,\n        end: end\n      };\n    };\n    var tableSelection = function (rng, table, cells) {\n      return {\n        rng: rng,\n        table: table,\n        cells: cells\n      };\n    };\n    var deleteAction = Adt.generate([\n      {\n        singleCellTable: [\n          'rng',\n          'cell'\n        ]\n      },\n      { fullTable: ['table'] },\n      {\n        partialTable: [\n          'cells',\n          'outsideDetails'\n        ]\n      },\n      {\n        multiTable: [\n          'startTableCells',\n          'endTableCells',\n          'betweenRng'\n        ]\n      }\n    ]);\n    var getClosestCell$1 = function (container, isRoot) {\n      return closest$2(SugarElement.fromDom(container), 'td,th', isRoot);\n    };\n    var isExpandedCellRng = function (cellRng) {\n      return !eq(cellRng.start, cellRng.end);\n    };\n    var getTableFromCellRng = function (cellRng, isRoot) {\n      return getClosestTable(cellRng.start, isRoot).bind(function (startParentTable) {\n        return getClosestTable(cellRng.end, isRoot).bind(function (endParentTable) {\n          return someIf(eq(startParentTable, endParentTable), startParentTable);\n        });\n      });\n    };\n    var isSingleCellTable = function (cellRng, isRoot) {\n      return !isExpandedCellRng(cellRng) && getTableFromCellRng(cellRng, isRoot).exists(function (table) {\n        var rows = table.dom.rows;\n        return rows.length === 1 && rows[0].cells.length === 1;\n      });\n    };\n    var getCellRng = function (rng, isRoot) {\n      var startCell = getClosestCell$1(rng.startContainer, isRoot);\n      var endCell = getClosestCell$1(rng.endContainer, isRoot);\n      return lift2(startCell, endCell, tableCellRng);\n    };\n    var getCellRangeFromStartTable = function (isRoot) {\n      return function (startCell) {\n        return getClosestTable(startCell, isRoot).bind(function (table) {\n          return last$2(getTableCells(table)).map(function (endCell) {\n            return tableCellRng(startCell, endCell);\n          });\n        });\n      };\n    };\n    var getCellRangeFromEndTable = function (isRoot) {\n      return function (endCell) {\n        return getClosestTable(endCell, isRoot).bind(function (table) {\n          return head(getTableCells(table)).map(function (startCell) {\n            return tableCellRng(startCell, endCell);\n          });\n        });\n      };\n    };\n    var getTableSelectionFromCellRng = function (isRoot) {\n      return function (cellRng) {\n        return getTableFromCellRng(cellRng, isRoot).map(function (table) {\n          return tableSelection(cellRng, table, getTableCells(table));\n        });\n      };\n    };\n    var getTableSelections = function (cellRng, selectionDetails, rng, isRoot) {\n      if (rng.collapsed || !cellRng.forall(isExpandedCellRng)) {\n        return Optional.none();\n      } else if (selectionDetails.isSameTable) {\n        var sameTableSelection = cellRng.bind(getTableSelectionFromCellRng(isRoot));\n        return Optional.some({\n          start: sameTableSelection,\n          end: sameTableSelection\n        });\n      } else {\n        var startCell = getClosestCell$1(rng.startContainer, isRoot);\n        var endCell = getClosestCell$1(rng.endContainer, isRoot);\n        var startTableSelection = startCell.bind(getCellRangeFromStartTable(isRoot)).bind(getTableSelectionFromCellRng(isRoot));\n        var endTableSelection = endCell.bind(getCellRangeFromEndTable(isRoot)).bind(getTableSelectionFromCellRng(isRoot));\n        return Optional.some({\n          start: startTableSelection,\n          end: endTableSelection\n        });\n      }\n    };\n    var getCellIndex = function (cells, cell) {\n      return findIndex$2(cells, function (x) {\n        return eq(x, cell);\n      });\n    };\n    var getSelectedCells = function (tableSelection) {\n      return lift2(getCellIndex(tableSelection.cells, tableSelection.rng.start), getCellIndex(tableSelection.cells, tableSelection.rng.end), function (startIndex, endIndex) {\n        return tableSelection.cells.slice(startIndex, endIndex + 1);\n      });\n    };\n    var isSingleCellTableContentSelected = function (optCellRng, rng, isRoot) {\n      return optCellRng.exists(function (cellRng) {\n        return isSingleCellTable(cellRng, isRoot) && hasAllContentsSelected(cellRng.start, rng);\n      });\n    };\n    var unselectCells = function (rng, selectionDetails) {\n      var startTable = selectionDetails.startTable, endTable = selectionDetails.endTable;\n      var otherContentRng = rng.cloneRange();\n      startTable.each(function (table) {\n        return otherContentRng.setStartAfter(table.dom);\n      });\n      endTable.each(function (table) {\n        return otherContentRng.setEndBefore(table.dom);\n      });\n      return otherContentRng;\n    };\n    var handleSingleTable = function (cellRng, selectionDetails, rng, isRoot) {\n      return getTableSelections(cellRng, selectionDetails, rng, isRoot).bind(function (_a) {\n        var start = _a.start, end = _a.end;\n        return start.or(end);\n      }).bind(function (tableSelection) {\n        var isSameTable = selectionDetails.isSameTable;\n        var selectedCells = getSelectedCells(tableSelection).getOr([]);\n        if (isSameTable && tableSelection.cells.length === selectedCells.length) {\n          return Optional.some(deleteAction.fullTable(tableSelection.table));\n        } else if (selectedCells.length > 0) {\n          if (isSameTable) {\n            return Optional.some(deleteAction.partialTable(selectedCells, Optional.none()));\n          } else {\n            var otherContentRng = unselectCells(rng, selectionDetails);\n            return Optional.some(deleteAction.partialTable(selectedCells, Optional.some(__assign(__assign({}, selectionDetails), { rng: otherContentRng }))));\n          }\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var handleMultiTable = function (cellRng, selectionDetails, rng, isRoot) {\n      return getTableSelections(cellRng, selectionDetails, rng, isRoot).bind(function (_a) {\n        var start = _a.start, end = _a.end;\n        var startTableSelectedCells = start.bind(getSelectedCells).getOr([]);\n        var endTableSelectedCells = end.bind(getSelectedCells).getOr([]);\n        if (startTableSelectedCells.length > 0 && endTableSelectedCells.length > 0) {\n          var otherContentRng = unselectCells(rng, selectionDetails);\n          return Optional.some(deleteAction.multiTable(startTableSelectedCells, endTableSelectedCells, otherContentRng));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var getActionFromRange = function (root, rng) {\n      var isRoot = isRootFromElement(root);\n      var optCellRng = getCellRng(rng, isRoot);\n      var selectionDetails = getTableDetailsFromRange(rng, isRoot);\n      if (isSingleCellTableContentSelected(optCellRng, rng, isRoot)) {\n        return optCellRng.map(function (cellRng) {\n          return deleteAction.singleCellTable(rng, cellRng.start);\n        });\n      } else if (selectionDetails.isMultiTable) {\n        return handleMultiTable(optCellRng, selectionDetails, rng, isRoot);\n      } else {\n        return handleSingleTable(optCellRng, selectionDetails, rng, isRoot);\n      }\n    };\n\n    var freefallRtl = function (root) {\n      var child = isComment$1(root) ? prevSibling(root) : lastChild(root);\n      return child.bind(freefallRtl).orThunk(function () {\n        return Optional.some(root);\n      });\n    };\n    var cleanCells = function (cells) {\n      return each$k(cells, function (cell) {\n        remove$6(cell, 'contenteditable');\n        fillWithPaddingBr(cell);\n      });\n    };\n    var getOutsideBlock = function (editor, container) {\n      return Optional.from(editor.dom.getParent(container, editor.dom.isBlock)).map(SugarElement.fromDom);\n    };\n    var handleEmptyBlock = function (editor, startInTable, emptyBlock) {\n      emptyBlock.each(function (block) {\n        if (startInTable) {\n          remove$7(block);\n        } else {\n          fillWithPaddingBr(block);\n          editor.selection.setCursorLocation(block.dom, 0);\n        }\n      });\n    };\n    var deleteContentInsideCell = function (editor, cell, rng, isFirstCellInSelection) {\n      var insideTableRng = rng.cloneRange();\n      if (isFirstCellInSelection) {\n        insideTableRng.setStart(rng.startContainer, rng.startOffset);\n        insideTableRng.setEndAfter(cell.dom.lastChild);\n      } else {\n        insideTableRng.setStartBefore(cell.dom.firstChild);\n        insideTableRng.setEnd(rng.endContainer, rng.endOffset);\n      }\n      deleteCellContents(editor, insideTableRng, cell, false);\n    };\n    var collapseAndRestoreCellSelection = function (editor) {\n      var selectedCells = getCellsFromEditor(editor);\n      var selectedNode = SugarElement.fromDom(editor.selection.getNode());\n      if (isTableCell$5(selectedNode.dom) && isEmpty$2(selectedNode)) {\n        editor.selection.setCursorLocation(selectedNode.dom, 0);\n      } else {\n        editor.selection.collapse(true);\n      }\n      if (selectedCells.length > 1 && exists(selectedCells, function (cell) {\n          return eq(cell, selectedNode);\n        })) {\n        set$1(selectedNode, 'data-mce-selected', '1');\n      }\n    };\n    var emptySingleTableCells = function (editor, cells, outsideDetails) {\n      var editorRng = editor.selection.getRng();\n      var cellsToClean = outsideDetails.bind(function (_a) {\n        var rng = _a.rng, isStartInTable = _a.isStartInTable;\n        var outsideBlock = getOutsideBlock(editor, isStartInTable ? rng.endContainer : rng.startContainer);\n        rng.deleteContents();\n        handleEmptyBlock(editor, isStartInTable, outsideBlock.filter(isEmpty$2));\n        var endPointCell = isStartInTable ? cells[0] : cells[cells.length - 1];\n        deleteContentInsideCell(editor, endPointCell, editorRng, isStartInTable);\n        if (!isEmpty$2(endPointCell)) {\n          return Optional.some(isStartInTable ? cells.slice(1) : cells.slice(0, -1));\n        } else {\n          return Optional.none();\n        }\n      }).getOr(cells);\n      cleanCells(cellsToClean);\n      collapseAndRestoreCellSelection(editor);\n      return true;\n    };\n    var emptyMultiTableCells = function (editor, startTableCells, endTableCells, betweenRng) {\n      var rng = editor.selection.getRng();\n      var startCell = startTableCells[0];\n      var endCell = endTableCells[endTableCells.length - 1];\n      deleteContentInsideCell(editor, startCell, rng, true);\n      deleteContentInsideCell(editor, endCell, rng, false);\n      var startTableCellsToClean = isEmpty$2(startCell) ? startTableCells : startTableCells.slice(1);\n      var endTableCellsToClean = isEmpty$2(endCell) ? endTableCells : endTableCells.slice(0, -1);\n      cleanCells(startTableCellsToClean.concat(endTableCellsToClean));\n      betweenRng.deleteContents();\n      collapseAndRestoreCellSelection(editor);\n      return true;\n    };\n    var deleteCellContents = function (editor, rng, cell, moveSelection) {\n      if (moveSelection === void 0) {\n        moveSelection = true;\n      }\n      rng.deleteContents();\n      var lastNode = freefallRtl(cell).getOr(cell);\n      var lastBlock = SugarElement.fromDom(editor.dom.getParent(lastNode.dom, editor.dom.isBlock));\n      if (isEmpty$2(lastBlock)) {\n        fillWithPaddingBr(lastBlock);\n        if (moveSelection) {\n          editor.selection.setCursorLocation(lastBlock.dom, 0);\n        }\n      }\n      if (!eq(cell, lastBlock)) {\n        var additionalCleanupNodes = is$1(parent(lastBlock), cell) ? [] : siblings(lastBlock);\n        each$k(additionalCleanupNodes.concat(children(cell)), function (node) {\n          if (!eq(node, lastBlock) && !contains$1(node, lastBlock) && isEmpty$2(node)) {\n            remove$7(node);\n          }\n        });\n      }\n      return true;\n    };\n    var deleteTableElement = function (editor, table) {\n      deleteElement$2(editor, false, table);\n      return true;\n    };\n    var deleteCellRange = function (editor, rootElm, rng) {\n      return getActionFromRange(rootElm, rng).map(function (action) {\n        return action.fold(curry(deleteCellContents, editor), curry(deleteTableElement, editor), curry(emptySingleTableCells, editor), curry(emptyMultiTableCells, editor));\n      });\n    };\n    var deleteCaptionRange = function (editor, caption) {\n      return emptyElement(editor, caption);\n    };\n    var deleteTableRange = function (editor, rootElm, rng, startElm) {\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCellRange(editor, rootElm, rng);\n      }, function (caption) {\n        return deleteCaptionRange(editor, caption);\n      }).getOr(false);\n    };\n    var deleteRange$2 = function (editor, startElm, selectedCells) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return selectedCells.length !== 0 ? emptySingleTableCells(editor, selectedCells, Optional.none()) : deleteTableRange(editor, rootNode, rng, startElm);\n    };\n    var getParentCell = function (rootElm, elm) {\n      return find$3(parentsAndSelf(elm, rootElm), isTableCell$4);\n    };\n    var getParentCaption = function (rootElm, elm) {\n      return find$3(parentsAndSelf(elm, rootElm), isTag('caption'));\n    };\n    var deleteBetweenCells = function (editor, rootElm, forward, fromCell, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return getParentCell(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCell) {\n          return eq(toCell, fromCell) === false;\n        });\n      });\n    };\n    var emptyElement = function (editor, elm) {\n      fillWithPaddingBr(elm);\n      editor.selection.setCursorLocation(elm.dom, 0);\n      return Optional.some(true);\n    };\n    var isDeleteOfLastCharPos = function (fromCaption, forward, from, to) {\n      return firstPositionIn(fromCaption.dom).bind(function (first) {\n        return lastPositionIn(fromCaption.dom).map(function (last) {\n          return forward ? from.isEqual(first) && to.isEqual(last) : from.isEqual(last) && to.isEqual(first);\n        });\n      }).getOr(true);\n    };\n    var emptyCaretCaption = function (editor, elm) {\n      return emptyElement(editor, elm);\n    };\n    var validateCaretCaption = function (rootElm, fromCaption, to) {\n      return getParentCaption(rootElm, SugarElement.fromDom(to.getNode())).map(function (toCaption) {\n        return eq(toCaption, fromCaption) === false;\n      });\n    };\n    var deleteCaretInsideCaption = function (editor, rootElm, forward, fromCaption, from) {\n      return navigate(forward, editor.getBody(), from).bind(function (to) {\n        return isDeleteOfLastCharPos(fromCaption, forward, from, to) ? emptyCaretCaption(editor, fromCaption) : validateCaretCaption(rootElm, fromCaption, to);\n      }).or(Optional.some(true));\n    };\n    var deleteCaretCells = function (editor, forward, rootElm, startElm) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return getParentCell(rootElm, startElm).bind(function (fromCell) {\n        return isEmpty$2(fromCell) ? emptyElement(editor, fromCell) : deleteBetweenCells(editor, rootElm, forward, fromCell, from);\n      }).getOr(false);\n    };\n    var deleteCaretCaption = function (editor, forward, rootElm, fromCaption) {\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isEmpty$2(fromCaption) ? emptyElement(editor, fromCaption) : deleteCaretInsideCaption(editor, rootElm, forward, fromCaption, from);\n    };\n    var isNearTable = function (forward, pos) {\n      return forward ? isBeforeTable(pos) : isAfterTable(pos);\n    };\n    var isBeforeOrAfterTable = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return isNearTable(forward, fromPos) || fromPosition(forward, editor.getBody(), fromPos).exists(function (pos) {\n        return isNearTable(forward, pos);\n      });\n    };\n    var deleteCaret$3 = function (editor, forward, startElm) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      return getParentCaption(rootElm, startElm).fold(function () {\n        return deleteCaretCells(editor, forward, rootElm, startElm) || isBeforeOrAfterTable(editor, forward);\n      }, function (fromCaption) {\n        return deleteCaretCaption(editor, forward, rootElm, fromCaption).getOr(false);\n      });\n    };\n    var backspaceDelete$9 = function (editor, forward) {\n      var startElm = SugarElement.fromDom(editor.selection.getStart(true));\n      var cells = getCellsFromEditor(editor);\n      return editor.selection.isCollapsed() && cells.length === 0 ? deleteCaret$3(editor, forward, startElm) : deleteRange$2(editor, startElm, cells);\n    };\n\n    var createRange = function (sc, so, ec, eo) {\n      var rng = document.createRange();\n      rng.setStart(sc, so);\n      rng.setEnd(ec, eo);\n      return rng;\n    };\n    var normalizeBlockSelectionRange = function (rng) {\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      var rootNode = rng.commonAncestorContainer;\n      return fromPosition(false, rootNode, endPos).map(function (newEndPos) {\n        if (!isInSameBlock(startPos, endPos, rootNode) && isInSameBlock(startPos, newEndPos, rootNode)) {\n          return createRange(startPos.container(), startPos.offset(), newEndPos.container(), newEndPos.offset());\n        } else {\n          return rng;\n        }\n      }).getOr(rng);\n    };\n    var normalize = function (rng) {\n      return rng.collapsed ? rng : normalizeBlockSelectionRange(rng);\n    };\n\n    var hasOnlyOneChild$1 = function (node) {\n      return node.firstChild && node.firstChild === node.lastChild;\n    };\n    var isPaddingNode = function (node) {\n      return node.name === 'br' || node.value === nbsp;\n    };\n    var isPaddedEmptyBlock = function (schema, node) {\n      var blockElements = schema.getBlockElements();\n      return blockElements[node.name] && hasOnlyOneChild$1(node) && isPaddingNode(node.firstChild);\n    };\n    var isEmptyFragmentElement = function (schema, node) {\n      var nonEmptyElements = schema.getNonEmptyElements();\n      return node && (node.isEmpty(nonEmptyElements) || isPaddedEmptyBlock(schema, node));\n    };\n    var isListFragment = function (schema, fragment) {\n      var firstChild = fragment.firstChild;\n      var lastChild = fragment.lastChild;\n      if (firstChild && firstChild.name === 'meta') {\n        firstChild = firstChild.next;\n      }\n      if (lastChild && lastChild.attr('id') === 'mce_marker') {\n        lastChild = lastChild.prev;\n      }\n      if (isEmptyFragmentElement(schema, lastChild)) {\n        lastChild = lastChild.prev;\n      }\n      if (!firstChild || firstChild !== lastChild) {\n        return false;\n      }\n      return firstChild.name === 'ul' || firstChild.name === 'ol';\n    };\n    var cleanupDomFragment = function (domFragment) {\n      var firstChild = domFragment.firstChild;\n      var lastChild = domFragment.lastChild;\n      if (firstChild && firstChild.nodeName === 'META') {\n        firstChild.parentNode.removeChild(firstChild);\n      }\n      if (lastChild && lastChild.id === 'mce_marker') {\n        lastChild.parentNode.removeChild(lastChild);\n      }\n      return domFragment;\n    };\n    var toDomFragment = function (dom, serializer, fragment) {\n      var html = serializer.serialize(fragment);\n      var domFragment = dom.createFragment(html);\n      return cleanupDomFragment(domFragment);\n    };\n    var listItems = function (elm) {\n      return filter$4(elm.childNodes, function (child) {\n        return child.nodeName === 'LI';\n      });\n    };\n    var isPadding = function (node) {\n      return node.data === nbsp || isBr$5(node);\n    };\n    var isListItemPadded = function (node) {\n      return node && node.firstChild && node.firstChild === node.lastChild && isPadding(node.firstChild);\n    };\n    var isEmptyOrPadded = function (elm) {\n      return !elm.firstChild || isListItemPadded(elm);\n    };\n    var trimListItems = function (elms) {\n      return elms.length > 0 && isEmptyOrPadded(elms[elms.length - 1]) ? elms.slice(0, -1) : elms;\n    };\n    var getParentLi = function (dom, node) {\n      var parentBlock = dom.getParent(node, dom.isBlock);\n      return parentBlock && parentBlock.nodeName === 'LI' ? parentBlock : null;\n    };\n    var isParentBlockLi = function (dom, node) {\n      return !!getParentLi(dom, node);\n    };\n    var getSplit = function (parentNode, rng) {\n      var beforeRng = rng.cloneRange();\n      var afterRng = rng.cloneRange();\n      beforeRng.setStartBefore(parentNode);\n      afterRng.setEndAfter(parentNode);\n      return [\n        beforeRng.cloneContents(),\n        afterRng.cloneContents()\n      ];\n    };\n    var findFirstIn = function (node, rootNode) {\n      var caretPos = CaretPosition.before(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.next(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var findLastOf = function (node, rootNode) {\n      var caretPos = CaretPosition.after(node);\n      var caretWalker = CaretWalker(rootNode);\n      var newCaretPos = caretWalker.prev(caretPos);\n      return newCaretPos ? newCaretPos.toRange() : null;\n    };\n    var insertMiddle = function (target, elms, rootNode, rng) {\n      var parts = getSplit(target, rng);\n      var parentElm = target.parentNode;\n      parentElm.insertBefore(parts[0], target);\n      Tools.each(elms, function (li) {\n        parentElm.insertBefore(li, target);\n      });\n      parentElm.insertBefore(parts[1], target);\n      parentElm.removeChild(target);\n      return findLastOf(elms[elms.length - 1], rootNode);\n    };\n    var insertBefore$1 = function (target, elms, rootNode) {\n      var parentElm = target.parentNode;\n      Tools.each(elms, function (elm) {\n        parentElm.insertBefore(elm, target);\n      });\n      return findFirstIn(target, rootNode);\n    };\n    var insertAfter$1 = function (target, elms, rootNode, dom) {\n      dom.insertAfter(elms.reverse(), target);\n      return findLastOf(elms[0], rootNode);\n    };\n    var insertAtCaret$1 = function (serializer, dom, rng, fragment) {\n      var domFragment = toDomFragment(dom, serializer, fragment);\n      var liTarget = getParentLi(dom, rng.startContainer);\n      var liElms = trimListItems(listItems(domFragment.firstChild));\n      var BEGINNING = 1, END = 2;\n      var rootNode = dom.getRoot();\n      var isAt = function (location) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(dom.getRoot());\n        var newPos = location === BEGINNING ? caretWalker.prev(caretPos) : caretWalker.next(caretPos);\n        return newPos ? getParentLi(dom, newPos.getNode()) !== liTarget : true;\n      };\n      if (isAt(BEGINNING)) {\n        return insertBefore$1(liTarget, liElms, rootNode);\n      } else if (isAt(END)) {\n        return insertAfter$1(liTarget, liElms, rootNode, dom);\n      }\n      return insertMiddle(liTarget, liElms, rootNode, rng);\n    };\n\n    var trimOrPadLeftRight = function (dom, rng, html) {\n      var root = SugarElement.fromDom(dom.getRoot());\n      if (needsToBeNbspLeft(root, CaretPosition.fromRangeStart(rng))) {\n        html = html.replace(/^ /, '&nbsp;');\n      } else {\n        html = html.replace(/^&nbsp;/, ' ');\n      }\n      if (needsToBeNbspRight(root, CaretPosition.fromRangeEnd(rng))) {\n        html = html.replace(/(&nbsp;| )(<br( \\/)>)?$/, '&nbsp;');\n      } else {\n        html = html.replace(/&nbsp;(<br( \\/)?>)?$/, ' ');\n      }\n      return html;\n    };\n\n    var isTableCell$1 = isTableCell$5;\n    var isTableCellContentSelected = function (dom, rng, cell) {\n      if (cell !== null) {\n        var endCell = dom.getParent(rng.endContainer, isTableCell$1);\n        return cell === endCell && hasAllContentsSelected(SugarElement.fromDom(cell), rng);\n      } else {\n        return false;\n      }\n    };\n    var validInsertion = function (editor, value, parentNode) {\n      if (parentNode.getAttribute('data-mce-bogus') === 'all') {\n        parentNode.parentNode.insertBefore(editor.dom.createFragment(value), parentNode);\n      } else {\n        var node = parentNode.firstChild;\n        var node2 = parentNode.lastChild;\n        if (!node || node === node2 && node.nodeName === 'BR') {\n          editor.dom.setHTML(parentNode, value);\n        } else {\n          editor.selection.setContent(value);\n        }\n      }\n    };\n    var trimBrsFromTableCell = function (dom, elm) {\n      Optional.from(dom.getParent(elm, 'td,th')).map(SugarElement.fromDom).each(trimBlockTrailingBr);\n    };\n    var reduceInlineTextElements = function (editor, merge) {\n      var textInlineElements = editor.schema.getTextInlineElements();\n      var dom = editor.dom;\n      if (merge) {\n        var root_1 = editor.getBody();\n        var elementUtils_1 = ElementUtils(dom);\n        Tools.each(dom.select('*[data-mce-fragment]'), function (node) {\n          var isInline = isNonNullable(textInlineElements[node.nodeName.toLowerCase()]);\n          if (isInline && hasInheritableStyles(dom, node)) {\n            for (var parentNode = node.parentNode; isNonNullable(parentNode) && parentNode !== root_1; parentNode = parentNode.parentNode) {\n              var styleConflict = hasStyleConflict(dom, node, parentNode);\n              if (styleConflict) {\n                break;\n              }\n              if (elementUtils_1.compare(parentNode, node)) {\n                dom.remove(node, true);\n                break;\n              }\n            }\n          }\n        });\n      }\n    };\n    var markFragmentElements = function (fragment) {\n      var node = fragment;\n      while (node = node.walk()) {\n        if (node.type === 1) {\n          node.attr('data-mce-fragment', '1');\n        }\n      }\n    };\n    var unmarkFragmentElements = function (elm) {\n      Tools.each(elm.getElementsByTagName('*'), function (elm) {\n        elm.removeAttribute('data-mce-fragment');\n      });\n    };\n    var isPartOfFragment = function (node) {\n      return !!node.getAttribute('data-mce-fragment');\n    };\n    var canHaveChildren = function (editor, node) {\n      return node && !editor.schema.getShortEndedElements()[node.nodeName];\n    };\n    var moveSelectionToMarker = function (editor, marker) {\n      var nextRng;\n      var dom = editor.dom;\n      var selection = editor.selection;\n      if (!marker) {\n        return;\n      }\n      selection.scrollIntoView(marker);\n      var parentEditableElm = getContentEditableRoot$1(editor.getBody(), marker);\n      if (dom.getContentEditable(parentEditableElm) === 'false') {\n        dom.remove(marker);\n        selection.select(parentEditableElm);\n        return;\n      }\n      var rng = dom.createRng();\n      var node = marker.previousSibling;\n      if (isText$7(node)) {\n        rng.setStart(node, node.nodeValue.length);\n        if (!Env.ie) {\n          var node2 = marker.nextSibling;\n          if (isText$7(node2)) {\n            node.appendData(node2.data);\n            node2.parentNode.removeChild(node2);\n          }\n        }\n      } else {\n        rng.setStartBefore(marker);\n        rng.setEndBefore(marker);\n      }\n      var findNextCaretRng = function (rng) {\n        var caretPos = CaretPosition.fromRangeStart(rng);\n        var caretWalker = CaretWalker(editor.getBody());\n        caretPos = caretWalker.next(caretPos);\n        if (caretPos) {\n          return caretPos.toRange();\n        }\n      };\n      var parentBlock = dom.getParent(marker, dom.isBlock);\n      dom.remove(marker);\n      if (parentBlock && dom.isEmpty(parentBlock)) {\n        editor.$(parentBlock).empty();\n        rng.setStart(parentBlock, 0);\n        rng.setEnd(parentBlock, 0);\n        if (!isTableCell$1(parentBlock) && !isPartOfFragment(parentBlock) && (nextRng = findNextCaretRng(rng))) {\n          rng = nextRng;\n          dom.remove(parentBlock);\n        } else {\n          dom.add(parentBlock, dom.create('br', { 'data-mce-bogus': '1' }));\n        }\n      }\n      selection.setRng(rng);\n    };\n    var deleteSelectedContent = function (editor) {\n      var dom = editor.dom;\n      var rng = normalize(editor.selection.getRng());\n      editor.selection.setRng(rng);\n      var startCell = dom.getParent(rng.startContainer, isTableCell$1);\n      if (isTableCellContentSelected(dom, rng, startCell)) {\n        deleteCellContents(editor, rng, SugarElement.fromDom(startCell));\n      } else {\n        editor.getDoc().execCommand('Delete', false, null);\n      }\n    };\n    var insertHtmlAtCaret = function (editor, value, details) {\n      var parentNode;\n      var rng, node;\n      var selection = editor.selection;\n      var dom = editor.dom;\n      if (/^ | $/.test(value)) {\n        value = trimOrPadLeftRight(dom, selection.getRng(), value);\n      }\n      var parser = editor.parser;\n      var merge = details.merge;\n      var serializer = HtmlSerializer({ validate: shouldValidate(editor) }, editor.schema);\n      var bookmarkHtml = '<span id=\"mce_marker\" data-mce-type=\"bookmark\">&#xFEFF;</span>';\n      var args = editor.fire('BeforeSetContent', {\n        content: value,\n        format: 'html',\n        selection: true,\n        paste: details.paste\n      });\n      if (args.isDefaultPrevented()) {\n        editor.fire('SetContent', {\n          content: args.content,\n          format: 'html',\n          selection: true,\n          paste: details.paste\n        });\n        return;\n      }\n      value = args.content;\n      if (value.indexOf('{$caret}') === -1) {\n        value += '{$caret}';\n      }\n      value = value.replace(/\\{\\$caret\\}/, bookmarkHtml);\n      rng = selection.getRng();\n      var caretElement = rng.startContainer || (rng.parentElement ? rng.parentElement() : null);\n      var body = editor.getBody();\n      if (caretElement === body && selection.isCollapsed()) {\n        if (dom.isBlock(body.firstChild) && canHaveChildren(editor, body.firstChild) && dom.isEmpty(body.firstChild)) {\n          rng = dom.createRng();\n          rng.setStart(body.firstChild, 0);\n          rng.setEnd(body.firstChild, 0);\n          selection.setRng(rng);\n        }\n      }\n      if (!selection.isCollapsed()) {\n        deleteSelectedContent(editor);\n      }\n      parentNode = selection.getNode();\n      var parserArgs = {\n        context: parentNode.nodeName.toLowerCase(),\n        data: details.data,\n        insert: true\n      };\n      var fragment = parser.parse(value, parserArgs);\n      if (details.paste === true && isListFragment(editor.schema, fragment) && isParentBlockLi(dom, parentNode)) {\n        rng = insertAtCaret$1(serializer, dom, selection.getRng(), fragment);\n        selection.setRng(rng);\n        editor.fire('SetContent', args);\n        return;\n      }\n      markFragmentElements(fragment);\n      node = fragment.lastChild;\n      if (node.attr('id') === 'mce_marker') {\n        var marker = node;\n        for (node = node.prev; node; node = node.walk(true)) {\n          if (node.type === 3 || !dom.isBlock(node.name)) {\n            if (editor.schema.isValidChild(node.parent.name, 'span')) {\n              node.parent.insert(marker, node, node.name === 'br');\n            }\n            break;\n          }\n        }\n      }\n      editor._selectionOverrides.showBlockCaretContainer(parentNode);\n      if (!parserArgs.invalid) {\n        value = serializer.serialize(fragment);\n        validInsertion(editor, value, parentNode);\n      } else {\n        editor.selection.setContent(bookmarkHtml);\n        parentNode = selection.getNode();\n        var rootNode = editor.getBody();\n        if (parentNode.nodeType === 9) {\n          parentNode = node = rootNode;\n        } else {\n          node = parentNode;\n        }\n        while (node !== rootNode) {\n          parentNode = node;\n          node = node.parentNode;\n        }\n        value = parentNode === rootNode ? rootNode.innerHTML : dom.getOuterHTML(parentNode);\n        value = serializer.serialize(parser.parse(value.replace(/<span (id=\"mce_marker\"|id=mce_marker).+?<\\/span>/i, function () {\n          return serializer.serialize(fragment);\n        })));\n        if (parentNode === rootNode) {\n          dom.setHTML(rootNode, value);\n        } else {\n          dom.setOuterHTML(parentNode, value);\n        }\n      }\n      reduceInlineTextElements(editor, merge);\n      moveSelectionToMarker(editor, dom.get('mce_marker'));\n      unmarkFragmentElements(editor.getBody());\n      trimBrsFromTableCell(dom, selection.getStart());\n      editor.fire('SetContent', args);\n      editor.addVisual();\n    };\n\n    var traverse = function (node, fn) {\n      fn(node);\n      if (node.firstChild) {\n        traverse(node.firstChild, fn);\n      }\n      if (node.next) {\n        traverse(node.next, fn);\n      }\n    };\n    var findMatchingNodes = function (nodeFilters, attributeFilters, node) {\n      var nodeMatches = {};\n      var attrMatches = {};\n      var matches = [];\n      if (node.firstChild) {\n        traverse(node.firstChild, function (node) {\n          each$k(nodeFilters, function (filter) {\n            if (filter.name === node.name) {\n              if (nodeMatches[filter.name]) {\n                nodeMatches[filter.name].nodes.push(node);\n              } else {\n                nodeMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n          each$k(attributeFilters, function (filter) {\n            if (typeof node.attr(filter.name) === 'string') {\n              if (attrMatches[filter.name]) {\n                attrMatches[filter.name].nodes.push(node);\n              } else {\n                attrMatches[filter.name] = {\n                  filter: filter,\n                  nodes: [node]\n                };\n              }\n            }\n          });\n        });\n      }\n      for (var name_1 in nodeMatches) {\n        if (has$2(nodeMatches, name_1)) {\n          matches.push(nodeMatches[name_1]);\n        }\n      }\n      for (var name_2 in attrMatches) {\n        if (has$2(attrMatches, name_2)) {\n          matches.push(attrMatches[name_2]);\n        }\n      }\n      return matches;\n    };\n    var filter$1 = function (nodeFilters, attributeFilters, node) {\n      var matches = findMatchingNodes(nodeFilters, attributeFilters, node);\n      each$k(matches, function (match) {\n        each$k(match.filter.callbacks, function (callback) {\n          callback(match.nodes, match.filter.name, {});\n        });\n      });\n    };\n\n    var defaultFormat$1 = 'html';\n    var isTreeNode = function (content) {\n      return content instanceof AstNode;\n    };\n    var moveSelection = function (editor) {\n      if (hasFocus(editor)) {\n        firstPositionIn(editor.getBody()).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable$3(node) ? firstPositionIn(node).getOr(pos) : pos;\n          editor.selection.setRng(caretPos.toRange());\n        });\n      }\n    };\n    var setEditorHtml = function (editor, html, noSelection) {\n      editor.dom.setHTML(editor.getBody(), html);\n      if (noSelection !== true) {\n        moveSelection(editor);\n      }\n    };\n    var setContentString = function (editor, body, content, args) {\n      if (content.length === 0 || /^\\s+$/.test(content)) {\n        var padd = '<br data-mce-bogus=\"1\">';\n        if (body.nodeName === 'TABLE') {\n          content = '<tr><td>' + padd + '</td></tr>';\n        } else if (/^(UL|OL)$/.test(body.nodeName)) {\n          content = '<li>' + padd + '</li>';\n        }\n        var forcedRootBlockName = getForcedRootBlock(editor);\n        if (forcedRootBlockName && editor.schema.isValidChild(body.nodeName.toLowerCase(), forcedRootBlockName.toLowerCase())) {\n          content = padd;\n          content = editor.dom.createHTML(forcedRootBlockName, getForcedRootBlockAttrs(editor), content);\n        } else if (!content) {\n          content = '<br data-mce-bogus=\"1\">';\n        }\n        setEditorHtml(editor, content, args.no_selection);\n        editor.fire('SetContent', args);\n      } else {\n        if (args.format !== 'raw') {\n          content = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(editor.parser.parse(content, {\n            isRootContent: true,\n            insert: true\n          }));\n        }\n        args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? content : Tools.trim(content);\n        setEditorHtml(editor, args.content, args.no_selection);\n        if (!args.no_events) {\n          editor.fire('SetContent', args);\n        }\n      }\n      return args.content;\n    };\n    var setContentTree = function (editor, body, content, args) {\n      filter$1(editor.parser.getNodeFilters(), editor.parser.getAttributeFilters(), content);\n      var html = HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(content);\n      args.content = isWsPreserveElement(SugarElement.fromDom(body)) ? html : Tools.trim(html);\n      setEditorHtml(editor, args.content, args.no_selection);\n      if (!args.no_events) {\n        editor.fire('SetContent', args);\n      }\n      return content;\n    };\n    var setupArgs$2 = function (args, content) {\n      return __assign(__assign({ format: defaultFormat$1 }, args), {\n        set: true,\n        content: isTreeNode(content) ? '' : content\n      });\n    };\n    var setContentInternal = function (editor, content, args) {\n      var defaultedArgs = setupArgs$2(args, content);\n      var updatedArgs = args.no_events ? defaultedArgs : editor.fire('BeforeSetContent', defaultedArgs);\n      if (!isTreeNode(content)) {\n        content = updatedArgs.content;\n      }\n      return Optional.from(editor.getBody()).fold(constant(content), function (body) {\n        return isTreeNode(content) ? setContentTree(editor, body, content, updatedArgs) : setContentString(editor, body, content, updatedArgs);\n      });\n    };\n\n    var sibling = function (scope, predicate) {\n      return sibling$2(scope, predicate).isSome();\n    };\n\n    var ensureIsRoot = function (isRoot) {\n      return isFunction(isRoot) ? isRoot : never;\n    };\n    var ancestor = function (scope, transform, isRoot) {\n      var element = scope.dom;\n      var stop = ensureIsRoot(isRoot);\n      while (element.parentNode) {\n        element = element.parentNode;\n        var el = SugarElement.fromDom(element);\n        var transformed = transform(el);\n        if (transformed.isSome()) {\n          return transformed;\n        } else if (stop(el)) {\n          break;\n        }\n      }\n      return Optional.none();\n    };\n    var closest$1 = function (scope, transform, isRoot) {\n      var current = transform(scope);\n      var stop = ensureIsRoot(isRoot);\n      return current.orThunk(function () {\n        return stop(scope) ? Optional.none() : ancestor(scope, transform, stop);\n      });\n    };\n\n    var isEq$3 = isEq$5;\n    var matchesUnInheritedFormatSelector = function (ed, node, name) {\n      var formatList = ed.formatter.get(name);\n      if (formatList) {\n        for (var i = 0; i < formatList.length; i++) {\n          var format = formatList[i];\n          if (isSelectorFormat(format) && format.inherit === false && ed.dom.is(node, format.selector)) {\n            return true;\n          }\n        }\n      }\n      return false;\n    };\n    var matchParents = function (editor, node, name, vars, similar) {\n      var root = editor.dom.getRoot();\n      if (node === root) {\n        return false;\n      }\n      node = editor.dom.getParent(node, function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, name)) {\n          return true;\n        }\n        return node.parentNode === root || !!matchNode(editor, node, name, vars, true);\n      });\n      return !!matchNode(editor, node, name, vars, similar);\n    };\n    var matchName$1 = function (dom, node, format) {\n      if (isEq$3(node, format.inline)) {\n        return true;\n      }\n      if (isEq$3(node, format.block)) {\n        return true;\n      }\n      if (format.selector) {\n        return node.nodeType === 1 && dom.is(node, format.selector);\n      }\n    };\n    var matchItems = function (dom, node, format, itemName, similar, vars) {\n      var items = format[itemName];\n      if (isFunction(format.onmatch)) {\n        return format.onmatch(node, format, itemName);\n      }\n      if (items) {\n        if (isUndefined(items.length)) {\n          for (var key in items) {\n            if (has$2(items, key)) {\n              var value = itemName === 'attributes' ? dom.getAttrib(node, key) : getStyle(dom, node, key);\n              var expectedValue = replaceVars(items[key], vars);\n              var isEmptyValue = isNullable(value) || isEmpty$3(value);\n              if (isEmptyValue && isNullable(expectedValue)) {\n                continue;\n              }\n              if (similar && isEmptyValue && !format.exact) {\n                return false;\n              }\n              if ((!similar || format.exact) && !isEq$3(value, normalizeStyleValue(dom, expectedValue, key))) {\n                return false;\n              }\n            }\n          }\n        } else {\n          for (var i = 0; i < items.length; i++) {\n            if (itemName === 'attributes' ? dom.getAttrib(node, items[i]) : getStyle(dom, node, items[i])) {\n              return true;\n            }\n          }\n        }\n      }\n      return true;\n    };\n    var matchNode = function (ed, node, name, vars, similar) {\n      var formatList = ed.formatter.get(name);\n      var dom = ed.dom;\n      if (formatList && node) {\n        for (var i = 0; i < formatList.length; i++) {\n          var format = formatList[i];\n          if (matchName$1(ed.dom, node, format) && matchItems(dom, node, format, 'attributes', similar, vars) && matchItems(dom, node, format, 'styles', similar, vars)) {\n            var classes = format.classes;\n            if (classes) {\n              for (var x = 0; x < classes.length; x++) {\n                if (!ed.dom.hasClass(node, replaceVars(classes[x], vars))) {\n                  return;\n                }\n              }\n            }\n            return format;\n          }\n        }\n      }\n    };\n    var match$2 = function (editor, name, vars, node, similar) {\n      if (node) {\n        return matchParents(editor, node, name, vars, similar);\n      }\n      node = editor.selection.getNode();\n      if (matchParents(editor, node, name, vars, similar)) {\n        return true;\n      }\n      var startNode = editor.selection.getStart();\n      if (startNode !== node) {\n        if (matchParents(editor, startNode, name, vars, similar)) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var matchAll = function (editor, names, vars) {\n      var matchedFormatNames = [];\n      var checkedMap = {};\n      var startElement = editor.selection.getStart();\n      editor.dom.getParent(startElement, function (node) {\n        for (var i = 0; i < names.length; i++) {\n          var name_1 = names[i];\n          if (!checkedMap[name_1] && matchNode(editor, node, name_1, vars)) {\n            checkedMap[name_1] = true;\n            matchedFormatNames.push(name_1);\n          }\n        }\n      }, editor.dom.getRoot());\n      return matchedFormatNames;\n    };\n    var closest = function (editor, names) {\n      var isRoot = function (elm) {\n        return eq(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      var match = function (elm, name) {\n        return matchNode(editor, elm.dom, name) ? Optional.some(name) : Optional.none();\n      };\n      return Optional.from(editor.selection.getStart(true)).bind(function (rawElm) {\n        return closest$1(SugarElement.fromDom(rawElm), function (elm) {\n          return findMap(names, function (name) {\n            return match(elm, name);\n          });\n        }, isRoot);\n      }).getOrNull();\n    };\n    var canApply = function (editor, name) {\n      var formatList = editor.formatter.get(name);\n      var dom = editor.dom;\n      if (formatList) {\n        var startNode = editor.selection.getStart();\n        var parents = getParents$2(dom, startNode);\n        for (var x = formatList.length - 1; x >= 0; x--) {\n          var format = formatList[x];\n          if (!isSelectorFormat(format) || isNonNullable(format.defaultBlock)) {\n            return true;\n          }\n          for (var i = parents.length - 1; i >= 0; i--) {\n            if (dom.is(parents[i], format.selector)) {\n              return true;\n            }\n          }\n        }\n      }\n      return false;\n    };\n    var matchAllOnNode = function (editor, node, formatNames) {\n      return foldl(formatNames, function (acc, name) {\n        var matchSimilar = isVariableFormatName(editor, name);\n        if (editor.formatter.matchNode(node, name, {}, matchSimilar)) {\n          return acc.concat([name]);\n        } else {\n          return acc;\n        }\n      }, []);\n    };\n\n    var ZWSP = ZWSP$1, CARET_ID = '_mce_caret';\n    var importNode = function (ownerDocument, node) {\n      return ownerDocument.importNode(node, true);\n    };\n    var getEmptyCaretContainers = function (node) {\n      var nodes = [];\n      while (node) {\n        if (node.nodeType === 3 && node.nodeValue !== ZWSP || node.childNodes.length > 1) {\n          return [];\n        }\n        if (node.nodeType === 1) {\n          nodes.push(node);\n        }\n        node = node.firstChild;\n      }\n      return nodes;\n    };\n    var isCaretContainerEmpty = function (node) {\n      return getEmptyCaretContainers(node).length > 0;\n    };\n    var findFirstTextNode = function (node) {\n      if (node) {\n        var walker = new DomTreeWalker(node, node);\n        for (node = walker.current(); node; node = walker.next()) {\n          if (isText$7(node)) {\n            return node;\n          }\n        }\n      }\n      return null;\n    };\n    var createCaretContainer = function (fill) {\n      var caretContainer = SugarElement.fromTag('span');\n      setAll$1(caretContainer, {\n        'id': CARET_ID,\n        'data-mce-bogus': '1',\n        'data-mce-type': 'format-caret'\n      });\n      if (fill) {\n        append$1(caretContainer, SugarElement.fromText(ZWSP));\n      }\n      return caretContainer;\n    };\n    var trimZwspFromCaretContainer = function (caretContainerNode) {\n      var textNode = findFirstTextNode(caretContainerNode);\n      if (textNode && textNode.nodeValue.charAt(0) === ZWSP) {\n        textNode.deleteData(0, 1);\n      }\n      return textNode;\n    };\n    var removeCaretContainerNode = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (isCaretContainerEmpty(node)) {\n        deleteElement$2(editor, false, SugarElement.fromDom(node), moveCaret);\n      } else {\n        var rng = selection.getRng();\n        var block = dom.getParent(node, dom.isBlock);\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        var textNode = trimZwspFromCaretContainer(node);\n        dom.remove(node, true);\n        if (startContainer === textNode && startOffset > 0) {\n          rng.setStart(textNode, startOffset - 1);\n        }\n        if (endContainer === textNode && endOffset > 0) {\n          rng.setEnd(textNode, endOffset - 1);\n        }\n        if (block && dom.isEmpty(block)) {\n          fillWithPaddingBr(SugarElement.fromDom(block));\n        }\n        selection.setRng(rng);\n      }\n    };\n    var removeCaretContainer = function (editor, node, moveCaret) {\n      if (moveCaret === void 0) {\n        moveCaret = true;\n      }\n      var dom = editor.dom, selection = editor.selection;\n      if (!node) {\n        node = getParentCaretContainer(editor.getBody(), selection.getStart());\n        if (!node) {\n          while (node = dom.get(CARET_ID)) {\n            removeCaretContainerNode(editor, node, false);\n          }\n        }\n      } else {\n        removeCaretContainerNode(editor, node, moveCaret);\n      }\n    };\n    var insertCaretContainerNode = function (editor, caretContainer, formatNode) {\n      var dom = editor.dom, block = dom.getParent(formatNode, curry(isTextBlock$1, editor));\n      if (block && dom.isEmpty(block)) {\n        formatNode.parentNode.replaceChild(caretContainer, formatNode);\n      } else {\n        removeTrailingBr(SugarElement.fromDom(formatNode));\n        if (dom.isEmpty(formatNode)) {\n          formatNode.parentNode.replaceChild(caretContainer, formatNode);\n        } else {\n          dom.insertAfter(caretContainer, formatNode);\n        }\n      }\n    };\n    var appendNode = function (parentNode, node) {\n      parentNode.appendChild(node);\n      return node;\n    };\n    var insertFormatNodesIntoCaretContainer = function (formatNodes, caretContainer) {\n      var innerMostFormatNode = foldr(formatNodes, function (parentNode, formatNode) {\n        return appendNode(parentNode, formatNode.cloneNode(false));\n      }, caretContainer);\n      return appendNode(innerMostFormatNode, innerMostFormatNode.ownerDocument.createTextNode(ZWSP));\n    };\n    var cleanFormatNode = function (editor, caretContainer, formatNode, name, vars, similar) {\n      var formatter = editor.formatter;\n      var dom = editor.dom;\n      var validFormats = filter$4(keys(formatter.get()), function (formatName) {\n        return formatName !== name && !contains$2(formatName, 'removeformat');\n      });\n      var matchedFormats = matchAllOnNode(editor, formatNode, validFormats);\n      var uniqueFormats = filter$4(matchedFormats, function (fmtName) {\n        return !areSimilarFormats(editor, fmtName, name);\n      });\n      if (uniqueFormats.length > 0) {\n        var clonedFormatNode = formatNode.cloneNode(false);\n        dom.add(caretContainer, clonedFormatNode);\n        formatter.remove(name, vars, clonedFormatNode, similar);\n        dom.remove(clonedFormatNode);\n        return Optional.some(clonedFormatNode);\n      } else {\n        return Optional.none();\n      }\n    };\n    var applyCaretFormat = function (editor, name, vars) {\n      var caretContainer, textNode;\n      var selection = editor.selection;\n      var selectionRng = selection.getRng();\n      var offset = selectionRng.startOffset;\n      var container = selectionRng.startContainer;\n      var text = container.nodeValue;\n      caretContainer = getParentCaretContainer(editor.getBody(), selection.getStart());\n      if (caretContainer) {\n        textNode = findFirstTextNode(caretContainer);\n      }\n      var wordcharRegex = /[^\\s\\u00a0\\u00ad\\u200b\\ufeff]/;\n      if (text && offset > 0 && offset < text.length && wordcharRegex.test(text.charAt(offset)) && wordcharRegex.test(text.charAt(offset - 1))) {\n        var bookmark = selection.getBookmark();\n        selectionRng.collapse(true);\n        var rng = expandRng(editor, selectionRng, editor.formatter.get(name));\n        rng = split(rng);\n        editor.formatter.apply(name, vars, rng);\n        selection.moveToBookmark(bookmark);\n      } else {\n        if (!caretContainer || textNode.nodeValue !== ZWSP) {\n          caretContainer = importNode(editor.getDoc(), createCaretContainer(true).dom);\n          textNode = caretContainer.firstChild;\n          selectionRng.insertNode(caretContainer);\n          offset = 1;\n          editor.formatter.apply(name, vars, caretContainer);\n        } else {\n          editor.formatter.apply(name, vars, caretContainer);\n        }\n        selection.setCursorLocation(textNode, offset);\n      }\n    };\n    var removeCaretFormat = function (editor, name, vars, similar) {\n      var dom = editor.dom;\n      var selection = editor.selection;\n      var hasContentAfter, node, formatNode;\n      var parents = [];\n      var rng = selection.getRng();\n      var container = rng.startContainer;\n      var offset = rng.startOffset;\n      node = container;\n      if (container.nodeType === 3) {\n        if (offset !== container.nodeValue.length) {\n          hasContentAfter = true;\n        }\n        node = node.parentNode;\n      }\n      while (node) {\n        if (matchNode(editor, node, name, vars, similar)) {\n          formatNode = node;\n          break;\n        }\n        if (node.nextSibling) {\n          hasContentAfter = true;\n        }\n        parents.push(node);\n        node = node.parentNode;\n      }\n      if (!formatNode) {\n        return;\n      }\n      if (hasContentAfter) {\n        var bookmark = selection.getBookmark();\n        rng.collapse(true);\n        var expandedRng = expandRng(editor, rng, editor.formatter.get(name), true);\n        expandedRng = split(expandedRng);\n        editor.formatter.remove(name, vars, expandedRng, similar);\n        selection.moveToBookmark(bookmark);\n      } else {\n        var caretContainer = getParentCaretContainer(editor.getBody(), formatNode);\n        var newCaretContainer = createCaretContainer(false).dom;\n        insertCaretContainerNode(editor, newCaretContainer, caretContainer !== null ? caretContainer : formatNode);\n        var cleanedFormatNode = cleanFormatNode(editor, newCaretContainer, formatNode, name, vars, similar);\n        var caretTextNode = insertFormatNodesIntoCaretContainer(parents.concat(cleanedFormatNode.toArray()), newCaretContainer);\n        removeCaretContainerNode(editor, caretContainer, false);\n        selection.setCursorLocation(caretTextNode, 1);\n        if (dom.isEmpty(formatNode)) {\n          dom.remove(formatNode);\n        }\n      }\n    };\n    var disableCaretContainer = function (editor, keyCode) {\n      var selection = editor.selection, body = editor.getBody();\n      removeCaretContainer(editor, null, false);\n      if ((keyCode === 8 || keyCode === 46) && selection.isCollapsed() && selection.getStart().innerHTML === ZWSP) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n      if (keyCode === 37 || keyCode === 39) {\n        removeCaretContainer(editor, getParentCaretContainer(body, selection.getStart()));\n      }\n    };\n    var setup$k = function (editor) {\n      editor.on('mouseup keydown', function (e) {\n        disableCaretContainer(editor, e.keyCode);\n      });\n    };\n    var replaceWithCaretFormat = function (targetNode, formatNodes) {\n      var caretContainer = createCaretContainer(false);\n      var innerMost = insertFormatNodesIntoCaretContainer(formatNodes, caretContainer.dom);\n      before$4(SugarElement.fromDom(targetNode), caretContainer);\n      remove$7(SugarElement.fromDom(targetNode));\n      return CaretPosition(innerMost, 0);\n    };\n    var isFormatElement = function (editor, element) {\n      var inlineElements = editor.schema.getTextInlineElements();\n      return has$2(inlineElements, name(element)) && !isCaretNode(element.dom) && !isBogus$2(element.dom);\n    };\n    var isEmptyCaretFormatElement = function (element) {\n      return isCaretNode(element.dom) && isCaretContainerEmpty(element.dom);\n    };\n\n    var postProcessHooks = {};\n    var filter = filter$2;\n    var each$b = each$i;\n    var addPostProcessHook = function (name, hook) {\n      var hooks = postProcessHooks[name];\n      if (!hooks) {\n        postProcessHooks[name] = [];\n      }\n      postProcessHooks[name].push(hook);\n    };\n    var postProcess$1 = function (name, editor) {\n      each$b(postProcessHooks[name], function (hook) {\n        hook(editor);\n      });\n    };\n    addPostProcessHook('pre', function (editor) {\n      var rng = editor.selection.getRng();\n      var blocks;\n      var hasPreSibling = function (pre) {\n        return isPre(pre.previousSibling) && indexOf$1(blocks, pre.previousSibling) !== -1;\n      };\n      var joinPre = function (pre1, pre2) {\n        DomQuery(pre2).remove();\n        DomQuery(pre1).append('<br><br>').append(pre2.childNodes);\n      };\n      var isPre = matchNodeNames(['pre']);\n      if (!rng.collapsed) {\n        blocks = editor.selection.getSelectedBlocks();\n        each$b(filter(filter(blocks, isPre), hasPreSibling), function (pre) {\n          joinPre(pre.previousSibling, pre);\n        });\n      }\n    });\n\n    var each$a = Tools.each;\n    var isElementNode$1 = function (node) {\n      return isElement$5(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus$2(node);\n    };\n    var findElementSibling = function (node, siblingName) {\n      for (var sibling = node; sibling; sibling = sibling[siblingName]) {\n        if (isText$7(sibling) && isNotEmpty(sibling.data)) {\n          return node;\n        }\n        if (isElement$5(sibling) && !isBookmarkNode$1(sibling)) {\n          return sibling;\n        }\n      }\n      return node;\n    };\n    var mergeSiblingsNodes = function (dom, prev, next) {\n      var elementUtils = ElementUtils(dom);\n      if (prev && next) {\n        prev = findElementSibling(prev, 'previousSibling');\n        next = findElementSibling(next, 'nextSibling');\n        if (elementUtils.compare(prev, next)) {\n          for (var sibling = prev.nextSibling; sibling && sibling !== next;) {\n            var tmpSibling = sibling;\n            sibling = sibling.nextSibling;\n            prev.appendChild(tmpSibling);\n          }\n          dom.remove(next);\n          Tools.each(Tools.grep(next.childNodes), function (node) {\n            prev.appendChild(node);\n          });\n          return prev;\n        }\n      }\n      return next;\n    };\n    var mergeSiblings = function (dom, format, vars, node) {\n      if (node && format.merge_siblings !== false) {\n        var newNode = mergeSiblingsNodes(dom, getNonWhiteSpaceSibling(node), node);\n        mergeSiblingsNodes(dom, newNode, getNonWhiteSpaceSibling(newNode, true));\n      }\n    };\n    var clearChildStyles = function (dom, format, node) {\n      if (format.clear_child_styles) {\n        var selector = format.links ? '*:not(a)' : '*';\n        each$a(dom.select(selector, node), function (node) {\n          if (isElementNode$1(node)) {\n            each$a(format.styles, function (value, name) {\n              dom.setStyle(node, name, '');\n            });\n          }\n        });\n      }\n    };\n    var processChildElements = function (node, filter, process) {\n      each$a(node.childNodes, function (node) {\n        if (isElementNode$1(node)) {\n          if (filter(node)) {\n            process(node);\n          }\n          if (node.hasChildNodes()) {\n            processChildElements(node, filter, process);\n          }\n        }\n      });\n    };\n    var unwrapEmptySpan = function (dom, node) {\n      if (node.nodeName === 'SPAN' && dom.getAttribs(node).length === 0) {\n        dom.remove(node, true);\n      }\n    };\n    var hasStyle = function (dom, name) {\n      return function (node) {\n        return !!(node && getStyle(dom, node, name));\n      };\n    };\n    var applyStyle = function (dom, name, value) {\n      return function (node) {\n        dom.setStyle(node, name, value);\n        if (node.getAttribute('style') === '') {\n          node.removeAttribute('style');\n        }\n        unwrapEmptySpan(dom, node);\n      };\n    };\n\n    var removeResult = Adt.generate([\n      { keep: [] },\n      { rename: ['name'] },\n      { removed: [] }\n    ]);\n    var MCE_ATTR_RE = /^(src|href|style)$/;\n    var each$9 = Tools.each;\n    var isEq$2 = isEq$5;\n    var isTableCellOrRow = function (node) {\n      return /^(TR|TH|TD)$/.test(node.nodeName);\n    };\n    var isChildOfInlineParent = function (dom, node, parent) {\n      return dom.isChildOf(node, parent) && node !== parent && !dom.isBlock(parent);\n    };\n    var getContainer = function (ed, rng, start) {\n      var container = rng[start ? 'startContainer' : 'endContainer'];\n      var offset = rng[start ? 'startOffset' : 'endOffset'];\n      if (isElement$5(container)) {\n        var lastIdx = container.childNodes.length - 1;\n        if (!start && offset) {\n          offset--;\n        }\n        container = container.childNodes[offset > lastIdx ? lastIdx : offset];\n      }\n      if (isText$7(container) && start && offset >= container.nodeValue.length) {\n        container = new DomTreeWalker(container, ed.getBody()).next() || container;\n      }\n      if (isText$7(container) && !start && offset === 0) {\n        container = new DomTreeWalker(container, ed.getBody()).prev() || container;\n      }\n      return container;\n    };\n    var normalizeTableSelection = function (node, start) {\n      var prop = start ? 'firstChild' : 'lastChild';\n      if (isTableCellOrRow(node) && node[prop]) {\n        var childNode = node[prop];\n        if (node.nodeName === 'TR') {\n          return childNode[prop] || childNode;\n        } else {\n          return childNode;\n        }\n      }\n      return node;\n    };\n    var wrap$1 = function (dom, node, name, attrs) {\n      var wrapper = dom.create(name, attrs);\n      node.parentNode.insertBefore(wrapper, node);\n      wrapper.appendChild(node);\n      return wrapper;\n    };\n    var wrapWithSiblings = function (dom, node, next, name, attrs) {\n      var start = SugarElement.fromDom(node);\n      var wrapper = SugarElement.fromDom(dom.create(name, attrs));\n      var siblings = next ? nextSiblings(start) : prevSiblings(start);\n      append(wrapper, siblings);\n      if (next) {\n        before$4(start, wrapper);\n        prepend(wrapper, start);\n      } else {\n        after$3(start, wrapper);\n        append$1(wrapper, start);\n      }\n      return wrapper.dom;\n    };\n    var matchName = function (dom, node, format) {\n      if (isInlineFormat(format) && isEq$2(node, format.inline)) {\n        return true;\n      }\n      if (isBlockFormat(format) && isEq$2(node, format.block)) {\n        return true;\n      }\n      if (isSelectorFormat(format)) {\n        return isElement$5(node) && dom.is(node, format.selector);\n      }\n    };\n    var isColorFormatAndAnchor = function (node, format) {\n      return format.links && node.nodeName === 'A';\n    };\n    var find = function (dom, node, next, inc) {\n      var sibling = getNonWhiteSpaceSibling(node, next, inc);\n      return isNullable(sibling) || sibling.nodeName === 'BR' || dom.isBlock(sibling);\n    };\n    var removeNode = function (ed, node, format) {\n      var parentNode = node.parentNode;\n      var rootBlockElm;\n      var dom = ed.dom, forcedRootBlock = getForcedRootBlock(ed);\n      if (isBlockFormat(format)) {\n        if (!forcedRootBlock) {\n          if (dom.isBlock(node) && !dom.isBlock(parentNode)) {\n            if (!find(dom, node, false) && !find(dom, node.firstChild, true, true)) {\n              node.insertBefore(dom.create('br'), node.firstChild);\n            }\n            if (!find(dom, node, true) && !find(dom, node.lastChild, false, true)) {\n              node.appendChild(dom.create('br'));\n            }\n          }\n        } else {\n          if (parentNode === dom.getRoot()) {\n            if (!format.list_block || !isEq$2(node, format.list_block)) {\n              each$k(from(node.childNodes), function (node) {\n                if (isValid(ed, forcedRootBlock, node.nodeName.toLowerCase())) {\n                  if (!rootBlockElm) {\n                    rootBlockElm = wrap$1(dom, node, forcedRootBlock);\n                    dom.setAttribs(rootBlockElm, ed.settings.forced_root_block_attrs);\n                  } else {\n                    rootBlockElm.appendChild(node);\n                  }\n                } else {\n                  rootBlockElm = null;\n                }\n              });\n            }\n          }\n        }\n      }\n      if (isMixedFormat(format) && !isEq$2(format.inline, node)) {\n        return;\n      }\n      dom.remove(node, true);\n    };\n    var removeFormatInternal = function (ed, format, vars, node, compareNode) {\n      var stylesModified;\n      var dom = ed.dom;\n      if (!matchName(dom, node, format) && !isColorFormatAndAnchor(node, format)) {\n        return removeResult.keep();\n      }\n      var elm = node;\n      if (isInlineFormat(format) && format.remove === 'all' && isArray$1(format.preserve_attributes)) {\n        var attrsToPreserve = filter$4(dom.getAttribs(elm), function (attr) {\n          return contains$3(format.preserve_attributes, attr.name.toLowerCase());\n        });\n        dom.removeAllAttribs(elm);\n        each$k(attrsToPreserve, function (attr) {\n          return dom.setAttrib(elm, attr.name, attr.value);\n        });\n        if (attrsToPreserve.length > 0) {\n          return removeResult.rename('span');\n        }\n      }\n      if (format.remove !== 'all') {\n        each$9(format.styles, function (value, name) {\n          value = normalizeStyleValue(dom, replaceVars(value, vars), name + '');\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$2(getStyle(dom, compareNode, name), value))) {\n            dom.setStyle(elm, name, '');\n          }\n          stylesModified = true;\n        });\n        if (stylesModified && dom.getAttrib(elm, 'style') === '') {\n          elm.removeAttribute('style');\n          elm.removeAttribute('data-mce-style');\n        }\n        each$9(format.attributes, function (value, name) {\n          var valueOut;\n          value = replaceVars(value, vars);\n          if (isNumber(name)) {\n            name = value;\n            compareNode = null;\n          }\n          if (format.remove_similar || (!compareNode || isEq$2(dom.getAttrib(compareNode, name), value))) {\n            if (name === 'class') {\n              value = dom.getAttrib(elm, name);\n              if (value) {\n                valueOut = '';\n                each$k(value.split(/\\s+/), function (cls) {\n                  if (/mce\\-\\w+/.test(cls)) {\n                    valueOut += (valueOut ? ' ' : '') + cls;\n                  }\n                });\n                if (valueOut) {\n                  dom.setAttrib(elm, name, valueOut);\n                  return;\n                }\n              }\n            }\n            if (MCE_ATTR_RE.test(name)) {\n              elm.removeAttribute('data-mce-' + name);\n            }\n            if (name === 'style' && matchNodeNames(['li'])(elm) && dom.getStyle(elm, 'list-style-type') === 'none') {\n              elm.removeAttribute(name);\n              dom.setStyle(elm, 'list-style-type', 'none');\n              return;\n            }\n            if (name === 'class') {\n              elm.removeAttribute('className');\n            }\n            elm.removeAttribute(name);\n          }\n        });\n        each$9(format.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!compareNode || dom.hasClass(compareNode, value)) {\n            dom.removeClass(elm, value);\n          }\n        });\n        var attrs = dom.getAttribs(elm);\n        for (var i = 0; i < attrs.length; i++) {\n          var attrName = attrs[i].nodeName;\n          if (attrName.indexOf('_') !== 0 && attrName.indexOf('data-') !== 0) {\n            return removeResult.keep();\n          }\n        }\n      }\n      if (format.remove !== 'none') {\n        removeNode(ed, elm, format);\n        return removeResult.removed();\n      }\n      return removeResult.keep();\n    };\n    var removeFormat$1 = function (ed, format, vars, node, compareNode) {\n      return removeFormatInternal(ed, format, vars, node, compareNode).fold(never, function (newName) {\n        ed.dom.rename(node, newName);\n        return true;\n      }, always);\n    };\n    var findFormatRoot = function (editor, container, name, vars, similar) {\n      var formatRoot;\n      each$k(getParents$2(editor.dom, container.parentNode).reverse(), function (parent) {\n        if (!formatRoot && parent.id !== '_start' && parent.id !== '_end') {\n          var format = matchNode(editor, parent, name, vars, similar);\n          if (format && format.split !== false) {\n            formatRoot = parent;\n          }\n        }\n      });\n      return formatRoot;\n    };\n    var removeFormatFromClone = function (editor, format, vars, clone) {\n      return removeFormatInternal(editor, format, vars, clone, clone).fold(constant(clone), function (newName) {\n        var fragment = editor.dom.createFragment();\n        fragment.appendChild(clone);\n        return editor.dom.rename(clone, newName);\n      }, constant(null));\n    };\n    var wrapAndSplit = function (editor, formatList, formatRoot, container, target, split, format, vars) {\n      var clone, lastClone, firstClone;\n      var dom = editor.dom;\n      if (formatRoot) {\n        var formatRootParent = formatRoot.parentNode;\n        for (var parent_1 = container.parentNode; parent_1 && parent_1 !== formatRootParent; parent_1 = parent_1.parentNode) {\n          clone = dom.clone(parent_1, false);\n          for (var i = 0; i < formatList.length; i++) {\n            clone = removeFormatFromClone(editor, formatList[i], vars, clone);\n            if (clone === null) {\n              break;\n            }\n          }\n          if (clone) {\n            if (lastClone) {\n              clone.appendChild(lastClone);\n            }\n            if (!firstClone) {\n              firstClone = clone;\n            }\n            lastClone = clone;\n          }\n        }\n        if (split && (!format.mixed || !dom.isBlock(formatRoot))) {\n          container = dom.split(formatRoot, container);\n        }\n        if (lastClone) {\n          target.parentNode.insertBefore(lastClone, target);\n          firstClone.appendChild(target);\n          if (isInlineFormat(format)) {\n            mergeSiblings(dom, format, vars, lastClone);\n          }\n        }\n      }\n      return container;\n    };\n    var remove$1 = function (ed, name, vars, node, similar) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var contentEditable = true;\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var splitToFormatRoot = function (container) {\n        var formatRoot = findFormatRoot(ed, container, name, vars, similar);\n        return wrapAndSplit(ed, formatList, formatRoot, container, container, true, format, vars);\n      };\n      var isRemoveBookmarkNode = function (node) {\n        return isBookmarkNode$1(node) && isElement$5(node) && (node.id === '_start' || node.id === '_end');\n      };\n      var removeNodeFormat = function (node) {\n        return exists(formatList, function (fmt) {\n          return removeFormat$1(ed, fmt, vars, node, node);\n        });\n      };\n      var process = function (node) {\n        var lastContentEditable = true;\n        var hasContentEditableState = false;\n        if (isElement$5(node) && dom.getContentEditable(node)) {\n          lastContentEditable = contentEditable;\n          contentEditable = dom.getContentEditable(node) === 'true';\n          hasContentEditableState = true;\n        }\n        var children = from(node.childNodes);\n        if (contentEditable && !hasContentEditableState) {\n          var removed = removeNodeFormat(node);\n          var currentNodeMatches = removed || exists(formatList, function (f) {\n            return matchName$1(dom, node, f);\n          });\n          var parentNode = node.parentNode;\n          if (!currentNodeMatches && isNonNullable(parentNode) && shouldExpandToSelector(format)) {\n            removeNodeFormat(parentNode);\n          }\n        }\n        if (format.deep) {\n          if (children.length) {\n            for (var i = 0; i < children.length; i++) {\n              process(children[i]);\n            }\n            if (hasContentEditableState) {\n              contentEditable = lastContentEditable;\n            }\n          }\n        }\n        var textDecorations = [\n          'underline',\n          'line-through',\n          'overline'\n        ];\n        each$k(textDecorations, function (decoration) {\n          if (isElement$5(node) && ed.dom.getStyle(node, 'text-decoration') === decoration && node.parentNode && getTextDecoration(dom, node.parentNode) === decoration) {\n            removeFormat$1(ed, {\n              deep: false,\n              exact: true,\n              inline: 'span',\n              styles: { textDecoration: decoration }\n            }, null, node);\n          }\n        });\n      };\n      var unwrap = function (start) {\n        var node = dom.get(start ? '_start' : '_end');\n        var out = node[start ? 'firstChild' : 'lastChild'];\n        if (isRemoveBookmarkNode(out)) {\n          out = out[start ? 'firstChild' : 'lastChild'];\n        }\n        if (isText$7(out) && out.data.length === 0) {\n          out = start ? node.previousSibling || node.nextSibling : node.nextSibling || node.previousSibling;\n        }\n        dom.remove(node, true);\n        return out;\n      };\n      var removeRngStyle = function (rng) {\n        var startContainer, endContainer;\n        var expandedRng = expandRng(ed, rng, formatList, rng.collapsed);\n        if (format.split) {\n          expandedRng = split(expandedRng);\n          startContainer = getContainer(ed, expandedRng, true);\n          endContainer = getContainer(ed, expandedRng);\n          if (startContainer !== endContainer) {\n            startContainer = normalizeTableSelection(startContainer, true);\n            endContainer = normalizeTableSelection(endContainer, false);\n            if (isChildOfInlineParent(dom, startContainer, endContainer)) {\n              var marker = Optional.from(startContainer.firstChild).getOr(startContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, true, 'span', {\n                'id': '_start',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(true);\n              return;\n            }\n            if (isChildOfInlineParent(dom, endContainer, startContainer)) {\n              var marker = Optional.from(endContainer.lastChild).getOr(endContainer);\n              splitToFormatRoot(wrapWithSiblings(dom, marker, false, 'span', {\n                'id': '_end',\n                'data-mce-type': 'bookmark'\n              }));\n              unwrap(false);\n              return;\n            }\n            startContainer = wrap$1(dom, startContainer, 'span', {\n              'id': '_start',\n              'data-mce-type': 'bookmark'\n            });\n            endContainer = wrap$1(dom, endContainer, 'span', {\n              'id': '_end',\n              'data-mce-type': 'bookmark'\n            });\n            var newRng = dom.createRng();\n            newRng.setStartAfter(startContainer);\n            newRng.setEndBefore(endContainer);\n            walk$2(dom, newRng, function (nodes) {\n              each$k(nodes, function (n) {\n                if (!isBookmarkNode$1(n) && !isBookmarkNode$1(n.parentNode)) {\n                  splitToFormatRoot(n);\n                }\n              });\n            });\n            splitToFormatRoot(startContainer);\n            splitToFormatRoot(endContainer);\n            startContainer = unwrap(true);\n            endContainer = unwrap();\n          } else {\n            startContainer = endContainer = splitToFormatRoot(startContainer);\n          }\n          expandedRng.startContainer = startContainer.parentNode ? startContainer.parentNode : startContainer;\n          expandedRng.startOffset = dom.nodeIndex(startContainer);\n          expandedRng.endContainer = endContainer.parentNode ? endContainer.parentNode : endContainer;\n          expandedRng.endOffset = dom.nodeIndex(endContainer) + 1;\n        }\n        walk$2(dom, expandedRng, function (nodes) {\n          each$k(nodes, process);\n        });\n      };\n      if (node) {\n        if (isNode(node)) {\n          var rng = dom.createRng();\n          rng.setStartBefore(node);\n          rng.setEndAfter(node);\n          removeRngStyle(rng);\n        } else {\n          removeRngStyle(node);\n        }\n        fireFormatRemove(ed, name, node, vars);\n        return;\n      }\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0; i < formatList.length; i++) {\n          if (formatList[i].ceFalseOverride) {\n            if (removeFormat$1(ed, formatList[i], vars, node, node)) {\n              break;\n            }\n          }\n        }\n        fireFormatRemove(ed, name, node, vars);\n        return;\n      }\n      if (!selection.isCollapsed() || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n        preserve(selection, true, function () {\n          runOnRanges(ed, removeRngStyle);\n        });\n        if (isInlineFormat(format) && match$2(ed, name, vars, selection.getStart())) {\n          moveStart(dom, selection, selection.getRng());\n        }\n        ed.nodeChanged();\n      } else {\n        removeCaretFormat(ed, name, vars, similar);\n      }\n      fireFormatRemove(ed, name, node, vars);\n    };\n\n    var each$8 = Tools.each;\n    var mergeTextDecorationsAndColor = function (dom, format, vars, node) {\n      var processTextDecorationsAndColor = function (n) {\n        if (n.nodeType === 1 && n.parentNode && n.parentNode.nodeType === 1) {\n          var textDecoration = getTextDecoration(dom, n.parentNode);\n          if (dom.getStyle(n, 'color') && textDecoration) {\n            dom.setStyle(n, 'text-decoration', textDecoration);\n          } else if (dom.getStyle(n, 'text-decoration') === textDecoration) {\n            dom.setStyle(n, 'text-decoration', null);\n          }\n        }\n      };\n      if (format.styles && (format.styles.color || format.styles.textDecoration)) {\n        Tools.walk(node, processTextDecorationsAndColor, 'childNodes');\n        processTextDecorationsAndColor(node);\n      }\n    };\n    var mergeBackgroundColorAndFontSize = function (dom, format, vars, node) {\n      if (format.styles && format.styles.backgroundColor) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'backgroundColor', replaceVars(format.styles.backgroundColor, vars)));\n      }\n    };\n    var mergeSubSup = function (dom, format, vars, node) {\n      if (isInlineFormat(format) && (format.inline === 'sub' || format.inline === 'sup')) {\n        processChildElements(node, hasStyle(dom, 'fontSize'), applyStyle(dom, 'fontSize', ''));\n        dom.remove(dom.select(format.inline === 'sup' ? 'sub' : 'sup', node), true);\n      }\n    };\n    var mergeWithChildren = function (editor, formatList, vars, node) {\n      each$8(formatList, function (format) {\n        if (isInlineFormat(format)) {\n          each$8(editor.dom.select(format.inline, node), function (child) {\n            if (!isElementNode$1(child)) {\n              return;\n            }\n            removeFormat$1(editor, format, vars, child, format.exact ? child : null);\n          });\n        }\n        clearChildStyles(editor.dom, format, node);\n      });\n    };\n    var mergeWithParents = function (editor, format, name, vars, node) {\n      if (matchNode(editor, node.parentNode, name, vars)) {\n        if (removeFormat$1(editor, format, vars, node)) {\n          return;\n        }\n      }\n      if (format.merge_with_parents) {\n        editor.dom.getParent(node.parentNode, function (parent) {\n          if (matchNode(editor, parent, name, vars)) {\n            removeFormat$1(editor, format, vars, node);\n            return true;\n          }\n        });\n      }\n    };\n\n    var each$7 = Tools.each;\n    var isElementNode = function (node) {\n      return isElement$5(node) && !isBookmarkNode$1(node) && !isCaretNode(node) && !isBogus$2(node);\n    };\n    var canFormatBR = function (editor, format, node, parentName) {\n      if (canFormatEmptyLines(editor) && isInlineFormat(format)) {\n        var validBRParentElements = __assign(__assign({}, editor.schema.getTextBlockElements()), {\n          td: {},\n          th: {},\n          li: {},\n          dt: {},\n          dd: {},\n          figcaption: {},\n          caption: {},\n          details: {},\n          summary: {}\n        });\n        var hasCaretNodeSibling = sibling(SugarElement.fromDom(node), function (sibling) {\n          return isCaretNode(sibling.dom);\n        });\n        return hasNonNullableKey(validBRParentElements, parentName) && isEmpty$2(SugarElement.fromDom(node.parentNode), false) && !hasCaretNodeSibling;\n      } else {\n        return false;\n      }\n    };\n    var applyFormat$1 = function (ed, name, vars, node) {\n      var formatList = ed.formatter.get(name);\n      var format = formatList[0];\n      var isCollapsed = !node && ed.selection.isCollapsed();\n      var dom = ed.dom;\n      var selection = ed.selection;\n      var setElementFormat = function (elm, fmt) {\n        if (fmt === void 0) {\n          fmt = format;\n        }\n        if (isFunction(fmt.onformat)) {\n          fmt.onformat(elm, fmt, vars, node);\n        }\n        each$7(fmt.styles, function (value, name) {\n          dom.setStyle(elm, name, replaceVars(value, vars));\n        });\n        if (fmt.styles) {\n          var styleVal = dom.getAttrib(elm, 'style');\n          if (styleVal) {\n            dom.setAttrib(elm, 'data-mce-style', styleVal);\n          }\n        }\n        each$7(fmt.attributes, function (value, name) {\n          dom.setAttrib(elm, name, replaceVars(value, vars));\n        });\n        each$7(fmt.classes, function (value) {\n          value = replaceVars(value, vars);\n          if (!dom.hasClass(elm, value)) {\n            dom.addClass(elm, value);\n          }\n        });\n      };\n      var applyNodeStyle = function (formatList, node) {\n        var found = false;\n        each$7(formatList, function (format) {\n          if (!isSelectorFormat(format)) {\n            return false;\n          }\n          if (isNonNullable(format.collapsed) && format.collapsed !== isCollapsed) {\n            return;\n          }\n          if (dom.is(node, format.selector) && !isCaretNode(node)) {\n            setElementFormat(node, format);\n            found = true;\n            return false;\n          }\n        });\n        return found;\n      };\n      var createWrapElement = function (wrapName) {\n        if (isString$1(wrapName)) {\n          var wrapElm = dom.create(wrapName);\n          setElementFormat(wrapElm);\n          return wrapElm;\n        } else {\n          return null;\n        }\n      };\n      var applyRngStyle = function (dom, rng, nodeSpecific) {\n        var newWrappers = [];\n        var contentEditable = true;\n        var wrapName = format.inline || format.block;\n        var wrapElm = createWrapElement(wrapName);\n        walk$2(dom, rng, function (nodes) {\n          var currentWrapElm;\n          var process = function (node) {\n            var hasContentEditableState = false;\n            var lastContentEditable = contentEditable;\n            var nodeName = node.nodeName.toLowerCase();\n            var parentNode = node.parentNode;\n            var parentName = parentNode.nodeName.toLowerCase();\n            if (isElement$5(node) && dom.getContentEditable(node)) {\n              lastContentEditable = contentEditable;\n              contentEditable = dom.getContentEditable(node) === 'true';\n              hasContentEditableState = true;\n            }\n            if (isBr$5(node) && !canFormatBR(ed, format, node, parentName)) {\n              currentWrapElm = null;\n              if (isBlockFormat(format)) {\n                dom.remove(node);\n              }\n              return;\n            }\n            if (isBlockFormat(format) && format.wrapper && matchNode(ed, node, name, vars)) {\n              currentWrapElm = null;\n              return;\n            }\n            if (contentEditable && !hasContentEditableState && isBlockFormat(format) && !format.wrapper && isTextBlock$1(ed, nodeName) && isValid(ed, parentName, wrapName)) {\n              var elm = dom.rename(node, wrapName);\n              setElementFormat(elm);\n              newWrappers.push(elm);\n              currentWrapElm = null;\n              return;\n            }\n            if (isSelectorFormat(format)) {\n              var found = applyNodeStyle(formatList, node);\n              if (!found && isNonNullable(parentNode) && shouldExpandToSelector(format)) {\n                found = applyNodeStyle(formatList, parentNode);\n              }\n              if (!isInlineFormat(format) || found) {\n                currentWrapElm = null;\n                return;\n              }\n            }\n            if (contentEditable && !hasContentEditableState && isValid(ed, wrapName, nodeName) && isValid(ed, parentName, wrapName) && !(!nodeSpecific && isText$7(node) && isZwsp(node.data)) && !isCaretNode(node) && (!isInlineFormat(format) || !dom.isBlock(node))) {\n              if (!currentWrapElm) {\n                currentWrapElm = dom.clone(wrapElm, false);\n                node.parentNode.insertBefore(currentWrapElm, node);\n                newWrappers.push(currentWrapElm);\n              }\n              currentWrapElm.appendChild(node);\n            } else {\n              currentWrapElm = null;\n              each$k(from(node.childNodes), process);\n              if (hasContentEditableState) {\n                contentEditable = lastContentEditable;\n              }\n              currentWrapElm = null;\n            }\n          };\n          each$k(nodes, process);\n        });\n        if (format.links === true) {\n          each$k(newWrappers, function (node) {\n            var process = function (node) {\n              if (node.nodeName === 'A') {\n                setElementFormat(node, format);\n              }\n              each$k(from(node.childNodes), process);\n            };\n            process(node);\n          });\n        }\n        each$k(newWrappers, function (node) {\n          var getChildCount = function (node) {\n            var count = 0;\n            each$k(node.childNodes, function (node) {\n              if (!isEmptyTextNode$1(node) && !isBookmarkNode$1(node)) {\n                count++;\n              }\n            });\n            return count;\n          };\n          var mergeStyles = function (node) {\n            var childElement = find$3(node.childNodes, isElementNode).filter(function (child) {\n              return matchName$1(dom, child, format);\n            });\n            return childElement.map(function (child) {\n              var clone = dom.clone(child, false);\n              setElementFormat(clone);\n              dom.replace(clone, node, true);\n              dom.remove(child, true);\n              return clone;\n            }).getOr(node);\n          };\n          var childCount = getChildCount(node);\n          if ((newWrappers.length > 1 || !dom.isBlock(node)) && childCount === 0) {\n            dom.remove(node, true);\n            return;\n          }\n          if (isInlineFormat(format) || isBlockFormat(format) && format.wrapper) {\n            if (!format.exact && childCount === 1) {\n              node = mergeStyles(node);\n            }\n            mergeWithChildren(ed, formatList, vars, node);\n            mergeWithParents(ed, format, name, vars, node);\n            mergeBackgroundColorAndFontSize(dom, format, vars, node);\n            mergeTextDecorationsAndColor(dom, format, vars, node);\n            mergeSubSup(dom, format, vars, node);\n            mergeSiblings(dom, format, vars, node);\n          }\n        });\n      };\n      if (dom.getContentEditable(selection.getNode()) === 'false') {\n        node = selection.getNode();\n        for (var i = 0, l = formatList.length; i < l; i++) {\n          var formatItem = formatList[i];\n          if (formatItem.ceFalseOverride && isSelectorFormat(formatItem) && dom.is(node, formatItem.selector)) {\n            setElementFormat(node, formatItem);\n            break;\n          }\n        }\n        fireFormatApply(ed, name, node, vars);\n        return;\n      }\n      if (format) {\n        if (node) {\n          if (isNode(node)) {\n            if (!applyNodeStyle(formatList, node)) {\n              var rng = dom.createRng();\n              rng.setStartBefore(node);\n              rng.setEndAfter(node);\n              applyRngStyle(dom, expandRng(ed, rng, formatList), true);\n            }\n          } else {\n            applyRngStyle(dom, node, true);\n          }\n        } else {\n          if (!isCollapsed || !isInlineFormat(format) || getCellsFromEditor(ed).length) {\n            var curSelNode = selection.getNode();\n            var firstFormat = formatList[0];\n            if (!ed.settings.forced_root_block && firstFormat.defaultBlock && !dom.getParent(curSelNode, dom.isBlock)) {\n              applyFormat$1(ed, firstFormat.defaultBlock);\n            }\n            selection.setRng(normalize(selection.getRng()));\n            preserve(selection, true, function () {\n              runOnRanges(ed, function (selectionRng, fake) {\n                var expandedRng = fake ? selectionRng : expandRng(ed, selectionRng, formatList);\n                applyRngStyle(dom, expandedRng, false);\n              });\n            });\n            moveStart(dom, selection, selection.getRng());\n            ed.nodeChanged();\n          } else {\n            applyCaretFormat(ed, name, vars);\n          }\n        }\n        postProcess$1(name, ed);\n      }\n      fireFormatApply(ed, name, node, vars);\n    };\n\n    var hasVars = function (value) {\n      return has$2(value, 'vars');\n    };\n    var setup$j = function (registeredFormatListeners, editor) {\n      registeredFormatListeners.set({});\n      editor.on('NodeChange', function (e) {\n        updateAndFireChangeCallbacks(editor, e.element, registeredFormatListeners.get());\n      });\n      editor.on('FormatApply FormatRemove', function (e) {\n        var element = Optional.from(e.node).map(function (nodeOrRange) {\n          return isNode(nodeOrRange) ? nodeOrRange : nodeOrRange.startContainer;\n        }).bind(function (node) {\n          return isElement$5(node) ? Optional.some(node) : Optional.from(node.parentElement);\n        }).getOrThunk(function () {\n          return fallbackElement(editor);\n        });\n        updateAndFireChangeCallbacks(editor, element, registeredFormatListeners.get());\n      });\n    };\n    var fallbackElement = function (editor) {\n      return editor.selection.getStart();\n    };\n    var matchingNode = function (editor, parents, format, similar, vars) {\n      var isMatchingNode = function (node) {\n        var matchingFormat = editor.formatter.matchNode(node, format, vars !== null && vars !== void 0 ? vars : {}, similar);\n        return !isUndefined(matchingFormat);\n      };\n      var isUnableToMatch = function (node) {\n        if (matchesUnInheritedFormatSelector(editor, node, format)) {\n          return true;\n        } else {\n          if (!similar) {\n            return isNonNullable(editor.formatter.matchNode(node, format, vars, true));\n          } else {\n            return false;\n          }\n        }\n      };\n      return findUntil$1(parents, isMatchingNode, isUnableToMatch);\n    };\n    var getParents = function (editor, elm) {\n      var element = elm !== null && elm !== void 0 ? elm : fallbackElement(editor);\n      return filter$4(getParents$2(editor.dom, element), function (node) {\n        return isElement$5(node) && !isBogus$2(node);\n      });\n    };\n    var updateAndFireChangeCallbacks = function (editor, elm, registeredCallbacks) {\n      var parents = getParents(editor, elm);\n      each$j(registeredCallbacks, function (data, format) {\n        var runIfChanged = function (spec) {\n          var match = matchingNode(editor, parents, format, spec.similar, hasVars(spec) ? spec.vars : undefined);\n          var isSet = match.isSome();\n          if (spec.state.get() !== isSet) {\n            spec.state.set(isSet);\n            var node_1 = match.getOr(elm);\n            if (hasVars(spec)) {\n              spec.callback(isSet, {\n                node: node_1,\n                format: format,\n                parents: parents\n              });\n            } else {\n              each$k(spec.callbacks, function (callback) {\n                return callback(isSet, {\n                  node: node_1,\n                  format: format,\n                  parents: parents\n                });\n              });\n            }\n          }\n        };\n        each$k([\n          data.withSimilar,\n          data.withoutSimilar\n        ], runIfChanged);\n        each$k(data.withVars, runIfChanged);\n      });\n    };\n    var addListeners = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each$k(formats.split(','), function (format) {\n        var group = get$9(formatChangeItems, format).getOrThunk(function () {\n          var base = {\n            withSimilar: {\n              state: Cell(false),\n              similar: true,\n              callbacks: []\n            },\n            withoutSimilar: {\n              state: Cell(false),\n              similar: false,\n              callbacks: []\n            },\n            withVars: []\n          };\n          formatChangeItems[format] = base;\n          return base;\n        });\n        var getCurrent = function () {\n          var parents = getParents(editor);\n          return matchingNode(editor, parents, format, similar, vars).isSome();\n        };\n        if (isUndefined(vars)) {\n          var toAppendTo = similar ? group.withSimilar : group.withoutSimilar;\n          toAppendTo.callbacks.push(callback);\n          if (toAppendTo.callbacks.length === 1) {\n            toAppendTo.state.set(getCurrent());\n          }\n        } else {\n          group.withVars.push({\n            state: Cell(getCurrent()),\n            similar: similar,\n            vars: vars,\n            callback: callback\n          });\n        }\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var removeListeners = function (registeredFormatListeners, formats, callback) {\n      var formatChangeItems = registeredFormatListeners.get();\n      each$k(formats.split(','), function (format) {\n        return get$9(formatChangeItems, format).each(function (group) {\n          formatChangeItems[format] = {\n            withSimilar: __assign(__assign({}, group.withSimilar), {\n              callbacks: filter$4(group.withSimilar.callbacks, function (cb) {\n                return cb !== callback;\n              })\n            }),\n            withoutSimilar: __assign(__assign({}, group.withoutSimilar), {\n              callbacks: filter$4(group.withoutSimilar.callbacks, function (cb) {\n                return cb !== callback;\n              })\n            }),\n            withVars: filter$4(group.withVars, function (item) {\n              return item.callback !== callback;\n            })\n          };\n        });\n      });\n      registeredFormatListeners.set(formatChangeItems);\n    };\n    var formatChangedInternal = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n      if (registeredFormatListeners.get() === null) {\n        setup$j(registeredFormatListeners, editor);\n      }\n      addListeners(editor, registeredFormatListeners, formats, callback, similar, vars);\n      return {\n        unbind: function () {\n          return removeListeners(registeredFormatListeners, formats, callback);\n        }\n      };\n    };\n\n    var toggle = function (editor, name, vars, node) {\n      var fmt = editor.formatter.get(name);\n      if (match$2(editor, name, vars, node) && (!('toggle' in fmt[0]) || fmt[0].toggle)) {\n        remove$1(editor, name, vars, node);\n      } else {\n        applyFormat$1(editor, name, vars, node);\n      }\n    };\n\n    var fromElements = function (elements, scope) {\n      var doc = scope || document;\n      var fragment = doc.createDocumentFragment();\n      each$k(elements, function (element) {\n        fragment.appendChild(element.dom);\n      });\n      return SugarElement.fromDom(fragment);\n    };\n\n    var tableModel = function (element, width, rows) {\n      return {\n        element: element,\n        width: width,\n        rows: rows\n      };\n    };\n    var tableRow = function (element, cells) {\n      return {\n        element: element,\n        cells: cells\n      };\n    };\n    var cellPosition = function (x, y) {\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var getSpan = function (td, key) {\n      var value = parseInt(get$6(td, key), 10);\n      return isNaN(value) ? 1 : value;\n    };\n    var fillout = function (table, x, y, tr, td) {\n      var rowspan = getSpan(td, 'rowspan');\n      var colspan = getSpan(td, 'colspan');\n      var rows = table.rows;\n      for (var y2 = y; y2 < y + rowspan; y2++) {\n        if (!rows[y2]) {\n          rows[y2] = tableRow(deep$1(tr), []);\n        }\n        for (var x2 = x; x2 < x + colspan; x2++) {\n          var cells = rows[y2].cells;\n          cells[x2] = y2 === y && x2 === x ? td : shallow(td);\n        }\n      }\n    };\n    var cellExists = function (table, x, y) {\n      var rows = table.rows;\n      var cells = rows[y] ? rows[y].cells : [];\n      return !!cells[x];\n    };\n    var skipCellsX = function (table, x, y) {\n      while (cellExists(table, x, y)) {\n        x++;\n      }\n      return x;\n    };\n    var getWidth = function (rows) {\n      return foldl(rows, function (acc, row) {\n        return row.cells.length > acc ? row.cells.length : acc;\n      }, 0);\n    };\n    var findElementPos = function (table, element) {\n      var rows = table.rows;\n      for (var y = 0; y < rows.length; y++) {\n        var cells = rows[y].cells;\n        for (var x = 0; x < cells.length; x++) {\n          if (eq(cells[x], element)) {\n            return Optional.some(cellPosition(x, y));\n          }\n        }\n      }\n      return Optional.none();\n    };\n    var extractRows = function (table, sx, sy, ex, ey) {\n      var newRows = [];\n      var rows = table.rows;\n      for (var y = sy; y <= ey; y++) {\n        var cells = rows[y].cells;\n        var slice = sx < ex ? cells.slice(sx, ex + 1) : cells.slice(ex, sx + 1);\n        newRows.push(tableRow(rows[y].element, slice));\n      }\n      return newRows;\n    };\n    var subTable = function (table, startPos, endPos) {\n      var sx = startPos.x, sy = startPos.y;\n      var ex = endPos.x, ey = endPos.y;\n      var newRows = sy < ey ? extractRows(table, sx, sy, ex, ey) : extractRows(table, sx, ey, ex, sy);\n      return tableModel(table.element, getWidth(newRows), newRows);\n    };\n    var createDomTable = function (table, rows) {\n      var tableElement = shallow(table.element);\n      var tableBody = SugarElement.fromTag('tbody');\n      append(tableBody, rows);\n      append$1(tableElement, tableBody);\n      return tableElement;\n    };\n    var modelRowsToDomRows = function (table) {\n      return map$3(table.rows, function (row) {\n        var cells = map$3(row.cells, function (cell) {\n          var td = deep$1(cell);\n          remove$6(td, 'colspan');\n          remove$6(td, 'rowspan');\n          return td;\n        });\n        var tr = shallow(row.element);\n        append(tr, cells);\n        return tr;\n      });\n    };\n    var fromDom = function (tableElm) {\n      var table = tableModel(shallow(tableElm), 0, []);\n      each$k(descendants(tableElm, 'tr'), function (tr, y) {\n        each$k(descendants(tr, 'td,th'), function (td, x) {\n          fillout(table, skipCellsX(table, x, y), y, tr, td);\n        });\n      });\n      return tableModel(table.element, getWidth(table.rows), table.rows);\n    };\n    var toDom = function (table) {\n      return createDomTable(table, modelRowsToDomRows(table));\n    };\n    var subsection = function (table, startElement, endElement) {\n      return findElementPos(table, startElement).bind(function (startPos) {\n        return findElementPos(table, endElement).map(function (endPos) {\n          return subTable(table, startPos, endPos);\n        });\n      });\n    };\n\n    var findParentListContainer = function (parents) {\n      return find$3(parents, function (elm) {\n        return name(elm) === 'ul' || name(elm) === 'ol';\n      });\n    };\n    var getFullySelectedListWrappers = function (parents, rng) {\n      return find$3(parents, function (elm) {\n        return name(elm) === 'li' && hasAllContentsSelected(elm, rng);\n      }).fold(constant([]), function (_li) {\n        return findParentListContainer(parents).map(function (listCont) {\n          var listElm = SugarElement.fromTag(name(listCont));\n          var listStyles = filter$3(getAllRaw(listCont), function (_style, name) {\n            return startsWith(name, 'list-style');\n          });\n          setAll(listElm, listStyles);\n          return [\n            SugarElement.fromTag('li'),\n            listElm\n          ];\n        }).getOr([]);\n      });\n    };\n    var wrap = function (innerElm, elms) {\n      var wrapped = foldl(elms, function (acc, elm) {\n        append$1(elm, acc);\n        return elm;\n      }, innerElm);\n      return elms.length > 0 ? fromElements([wrapped]) : wrapped;\n    };\n    var directListWrappers = function (commonAnchorContainer) {\n      if (isListItem(commonAnchorContainer)) {\n        return parent(commonAnchorContainer).filter(isList).fold(constant([]), function (listElm) {\n          return [\n            commonAnchorContainer,\n            listElm\n          ];\n        });\n      } else {\n        return isList(commonAnchorContainer) ? [commonAnchorContainer] : [];\n      }\n    };\n    var getWrapElements = function (rootNode, rng) {\n      var commonAnchorContainer = SugarElement.fromDom(rng.commonAncestorContainer);\n      var parents = parentsAndSelf(commonAnchorContainer, rootNode);\n      var wrapElements = filter$4(parents, function (elm) {\n        return isInline$1(elm) || isHeading(elm);\n      });\n      var listWrappers = getFullySelectedListWrappers(parents, rng);\n      var allWrappers = wrapElements.concat(listWrappers.length ? listWrappers : directListWrappers(commonAnchorContainer));\n      return map$3(allWrappers, shallow);\n    };\n    var emptyFragment = function () {\n      return fromElements([]);\n    };\n    var getFragmentFromRange = function (rootNode, rng) {\n      return wrap(SugarElement.fromDom(rng.cloneContents()), getWrapElements(rootNode, rng));\n    };\n    var getParentTable = function (rootElm, cell) {\n      return ancestor$2(cell, 'table', curry(eq, rootElm));\n    };\n    var getTableFragment = function (rootNode, selectedTableCells) {\n      return getParentTable(rootNode, selectedTableCells[0]).bind(function (tableElm) {\n        var firstCell = selectedTableCells[0];\n        var lastCell = selectedTableCells[selectedTableCells.length - 1];\n        var fullTableModel = fromDom(tableElm);\n        return subsection(fullTableModel, firstCell, lastCell).map(function (sectionedTableModel) {\n          return fromElements([toDom(sectionedTableModel)]);\n        });\n      }).getOrThunk(emptyFragment);\n    };\n    var getSelectionFragment = function (rootNode, ranges) {\n      return ranges.length > 0 && ranges[0].collapsed ? emptyFragment() : getFragmentFromRange(rootNode, ranges[0]);\n    };\n    var read$3 = function (rootNode, ranges) {\n      var selectedCells = getCellsFromElementOrRanges(ranges, rootNode);\n      return selectedCells.length > 0 ? getTableFragment(rootNode, selectedCells) : getSelectionFragment(rootNode, ranges);\n    };\n\n    var trimLeadingCollapsibleText = function (text) {\n      return text.replace(/^[ \\f\\n\\r\\t\\v]+/, '');\n    };\n    var isCollapsibleWhitespace = function (text, index) {\n      return index >= 0 && index < text.length && isWhiteSpace(text.charAt(index));\n    };\n    var getInnerText = function (bin, shouldTrim) {\n      var text = trim$2(bin.innerText);\n      return shouldTrim ? trimLeadingCollapsibleText(text) : text;\n    };\n    var getContextNodeName = function (parentBlockOpt) {\n      return parentBlockOpt.map(function (block) {\n        return block.nodeName;\n      }).getOr('div').toLowerCase();\n    };\n    var getTextContent = function (editor) {\n      return Optional.from(editor.selection.getRng()).map(function (rng) {\n        var parentBlockOpt = Optional.from(editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock));\n        var body = editor.getBody();\n        var contextNodeName = getContextNodeName(parentBlockOpt);\n        var shouldTrimSpaces = Env.browser.isIE() && contextNodeName !== 'pre';\n        var bin = editor.dom.add(body, contextNodeName, {\n          'data-mce-bogus': 'all',\n          'style': 'overflow: hidden; opacity: 0;'\n        }, rng.cloneContents());\n        var text = getInnerText(bin, shouldTrimSpaces);\n        var nonRenderedText = trim$2(bin.textContent);\n        editor.dom.remove(bin);\n        if (isCollapsibleWhitespace(nonRenderedText, 0) || isCollapsibleWhitespace(nonRenderedText, nonRenderedText.length - 1)) {\n          var parentBlock = parentBlockOpt.getOr(body);\n          var parentBlockText = getInnerText(parentBlock, shouldTrimSpaces);\n          var textIndex = parentBlockText.indexOf(text);\n          if (textIndex === -1) {\n            return text;\n          } else {\n            var hasProceedingSpace = isCollapsibleWhitespace(parentBlockText, textIndex - 1);\n            var hasTrailingSpace = isCollapsibleWhitespace(parentBlockText, textIndex + text.length);\n            return (hasProceedingSpace ? ' ' : '') + text + (hasTrailingSpace ? ' ' : '');\n          }\n        } else {\n          return text;\n        }\n      }).getOr('');\n    };\n    var getSerializedContent = function (editor, args) {\n      var rng = editor.selection.getRng(), tmpElm = editor.dom.create('body');\n      var sel = editor.selection.getSel();\n      var ranges = processRanges(editor, getRanges(sel));\n      var fragment = args.contextual ? read$3(SugarElement.fromDom(editor.getBody()), ranges).dom : rng.cloneContents();\n      if (fragment) {\n        tmpElm.appendChild(fragment);\n      }\n      return editor.selection.serializer.serialize(tmpElm, args);\n    };\n    var setupArgs$1 = function (args, format) {\n      return __assign(__assign({}, args), {\n        format: format,\n        get: true,\n        selection: true\n      });\n    };\n    var getSelectedContentInternal = function (editor, format, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var defaultedArgs = setupArgs$1(args, format);\n      var updatedArgs = editor.fire('BeforeGetContent', defaultedArgs);\n      if (updatedArgs.isDefaultPrevented()) {\n        editor.fire('GetContent', updatedArgs);\n        return updatedArgs.content;\n      }\n      if (updatedArgs.format === 'text') {\n        return getTextContent(editor);\n      } else {\n        updatedArgs.getInner = true;\n        var content = getSerializedContent(editor, updatedArgs);\n        if (updatedArgs.format === 'tree') {\n          return content;\n        } else {\n          updatedArgs.content = editor.selection.isCollapsed() ? '' : content;\n          editor.fire('GetContent', updatedArgs);\n          return updatedArgs.content;\n        }\n      }\n    };\n\n    var KEEP = 0, INSERT = 1, DELETE = 2;\n    var diff = function (left, right) {\n      var size = left.length + right.length + 2;\n      var vDown = new Array(size);\n      var vUp = new Array(size);\n      var snake = function (start, end, diag) {\n        return {\n          start: start,\n          end: end,\n          diag: diag\n        };\n      };\n      var buildScript = function (start1, end1, start2, end2, script) {\n        var middle = getMiddleSnake(start1, end1, start2, end2);\n        if (middle === null || middle.start === end1 && middle.diag === end1 - end2 || middle.end === start1 && middle.diag === start1 - start2) {\n          var i = start1;\n          var j = start2;\n          while (i < end1 || j < end2) {\n            if (i < end1 && j < end2 && left[i] === right[j]) {\n              script.push([\n                KEEP,\n                left[i]\n              ]);\n              ++i;\n              ++j;\n            } else {\n              if (end1 - start1 > end2 - start2) {\n                script.push([\n                  DELETE,\n                  left[i]\n                ]);\n                ++i;\n              } else {\n                script.push([\n                  INSERT,\n                  right[j]\n                ]);\n                ++j;\n              }\n            }\n          }\n        } else {\n          buildScript(start1, middle.start, start2, middle.start - middle.diag, script);\n          for (var i2 = middle.start; i2 < middle.end; ++i2) {\n            script.push([\n              KEEP,\n              left[i2]\n            ]);\n          }\n          buildScript(middle.end, end1, middle.end - middle.diag, end2, script);\n        }\n      };\n      var buildSnake = function (start, diag, end1, end2) {\n        var end = start;\n        while (end - diag < end2 && end < end1 && left[end] === right[end - diag]) {\n          ++end;\n        }\n        return snake(start, end, diag);\n      };\n      var getMiddleSnake = function (start1, end1, start2, end2) {\n        var m = end1 - start1;\n        var n = end2 - start2;\n        if (m === 0 || n === 0) {\n          return null;\n        }\n        var delta = m - n;\n        var sum = n + m;\n        var offset = (sum % 2 === 0 ? sum : sum + 1) / 2;\n        vDown[1 + offset] = start1;\n        vUp[1 + offset] = end1 + 1;\n        var d, k, i, x, y;\n        for (d = 0; d <= offset; ++d) {\n          for (k = -d; k <= d; k += 2) {\n            i = k + offset;\n            if (k === -d || k !== d && vDown[i - 1] < vDown[i + 1]) {\n              vDown[i] = vDown[i + 1];\n            } else {\n              vDown[i] = vDown[i - 1] + 1;\n            }\n            x = vDown[i];\n            y = x - start1 + start2 - k;\n            while (x < end1 && y < end2 && left[x] === right[y]) {\n              vDown[i] = ++x;\n              ++y;\n            }\n            if (delta % 2 !== 0 && delta - d <= k && k <= delta + d) {\n              if (vUp[i - delta] <= vDown[i]) {\n                return buildSnake(vUp[i - delta], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n          for (k = delta - d; k <= delta + d; k += 2) {\n            i = k + offset - delta;\n            if (k === delta - d || k !== delta + d && vUp[i + 1] <= vUp[i - 1]) {\n              vUp[i] = vUp[i + 1] - 1;\n            } else {\n              vUp[i] = vUp[i - 1];\n            }\n            x = vUp[i] - 1;\n            y = x - start1 + start2 - k;\n            while (x >= start1 && y >= start2 && left[x] === right[y]) {\n              vUp[i] = x--;\n              y--;\n            }\n            if (delta % 2 === 0 && -d <= k && k <= d) {\n              if (vUp[i] <= vDown[i + delta]) {\n                return buildSnake(vUp[i], k + start1 - start2, end1, end2);\n              }\n            }\n          }\n        }\n      };\n      var script = [];\n      buildScript(0, left.length, 0, right.length, script);\n      return script;\n    };\n\n    var getOuterHtml = function (elm) {\n      if (isElement$5(elm)) {\n        return elm.outerHTML;\n      } else if (isText$7(elm)) {\n        return Entities.encodeRaw(elm.data, false);\n      } else if (isComment(elm)) {\n        return '<!--' + elm.data + '-->';\n      }\n      return '';\n    };\n    var createFragment = function (html) {\n      var node;\n      var container = document.createElement('div');\n      var frag = document.createDocumentFragment();\n      if (html) {\n        container.innerHTML = html;\n      }\n      while (node = container.firstChild) {\n        frag.appendChild(node);\n      }\n      return frag;\n    };\n    var insertAt = function (elm, html, index) {\n      var fragment = createFragment(html);\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.insertBefore(fragment, target);\n      } else {\n        elm.appendChild(fragment);\n      }\n    };\n    var removeAt = function (elm, index) {\n      if (elm.hasChildNodes() && index < elm.childNodes.length) {\n        var target = elm.childNodes[index];\n        target.parentNode.removeChild(target);\n      }\n    };\n    var applyDiff = function (diff, elm) {\n      var index = 0;\n      each$k(diff, function (action) {\n        if (action[0] === KEEP) {\n          index++;\n        } else if (action[0] === INSERT) {\n          insertAt(elm, action[1], index);\n          index++;\n        } else if (action[0] === DELETE) {\n          removeAt(elm, index);\n        }\n      });\n    };\n    var read$2 = function (elm) {\n      return filter$4(map$3(from(elm.childNodes), getOuterHtml), function (item) {\n        return item.length > 0;\n      });\n    };\n    var write = function (fragments, elm) {\n      var currentFragments = map$3(from(elm.childNodes), getOuterHtml);\n      applyDiff(diff(currentFragments, fragments), elm);\n      return elm;\n    };\n\n    var lazyTempDocument = cached(function () {\n      return document.implementation.createHTMLDocument('undo');\n    });\n    var hasIframes = function (html) {\n      return html.indexOf('</iframe>') !== -1;\n    };\n    var createFragmentedLevel = function (fragments) {\n      return {\n        type: 'fragmented',\n        fragments: fragments,\n        content: '',\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createCompleteLevel = function (content) {\n      return {\n        type: 'complete',\n        fragments: null,\n        content: content,\n        bookmark: null,\n        beforeBookmark: null\n      };\n    };\n    var createFromEditor = function (editor) {\n      var fragments = read$2(editor.getBody());\n      var trimmedFragments = bind(fragments, function (html) {\n        var trimmed = trimInternal(editor.serializer, html);\n        return trimmed.length > 0 ? [trimmed] : [];\n      });\n      var content = trimmedFragments.join('');\n      return hasIframes(content) ? createFragmentedLevel(trimmedFragments) : createCompleteLevel(content);\n    };\n    var applyToEditor = function (editor, level, before) {\n      var bookmark = before ? level.beforeBookmark : level.bookmark;\n      if (level.type === 'fragmented') {\n        write(level.fragments, editor.getBody());\n      } else {\n        editor.setContent(level.content, {\n          format: 'raw',\n          no_selection: isNonNullable(bookmark) && isPathBookmark(bookmark) ? !bookmark.isFakeCaret : true\n        });\n      }\n      editor.selection.moveToBookmark(bookmark);\n    };\n    var getLevelContent = function (level) {\n      return level.type === 'fragmented' ? level.fragments.join('') : level.content;\n    };\n    var getCleanLevelContent = function (level) {\n      var elm = SugarElement.fromTag('body', lazyTempDocument());\n      set(elm, getLevelContent(level));\n      each$k(descendants(elm, '*[data-mce-bogus]'), unwrap);\n      return get$3(elm);\n    };\n    var hasEqualContent = function (level1, level2) {\n      return getLevelContent(level1) === getLevelContent(level2);\n    };\n    var hasEqualCleanedContent = function (level1, level2) {\n      return getCleanLevelContent(level1) === getCleanLevelContent(level2);\n    };\n    var isEq$1 = function (level1, level2) {\n      if (!level1 || !level2) {\n        return false;\n      } else if (hasEqualContent(level1, level2)) {\n        return true;\n      } else {\n        return hasEqualCleanedContent(level1, level2);\n      }\n    };\n\n    var isUnlocked = function (locks) {\n      return locks.get() === 0;\n    };\n\n    var setTyping = function (undoManager, typing, locks) {\n      if (isUnlocked(locks)) {\n        undoManager.typing = typing;\n      }\n    };\n    var endTyping = function (undoManager, locks) {\n      if (undoManager.typing) {\n        setTyping(undoManager, false, locks);\n        undoManager.add();\n      }\n    };\n    var endTypingLevelIgnoreLocks = function (undoManager) {\n      if (undoManager.typing) {\n        undoManager.typing = false;\n        undoManager.add();\n      }\n    };\n\n    var beforeChange$1 = function (editor, locks, beforeBookmark) {\n      if (isUnlocked(locks)) {\n        beforeBookmark.set(getUndoBookmark(editor.selection));\n      }\n    };\n    var addUndoLevel$1 = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      var currentLevel = createFromEditor(editor);\n      level = level || {};\n      level = Tools.extend(level, currentLevel);\n      if (isUnlocked(locks) === false || editor.removed) {\n        return null;\n      }\n      var lastLevel = undoManager.data[index.get()];\n      if (editor.fire('BeforeAddUndo', {\n          level: level,\n          lastLevel: lastLevel,\n          originalEvent: event\n        }).isDefaultPrevented()) {\n        return null;\n      }\n      if (lastLevel && isEq$1(lastLevel, level)) {\n        return null;\n      }\n      if (undoManager.data[index.get()]) {\n        beforeBookmark.get().each(function (bm) {\n          undoManager.data[index.get()].beforeBookmark = bm;\n        });\n      }\n      var customUndoRedoLevels = getCustomUndoRedoLevels(editor);\n      if (customUndoRedoLevels) {\n        if (undoManager.data.length > customUndoRedoLevels) {\n          for (var i = 0; i < undoManager.data.length - 1; i++) {\n            undoManager.data[i] = undoManager.data[i + 1];\n          }\n          undoManager.data.length--;\n          index.set(undoManager.data.length);\n        }\n      }\n      level.bookmark = getUndoBookmark(editor.selection);\n      if (index.get() < undoManager.data.length - 1) {\n        undoManager.data.length = index.get() + 1;\n      }\n      undoManager.data.push(level);\n      index.set(undoManager.data.length - 1);\n      var args = {\n        level: level,\n        lastLevel: lastLevel,\n        originalEvent: event\n      };\n      if (index.get() > 0) {\n        editor.setDirty(true);\n        editor.fire('AddUndo', args);\n        editor.fire('change', args);\n      } else {\n        editor.fire('AddUndo', args);\n      }\n      return level;\n    };\n    var clear$1 = function (editor, undoManager, index) {\n      undoManager.data = [];\n      index.set(0);\n      undoManager.typing = false;\n      editor.fire('ClearUndos');\n    };\n    var extra$1 = function (editor, undoManager, index, callback1, callback2) {\n      if (undoManager.transact(callback1)) {\n        var bookmark = undoManager.data[index.get()].bookmark;\n        var lastLevel = undoManager.data[index.get() - 1];\n        applyToEditor(editor, lastLevel, true);\n        if (undoManager.transact(callback2)) {\n          undoManager.data[index.get() - 1].beforeBookmark = bookmark;\n        }\n      }\n    };\n    var redo$1 = function (editor, index, data) {\n      var level;\n      if (index.get() < data.length - 1) {\n        index.set(index.get() + 1);\n        level = data[index.get()];\n        applyToEditor(editor, level, false);\n        editor.setDirty(true);\n        editor.fire('Redo', { level: level });\n      }\n      return level;\n    };\n    var undo$1 = function (editor, undoManager, locks, index) {\n      var level;\n      if (undoManager.typing) {\n        undoManager.add();\n        undoManager.typing = false;\n        setTyping(undoManager, false, locks);\n      }\n      if (index.get() > 0) {\n        index.set(index.get() - 1);\n        level = undoManager.data[index.get()];\n        applyToEditor(editor, level, true);\n        editor.setDirty(true);\n        editor.fire('Undo', { level: level });\n      }\n      return level;\n    };\n    var reset$1 = function (undoManager) {\n      undoManager.clear();\n      undoManager.add();\n    };\n    var hasUndo$1 = function (editor, undoManager, index) {\n      return index.get() > 0 || undoManager.typing && undoManager.data[0] && !isEq$1(createFromEditor(editor), undoManager.data[0]);\n    };\n    var hasRedo$1 = function (undoManager, index) {\n      return index.get() < undoManager.data.length - 1 && !undoManager.typing;\n    };\n    var transact$1 = function (undoManager, locks, callback) {\n      endTyping(undoManager, locks);\n      undoManager.beforeChange();\n      undoManager.ignore(callback);\n      return undoManager.add();\n    };\n    var ignore$1 = function (locks, callback) {\n      try {\n        locks.set(locks.get() + 1);\n        callback();\n      } finally {\n        locks.set(locks.get() - 1);\n      }\n    };\n\n    var addVisualInternal = function (editor, elm) {\n      var dom = editor.dom;\n      var scope = isNonNullable(elm) ? elm : editor.getBody();\n      if (isUndefined(editor.hasVisual)) {\n        editor.hasVisual = isVisualAidsEnabled(editor);\n      }\n      each$k(dom.select('table,a', scope), function (matchedElm) {\n        switch (matchedElm.nodeName) {\n        case 'TABLE':\n          var cls = getVisualAidsTableClass(editor);\n          var value = dom.getAttrib(matchedElm, 'border');\n          if ((!value || value === '0') && editor.hasVisual) {\n            dom.addClass(matchedElm, cls);\n          } else {\n            dom.removeClass(matchedElm, cls);\n          }\n          break;\n        case 'A':\n          if (!dom.getAttrib(matchedElm, 'href')) {\n            var value_1 = dom.getAttrib(matchedElm, 'name') || matchedElm.id;\n            var cls_1 = getVisualAidsAnchorClass(editor);\n            if (value_1 && editor.hasVisual) {\n              dom.addClass(matchedElm, cls_1);\n            } else {\n              dom.removeClass(matchedElm, cls_1);\n            }\n          }\n          break;\n        }\n      });\n      editor.fire('VisualAid', {\n        element: elm,\n        hasVisual: editor.hasVisual\n      });\n    };\n\n    var makePlainAdaptor = function (editor) {\n      return {\n        undoManager: {\n          beforeChange: function (locks, beforeBookmark) {\n            return beforeChange$1(editor, locks, beforeBookmark);\n          },\n          add: function (undoManager, index, locks, beforeBookmark, level, event) {\n            return addUndoLevel$1(editor, undoManager, index, locks, beforeBookmark, level, event);\n          },\n          undo: function (undoManager, locks, index) {\n            return undo$1(editor, undoManager, locks, index);\n          },\n          redo: function (index, data) {\n            return redo$1(editor, index, data);\n          },\n          clear: function (undoManager, index) {\n            return clear$1(editor, undoManager, index);\n          },\n          reset: function (undoManager) {\n            return reset$1(undoManager);\n          },\n          hasUndo: function (undoManager, index) {\n            return hasUndo$1(editor, undoManager, index);\n          },\n          hasRedo: function (undoManager, index) {\n            return hasRedo$1(undoManager, index);\n          },\n          transact: function (undoManager, locks, callback) {\n            return transact$1(undoManager, locks, callback);\n          },\n          ignore: function (locks, callback) {\n            return ignore$1(locks, callback);\n          },\n          extra: function (undoManager, index, callback1, callback2) {\n            return extra$1(editor, undoManager, index, callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, node, similar) {\n            return match$2(editor, name, vars, node, similar);\n          },\n          matchAll: function (names, vars) {\n            return matchAll(editor, names, vars);\n          },\n          matchNode: function (node, name, vars, similar) {\n            return matchNode(editor, node, name, vars, similar);\n          },\n          canApply: function (name) {\n            return canApply(editor, name);\n          },\n          closest: function (names) {\n            return closest(editor, names);\n          },\n          apply: function (name, vars, node) {\n            return applyFormat$1(editor, name, vars, node);\n          },\n          remove: function (name, vars, node, similar) {\n            return remove$1(editor, name, vars, node, similar);\n          },\n          toggle: function (name, vars, node) {\n            return toggle(editor, name, vars, node);\n          },\n          formatChanged: function (registeredFormatListeners, formats, callback, similar, vars) {\n            return formatChangedInternal(editor, registeredFormatListeners, formats, callback, similar, vars);\n          }\n        },\n        editor: {\n          getContent: function (args, format) {\n            return getContentInternal(editor, args, format);\n          },\n          setContent: function (content, args) {\n            return setContentInternal(editor, content, args);\n          },\n          insertContent: function (value, details) {\n            return insertHtmlAtCaret(editor, value, details);\n          },\n          addVisual: function (elm) {\n            return addVisualInternal(editor, elm);\n          }\n        },\n        selection: {\n          getContent: function (format, args) {\n            return getSelectedContentInternal(editor, format, args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.none();\n          }\n        }\n      };\n    };\n    var makeRtcAdaptor = function (rtcEditor) {\n      var defaultVars = function (vars) {\n        return isObject(vars) ? vars : {};\n      };\n      var undoManager = rtcEditor.undoManager, formatter = rtcEditor.formatter, editor = rtcEditor.editor, selection = rtcEditor.selection, raw = rtcEditor.raw;\n      return {\n        undoManager: {\n          beforeChange: undoManager.beforeChange,\n          add: undoManager.add,\n          undo: undoManager.undo,\n          redo: undoManager.redo,\n          clear: undoManager.clear,\n          reset: undoManager.reset,\n          hasUndo: undoManager.hasUndo,\n          hasRedo: undoManager.hasRedo,\n          transact: function (_undoManager, _locks, fn) {\n            return undoManager.transact(fn);\n          },\n          ignore: function (_locks, callback) {\n            return undoManager.ignore(callback);\n          },\n          extra: function (_undoManager, _index, callback1, callback2) {\n            return undoManager.extra(callback1, callback2);\n          }\n        },\n        formatter: {\n          match: function (name, vars, _node, similar) {\n            return formatter.match(name, defaultVars(vars), similar);\n          },\n          matchAll: formatter.matchAll,\n          matchNode: formatter.matchNode,\n          canApply: function (name) {\n            return formatter.canApply(name);\n          },\n          closest: function (names) {\n            return formatter.closest(names);\n          },\n          apply: function (name, vars, _node) {\n            return formatter.apply(name, defaultVars(vars));\n          },\n          remove: function (name, vars, _node, _similar) {\n            return formatter.remove(name, defaultVars(vars));\n          },\n          toggle: function (name, vars, _node) {\n            return formatter.toggle(name, defaultVars(vars));\n          },\n          formatChanged: function (_rfl, formats, callback, similar, vars) {\n            return formatter.formatChanged(formats, callback, similar, vars);\n          }\n        },\n        editor: {\n          getContent: function (args, _format) {\n            return editor.getContent(args);\n          },\n          setContent: function (content, args) {\n            return editor.setContent(content, args);\n          },\n          insertContent: function (content, _details) {\n            return editor.insertContent(content);\n          },\n          addVisual: editor.addVisual\n        },\n        selection: {\n          getContent: function (_format, args) {\n            return selection.getContent(args);\n          }\n        },\n        raw: {\n          getModel: function () {\n            return Optional.some(raw.getRawModel());\n          }\n        }\n      };\n    };\n    var makeNoopAdaptor = function () {\n      var nul = constant(null);\n      var empty = constant('');\n      return {\n        undoManager: {\n          beforeChange: noop,\n          add: nul,\n          undo: nul,\n          redo: nul,\n          clear: noop,\n          reset: noop,\n          hasUndo: never,\n          hasRedo: never,\n          transact: nul,\n          ignore: noop,\n          extra: noop\n        },\n        formatter: {\n          match: never,\n          matchAll: constant([]),\n          matchNode: constant(undefined),\n          canApply: never,\n          closest: empty,\n          apply: noop,\n          remove: noop,\n          toggle: noop,\n          formatChanged: constant({ unbind: noop })\n        },\n        editor: {\n          getContent: empty,\n          setContent: empty,\n          insertContent: noop,\n          addVisual: noop\n        },\n        selection: { getContent: empty },\n        raw: { getModel: constant(Optional.none()) }\n      };\n    };\n    var isRtc = function (editor) {\n      return has$2(editor.plugins, 'rtc');\n    };\n    var getRtcSetup = function (editor) {\n      return get$9(editor.plugins, 'rtc').bind(function (rtcPlugin) {\n        return Optional.from(rtcPlugin.setup);\n      });\n    };\n    var setup$i = function (editor) {\n      var editorCast = editor;\n      return getRtcSetup(editor).fold(function () {\n        editorCast.rtcInstance = makePlainAdaptor(editor);\n        return Optional.none();\n      }, function (setup) {\n        editorCast.rtcInstance = makeNoopAdaptor();\n        return Optional.some(function () {\n          return setup().then(function (rtcEditor) {\n            editorCast.rtcInstance = makeRtcAdaptor(rtcEditor);\n            return rtcEditor.rtc.isRemote;\n          });\n        });\n      });\n    };\n    var getRtcInstanceWithFallback = function (editor) {\n      return editor.rtcInstance ? editor.rtcInstance : makePlainAdaptor(editor);\n    };\n    var getRtcInstanceWithError = function (editor) {\n      var rtcInstance = editor.rtcInstance;\n      if (!rtcInstance) {\n        throw new Error('Failed to get RTC instance not yet initialized.');\n      } else {\n        return rtcInstance;\n      }\n    };\n    var beforeChange = function (editor, locks, beforeBookmark) {\n      getRtcInstanceWithError(editor).undoManager.beforeChange(locks, beforeBookmark);\n    };\n    var addUndoLevel = function (editor, undoManager, index, locks, beforeBookmark, level, event) {\n      return getRtcInstanceWithError(editor).undoManager.add(undoManager, index, locks, beforeBookmark, level, event);\n    };\n    var undo = function (editor, undoManager, locks, index) {\n      return getRtcInstanceWithError(editor).undoManager.undo(undoManager, locks, index);\n    };\n    var redo = function (editor, index, data) {\n      return getRtcInstanceWithError(editor).undoManager.redo(index, data);\n    };\n    var clear = function (editor, undoManager, index) {\n      getRtcInstanceWithError(editor).undoManager.clear(undoManager, index);\n    };\n    var reset = function (editor, undoManager) {\n      getRtcInstanceWithError(editor).undoManager.reset(undoManager);\n    };\n    var hasUndo = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasUndo(undoManager, index);\n    };\n    var hasRedo = function (editor, undoManager, index) {\n      return getRtcInstanceWithError(editor).undoManager.hasRedo(undoManager, index);\n    };\n    var transact = function (editor, undoManager, locks, callback) {\n      return getRtcInstanceWithError(editor).undoManager.transact(undoManager, locks, callback);\n    };\n    var ignore = function (editor, locks, callback) {\n      getRtcInstanceWithError(editor).undoManager.ignore(locks, callback);\n    };\n    var extra = function (editor, undoManager, index, callback1, callback2) {\n      getRtcInstanceWithError(editor).undoManager.extra(undoManager, index, callback1, callback2);\n    };\n    var matchFormat = function (editor, name, vars, node, similar) {\n      return getRtcInstanceWithError(editor).formatter.match(name, vars, node, similar);\n    };\n    var matchAllFormats = function (editor, names, vars) {\n      return getRtcInstanceWithError(editor).formatter.matchAll(names, vars);\n    };\n    var matchNodeFormat = function (editor, node, name, vars, similar) {\n      return getRtcInstanceWithError(editor).formatter.matchNode(node, name, vars, similar);\n    };\n    var canApplyFormat = function (editor, name) {\n      return getRtcInstanceWithError(editor).formatter.canApply(name);\n    };\n    var closestFormat = function (editor, names) {\n      return getRtcInstanceWithError(editor).formatter.closest(names);\n    };\n    var applyFormat = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.apply(name, vars, node);\n    };\n    var removeFormat = function (editor, name, vars, node, similar) {\n      getRtcInstanceWithError(editor).formatter.remove(name, vars, node, similar);\n    };\n    var toggleFormat = function (editor, name, vars, node) {\n      getRtcInstanceWithError(editor).formatter.toggle(name, vars, node);\n    };\n    var formatChanged = function (editor, registeredFormatListeners, formats, callback, similar, vars) {\n      return getRtcInstanceWithError(editor).formatter.formatChanged(registeredFormatListeners, formats, callback, similar, vars);\n    };\n    var getContent$2 = function (editor, args, format) {\n      return getRtcInstanceWithFallback(editor).editor.getContent(args, format);\n    };\n    var setContent$2 = function (editor, content, args) {\n      return getRtcInstanceWithFallback(editor).editor.setContent(content, args);\n    };\n    var insertContent = function (editor, value, details) {\n      return getRtcInstanceWithFallback(editor).editor.insertContent(value, details);\n    };\n    var getSelectedContent = function (editor, format, args) {\n      return getRtcInstanceWithError(editor).selection.getContent(format, args);\n    };\n    var addVisual$1 = function (editor, elm) {\n      return getRtcInstanceWithError(editor).editor.addVisual(elm);\n    };\n\n    var getContent$1 = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : 'html';\n      return getSelectedContent(editor, format, args);\n    };\n\n    var removeEmpty = function (text) {\n      if (text.dom.length === 0) {\n        remove$7(text);\n        return Optional.none();\n      } else {\n        return Optional.some(text);\n      }\n    };\n    var walkPastBookmark = function (node, start) {\n      return node.filter(function (elm) {\n        return BookmarkManager.isBookmarkNode(elm.dom);\n      }).bind(start ? nextSibling : prevSibling);\n    };\n    var merge = function (outer, inner, rng, start) {\n      var outerElm = outer.dom;\n      var innerElm = inner.dom;\n      var oldLength = start ? outerElm.length : innerElm.length;\n      if (start) {\n        mergeTextNodes(outerElm, innerElm, false, !start);\n        rng.setStart(innerElm, oldLength);\n      } else {\n        mergeTextNodes(innerElm, outerElm, false, !start);\n        rng.setEnd(innerElm, oldLength);\n      }\n    };\n    var normalizeTextIfRequired = function (inner, start) {\n      parent(inner).each(function (root) {\n        var text = inner.dom;\n        if (start && needsToBeNbspLeft(root, CaretPosition(text, 0))) {\n          normalizeWhitespaceAfter(text, 0);\n        } else if (!start && needsToBeNbspRight(root, CaretPosition(text, text.length))) {\n          normalizeWhitespaceBefore(text, text.length);\n        }\n      });\n    };\n    var mergeAndNormalizeText = function (outerNode, innerNode, rng, start) {\n      outerNode.bind(function (outer) {\n        var normalizer = start ? normalizeWhitespaceBefore : normalizeWhitespaceAfter;\n        normalizer(outer.dom, start ? outer.dom.length : 0);\n        return innerNode.filter(isText$8).map(function (inner) {\n          return merge(outer, inner, rng, start);\n        });\n      }).orThunk(function () {\n        var innerTextNode = walkPastBookmark(innerNode, start).or(innerNode).filter(isText$8);\n        return innerTextNode.map(function (inner) {\n          return normalizeTextIfRequired(inner, start);\n        });\n      });\n    };\n    var rngSetContent = function (rng, fragment) {\n      var firstChild = Optional.from(fragment.firstChild).map(SugarElement.fromDom);\n      var lastChild = Optional.from(fragment.lastChild).map(SugarElement.fromDom);\n      rng.deleteContents();\n      rng.insertNode(fragment);\n      var prevText = firstChild.bind(prevSibling).filter(isText$8).bind(removeEmpty);\n      var nextText = lastChild.bind(nextSibling).filter(isText$8).bind(removeEmpty);\n      mergeAndNormalizeText(prevText, firstChild, rng, true);\n      mergeAndNormalizeText(nextText, lastChild, rng, false);\n      rng.collapse(false);\n    };\n    var setupArgs = function (args, content) {\n      return __assign(__assign({ format: 'html' }, args), {\n        set: true,\n        selection: true,\n        content: content\n      });\n    };\n    var cleanContent = function (editor, args) {\n      if (args.format !== 'raw') {\n        var rng = editor.selection.getRng();\n        var contextBlock = editor.dom.getParent(rng.commonAncestorContainer, editor.dom.isBlock);\n        var contextArgs = contextBlock ? { context: contextBlock.nodeName.toLowerCase() } : {};\n        var node = editor.parser.parse(args.content, __assign(__assign({\n          isRootContent: true,\n          forced_root_block: false\n        }, contextArgs), args));\n        return HtmlSerializer({ validate: editor.validate }, editor.schema).serialize(node);\n      } else {\n        return args.content;\n      }\n    };\n    var setContent$1 = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var defaultedArgs = setupArgs(args, content);\n      var updatedArgs = defaultedArgs;\n      if (!defaultedArgs.no_events) {\n        var eventArgs = editor.fire('BeforeSetContent', defaultedArgs);\n        if (eventArgs.isDefaultPrevented()) {\n          editor.fire('SetContent', eventArgs);\n          return;\n        } else {\n          updatedArgs = eventArgs;\n        }\n      }\n      updatedArgs.content = cleanContent(editor, updatedArgs);\n      var rng = editor.selection.getRng();\n      rngSetContent(rng, rng.createContextualFragment(updatedArgs.content));\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n      if (!updatedArgs.no_events) {\n        editor.fire('SetContent', updatedArgs);\n      }\n    };\n\n    var deleteFromCallbackMap = function (callbackMap, selector, callback) {\n      if (callbackMap && has$2(callbackMap, selector)) {\n        var newCallbacks = filter$4(callbackMap[selector], function (cb) {\n          return cb !== callback;\n        });\n        if (newCallbacks.length === 0) {\n          delete callbackMap[selector];\n        } else {\n          callbackMap[selector] = newCallbacks;\n        }\n      }\n    };\n    function SelectorChanged (dom, editor) {\n      var selectorChangedData;\n      var currentSelectors;\n      var findMatchingNode = function (selector, nodes) {\n        return find$3(nodes, function (node) {\n          return dom.is(node, selector);\n        });\n      };\n      var getParents = function (elem) {\n        return dom.getParents(elem, null, dom.getRoot());\n      };\n      return {\n        selectorChangedWithUnbind: function (selector, callback) {\n          if (!selectorChangedData) {\n            selectorChangedData = {};\n            currentSelectors = {};\n            editor.on('NodeChange', function (e) {\n              var node = e.element;\n              var parents = getParents(node);\n              var matchedSelectors = {};\n              Tools.each(selectorChangedData, function (callbacks, selector) {\n                findMatchingNode(selector, parents).each(function (node) {\n                  if (!currentSelectors[selector]) {\n                    each$k(callbacks, function (callback) {\n                      callback(true, {\n                        node: node,\n                        selector: selector,\n                        parents: parents\n                      });\n                    });\n                    currentSelectors[selector] = callbacks;\n                  }\n                  matchedSelectors[selector] = callbacks;\n                });\n              });\n              Tools.each(currentSelectors, function (callbacks, selector) {\n                if (!matchedSelectors[selector]) {\n                  delete currentSelectors[selector];\n                  Tools.each(callbacks, function (callback) {\n                    callback(false, {\n                      node: node,\n                      selector: selector,\n                      parents: parents\n                    });\n                  });\n                }\n              });\n            });\n          }\n          if (!selectorChangedData[selector]) {\n            selectorChangedData[selector] = [];\n          }\n          selectorChangedData[selector].push(callback);\n          findMatchingNode(selector, getParents(editor.selection.getStart())).each(function () {\n            currentSelectors[selector] = selectorChangedData[selector];\n          });\n          return {\n            unbind: function () {\n              deleteFromCallbackMap(selectorChangedData, selector, callback);\n              deleteFromCallbackMap(currentSelectors, selector, callback);\n            }\n          };\n        }\n      };\n    }\n\n    var isNativeIeSelection = function (rng) {\n      return !!rng.select;\n    };\n    var isAttachedToDom = function (node) {\n      return !!(node && node.ownerDocument) && contains$1(SugarElement.fromDom(node.ownerDocument), SugarElement.fromDom(node));\n    };\n    var isValidRange = function (rng) {\n      if (!rng) {\n        return false;\n      } else if (isNativeIeSelection(rng)) {\n        return true;\n      } else {\n        return isAttachedToDom(rng.startContainer) && isAttachedToDom(rng.endContainer);\n      }\n    };\n    var EditorSelection = function (dom, win, serializer, editor) {\n      var selectedRange;\n      var explicitRange;\n      var selectorChangedWithUnbind = SelectorChanged(dom, editor).selectorChangedWithUnbind;\n      var setCursorLocation = function (node, offset) {\n        var rng = dom.createRng();\n        if (isNonNullable(node) && isNonNullable(offset)) {\n          rng.setStart(node, offset);\n          rng.setEnd(node, offset);\n          setRng(rng);\n          collapse(false);\n        } else {\n          moveEndPoint(dom, rng, editor.getBody(), true);\n          setRng(rng);\n        }\n      };\n      var getContent = function (args) {\n        return getContent$1(editor, args);\n      };\n      var setContent = function (content, args) {\n        return setContent$1(editor, content, args);\n      };\n      var getStart$1 = function (real) {\n        return getStart(editor.getBody(), getRng$1(), real);\n      };\n      var getEnd$1 = function (real) {\n        return getEnd(editor.getBody(), getRng$1(), real);\n      };\n      var getBookmark = function (type, normalized) {\n        return bookmarkManager.getBookmark(type, normalized);\n      };\n      var moveToBookmark = function (bookmark) {\n        return bookmarkManager.moveToBookmark(bookmark);\n      };\n      var select$1 = function (node, content) {\n        select(dom, node, content).each(setRng);\n        return node;\n      };\n      var isCollapsed = function () {\n        var rng = getRng$1(), sel = getSel();\n        if (!rng || rng.item) {\n          return false;\n        }\n        if (rng.compareEndPoints) {\n          return rng.compareEndPoints('StartToEnd', rng) === 0;\n        }\n        return !sel || rng.collapsed;\n      };\n      var collapse = function (toStart) {\n        var rng = getRng$1();\n        rng.collapse(!!toStart);\n        setRng(rng);\n      };\n      var getSel = function () {\n        return win.getSelection ? win.getSelection() : win.document.selection;\n      };\n      var getRng$1 = function () {\n        var selection, rng, elm;\n        var tryCompareBoundaryPoints = function (how, sourceRange, destinationRange) {\n          try {\n            return sourceRange.compareBoundaryPoints(how, destinationRange);\n          } catch (ex) {\n            return -1;\n          }\n        };\n        var doc = win.document;\n        if (editor.bookmark !== undefined && hasFocus(editor) === false) {\n          var bookmark = getRng(editor);\n          if (bookmark.isSome()) {\n            return bookmark.map(function (r) {\n              return processRanges(editor, [r])[0];\n            }).getOr(doc.createRange());\n          }\n        }\n        try {\n          if ((selection = getSel()) && !isRestrictedNode(selection.anchorNode)) {\n            if (selection.rangeCount > 0) {\n              rng = selection.getRangeAt(0);\n            } else {\n              rng = selection.createRange ? selection.createRange() : doc.createRange();\n            }\n            rng = processRanges(editor, [rng])[0];\n          }\n        } catch (ex) {\n        }\n        if (!rng) {\n          rng = doc.createRange ? doc.createRange() : doc.body.createTextRange();\n        }\n        if (rng.setStart && rng.startContainer.nodeType === 9 && rng.collapsed) {\n          elm = dom.getRoot();\n          rng.setStart(elm, 0);\n          rng.setEnd(elm, 0);\n        }\n        if (selectedRange && explicitRange) {\n          if (tryCompareBoundaryPoints(rng.START_TO_START, rng, selectedRange) === 0 && tryCompareBoundaryPoints(rng.END_TO_END, rng, selectedRange) === 0) {\n            rng = explicitRange;\n          } else {\n            selectedRange = null;\n            explicitRange = null;\n          }\n        }\n        return rng;\n      };\n      var setRng = function (rng, forward) {\n        var node;\n        if (!isValidRange(rng)) {\n          return;\n        }\n        var ieRange = isNativeIeSelection(rng) ? rng : null;\n        if (ieRange) {\n          explicitRange = null;\n          try {\n            ieRange.select();\n          } catch (ex) {\n          }\n          return;\n        }\n        var sel = getSel();\n        var evt = editor.fire('SetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n        rng = evt.range;\n        if (sel) {\n          explicitRange = rng;\n          try {\n            sel.removeAllRanges();\n            sel.addRange(rng);\n          } catch (ex) {\n          }\n          if (forward === false && sel.extend) {\n            sel.collapse(rng.endContainer, rng.endOffset);\n            sel.extend(rng.startContainer, rng.startOffset);\n          }\n          selectedRange = sel.rangeCount > 0 ? sel.getRangeAt(0) : null;\n        }\n        if (!rng.collapsed && rng.startContainer === rng.endContainer && sel.setBaseAndExtent && !Env.ie) {\n          if (rng.endOffset - rng.startOffset < 2) {\n            if (rng.startContainer.hasChildNodes()) {\n              node = rng.startContainer.childNodes[rng.startOffset];\n              if (node && node.tagName === 'IMG') {\n                sel.setBaseAndExtent(rng.startContainer, rng.startOffset, rng.endContainer, rng.endOffset);\n                if (sel.anchorNode !== rng.startContainer || sel.focusNode !== rng.endContainer) {\n                  sel.setBaseAndExtent(node, 0, node, 1);\n                }\n              }\n            }\n          }\n        }\n        editor.fire('AfterSetSelectionRange', {\n          range: rng,\n          forward: forward\n        });\n      };\n      var setNode = function (elm) {\n        setContent(dom.getOuterHTML(elm));\n        return elm;\n      };\n      var getNode$1 = function () {\n        return getNode(editor.getBody(), getRng$1());\n      };\n      var getSelectedBlocks$1 = function (startElm, endElm) {\n        return getSelectedBlocks(dom, getRng$1(), startElm, endElm);\n      };\n      var isForward = function () {\n        var sel = getSel();\n        var anchorNode = sel === null || sel === void 0 ? void 0 : sel.anchorNode;\n        var focusNode = sel === null || sel === void 0 ? void 0 : sel.focusNode;\n        if (!sel || !anchorNode || !focusNode || isRestrictedNode(anchorNode) || isRestrictedNode(focusNode)) {\n          return true;\n        }\n        var anchorRange = dom.createRng();\n        anchorRange.setStart(anchorNode, sel.anchorOffset);\n        anchorRange.collapse(true);\n        var focusRange = dom.createRng();\n        focusRange.setStart(focusNode, sel.focusOffset);\n        focusRange.collapse(true);\n        return anchorRange.compareBoundaryPoints(anchorRange.START_TO_START, focusRange) <= 0;\n      };\n      var normalize = function () {\n        var rng = getRng$1();\n        var sel = getSel();\n        if (!hasMultipleRanges(sel) && hasAnyRanges(editor)) {\n          var normRng = normalize$2(dom, rng);\n          normRng.each(function (normRng) {\n            setRng(normRng, isForward());\n          });\n          return normRng.getOr(rng);\n        }\n        return rng;\n      };\n      var selectorChanged = function (selector, callback) {\n        selectorChangedWithUnbind(selector, callback);\n        return exports;\n      };\n      var getScrollContainer = function () {\n        var scrollContainer;\n        var node = dom.getRoot();\n        while (node && node.nodeName !== 'BODY') {\n          if (node.scrollHeight > node.clientHeight) {\n            scrollContainer = node;\n            break;\n          }\n          node = node.parentNode;\n        }\n        return scrollContainer;\n      };\n      var scrollIntoView = function (elm, alignToTop) {\n        if (isNonNullable(elm)) {\n          scrollElementIntoView(editor, elm, alignToTop);\n        } else {\n          scrollRangeIntoView(editor, getRng$1(), alignToTop);\n        }\n      };\n      var placeCaretAt = function (clientX, clientY) {\n        return setRng(fromPoint(clientX, clientY, editor.getDoc()));\n      };\n      var getBoundingClientRect = function () {\n        var rng = getRng$1();\n        return rng.collapsed ? CaretPosition.fromRangeStart(rng).getClientRects()[0] : rng.getBoundingClientRect();\n      };\n      var destroy = function () {\n        win = selectedRange = explicitRange = null;\n        controlSelection.destroy();\n      };\n      var exports = {\n        bookmarkManager: null,\n        controlSelection: null,\n        dom: dom,\n        win: win,\n        serializer: serializer,\n        editor: editor,\n        collapse: collapse,\n        setCursorLocation: setCursorLocation,\n        getContent: getContent,\n        setContent: setContent,\n        getBookmark: getBookmark,\n        moveToBookmark: moveToBookmark,\n        select: select$1,\n        isCollapsed: isCollapsed,\n        isForward: isForward,\n        setNode: setNode,\n        getNode: getNode$1,\n        getSel: getSel,\n        setRng: setRng,\n        getRng: getRng$1,\n        getStart: getStart$1,\n        getEnd: getEnd$1,\n        getSelectedBlocks: getSelectedBlocks$1,\n        normalize: normalize,\n        selectorChanged: selectorChanged,\n        selectorChangedWithUnbind: selectorChangedWithUnbind,\n        getScrollContainer: getScrollContainer,\n        scrollIntoView: scrollIntoView,\n        placeCaretAt: placeCaretAt,\n        getBoundingClientRect: getBoundingClientRect,\n        destroy: destroy\n      };\n      var bookmarkManager = BookmarkManager(exports);\n      var controlSelection = ControlSelection(exports, editor);\n      exports.bookmarkManager = bookmarkManager;\n      exports.controlSelection = controlSelection;\n      return exports;\n    };\n\n    var removeAttrs = function (node, names) {\n      each$k(names, function (name) {\n        node.attr(name, null);\n      });\n    };\n    var addFontToSpansFilter = function (domParser, styles, fontSizes) {\n      domParser.addNodeFilter('font', function (nodes) {\n        each$k(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          var color = node.attr('color');\n          var face = node.attr('face');\n          var size = node.attr('size');\n          if (color) {\n            props.color = color;\n          }\n          if (face) {\n            props['font-family'] = face;\n          }\n          if (size) {\n            props['font-size'] = fontSizes[parseInt(node.attr('size'), 10) - 1];\n          }\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n          removeAttrs(node, [\n            'color',\n            'face',\n            'size'\n          ]);\n        });\n      });\n    };\n    var addStrikeToSpanFilter = function (domParser, styles) {\n      domParser.addNodeFilter('strike', function (nodes) {\n        each$k(nodes, function (node) {\n          var props = styles.parse(node.attr('style'));\n          props['text-decoration'] = 'line-through';\n          node.name = 'span';\n          node.attr('style', styles.serialize(props));\n        });\n      });\n    };\n    var addFilters = function (domParser, settings) {\n      var styles = Styles();\n      if (settings.convert_fonts_to_spans) {\n        addFontToSpansFilter(domParser, styles, Tools.explode(settings.font_size_legacy_values));\n      }\n      addStrikeToSpanFilter(domParser, styles);\n    };\n    var register$2 = function (domParser, settings) {\n      if (settings.inline_styles) {\n        addFilters(domParser, settings);\n      }\n    };\n\n    var blobUriToBlob = function (url) {\n      return new promiseObj(function (resolve, reject) {\n        var rejectWithError = function () {\n          reject('Cannot convert ' + url + ' to Blob. Resource might not exist or is inaccessible.');\n        };\n        try {\n          var xhr_1 = new XMLHttpRequest();\n          xhr_1.open('GET', url, true);\n          xhr_1.responseType = 'blob';\n          xhr_1.onload = function () {\n            if (xhr_1.status === 200) {\n              resolve(xhr_1.response);\n            } else {\n              rejectWithError();\n            }\n          };\n          xhr_1.onerror = rejectWithError;\n          xhr_1.send();\n        } catch (ex) {\n          rejectWithError();\n        }\n      });\n    };\n    var parseDataUri = function (uri) {\n      var type;\n      var uriParts = decodeURIComponent(uri).split(',');\n      var matches = /data:([^;]+)/.exec(uriParts[0]);\n      if (matches) {\n        type = matches[1];\n      }\n      return {\n        type: type,\n        data: uriParts[1]\n      };\n    };\n    var buildBlob = function (type, data) {\n      var str;\n      try {\n        str = atob(data);\n      } catch (e) {\n        return Optional.none();\n      }\n      var arr = new Uint8Array(str.length);\n      for (var i = 0; i < arr.length; i++) {\n        arr[i] = str.charCodeAt(i);\n      }\n      return Optional.some(new Blob([arr], { type: type }));\n    };\n    var dataUriToBlob = function (uri) {\n      return new promiseObj(function (resolve) {\n        var _a = parseDataUri(uri), type = _a.type, data = _a.data;\n        buildBlob(type, data).fold(function () {\n          return resolve(new Blob([]));\n        }, resolve);\n      });\n    };\n    var uriToBlob = function (url) {\n      if (url.indexOf('blob:') === 0) {\n        return blobUriToBlob(url);\n      }\n      if (url.indexOf('data:') === 0) {\n        return dataUriToBlob(url);\n      }\n      return null;\n    };\n    var blobToDataUri = function (blob) {\n      return new promiseObj(function (resolve) {\n        var reader = new FileReader();\n        reader.onloadend = function () {\n          resolve(reader.result);\n        };\n        reader.readAsDataURL(blob);\n      });\n    };\n\n    var count$1 = 0;\n    var uniqueId = function (prefix) {\n      return (prefix || 'blobid') + count$1++;\n    };\n    var imageToBlobInfo = function (blobCache, img, resolve, reject) {\n      var base64, blobInfo;\n      if (img.src.indexOf('blob:') === 0) {\n        blobInfo = blobCache.getByUri(img.src);\n        if (blobInfo) {\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        } else {\n          uriToBlob(img.src).then(function (blob) {\n            blobToDataUri(blob).then(function (dataUri) {\n              base64 = parseDataUri(dataUri).data;\n              blobInfo = blobCache.create(uniqueId(), blob, base64);\n              blobCache.add(blobInfo);\n              resolve({\n                image: img,\n                blobInfo: blobInfo\n              });\n            });\n          }, function (err) {\n            reject(err);\n          });\n        }\n        return;\n      }\n      var _a = parseDataUri(img.src), data = _a.data, type = _a.type;\n      base64 = data;\n      blobInfo = blobCache.getByData(base64, type);\n      if (blobInfo) {\n        resolve({\n          image: img,\n          blobInfo: blobInfo\n        });\n      } else {\n        uriToBlob(img.src).then(function (blob) {\n          blobInfo = blobCache.create(uniqueId(), blob, base64);\n          blobCache.add(blobInfo);\n          resolve({\n            image: img,\n            blobInfo: blobInfo\n          });\n        }, function (err) {\n          reject(err);\n        });\n      }\n    };\n    var getAllImages = function (elm) {\n      return elm ? from(elm.getElementsByTagName('img')) : [];\n    };\n    var ImageScanner = function (uploadStatus, blobCache) {\n      var cachedPromises = {};\n      var findAll = function (elm, predicate) {\n        if (!predicate) {\n          predicate = always;\n        }\n        var images = filter$4(getAllImages(elm), function (img) {\n          var src = img.src;\n          if (!Env.fileApi) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-bogus')) {\n            return false;\n          }\n          if (img.hasAttribute('data-mce-placeholder')) {\n            return false;\n          }\n          if (!src || src === Env.transparentSrc) {\n            return false;\n          }\n          if (src.indexOf('blob:') === 0) {\n            return !uploadStatus.isUploaded(src) && predicate(img);\n          }\n          if (src.indexOf('data:') === 0) {\n            return predicate(img);\n          }\n          return false;\n        });\n        var promises = map$3(images, function (img) {\n          if (cachedPromises[img.src] !== undefined) {\n            return new promiseObj(function (resolve) {\n              cachedPromises[img.src].then(function (imageInfo) {\n                if (typeof imageInfo === 'string') {\n                  return imageInfo;\n                }\n                resolve({\n                  image: img,\n                  blobInfo: imageInfo.blobInfo\n                });\n              });\n            });\n          }\n          var newPromise = new promiseObj(function (resolve, reject) {\n            imageToBlobInfo(blobCache, img, resolve, reject);\n          }).then(function (result) {\n            delete cachedPromises[result.image.src];\n            return result;\n          }).catch(function (error) {\n            delete cachedPromises[img.src];\n            return error;\n          });\n          cachedPromises[img.src] = newPromise;\n          return newPromise;\n        });\n        return promiseObj.all(promises);\n      };\n      return { findAll: findAll };\n    };\n\n    var paddEmptyNode = function (settings, args, blockElements, node) {\n      var brPreferred = settings.padd_empty_with_br || args.insert;\n      if (brPreferred && blockElements[node.name]) {\n        node.empty().append(new AstNode('br', 1)).shortEnded = true;\n      } else {\n        node.empty().append(new AstNode('#text', 3)).value = nbsp;\n      }\n    };\n    var isPaddedWithNbsp = function (node) {\n      return hasOnlyChild(node, '#text') && node.firstChild.value === nbsp;\n    };\n    var hasOnlyChild = function (node, name) {\n      return node && node.firstChild && node.firstChild === node.lastChild && node.firstChild.name === name;\n    };\n    var isPadded = function (schema, node) {\n      var rule = schema.getElementRule(node.name);\n      return rule && rule.paddEmpty;\n    };\n    var isEmpty = function (schema, nonEmptyElements, whitespaceElements, node) {\n      return node.isEmpty(nonEmptyElements, whitespaceElements, function (node) {\n        return isPadded(schema, node);\n      });\n    };\n    var isLineBreakNode = function (node, blockElements) {\n      return node && (has$2(blockElements, node.name) || node.name === 'br');\n    };\n\n    var isBogusImage = function (img) {\n      return isNonNullable(img.attr('data-mce-bogus'));\n    };\n    var isInternalImageSource = function (img) {\n      return img.attr('src') === Env.transparentSrc || isNonNullable(img.attr('data-mce-placeholder'));\n    };\n    var isValidDataImg = function (img, settings) {\n      if (settings.images_dataimg_filter) {\n        var imgElem_1 = new Image();\n        imgElem_1.src = img.attr('src');\n        each$j(img.attributes.map, function (value, key) {\n          imgElem_1.setAttribute(key, value);\n        });\n        return settings.images_dataimg_filter(imgElem_1);\n      } else {\n        return true;\n      }\n    };\n    var registerBase64ImageFilter = function (parser, settings) {\n      var blobCache = settings.blob_cache;\n      var processImage = function (img) {\n        var inputSrc = img.attr('src');\n        if (isInternalImageSource(img) || isBogusImage(img)) {\n          return;\n        }\n        parseDataUri$1(inputSrc).filter(function () {\n          return isValidDataImg(img, settings);\n        }).bind(function (_a) {\n          var type = _a.type, data = _a.data;\n          return Optional.from(blobCache.getByData(data, type)).orThunk(function () {\n            return buildBlob(type, data).map(function (blob) {\n              var blobInfo = blobCache.create(uniqueId(), blob, data);\n              blobCache.add(blobInfo);\n              return blobInfo;\n            });\n          });\n        }).each(function (blobInfo) {\n          img.attr('src', blobInfo.blobUri());\n        });\n      };\n      if (blobCache) {\n        parser.addAttributeFilter('src', function (nodes) {\n          return each$k(nodes, processImage);\n        });\n      }\n    };\n    var register$1 = function (parser, settings) {\n      var schema = parser.schema;\n      if (settings.remove_trailing_brs) {\n        parser.addNodeFilter('br', function (nodes, _, args) {\n          var i;\n          var l = nodes.length;\n          var node;\n          var blockElements = Tools.extend({}, schema.getBlockElements());\n          var nonEmptyElements = schema.getNonEmptyElements();\n          var parent, lastParent, prev, prevName;\n          var whiteSpaceElements = schema.getWhiteSpaceElements();\n          var elementRule, textNode;\n          blockElements.body = 1;\n          for (i = 0; i < l; i++) {\n            node = nodes[i];\n            parent = node.parent;\n            if (blockElements[node.parent.name] && node === parent.lastChild) {\n              prev = node.prev;\n              while (prev) {\n                prevName = prev.name;\n                if (prevName !== 'span' || prev.attr('data-mce-type') !== 'bookmark') {\n                  if (prevName === 'br') {\n                    node = null;\n                  }\n                  break;\n                }\n                prev = prev.prev;\n              }\n              if (node) {\n                node.remove();\n                if (isEmpty(schema, nonEmptyElements, whiteSpaceElements, parent)) {\n                  elementRule = schema.getElementRule(parent.name);\n                  if (elementRule) {\n                    if (elementRule.removeEmpty) {\n                      parent.remove();\n                    } else if (elementRule.paddEmpty) {\n                      paddEmptyNode(settings, args, blockElements, parent);\n                    }\n                  }\n                }\n              }\n            } else {\n              lastParent = node;\n              while (parent && parent.firstChild === lastParent && parent.lastChild === lastParent) {\n                lastParent = parent;\n                if (blockElements[parent.name]) {\n                  break;\n                }\n                parent = parent.parent;\n              }\n              if (lastParent === parent && settings.padd_empty_with_br !== true) {\n                textNode = new AstNode('#text', 3);\n                textNode.value = nbsp;\n                node.replace(textNode);\n              }\n            }\n          }\n        });\n      }\n      parser.addAttributeFilter('href', function (nodes) {\n        var i = nodes.length;\n        var appendRel = function (rel) {\n          var parts = rel.split(' ').filter(function (p) {\n            return p.length > 0;\n          });\n          return parts.concat(['noopener']).sort().join(' ');\n        };\n        var addNoOpener = function (rel) {\n          var newRel = rel ? Tools.trim(rel) : '';\n          if (!/\\b(noopener)\\b/g.test(newRel)) {\n            return appendRel(newRel);\n          } else {\n            return newRel;\n          }\n        };\n        if (!settings.allow_unsafe_link_target) {\n          while (i--) {\n            var node = nodes[i];\n            if (node.name === 'a' && node.attr('target') === '_blank') {\n              node.attr('rel', addNoOpener(node.attr('rel')));\n            }\n          }\n        }\n      });\n      if (!settings.allow_html_in_named_anchor) {\n        parser.addAttributeFilter('id,name', function (nodes) {\n          var i = nodes.length, sibling, prevSibling, parent, node;\n          while (i--) {\n            node = nodes[i];\n            if (node.name === 'a' && node.firstChild && !node.attr('href')) {\n              parent = node.parent;\n              sibling = node.lastChild;\n              do {\n                prevSibling = sibling.prev;\n                parent.insert(sibling, node);\n                sibling = prevSibling;\n              } while (sibling);\n            }\n          }\n        });\n      }\n      if (settings.fix_list_elements) {\n        parser.addNodeFilter('ul,ol', function (nodes) {\n          var i = nodes.length, node, parentNode;\n          while (i--) {\n            node = nodes[i];\n            parentNode = node.parent;\n            if (parentNode.name === 'ul' || parentNode.name === 'ol') {\n              if (node.prev && node.prev.name === 'li') {\n                node.prev.append(node);\n              } else {\n                var li = new AstNode('li', 1);\n                li.attr('style', 'list-style-type: none');\n                node.wrap(li);\n              }\n            }\n          }\n        });\n      }\n      if (settings.validate && schema.getValidClasses()) {\n        parser.addAttributeFilter('class', function (nodes) {\n          var validClasses = schema.getValidClasses();\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            var classList = node.attr('class').split(' ');\n            var classValue = '';\n            for (var ci = 0; ci < classList.length; ci++) {\n              var className = classList[ci];\n              var valid = false;\n              var validClassesMap = validClasses['*'];\n              if (validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              validClassesMap = validClasses[node.name];\n              if (!valid && validClassesMap && validClassesMap[className]) {\n                valid = true;\n              }\n              if (valid) {\n                if (classValue) {\n                  classValue += ' ';\n                }\n                classValue += className;\n              }\n            }\n            if (!classValue.length) {\n              classValue = null;\n            }\n            node.attr('class', classValue);\n          }\n        });\n      }\n      registerBase64ImageFilter(parser, settings);\n    };\n\n    var makeMap = Tools.makeMap, each$6 = Tools.each, explode$2 = Tools.explode, extend$4 = Tools.extend;\n    var DomParser = function (settings, schema) {\n      if (schema === void 0) {\n        schema = Schema();\n      }\n      var nodeFilters = {};\n      var attributeFilters = [];\n      var matchedNodes = {};\n      var matchedAttributes = {};\n      settings = settings || {};\n      settings.validate = 'validate' in settings ? settings.validate : true;\n      settings.root_name = settings.root_name || 'body';\n      var fixInvalidChildren = function (nodes) {\n        var nonSplitableElements = makeMap('tr,td,th,tbody,thead,tfoot,table');\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var whitespaceElements = schema.getWhiteSpaceElements();\n        var textBlockElements = schema.getTextBlockElements();\n        var specialElements = schema.getSpecialElements();\n        var removeOrUnwrapInvalidNode = function (node, originalNodeParent) {\n          if (originalNodeParent === void 0) {\n            originalNodeParent = node.parent;\n          }\n          if (specialElements[node.name]) {\n            node.empty().remove();\n          } else {\n            var children = node.children();\n            for (var _i = 0, children_1 = children; _i < children_1.length; _i++) {\n              var childNode = children_1[_i];\n              if (!schema.isValidChild(originalNodeParent.name, childNode.name)) {\n                removeOrUnwrapInvalidNode(childNode, originalNodeParent);\n              }\n            }\n            node.unwrap();\n          }\n        };\n        for (var ni = 0; ni < nodes.length; ni++) {\n          var node = nodes[ni];\n          var parent_1 = void 0, newParent = void 0, tempNode = void 0;\n          if (!node.parent || node.fixed) {\n            continue;\n          }\n          if (textBlockElements[node.name] && node.parent.name === 'li') {\n            var sibling = node.next;\n            while (sibling) {\n              if (textBlockElements[sibling.name]) {\n                sibling.name = 'li';\n                sibling.fixed = true;\n                node.parent.insert(sibling, node.parent);\n              } else {\n                break;\n              }\n              sibling = sibling.next;\n            }\n            node.unwrap();\n            continue;\n          }\n          var parents = [node];\n          for (parent_1 = node.parent; parent_1 && !schema.isValidChild(parent_1.name, node.name) && !nonSplitableElements[parent_1.name]; parent_1 = parent_1.parent) {\n            parents.push(parent_1);\n          }\n          if (parent_1 && parents.length > 1) {\n            if (schema.isValidChild(parent_1.name, node.name)) {\n              parents.reverse();\n              newParent = filterNode(parents[0].clone());\n              var currentNode = newParent;\n              for (var i = 0; i < parents.length - 1; i++) {\n                if (schema.isValidChild(currentNode.name, parents[i].name)) {\n                  tempNode = filterNode(parents[i].clone());\n                  currentNode.append(tempNode);\n                } else {\n                  tempNode = currentNode;\n                }\n                for (var childNode = parents[i].firstChild; childNode && childNode !== parents[i + 1];) {\n                  var nextNode = childNode.next;\n                  tempNode.append(childNode);\n                  childNode = nextNode;\n                }\n                currentNode = tempNode;\n              }\n              if (!isEmpty(schema, nonEmptyElements, whitespaceElements, newParent)) {\n                parent_1.insert(newParent, parents[0], true);\n                parent_1.insert(node, newParent);\n              } else {\n                parent_1.insert(node, parents[0], true);\n              }\n              parent_1 = parents[0];\n              if (isEmpty(schema, nonEmptyElements, whitespaceElements, parent_1) || hasOnlyChild(parent_1, 'br')) {\n                parent_1.empty().remove();\n              }\n            } else {\n              removeOrUnwrapInvalidNode(node);\n            }\n          } else if (node.parent) {\n            if (node.name === 'li') {\n              var sibling = node.prev;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.append(node);\n                continue;\n              }\n              sibling = node.next;\n              if (sibling && (sibling.name === 'ul' || sibling.name === 'ol')) {\n                sibling.insert(node, sibling.firstChild, true);\n                continue;\n              }\n              node.wrap(filterNode(new AstNode('ul', 1)));\n              continue;\n            }\n            if (schema.isValidChild(node.parent.name, 'div') && schema.isValidChild('div', node.name)) {\n              node.wrap(filterNode(new AstNode('div', 1)));\n            } else {\n              removeOrUnwrapInvalidNode(node);\n            }\n          }\n        }\n      };\n      var filterNode = function (node) {\n        var name = node.name;\n        if (name in nodeFilters) {\n          var list = matchedNodes[name];\n          if (list) {\n            list.push(node);\n          } else {\n            matchedNodes[name] = [node];\n          }\n        }\n        var i = attributeFilters.length;\n        while (i--) {\n          var attrName = attributeFilters[i].name;\n          if (attrName in node.attributes.map) {\n            var list = matchedAttributes[attrName];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedAttributes[attrName] = [node];\n            }\n          }\n        }\n        return node;\n      };\n      var addNodeFilter = function (name, callback) {\n        each$6(explode$2(name), function (name) {\n          var list = nodeFilters[name];\n          if (!list) {\n            nodeFilters[name] = list = [];\n          }\n          list.push(callback);\n        });\n      };\n      var getNodeFilters = function () {\n        var out = [];\n        for (var name_1 in nodeFilters) {\n          if (has$2(nodeFilters, name_1)) {\n            out.push({\n              name: name_1,\n              callbacks: nodeFilters[name_1]\n            });\n          }\n        }\n        return out;\n      };\n      var addAttributeFilter = function (name, callback) {\n        each$6(explode$2(name), function (name) {\n          var i;\n          for (i = 0; i < attributeFilters.length; i++) {\n            if (attributeFilters[i].name === name) {\n              attributeFilters[i].callbacks.push(callback);\n              return;\n            }\n          }\n          attributeFilters.push({\n            name: name,\n            callbacks: [callback]\n          });\n        });\n      };\n      var getAttributeFilters = function () {\n        return [].concat(attributeFilters);\n      };\n      var parse = function (html, args) {\n        var nodes, i, l, fi, fl, list, name;\n        var invalidChildren = [];\n        var node;\n        var getRootBlockName = function (name) {\n          if (name === false) {\n            return '';\n          } else if (name === true) {\n            return 'p';\n          } else {\n            return name;\n          }\n        };\n        args = args || {};\n        matchedNodes = {};\n        matchedAttributes = {};\n        var blockElements = extend$4(makeMap('script,style,head,html,body,title,meta,param'), schema.getBlockElements());\n        var nonEmptyElements = schema.getNonEmptyElements();\n        var children = schema.children;\n        var validate = settings.validate;\n        var forcedRootBlockName = 'forced_root_block' in args ? args.forced_root_block : settings.forced_root_block;\n        var rootBlockName = getRootBlockName(forcedRootBlockName);\n        var whiteSpaceElements = schema.getWhiteSpaceElements();\n        var startWhiteSpaceRegExp = /^[ \\t\\r\\n]+/;\n        var endWhiteSpaceRegExp = /[ \\t\\r\\n]+$/;\n        var allWhiteSpaceRegExp = /[ \\t\\r\\n]+/g;\n        var isAllWhiteSpaceRegExp = /^[ \\t\\r\\n]+$/;\n        var isInWhiteSpacePreservedElement = has$2(whiteSpaceElements, args.context) || has$2(whiteSpaceElements, settings.root_name);\n        var addRootBlocks = function () {\n          var node = rootNode.firstChild, rootBlockNode = null;\n          var trim = function (rootBlock) {\n            if (rootBlock) {\n              node = rootBlock.firstChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(startWhiteSpaceRegExp, '');\n              }\n              node = rootBlock.lastChild;\n              if (node && node.type === 3) {\n                node.value = node.value.replace(endWhiteSpaceRegExp, '');\n              }\n            }\n          };\n          if (!schema.isValidChild(rootNode.name, rootBlockName.toLowerCase())) {\n            return;\n          }\n          while (node) {\n            var next = node.next;\n            if (node.type === 3 || node.type === 1 && node.name !== 'p' && !blockElements[node.name] && !node.attr('data-mce-type')) {\n              if (!rootBlockNode) {\n                rootBlockNode = createNode(rootBlockName, 1);\n                rootBlockNode.attr(settings.forced_root_block_attrs);\n                rootNode.insert(rootBlockNode, node);\n                rootBlockNode.append(node);\n              } else {\n                rootBlockNode.append(node);\n              }\n            } else {\n              trim(rootBlockNode);\n              rootBlockNode = null;\n            }\n            node = next;\n          }\n          trim(rootBlockNode);\n        };\n        var createNode = function (name, type) {\n          var node = new AstNode(name, type);\n          var list;\n          if (name in nodeFilters) {\n            list = matchedNodes[name];\n            if (list) {\n              list.push(node);\n            } else {\n              matchedNodes[name] = [node];\n            }\n          }\n          return node;\n        };\n        var removeWhitespaceBefore = function (node) {\n          var blockElements = schema.getBlockElements();\n          for (var textNode = node.prev; textNode && textNode.type === 3;) {\n            var textVal = textNode.value.replace(endWhiteSpaceRegExp, '');\n            if (textVal.length > 0) {\n              textNode.value = textVal;\n              return;\n            }\n            var textNodeNext = textNode.next;\n            if (textNodeNext) {\n              if (textNodeNext.type === 3 && textNodeNext.value.length) {\n                textNode = textNode.prev;\n                continue;\n              }\n              if (!blockElements[textNodeNext.name] && textNodeNext.name !== 'script' && textNodeNext.name !== 'style') {\n                textNode = textNode.prev;\n                continue;\n              }\n            }\n            var sibling = textNode.prev;\n            textNode.remove();\n            textNode = sibling;\n          }\n        };\n        var cloneAndExcludeBlocks = function (input) {\n          var output = {};\n          for (var name_2 in input) {\n            if (name_2 !== 'li' && name_2 !== 'p') {\n              output[name_2] = input[name_2];\n            }\n          }\n          return output;\n        };\n        var parser = SaxParser({\n          validate: validate,\n          document: settings.document,\n          allow_html_data_urls: settings.allow_html_data_urls,\n          allow_svg_data_urls: settings.allow_svg_data_urls,\n          allow_script_urls: settings.allow_script_urls,\n          allow_conditional_comments: settings.allow_conditional_comments,\n          preserve_cdata: settings.preserve_cdata,\n          self_closing_elements: cloneAndExcludeBlocks(schema.getSelfClosingElements()),\n          cdata: function (text) {\n            node.append(createNode('#cdata', 4)).value = text;\n          },\n          text: function (text, raw) {\n            var textNode;\n            if (!isInWhiteSpacePreservedElement) {\n              text = text.replace(allWhiteSpaceRegExp, ' ');\n              if (isLineBreakNode(node.lastChild, blockElements)) {\n                text = text.replace(startWhiteSpaceRegExp, '');\n              }\n            }\n            if (text.length !== 0) {\n              textNode = createNode('#text', 3);\n              textNode.raw = !!raw;\n              node.append(textNode).value = text;\n            }\n          },\n          comment: function (text) {\n            node.append(createNode('#comment', 8)).value = text;\n          },\n          pi: function (name, text) {\n            node.append(createNode(name, 7)).value = text;\n            removeWhitespaceBefore(node);\n          },\n          doctype: function (text) {\n            var newNode = node.append(createNode('#doctype', 10));\n            newNode.value = text;\n            removeWhitespaceBefore(node);\n          },\n          start: function (name, attrs, empty) {\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              var newNode = createNode(elementRule.outputName || name, 1);\n              newNode.attributes = attrs;\n              newNode.shortEnded = empty;\n              node.append(newNode);\n              var parent_2 = children[node.name];\n              if (parent_2 && children[newNode.name] && !parent_2[newNode.name]) {\n                invalidChildren.push(newNode);\n              }\n              var attrFiltersLen = attributeFilters.length;\n              while (attrFiltersLen--) {\n                var attrName = attributeFilters[attrFiltersLen].name;\n                if (attrName in attrs.map) {\n                  list = matchedAttributes[attrName];\n                  if (list) {\n                    list.push(newNode);\n                  } else {\n                    matchedAttributes[attrName] = [newNode];\n                  }\n                }\n              }\n              if (blockElements[name]) {\n                removeWhitespaceBefore(newNode);\n              }\n              if (!empty) {\n                node = newNode;\n              }\n              if (!isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = true;\n              }\n            }\n          },\n          end: function (name) {\n            var textNode, text, sibling, tempNode;\n            var elementRule = validate ? schema.getElementRule(name) : {};\n            if (elementRule) {\n              if (blockElements[name]) {\n                if (!isInWhiteSpacePreservedElement) {\n                  textNode = node.firstChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(startWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.next;\n                    } else {\n                      sibling = textNode.next;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.next;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                  textNode = node.lastChild;\n                  if (textNode && textNode.type === 3) {\n                    text = textNode.value.replace(endWhiteSpaceRegExp, '');\n                    if (text.length > 0) {\n                      textNode.value = text;\n                      textNode = textNode.prev;\n                    } else {\n                      sibling = textNode.prev;\n                      textNode.remove();\n                      textNode = sibling;\n                      while (textNode && textNode.type === 3) {\n                        text = textNode.value;\n                        sibling = textNode.prev;\n                        if (text.length === 0 || isAllWhiteSpaceRegExp.test(text)) {\n                          textNode.remove();\n                          textNode = sibling;\n                        }\n                        textNode = sibling;\n                      }\n                    }\n                  }\n                }\n              }\n              if (isInWhiteSpacePreservedElement && whiteSpaceElements[name]) {\n                isInWhiteSpacePreservedElement = false;\n              }\n              if (elementRule.removeEmpty && isEmpty(schema, nonEmptyElements, whiteSpaceElements, node)) {\n                tempNode = node.parent;\n                if (blockElements[node.name]) {\n                  node.empty().remove();\n                } else {\n                  node.unwrap();\n                }\n                node = tempNode;\n                return;\n              }\n              if (elementRule.paddEmpty && (isPaddedWithNbsp(node) || isEmpty(schema, nonEmptyElements, whiteSpaceElements, node))) {\n                paddEmptyNode(settings, args, blockElements, node);\n              }\n              node = node.parent;\n            }\n          }\n        }, schema);\n        var rootNode = node = new AstNode(args.context || settings.root_name, 11);\n        parser.parse(html, args.format);\n        if (validate && invalidChildren.length) {\n          if (!args.context) {\n            fixInvalidChildren(invalidChildren);\n          } else {\n            args.invalid = true;\n          }\n        }\n        if (rootBlockName && (rootNode.name === 'body' || args.isRootContent)) {\n          addRootBlocks();\n        }\n        if (!args.invalid) {\n          for (name in matchedNodes) {\n            if (!has$2(matchedNodes, name)) {\n              continue;\n            }\n            list = nodeFilters[name];\n            nodes = matchedNodes[name];\n            fi = nodes.length;\n            while (fi--) {\n              if (!nodes[fi].parent) {\n                nodes.splice(fi, 1);\n              }\n            }\n            for (i = 0, l = list.length; i < l; i++) {\n              list[i](nodes, name, args);\n            }\n          }\n          for (i = 0, l = attributeFilters.length; i < l; i++) {\n            list = attributeFilters[i];\n            if (list.name in matchedAttributes) {\n              nodes = matchedAttributes[list.name];\n              fi = nodes.length;\n              while (fi--) {\n                if (!nodes[fi].parent) {\n                  nodes.splice(fi, 1);\n                }\n              }\n              for (fi = 0, fl = list.callbacks.length; fi < fl; fi++) {\n                list.callbacks[fi](nodes, list.name, args);\n              }\n            }\n          }\n        }\n        return rootNode;\n      };\n      var exports = {\n        schema: schema,\n        addAttributeFilter: addAttributeFilter,\n        getAttributeFilters: getAttributeFilters,\n        addNodeFilter: addNodeFilter,\n        getNodeFilters: getNodeFilters,\n        filterNode: filterNode,\n        parse: parse\n      };\n      register$1(exports, settings);\n      register$2(exports, settings);\n      return exports;\n    };\n\n    var register = function (htmlParser, settings, dom) {\n      htmlParser.addAttributeFilter('data-mce-tabindex', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          node.attr('tabindex', node.attr('data-mce-tabindex'));\n          node.attr(name, null);\n        }\n      });\n      htmlParser.addAttributeFilter('src,href,style', function (nodes, name) {\n        var internalName = 'data-mce-' + name;\n        var urlConverter = settings.url_converter;\n        var urlConverterScope = settings.url_converter_scope;\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var value = node.attr(internalName);\n          if (value !== undefined) {\n            node.attr(name, value.length > 0 ? value : null);\n            node.attr(internalName, null);\n          } else {\n            value = node.attr(name);\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n            } else if (urlConverter) {\n              value = urlConverter.call(urlConverterScope, value, name, node.name);\n            }\n            node.attr(name, value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('class', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var value = node.attr('class');\n          if (value) {\n            value = node.attr('class').replace(/(?:^|\\s)mce-item-\\w+(?!\\S)/g, '');\n            node.attr('class', value.length > 0 ? value : null);\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes, name, args) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          if (node.attr('data-mce-type') === 'bookmark' && !args.cleanup) {\n            var hasChildren = Optional.from(node.firstChild).exists(function (firstChild) {\n              return !isZwsp(firstChild.value);\n            });\n            if (hasChildren) {\n              node.unwrap();\n            } else {\n              node.remove();\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('noscript', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i].firstChild;\n          if (node) {\n            node.value = Entities.decode(node.value);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('script,style', function (nodes, name) {\n        var trim = function (value) {\n          return value.replace(/(<!--\\[CDATA\\[|\\]\\]-->)/g, '\\n').replace(/^[\\r\\n]*|[\\r\\n]*$/g, '').replace(/^\\s*((<!--)?(\\s*\\/\\/)?\\s*<!\\[CDATA\\[|(<!--\\s*)?\\/\\*\\s*<!\\[CDATA\\[\\s*\\*\\/|(\\/\\/)?\\s*<!--|\\/\\*\\s*<!--\\s*\\*\\/)\\s*[\\r\\n]*/gi, '').replace(/\\s*(\\/\\*\\s*\\]\\]>\\s*\\*\\/(-->)?|\\s*\\/\\/\\s*\\]\\]>(-->)?|\\/\\/\\s*(-->)?|\\]\\]>|\\/\\*\\s*-->\\s*\\*\\/|\\s*-->\\s*)\\s*$/g, '');\n        };\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var value = node.firstChild ? node.firstChild.value : '';\n          if (name === 'script') {\n            var type = node.attr('type');\n            if (type) {\n              node.attr('type', type === 'mce-no/type' ? null : type.replace(/^mce\\-/, ''));\n            }\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '// <![CDATA[\\n' + trim(value) + '\\n// ]]>';\n            }\n          } else {\n            if (settings.element_format === 'xhtml' && value.length > 0) {\n              node.firstChild.value = '<!--\\n' + trim(value) + '\\n-->';\n            }\n          }\n        }\n      });\n      htmlParser.addNodeFilter('#comment', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          if (settings.preserve_cdata && node.value.indexOf('[CDATA[') === 0) {\n            node.name = '#cdata';\n            node.type = 4;\n            node.value = dom.decode(node.value.replace(/^\\[CDATA\\[|\\]\\]$/g, ''));\n          } else if (node.value.indexOf('mce:protected ') === 0) {\n            node.name = '#text';\n            node.type = 3;\n            node.raw = true;\n            node.value = unescape(node.value).substr(14);\n          }\n        }\n      });\n      htmlParser.addNodeFilter('xml:namespace,input', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          if (node.type === 7) {\n            node.remove();\n          } else if (node.type === 1) {\n            if (name === 'input' && !node.attr('type')) {\n              node.attr('type', 'text');\n            }\n          }\n        }\n      });\n      htmlParser.addAttributeFilter('data-mce-type', function (nodes) {\n        each$k(nodes, function (node) {\n          if (node.attr('data-mce-type') === 'format-caret') {\n            if (node.isEmpty(htmlParser.schema.getNonEmptyElements())) {\n              node.remove();\n            } else {\n              node.unwrap();\n            }\n          }\n        });\n      });\n      htmlParser.addAttributeFilter('data-mce-src,data-mce-href,data-mce-style,' + 'data-mce-selected,data-mce-expando,' + 'data-mce-type,data-mce-resize,data-mce-placeholder', function (nodes, name) {\n        var i = nodes.length;\n        while (i--) {\n          nodes[i].attr(name, null);\n        }\n      });\n    };\n    var trimTrailingBr = function (rootNode) {\n      var isBr = function (node) {\n        return node && node.name === 'br';\n      };\n      var brNode1 = rootNode.lastChild;\n      if (isBr(brNode1)) {\n        var brNode2 = brNode1.prev;\n        if (isBr(brNode2)) {\n          brNode1.remove();\n          brNode2.remove();\n        }\n      }\n    };\n\n    var preProcess = function (editor, node, args) {\n      var oldDoc;\n      var dom = editor.dom;\n      var clonedNode = node.cloneNode(true);\n      var impl = document.implementation;\n      if (impl.createHTMLDocument) {\n        var doc_1 = impl.createHTMLDocument('');\n        Tools.each(clonedNode.nodeName === 'BODY' ? clonedNode.childNodes : [clonedNode], function (node) {\n          doc_1.body.appendChild(doc_1.importNode(node, true));\n        });\n        if (clonedNode.nodeName !== 'BODY') {\n          clonedNode = doc_1.body.firstChild;\n        } else {\n          clonedNode = doc_1.body;\n        }\n        oldDoc = dom.doc;\n        dom.doc = doc_1;\n      }\n      firePreProcess(editor, __assign(__assign({}, args), { node: clonedNode }));\n      if (oldDoc) {\n        dom.doc = oldDoc;\n      }\n      return clonedNode;\n    };\n    var shouldFireEvent = function (editor, args) {\n      return editor && editor.hasEventListeners('PreProcess') && !args.no_events;\n    };\n    var process = function (editor, node, args) {\n      return shouldFireEvent(editor, args) ? preProcess(editor, node, args) : node;\n    };\n\n    var addTempAttr = function (htmlParser, tempAttrs, name) {\n      if (Tools.inArray(tempAttrs, name) === -1) {\n        htmlParser.addAttributeFilter(name, function (nodes, name) {\n          var i = nodes.length;\n          while (i--) {\n            nodes[i].attr(name, null);\n          }\n        });\n        tempAttrs.push(name);\n      }\n    };\n    var postProcess = function (editor, args, content) {\n      if (!args.no_events && editor) {\n        var outArgs = firePostProcess(editor, __assign(__assign({}, args), { content: content }));\n        return outArgs.content;\n      } else {\n        return content;\n      }\n    };\n    var getHtmlFromNode = function (dom, node, args) {\n      var html = trim$2(args.getInner ? node.innerHTML : dom.getOuterHTML(node));\n      return args.selection || isWsPreserveElement(SugarElement.fromDom(node)) ? html : Tools.trim(html);\n    };\n    var parseHtml = function (htmlParser, html, args) {\n      var parserArgs = args.selection ? __assign({ forced_root_block: false }, args) : args;\n      var rootNode = htmlParser.parse(html, parserArgs);\n      trimTrailingBr(rootNode);\n      return rootNode;\n    };\n    var serializeNode = function (settings, schema, node) {\n      var htmlSerializer = HtmlSerializer(settings, schema);\n      return htmlSerializer.serialize(node);\n    };\n    var toHtml = function (editor, settings, schema, rootNode, args) {\n      var content = serializeNode(settings, schema, rootNode);\n      return postProcess(editor, args, content);\n    };\n    var DomSerializerImpl = function (settings, editor) {\n      var tempAttrs = ['data-mce-selected'];\n      var dom = editor && editor.dom ? editor.dom : DOMUtils.DOM;\n      var schema = editor && editor.schema ? editor.schema : Schema(settings);\n      settings.entity_encoding = settings.entity_encoding || 'named';\n      settings.remove_trailing_brs = 'remove_trailing_brs' in settings ? settings.remove_trailing_brs : true;\n      var htmlParser = DomParser(settings, schema);\n      register(htmlParser, settings, dom);\n      var serialize = function (node, parserArgs) {\n        if (parserArgs === void 0) {\n          parserArgs = {};\n        }\n        var args = __assign({ format: 'html' }, parserArgs);\n        var targetNode = process(editor, node, args);\n        var html = getHtmlFromNode(dom, targetNode, args);\n        var rootNode = parseHtml(htmlParser, html, args);\n        return args.format === 'tree' ? rootNode : toHtml(editor, settings, schema, rootNode, args);\n      };\n      return {\n        schema: schema,\n        addNodeFilter: htmlParser.addNodeFilter,\n        addAttributeFilter: htmlParser.addAttributeFilter,\n        serialize: serialize,\n        addRules: schema.addValidElements,\n        setRules: schema.setValidElements,\n        addTempAttr: curry(addTempAttr, htmlParser, tempAttrs),\n        getTempAttrs: constant(tempAttrs),\n        getNodeFilters: htmlParser.getNodeFilters,\n        getAttributeFilters: htmlParser.getAttributeFilters\n      };\n    };\n\n    var DomSerializer = function (settings, editor) {\n      var domSerializer = DomSerializerImpl(settings, editor);\n      return {\n        schema: domSerializer.schema,\n        addNodeFilter: domSerializer.addNodeFilter,\n        addAttributeFilter: domSerializer.addAttributeFilter,\n        serialize: domSerializer.serialize,\n        addRules: domSerializer.addRules,\n        setRules: domSerializer.setRules,\n        addTempAttr: domSerializer.addTempAttr,\n        getTempAttrs: domSerializer.getTempAttrs,\n        getNodeFilters: domSerializer.getNodeFilters,\n        getAttributeFilters: domSerializer.getAttributeFilters\n      };\n    };\n\n    var defaultFormat = 'html';\n    var getContent = function (editor, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      var format = args.format ? args.format : defaultFormat;\n      return getContent$2(editor, args, format);\n    };\n\n    var setContent = function (editor, content, args) {\n      if (args === void 0) {\n        args = {};\n      }\n      return setContent$2(editor, content, args);\n    };\n\n    var DOM$7 = DOMUtils.DOM;\n    var restoreOriginalStyles = function (editor) {\n      DOM$7.setStyle(editor.id, 'display', editor.orgDisplay);\n    };\n    var safeDestroy = function (x) {\n      return Optional.from(x).each(function (x) {\n        return x.destroy();\n      });\n    };\n    var clearDomReferences = function (editor) {\n      editor.contentAreaContainer = editor.formElement = editor.container = editor.editorContainer = null;\n      editor.bodyElement = editor.contentDocument = editor.contentWindow = null;\n      editor.iframeElement = editor.targetElm = null;\n      if (editor.selection) {\n        editor.selection = editor.selection.win = editor.selection.dom = editor.selection.dom.doc = null;\n      }\n    };\n    var restoreForm = function (editor) {\n      var form = editor.formElement;\n      if (form) {\n        if (form._mceOldSubmit) {\n          form.submit = form._mceOldSubmit;\n          form._mceOldSubmit = null;\n        }\n        DOM$7.unbind(form, 'submit reset', editor.formEventDelegate);\n      }\n    };\n    var remove = function (editor) {\n      if (!editor.removed) {\n        var _selectionOverrides = editor._selectionOverrides, editorUpload = editor.editorUpload;\n        var body = editor.getBody();\n        var element = editor.getElement();\n        if (body) {\n          editor.save({ is_removing: true });\n        }\n        editor.removed = true;\n        editor.unbindAllNativeEvents();\n        if (editor.hasHiddenInput && element) {\n          DOM$7.remove(element.nextSibling);\n        }\n        fireRemove(editor);\n        editor.editorManager.remove(editor);\n        if (!editor.inline && body) {\n          restoreOriginalStyles(editor);\n        }\n        fireDetach(editor);\n        DOM$7.remove(editor.getContainer());\n        safeDestroy(_selectionOverrides);\n        safeDestroy(editorUpload);\n        editor.destroy();\n      }\n    };\n    var destroy = function (editor, automatic) {\n      var selection = editor.selection, dom = editor.dom;\n      if (editor.destroyed) {\n        return;\n      }\n      if (!automatic && !editor.removed) {\n        editor.remove();\n        return;\n      }\n      if (!automatic) {\n        editor.editorManager.off('beforeunload', editor._beforeUnload);\n        if (editor.theme && editor.theme.destroy) {\n          editor.theme.destroy();\n        }\n        safeDestroy(selection);\n        safeDestroy(dom);\n      }\n      restoreForm(editor);\n      clearDomReferences(editor);\n      editor.destroyed = true;\n    };\n\n    var deep = function (old, nu) {\n      var bothObjects = isObject(old) && isObject(nu);\n      return bothObjects ? deepMerge(old, nu) : nu;\n    };\n    var baseMerge = function (merger) {\n      return function () {\n        var objects = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          objects[_i] = arguments[_i];\n        }\n        if (objects.length === 0) {\n          throw new Error('Can\\'t merge zero objects');\n        }\n        var ret = {};\n        for (var j = 0; j < objects.length; j++) {\n          var curObject = objects[j];\n          for (var key in curObject) {\n            if (has$2(curObject, key)) {\n              ret[key] = merger(ret[key], curObject[key]);\n            }\n          }\n        }\n        return ret;\n      };\n    };\n    var deepMerge = baseMerge(deep);\n\n    var deprecatedSettings = ('autoresize_on_init,content_editable_state,convert_fonts_to_spans,inline_styles,padd_empty_with_br,block_elements,' + 'boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,' + 'force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,' + 'non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,' + 'tab_focus,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,' + 'paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists').split(',');\n    var deprecatedPlugins = 'bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,textcolor'.split(',');\n    var movedToPremiumPlugins = 'imagetools,toc'.split(',');\n    var getDeprecatedSettings = function (settings) {\n      var settingNames = filter$4(deprecatedSettings, function (setting) {\n        return has$2(settings, setting);\n      });\n      var forcedRootBlock = settings.forced_root_block;\n      if (forcedRootBlock === false || forcedRootBlock === '') {\n        settingNames.push('forced_root_block (false only)');\n      }\n      return sort(settingNames);\n    };\n    var getDeprecatedPlugins = function (settings) {\n      var plugins = Tools.makeMap(settings.plugins, ' ');\n      var hasPlugin = function (plugin) {\n        return has$2(plugins, plugin);\n      };\n      var pluginNames = __spreadArray(__spreadArray([], filter$4(deprecatedPlugins, hasPlugin), true), bind(movedToPremiumPlugins, function (plugin) {\n        return hasPlugin(plugin) ? [plugin + ' (moving to premium)'] : [];\n      }), true);\n      return sort(pluginNames);\n    };\n    var logDeprecationsWarning = function (rawSettings, finalSettings) {\n      var deprecatedSettings = getDeprecatedSettings(rawSettings);\n      var deprecatedPlugins = getDeprecatedPlugins(finalSettings);\n      var hasDeprecatedPlugins = deprecatedPlugins.length > 0;\n      var hasDeprecatedSettings = deprecatedSettings.length > 0;\n      var isLegacyMobileTheme = finalSettings.theme === 'mobile';\n      if (hasDeprecatedPlugins || hasDeprecatedSettings || isLegacyMobileTheme) {\n        var listJoiner = '\\n- ';\n        var themesMessage = isLegacyMobileTheme ? '\\n\\nThemes:' + listJoiner + 'mobile' : '';\n        var pluginsMessage = hasDeprecatedPlugins ? '\\n\\nPlugins:' + listJoiner + deprecatedPlugins.join(listJoiner) : '';\n        var settingsMessage = hasDeprecatedSettings ? '\\n\\nSettings:' + listJoiner + deprecatedSettings.join(listJoiner) : '';\n        console.warn('The following deprecated features are currently enabled, these will be removed in TinyMCE 6.0. ' + 'See https://www.tiny.cloud/docs/release-notes/6.0-upcoming-changes/ for more information.' + themesMessage + pluginsMessage + settingsMessage);\n      }\n    };\n\n    var sectionResult = function (sections, settings) {\n      return {\n        sections: constant(sections),\n        settings: constant(settings)\n      };\n    };\n    var deviceDetection = detect().deviceType;\n    var isTouch = deviceDetection.isTouch();\n    var isPhone = deviceDetection.isPhone();\n    var isTablet = deviceDetection.isTablet();\n    var legacyMobilePlugins = [\n      'lists',\n      'autolink',\n      'autosave'\n    ];\n    var defaultTouchSettings = {\n      table_grid: false,\n      object_resizing: false,\n      resize: false\n    };\n    var normalizePlugins = function (plugins) {\n      var pluginNames = isArray$1(plugins) ? plugins.join(' ') : plugins;\n      var trimmedPlugins = map$3(isString$1(pluginNames) ? pluginNames.split(' ') : [], trim$4);\n      return filter$4(trimmedPlugins, function (item) {\n        return item.length > 0;\n      });\n    };\n    var filterLegacyMobilePlugins = function (plugins) {\n      return filter$4(plugins, curry(contains$3, legacyMobilePlugins));\n    };\n    var extractSections = function (keys, settings) {\n      var result = bifilter(settings, function (value, key) {\n        return contains$3(keys, key);\n      });\n      return sectionResult(result.t, result.f);\n    };\n    var getSection = function (sectionResult, name, defaults) {\n      if (defaults === void 0) {\n        defaults = {};\n      }\n      var sections = sectionResult.sections();\n      var sectionSettings = get$9(sections, name).getOr({});\n      return Tools.extend({}, defaults, sectionSettings);\n    };\n    var hasSection = function (sectionResult, name) {\n      return has$2(sectionResult.sections(), name);\n    };\n    var isSectionTheme = function (sectionResult, name, theme) {\n      var section = sectionResult.sections();\n      return hasSection(sectionResult, name) && section[name].theme === theme;\n    };\n    var getSectionConfig = function (sectionResult, name) {\n      return hasSection(sectionResult, name) ? sectionResult.sections()[name] : {};\n    };\n    var getToolbarMode = function (settings, defaultVal) {\n      return get$9(settings, 'toolbar_mode').orThunk(function () {\n        return get$9(settings, 'toolbar_drawer').map(function (val) {\n          return val === false ? 'wrap' : val;\n        });\n      }).getOr(defaultVal);\n    };\n    var getDefaultSettings = function (settings, id, documentBaseUrl, isTouch, editor) {\n      var baseDefaults = {\n        id: id,\n        theme: 'silver',\n        toolbar_mode: getToolbarMode(settings, 'floating'),\n        plugins: '',\n        document_base_url: documentBaseUrl,\n        add_form_submit_trigger: true,\n        submit_patch: true,\n        add_unload_trigger: true,\n        convert_urls: true,\n        relative_urls: true,\n        remove_script_host: true,\n        object_resizing: true,\n        doctype: '<!DOCTYPE html>',\n        visual: true,\n        font_size_legacy_values: 'xx-small,small,medium,large,x-large,xx-large,300%',\n        forced_root_block: 'p',\n        hidden_input: true,\n        inline_styles: true,\n        convert_fonts_to_spans: true,\n        indent: true,\n        indent_before: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        indent_after: 'p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,' + 'tfoot,tbody,tr,section,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist',\n        entity_encoding: 'named',\n        url_converter: editor.convertURL,\n        url_converter_scope: editor\n      };\n      return __assign(__assign({}, baseDefaults), isTouch ? defaultTouchSettings : {});\n    };\n    var getDefaultMobileSettings = function (mobileSettings, isPhone) {\n      var defaultMobileSettings = {\n        resize: false,\n        toolbar_mode: getToolbarMode(mobileSettings, 'scrolling'),\n        toolbar_sticky: false\n      };\n      var defaultPhoneSettings = { menubar: false };\n      return __assign(__assign(__assign({}, defaultTouchSettings), defaultMobileSettings), isPhone ? defaultPhoneSettings : {});\n    };\n    var getExternalPlugins = function (overrideSettings, settings) {\n      var userDefinedExternalPlugins = settings.external_plugins ? settings.external_plugins : {};\n      if (overrideSettings && overrideSettings.external_plugins) {\n        return Tools.extend({}, overrideSettings.external_plugins, userDefinedExternalPlugins);\n      } else {\n        return userDefinedExternalPlugins;\n      }\n    };\n    var combinePlugins = function (forcedPlugins, plugins) {\n      return [].concat(normalizePlugins(forcedPlugins)).concat(normalizePlugins(plugins));\n    };\n    var getPlatformPlugins = function (isMobileDevice, sectionResult, desktopPlugins, mobilePlugins) {\n      if (isMobileDevice && isSectionTheme(sectionResult, 'mobile', 'mobile')) {\n        return filterLegacyMobilePlugins(mobilePlugins);\n      } else if (isMobileDevice && hasSection(sectionResult, 'mobile')) {\n        return mobilePlugins;\n      } else {\n        return desktopPlugins;\n      }\n    };\n    var processPlugins = function (isMobileDevice, sectionResult, defaultOverrideSettings, settings) {\n      var forcedPlugins = normalizePlugins(defaultOverrideSettings.forced_plugins);\n      var desktopPlugins = normalizePlugins(settings.plugins);\n      var mobileConfig = getSectionConfig(sectionResult, 'mobile');\n      var mobilePlugins = mobileConfig.plugins ? normalizePlugins(mobileConfig.plugins) : desktopPlugins;\n      var platformPlugins = getPlatformPlugins(isMobileDevice, sectionResult, desktopPlugins, mobilePlugins);\n      var combinedPlugins = combinePlugins(forcedPlugins, platformPlugins);\n      if (Env.browser.isIE() && contains$3(combinedPlugins, 'rtc')) {\n        throw new Error('RTC plugin is not supported on IE 11.');\n      }\n      return Tools.extend(settings, { plugins: combinedPlugins.join(' ') });\n    };\n    var isOnMobile = function (isMobileDevice, sectionResult) {\n      return isMobileDevice && hasSection(sectionResult, 'mobile');\n    };\n    var combineSettings = function (isMobileDevice, isPhone, defaultSettings, defaultOverrideSettings, settings) {\n      var defaultDeviceSettings = isMobileDevice ? { mobile: getDefaultMobileSettings(settings.mobile || {}, isPhone) } : {};\n      var sectionResult = extractSections(['mobile'], deepMerge(defaultDeviceSettings, settings));\n      var extendedSettings = Tools.extend(defaultSettings, defaultOverrideSettings, sectionResult.settings(), isOnMobile(isMobileDevice, sectionResult) ? getSection(sectionResult, 'mobile') : {}, {\n        validate: true,\n        external_plugins: getExternalPlugins(defaultOverrideSettings, sectionResult.settings())\n      });\n      return processPlugins(isMobileDevice, sectionResult, defaultOverrideSettings, extendedSettings);\n    };\n    var getEditorSettings = function (editor, id, documentBaseUrl, defaultOverrideSettings, settings) {\n      var defaultSettings = getDefaultSettings(settings, id, documentBaseUrl, isTouch, editor);\n      var finalSettings = combineSettings(isPhone || isTablet, isPhone, defaultSettings, defaultOverrideSettings, settings);\n      if (finalSettings.deprecation_warnings !== false) {\n        logDeprecationsWarning(settings, finalSettings);\n      }\n      return finalSettings;\n    };\n    var getFiltered = function (predicate, editor, name) {\n      return Optional.from(editor.settings[name]).filter(predicate);\n    };\n    var getParamObject = function (value) {\n      var output = {};\n      if (typeof value === 'string') {\n        each$k(value.indexOf('=') > 0 ? value.split(/[;,](?![^=;,]*(?:[;,]|$))/) : value.split(','), function (val) {\n          var arr = val.split('=');\n          if (arr.length > 1) {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[1]);\n          } else {\n            output[Tools.trim(arr[0])] = Tools.trim(arr[0]);\n          }\n        });\n      } else {\n        output = value;\n      }\n      return output;\n    };\n    var isArrayOf = function (p) {\n      return function (a) {\n        return isArray$1(a) && forall(a, p);\n      };\n    };\n    var getParam = function (editor, name, defaultVal, type) {\n      var value = name in editor.settings ? editor.settings[name] : defaultVal;\n      if (type === 'hash') {\n        return getParamObject(value);\n      } else if (type === 'string') {\n        return getFiltered(isString$1, editor, name).getOr(defaultVal);\n      } else if (type === 'number') {\n        return getFiltered(isNumber, editor, name).getOr(defaultVal);\n      } else if (type === 'boolean') {\n        return getFiltered(isBoolean, editor, name).getOr(defaultVal);\n      } else if (type === 'object') {\n        return getFiltered(isObject, editor, name).getOr(defaultVal);\n      } else if (type === 'array') {\n        return getFiltered(isArray$1, editor, name).getOr(defaultVal);\n      } else if (type === 'string[]') {\n        return getFiltered(isArrayOf(isString$1), editor, name).getOr(defaultVal);\n      } else if (type === 'function') {\n        return getFiltered(isFunction, editor, name).getOr(defaultVal);\n      } else {\n        return value;\n      }\n    };\n\n    var CreateIconManager = function () {\n      var lookup = {};\n      var add = function (id, iconPack) {\n        lookup[id] = iconPack;\n      };\n      var get = function (id) {\n        if (lookup[id]) {\n          return lookup[id];\n        }\n        return { icons: {} };\n      };\n      var has = function (id) {\n        return has$2(lookup, id);\n      };\n      return {\n        add: add,\n        get: get,\n        has: has\n      };\n    };\n    var IconManager = CreateIconManager();\n\n    var getProp = function (propName, elm) {\n      var rawElm = elm.dom;\n      return rawElm[propName];\n    };\n    var getComputedSizeProp = function (propName, elm) {\n      return parseInt(get$5(elm, propName), 10);\n    };\n    var getClientWidth = curry(getProp, 'clientWidth');\n    var getClientHeight = curry(getProp, 'clientHeight');\n    var getMarginTop = curry(getComputedSizeProp, 'margin-top');\n    var getMarginLeft = curry(getComputedSizeProp, 'margin-left');\n    var getBoundingClientRect = function (elm) {\n      return elm.dom.getBoundingClientRect();\n    };\n    var isInsideElementContentArea = function (bodyElm, clientX, clientY) {\n      var clientWidth = getClientWidth(bodyElm);\n      var clientHeight = getClientHeight(bodyElm);\n      return clientX >= 0 && clientY >= 0 && clientX <= clientWidth && clientY <= clientHeight;\n    };\n    var transpose = function (inline, elm, clientX, clientY) {\n      var clientRect = getBoundingClientRect(elm);\n      var deltaX = inline ? clientRect.left + elm.dom.clientLeft + getMarginLeft(elm) : 0;\n      var deltaY = inline ? clientRect.top + elm.dom.clientTop + getMarginTop(elm) : 0;\n      var x = clientX - deltaX;\n      var y = clientY - deltaY;\n      return {\n        x: x,\n        y: y\n      };\n    };\n    var isXYInContentArea = function (editor, clientX, clientY) {\n      var bodyElm = SugarElement.fromDom(editor.getBody());\n      var targetElm = editor.inline ? bodyElm : documentElement(bodyElm);\n      var transposedPoint = transpose(editor.inline, targetElm, clientX, clientY);\n      return isInsideElementContentArea(targetElm, transposedPoint.x, transposedPoint.y);\n    };\n    var fromDomSafe = function (node) {\n      return Optional.from(node).map(SugarElement.fromDom);\n    };\n    var isEditorAttachedToDom = function (editor) {\n      var rawContainer = editor.inline ? editor.getBody() : editor.getContentAreaContainer();\n      return fromDomSafe(rawContainer).map(inBody).getOr(false);\n    };\n\n    var NotificationManagerImpl = function () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a NotificationManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        close: unimplemented,\n        reposition: unimplemented,\n        getArgs: unimplemented\n      };\n    };\n\n    var NotificationManager = function (editor) {\n      var notifications = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getNotificationManagerImpl ? theme.getNotificationManagerImpl() : NotificationManagerImpl();\n      };\n      var getTopNotification = function () {\n        return Optional.from(notifications[0]);\n      };\n      var isEqual = function (a, b) {\n        return a.type === b.type && a.text === b.text && !a.progressBar && !a.timeout && !b.progressBar && !b.timeout;\n      };\n      var reposition = function () {\n        if (notifications.length > 0) {\n          getImplementation().reposition(notifications);\n        }\n      };\n      var addNotification = function (notification) {\n        notifications.push(notification);\n      };\n      var closeNotification = function (notification) {\n        findIndex$2(notifications, function (otherNotification) {\n          return otherNotification === notification;\n        }).each(function (index) {\n          notifications.splice(index, 1);\n        });\n      };\n      var open = function (spec, fireEvent) {\n        if (fireEvent === void 0) {\n          fireEvent = true;\n        }\n        if (editor.removed || !isEditorAttachedToDom(editor)) {\n          return;\n        }\n        if (fireEvent) {\n          editor.fire('BeforeOpenNotification', { notification: spec });\n        }\n        return find$3(notifications, function (notification) {\n          return isEqual(getImplementation().getArgs(notification), spec);\n        }).getOrThunk(function () {\n          editor.editorManager.setActive(editor);\n          var notification = getImplementation().open(spec, function () {\n            closeNotification(notification);\n            reposition();\n            getTopNotification().fold(function () {\n              return editor.focus();\n            }, function (top) {\n              return focus$1(SugarElement.fromDom(top.getEl()));\n            });\n          });\n          addNotification(notification);\n          reposition();\n          editor.fire('OpenNotification', { notification: __assign({}, notification) });\n          return notification;\n        });\n      };\n      var close = function () {\n        getTopNotification().each(function (notification) {\n          getImplementation().close(notification);\n          closeNotification(notification);\n          reposition();\n        });\n      };\n      var getNotifications = constant(notifications);\n      var registerEvents = function (editor) {\n        editor.on('SkinLoaded', function () {\n          var serviceMessage = getServiceMessage(editor);\n          if (serviceMessage) {\n            open({\n              text: serviceMessage,\n              type: 'warning',\n              timeout: 0\n            }, false);\n          }\n          reposition();\n        });\n        editor.on('show ResizeEditor ResizeWindow NodeChange', function () {\n          Delay.requestAnimationFrame(reposition);\n        });\n        editor.on('remove', function () {\n          each$k(notifications.slice(), function (notification) {\n            getImplementation().close(notification);\n          });\n        });\n      };\n      registerEvents(editor);\n      return {\n        open: open,\n        close: close,\n        getNotifications: getNotifications\n      };\n    };\n\n    var PluginManager = AddOnManager.PluginManager;\n\n    var ThemeManager = AddOnManager.ThemeManager;\n\n    function WindowManagerImpl () {\n      var unimplemented = function () {\n        throw new Error('Theme did not provide a WindowManager implementation.');\n      };\n      return {\n        open: unimplemented,\n        openUrl: unimplemented,\n        alert: unimplemented,\n        confirm: unimplemented,\n        close: unimplemented,\n        getParams: unimplemented,\n        setParams: unimplemented\n      };\n    }\n\n    var WindowManager = function (editor) {\n      var dialogs = [];\n      var getImplementation = function () {\n        var theme = editor.theme;\n        return theme && theme.getWindowManagerImpl ? theme.getWindowManagerImpl() : WindowManagerImpl();\n      };\n      var funcBind = function (scope, f) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          return f ? f.apply(scope, args) : undefined;\n        };\n      };\n      var fireOpenEvent = function (dialog) {\n        editor.fire('OpenWindow', { dialog: dialog });\n      };\n      var fireCloseEvent = function (dialog) {\n        editor.fire('CloseWindow', { dialog: dialog });\n      };\n      var addDialog = function (dialog) {\n        dialogs.push(dialog);\n        fireOpenEvent(dialog);\n      };\n      var closeDialog = function (dialog) {\n        fireCloseEvent(dialog);\n        dialogs = filter$4(dialogs, function (otherDialog) {\n          return otherDialog !== dialog;\n        });\n        if (dialogs.length === 0) {\n          editor.focus();\n        }\n      };\n      var getTopDialog = function () {\n        return Optional.from(dialogs[dialogs.length - 1]);\n      };\n      var storeSelectionAndOpenDialog = function (openDialog) {\n        editor.editorManager.setActive(editor);\n        store(editor);\n        var dialog = openDialog();\n        addDialog(dialog);\n        return dialog;\n      };\n      var open = function (args, params) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().open(args, params, closeDialog);\n        });\n      };\n      var openUrl = function (args) {\n        return storeSelectionAndOpenDialog(function () {\n          return getImplementation().openUrl(args, closeDialog);\n        });\n      };\n      var alert = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.alert(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var confirm = function (message, callback, scope) {\n        var windowManagerImpl = getImplementation();\n        windowManagerImpl.confirm(message, funcBind(scope ? scope : windowManagerImpl, callback));\n      };\n      var close = function () {\n        getTopDialog().each(function (dialog) {\n          getImplementation().close(dialog);\n          closeDialog(dialog);\n        });\n      };\n      editor.on('remove', function () {\n        each$k(dialogs, function (dialog) {\n          getImplementation().close(dialog);\n        });\n      });\n      return {\n        open: open,\n        openUrl: openUrl,\n        alert: alert,\n        confirm: confirm,\n        close: close\n      };\n    };\n\n    var displayNotification = function (editor, message) {\n      editor.notificationManager.open({\n        type: 'error',\n        text: message\n      });\n    };\n    var displayError = function (editor, message) {\n      if (editor._skinLoaded) {\n        displayNotification(editor, message);\n      } else {\n        editor.on('SkinLoaded', function () {\n          displayNotification(editor, message);\n        });\n      }\n    };\n    var uploadError = function (editor, message) {\n      displayError(editor, I18n.translate([\n        'Failed to upload image: {0}',\n        message\n      ]));\n    };\n    var logError = function (editor, errorType, msg) {\n      fireError(editor, errorType, { message: msg });\n      console.error(msg);\n    };\n    var createLoadError = function (type, url, name) {\n      return name ? 'Failed to load ' + type + ': ' + name + ' from url ' + url : 'Failed to load ' + type + ' url: ' + url;\n    };\n    var pluginLoadError = function (editor, url, name) {\n      logError(editor, 'PluginLoadError', createLoadError('plugin', url, name));\n    };\n    var iconsLoadError = function (editor, url, name) {\n      logError(editor, 'IconsLoadError', createLoadError('icons', url, name));\n    };\n    var languageLoadError = function (editor, url, name) {\n      logError(editor, 'LanguageLoadError', createLoadError('language', url, name));\n    };\n    var pluginInitError = function (editor, name, err) {\n      var message = I18n.translate([\n        'Failed to initialize plugin: {0}',\n        name\n      ]);\n      fireError(editor, 'PluginLoadError', { message: message });\n      initError(message, err);\n      displayError(editor, message);\n    };\n    var initError = function (message) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      var console = window.console;\n      if (console) {\n        if (console.error) {\n          console.error.apply(console, __spreadArray([message], x, false));\n        } else {\n          console.log.apply(console, __spreadArray([message], x, false));\n        }\n      }\n    };\n\n    var isContentCssSkinName = function (url) {\n      return /^[a-z0-9\\-]+$/i.test(url);\n    };\n    var getContentCssUrls = function (editor) {\n      return transformToUrls(editor, getContentCss(editor));\n    };\n    var getFontCssUrls = function (editor) {\n      return transformToUrls(editor, getFontCss(editor));\n    };\n    var transformToUrls = function (editor, cssLinks) {\n      var skinUrl = editor.editorManager.baseURL + '/skins/content';\n      var suffix = editor.editorManager.suffix;\n      var contentCssFile = 'content' + suffix + '.css';\n      var inline = editor.inline === true;\n      return map$3(cssLinks, function (url) {\n        if (isContentCssSkinName(url) && !inline) {\n          return skinUrl + '/' + url + '/' + contentCssFile;\n        } else {\n          return editor.documentBaseURI.toAbsolute(url);\n        }\n      });\n    };\n    var appendContentCssFromSettings = function (editor) {\n      editor.contentCSS = editor.contentCSS.concat(getContentCssUrls(editor), getFontCssUrls(editor));\n    };\n\n    var UploadStatus = function () {\n      var PENDING = 1, UPLOADED = 2;\n      var blobUriStatuses = {};\n      var createStatus = function (status, resultUri) {\n        return {\n          status: status,\n          resultUri: resultUri\n        };\n      };\n      var hasBlobUri = function (blobUri) {\n        return blobUri in blobUriStatuses;\n      };\n      var getResultUri = function (blobUri) {\n        var result = blobUriStatuses[blobUri];\n        return result ? result.resultUri : null;\n      };\n      var isPending = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === PENDING : false;\n      };\n      var isUploaded = function (blobUri) {\n        return hasBlobUri(blobUri) ? blobUriStatuses[blobUri].status === UPLOADED : false;\n      };\n      var markPending = function (blobUri) {\n        blobUriStatuses[blobUri] = createStatus(PENDING, null);\n      };\n      var markUploaded = function (blobUri, resultUri) {\n        blobUriStatuses[blobUri] = createStatus(UPLOADED, resultUri);\n      };\n      var removeFailed = function (blobUri) {\n        delete blobUriStatuses[blobUri];\n      };\n      var destroy = function () {\n        blobUriStatuses = {};\n      };\n      return {\n        hasBlobUri: hasBlobUri,\n        getResultUri: getResultUri,\n        isPending: isPending,\n        isUploaded: isUploaded,\n        markPending: markPending,\n        markUploaded: markUploaded,\n        removeFailed: removeFailed,\n        destroy: destroy\n      };\n    };\n\n    var count = 0;\n    var seed = function () {\n      var rnd = function () {\n        return Math.round(Math.random() * 4294967295).toString(36);\n      };\n      var now = new Date().getTime();\n      return 's' + now.toString(36) + rnd() + rnd() + rnd();\n    };\n    var uuid = function (prefix) {\n      return prefix + count++ + seed();\n    };\n\n    var BlobCache = function () {\n      var cache = [];\n      var mimeToExt = function (mime) {\n        var mimes = {\n          'image/jpeg': 'jpg',\n          'image/jpg': 'jpg',\n          'image/gif': 'gif',\n          'image/png': 'png',\n          'image/apng': 'apng',\n          'image/avif': 'avif',\n          'image/svg+xml': 'svg',\n          'image/webp': 'webp',\n          'image/bmp': 'bmp',\n          'image/tiff': 'tiff'\n        };\n        return mimes[mime.toLowerCase()] || 'dat';\n      };\n      var create = function (o, blob, base64, name, filename) {\n        if (isString$1(o)) {\n          var id = o;\n          return toBlobInfo({\n            id: id,\n            name: name,\n            filename: filename,\n            blob: blob,\n            base64: base64\n          });\n        } else if (isObject(o)) {\n          return toBlobInfo(o);\n        } else {\n          throw new Error('Unknown input type');\n        }\n      };\n      var toBlobInfo = function (o) {\n        if (!o.blob || !o.base64) {\n          throw new Error('blob and base64 representations of the image are required for BlobInfo to be created');\n        }\n        var id = o.id || uuid('blobid');\n        var name = o.name || id;\n        var blob = o.blob;\n        return {\n          id: constant(id),\n          name: constant(name),\n          filename: constant(o.filename || name + '.' + mimeToExt(blob.type)),\n          blob: constant(blob),\n          base64: constant(o.base64),\n          blobUri: constant(o.blobUri || URL.createObjectURL(blob)),\n          uri: constant(o.uri)\n        };\n      };\n      var add = function (blobInfo) {\n        if (!get(blobInfo.id())) {\n          cache.push(blobInfo);\n        }\n      };\n      var findFirst = function (predicate) {\n        return find$3(cache, predicate).getOrUndefined();\n      };\n      var get = function (id) {\n        return findFirst(function (cachedBlobInfo) {\n          return cachedBlobInfo.id() === id;\n        });\n      };\n      var getByUri = function (blobUri) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.blobUri() === blobUri;\n        });\n      };\n      var getByData = function (base64, type) {\n        return findFirst(function (blobInfo) {\n          return blobInfo.base64() === base64 && blobInfo.blob().type === type;\n        });\n      };\n      var removeByUri = function (blobUri) {\n        cache = filter$4(cache, function (blobInfo) {\n          if (blobInfo.blobUri() === blobUri) {\n            URL.revokeObjectURL(blobInfo.blobUri());\n            return false;\n          }\n          return true;\n        });\n      };\n      var destroy = function () {\n        each$k(cache, function (cachedBlobInfo) {\n          URL.revokeObjectURL(cachedBlobInfo.blobUri());\n        });\n        cache = [];\n      };\n      return {\n        create: create,\n        add: add,\n        get: get,\n        getByUri: getByUri,\n        getByData: getByData,\n        findFirst: findFirst,\n        removeByUri: removeByUri,\n        destroy: destroy\n      };\n    };\n\n    var Uploader = function (uploadStatus, settings) {\n      var pendingPromises = {};\n      var pathJoin = function (path1, path2) {\n        if (path1) {\n          return path1.replace(/\\/$/, '') + '/' + path2.replace(/^\\//, '');\n        }\n        return path2;\n      };\n      var defaultHandler = function (blobInfo, success, failure, progress) {\n        var xhr = new XMLHttpRequest();\n        xhr.open('POST', settings.url);\n        xhr.withCredentials = settings.credentials;\n        xhr.upload.onprogress = function (e) {\n          progress(e.loaded / e.total * 100);\n        };\n        xhr.onerror = function () {\n          failure('Image upload failed due to a XHR Transport error. Code: ' + xhr.status);\n        };\n        xhr.onload = function () {\n          if (xhr.status < 200 || xhr.status >= 300) {\n            failure('HTTP Error: ' + xhr.status);\n            return;\n          }\n          var json = JSON.parse(xhr.responseText);\n          if (!json || typeof json.location !== 'string') {\n            failure('Invalid JSON: ' + xhr.responseText);\n            return;\n          }\n          success(pathJoin(settings.basePath, json.location));\n        };\n        var formData = new FormData();\n        formData.append('file', blobInfo.blob(), blobInfo.filename());\n        xhr.send(formData);\n      };\n      var noUpload = function () {\n        return new promiseObj(function (resolve) {\n          resolve([]);\n        });\n      };\n      var handlerSuccess = function (blobInfo, url) {\n        return {\n          url: url,\n          blobInfo: blobInfo,\n          status: true\n        };\n      };\n      var handlerFailure = function (blobInfo, message, options) {\n        return {\n          url: '',\n          blobInfo: blobInfo,\n          status: false,\n          error: {\n            message: message,\n            options: options\n          }\n        };\n      };\n      var resolvePending = function (blobUri, result) {\n        Tools.each(pendingPromises[blobUri], function (resolve) {\n          resolve(result);\n        });\n        delete pendingPromises[blobUri];\n      };\n      var uploadBlobInfo = function (blobInfo, handler, openNotification) {\n        uploadStatus.markPending(blobInfo.blobUri());\n        return new promiseObj(function (resolve) {\n          var notification, progress;\n          try {\n            var closeNotification_1 = function () {\n              if (notification) {\n                notification.close();\n                progress = noop;\n              }\n            };\n            var success = function (url) {\n              closeNotification_1();\n              uploadStatus.markUploaded(blobInfo.blobUri(), url);\n              resolvePending(blobInfo.blobUri(), handlerSuccess(blobInfo, url));\n              resolve(handlerSuccess(blobInfo, url));\n            };\n            var failure = function (error, options) {\n              var failureOptions = options ? options : {};\n              closeNotification_1();\n              uploadStatus.removeFailed(blobInfo.blobUri());\n              resolvePending(blobInfo.blobUri(), handlerFailure(blobInfo, error, failureOptions));\n              resolve(handlerFailure(blobInfo, error, failureOptions));\n            };\n            progress = function (percent) {\n              if (percent < 0 || percent > 100) {\n                return;\n              }\n              Optional.from(notification).orThunk(function () {\n                return Optional.from(openNotification).map(apply);\n              }).each(function (n) {\n                notification = n;\n                n.progressBar.value(percent);\n              });\n            };\n            handler(blobInfo, success, failure, progress);\n          } catch (ex) {\n            resolve(handlerFailure(blobInfo, ex.message, {}));\n          }\n        });\n      };\n      var isDefaultHandler = function (handler) {\n        return handler === defaultHandler;\n      };\n      var pendingUploadBlobInfo = function (blobInfo) {\n        var blobUri = blobInfo.blobUri();\n        return new promiseObj(function (resolve) {\n          pendingPromises[blobUri] = pendingPromises[blobUri] || [];\n          pendingPromises[blobUri].push(resolve);\n        });\n      };\n      var uploadBlobs = function (blobInfos, openNotification) {\n        blobInfos = Tools.grep(blobInfos, function (blobInfo) {\n          return !uploadStatus.isUploaded(blobInfo.blobUri());\n        });\n        return promiseObj.all(Tools.map(blobInfos, function (blobInfo) {\n          return uploadStatus.isPending(blobInfo.blobUri()) ? pendingUploadBlobInfo(blobInfo) : uploadBlobInfo(blobInfo, settings.handler, openNotification);\n        }));\n      };\n      var upload = function (blobInfos, openNotification) {\n        return !settings.url && isDefaultHandler(settings.handler) ? noUpload() : uploadBlobs(blobInfos, openNotification);\n      };\n      if (isFunction(settings.handler) === false) {\n        settings.handler = defaultHandler;\n      }\n      return { upload: upload };\n    };\n\n    var openNotification = function (editor) {\n      return function () {\n        return editor.notificationManager.open({\n          text: editor.translate('Image uploading...'),\n          type: 'info',\n          timeout: -1,\n          progressBar: true\n        });\n      };\n    };\n    var createUploader = function (editor, uploadStatus) {\n      return Uploader(uploadStatus, {\n        url: getImageUploadUrl(editor),\n        basePath: getImageUploadBasePath(editor),\n        credentials: getImagesUploadCredentials(editor),\n        handler: getImagesUploadHandler(editor)\n      });\n    };\n    var ImageUploader = function (editor) {\n      var uploadStatus = UploadStatus();\n      var uploader = createUploader(editor, uploadStatus);\n      return {\n        upload: function (blobInfos, showNotification) {\n          if (showNotification === void 0) {\n            showNotification = true;\n          }\n          return uploader.upload(blobInfos, showNotification ? openNotification(editor) : undefined);\n        }\n      };\n    };\n\n    var UploadChangeHandler = function (editor) {\n      var lastChangedLevel = Cell(null);\n      editor.on('change AddUndo', function (e) {\n        lastChangedLevel.set(__assign({}, e.level));\n      });\n      var fireIfChanged = function () {\n        var data = editor.undoManager.data;\n        last$2(data).filter(function (level) {\n          return !isEq$1(lastChangedLevel.get(), level);\n        }).each(function (level) {\n          editor.setDirty(true);\n          editor.fire('change', {\n            level: level,\n            lastLevel: get$a(data, data.length - 2).getOrNull()\n          });\n        });\n      };\n      return { fireIfChanged: fireIfChanged };\n    };\n    var EditorUpload = function (editor) {\n      var blobCache = BlobCache();\n      var uploader, imageScanner;\n      var uploadStatus = UploadStatus();\n      var urlFilters = [];\n      var changeHandler = UploadChangeHandler(editor);\n      var aliveGuard = function (callback) {\n        return function (result) {\n          if (editor.selection) {\n            return callback(result);\n          }\n          return [];\n        };\n      };\n      var cacheInvalidator = function (url) {\n        return url + (url.indexOf('?') === -1 ? '?' : '&') + new Date().getTime();\n      };\n      var replaceString = function (content, search, replace) {\n        var index = 0;\n        do {\n          index = content.indexOf(search, index);\n          if (index !== -1) {\n            content = content.substring(0, index) + replace + content.substr(index + search.length);\n            index += replace.length - search.length + 1;\n          }\n        } while (index !== -1);\n        return content;\n      };\n      var replaceImageUrl = function (content, targetUrl, replacementUrl) {\n        var replacementString = 'src=\"' + replacementUrl + '\"' + (replacementUrl === Env.transparentSrc ? ' data-mce-placeholder=\"1\"' : '');\n        content = replaceString(content, 'src=\"' + targetUrl + '\"', replacementString);\n        content = replaceString(content, 'data-mce-src=\"' + targetUrl + '\"', 'data-mce-src=\"' + replacementUrl + '\"');\n        return content;\n      };\n      var replaceUrlInUndoStack = function (targetUrl, replacementUrl) {\n        each$k(editor.undoManager.data, function (level) {\n          if (level.type === 'fragmented') {\n            level.fragments = map$3(level.fragments, function (fragment) {\n              return replaceImageUrl(fragment, targetUrl, replacementUrl);\n            });\n          } else {\n            level.content = replaceImageUrl(level.content, targetUrl, replacementUrl);\n          }\n        });\n      };\n      var replaceImageUriInView = function (image, resultUri) {\n        var src = editor.convertURL(resultUri, 'src');\n        replaceUrlInUndoStack(image.src, resultUri);\n        editor.$(image).attr({\n          'src': shouldReuseFileName(editor) ? cacheInvalidator(resultUri) : resultUri,\n          'data-mce-src': src\n        });\n      };\n      var uploadImages = function (callback) {\n        if (!uploader) {\n          uploader = createUploader(editor, uploadStatus);\n        }\n        return scanForImages().then(aliveGuard(function (imageInfos) {\n          var blobInfos = map$3(imageInfos, function (imageInfo) {\n            return imageInfo.blobInfo;\n          });\n          return uploader.upload(blobInfos, openNotification(editor)).then(aliveGuard(function (result) {\n            var imagesToRemove = [];\n            var filteredResult = map$3(result, function (uploadInfo, index) {\n              var blobInfo = imageInfos[index].blobInfo;\n              var image = imageInfos[index].image;\n              if (uploadInfo.status && shouldReplaceBlobUris(editor)) {\n                blobCache.removeByUri(image.src);\n                if (isRtc(editor)) ; else {\n                  replaceImageUriInView(image, uploadInfo.url);\n                }\n              } else if (uploadInfo.error) {\n                if (uploadInfo.error.options.remove) {\n                  replaceUrlInUndoStack(image.getAttribute('src'), Env.transparentSrc);\n                  imagesToRemove.push(image);\n                }\n                uploadError(editor, uploadInfo.error.message);\n              }\n              return {\n                element: image,\n                status: uploadInfo.status,\n                uploadUri: uploadInfo.url,\n                blobInfo: blobInfo\n              };\n            });\n            if (filteredResult.length > 0) {\n              changeHandler.fireIfChanged();\n            }\n            if (imagesToRemove.length > 0) {\n              if (isRtc(editor)) {\n                console.error('Removing images on failed uploads is currently unsupported for RTC');\n              } else {\n                editor.undoManager.transact(function () {\n                  each$k(imagesToRemove, function (element) {\n                    editor.dom.remove(element);\n                    blobCache.removeByUri(element.src);\n                  });\n                });\n              }\n            }\n            if (callback) {\n              callback(filteredResult);\n            }\n            return filteredResult;\n          }));\n        }));\n      };\n      var uploadImagesAuto = function (callback) {\n        if (isAutomaticUploadsEnabled(editor)) {\n          return uploadImages(callback);\n        }\n      };\n      var isValidDataUriImage = function (imgElm) {\n        if (forall(urlFilters, function (filter) {\n            return filter(imgElm);\n          }) === false) {\n          return false;\n        }\n        if (imgElm.getAttribute('src').indexOf('data:') === 0) {\n          var dataImgFilter = getImagesDataImgFilter(editor);\n          return dataImgFilter(imgElm);\n        }\n        return true;\n      };\n      var addFilter = function (filter) {\n        urlFilters.push(filter);\n      };\n      var scanForImages = function () {\n        if (!imageScanner) {\n          imageScanner = ImageScanner(uploadStatus, blobCache);\n        }\n        return imageScanner.findAll(editor.getBody(), isValidDataUriImage).then(aliveGuard(function (result) {\n          result = filter$4(result, function (resultItem) {\n            if (typeof resultItem === 'string') {\n              displayError(editor, resultItem);\n              return false;\n            }\n            return true;\n          });\n          if (isRtc(editor)) ; else {\n            each$k(result, function (resultItem) {\n              replaceUrlInUndoStack(resultItem.image.src, resultItem.blobInfo.blobUri());\n              resultItem.image.src = resultItem.blobInfo.blobUri();\n              resultItem.image.removeAttribute('data-mce-src');\n            });\n          }\n          return result;\n        }));\n      };\n      var destroy = function () {\n        blobCache.destroy();\n        uploadStatus.destroy();\n        imageScanner = uploader = null;\n      };\n      var replaceBlobUris = function (content) {\n        return content.replace(/src=\"(blob:[^\"]+)\"/g, function (match, blobUri) {\n          var resultUri = uploadStatus.getResultUri(blobUri);\n          if (resultUri) {\n            return 'src=\"' + resultUri + '\"';\n          }\n          var blobInfo = blobCache.getByUri(blobUri);\n          if (!blobInfo) {\n            blobInfo = foldl(editor.editorManager.get(), function (result, editor) {\n              return result || editor.editorUpload && editor.editorUpload.blobCache.getByUri(blobUri);\n            }, null);\n          }\n          if (blobInfo) {\n            var blob = blobInfo.blob();\n            return 'src=\"data:' + blob.type + ';base64,' + blobInfo.base64() + '\"';\n          }\n          return match;\n        });\n      };\n      editor.on('SetContent', function () {\n        if (isAutomaticUploadsEnabled(editor)) {\n          uploadImagesAuto();\n        } else {\n          scanForImages();\n        }\n      });\n      editor.on('RawSaveContent', function (e) {\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('GetContent', function (e) {\n        if (e.source_view || e.format === 'raw' || e.format === 'tree') {\n          return;\n        }\n        e.content = replaceBlobUris(e.content);\n      });\n      editor.on('PostRender', function () {\n        editor.parser.addNodeFilter('img', function (images) {\n          each$k(images, function (img) {\n            var src = img.attr('src');\n            if (blobCache.getByUri(src)) {\n              return;\n            }\n            var resultUri = uploadStatus.getResultUri(src);\n            if (resultUri) {\n              img.attr('src', resultUri);\n            }\n          });\n        });\n      });\n      return {\n        blobCache: blobCache,\n        addFilter: addFilter,\n        uploadImages: uploadImages,\n        uploadImagesAuto: uploadImagesAuto,\n        scanForImages: scanForImages,\n        destroy: destroy\n      };\n    };\n\n    var get = function (dom) {\n      var formats = {\n        valigntop: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'top' }\n          }],\n        valignmiddle: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'middle' }\n          }],\n        valignbottom: [{\n            selector: 'td,th',\n            styles: { verticalAlign: 'bottom' }\n          }],\n        alignleft: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-left',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'left' },\n            inherit: false,\n            preview: false,\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table,audio,video',\n            collapsed: false,\n            styles: { float: 'left' },\n            preview: 'font-family font-size'\n          }\n        ],\n        aligncenter: [\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'center' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-center',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'img,audio,video',\n            collapsed: false,\n            styles: {\n              display: 'block',\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: false\n          },\n          {\n            selector: 'table',\n            collapsed: false,\n            styles: {\n              marginLeft: 'auto',\n              marginRight: 'auto'\n            },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignright: [\n          {\n            selector: 'figure.image',\n            collapsed: false,\n            classes: 'align-right',\n            ceFalseOverride: true,\n            preview: 'font-family font-size'\n          },\n          {\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'right' },\n            inherit: false,\n            preview: 'font-family font-size',\n            defaultBlock: 'div'\n          },\n          {\n            selector: 'img,table,audio,video',\n            collapsed: false,\n            styles: { float: 'right' },\n            preview: 'font-family font-size'\n          }\n        ],\n        alignjustify: [{\n            selector: 'figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li',\n            styles: { textAlign: 'justify' },\n            inherit: false,\n            defaultBlock: 'div',\n            preview: 'font-family font-size'\n          }],\n        bold: [\n          {\n            inline: 'strong',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontWeight: 'bold' }\n          },\n          {\n            inline: 'b',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        italic: [\n          {\n            inline: 'em',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 'span',\n            styles: { fontStyle: 'italic' }\n          },\n          {\n            inline: 'i',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        underline: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'underline' },\n            exact: true\n          },\n          {\n            inline: 'u',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        strikethrough: [\n          {\n            inline: 'span',\n            styles: { textDecoration: 'line-through' },\n            exact: true\n          },\n          {\n            inline: 'strike',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          },\n          {\n            inline: 's',\n            remove: 'all',\n            preserve_attributes: [\n              'class',\n              'style'\n            ]\n          }\n        ],\n        forecolor: {\n          inline: 'span',\n          styles: { color: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        hilitecolor: {\n          inline: 'span',\n          styles: { backgroundColor: '%value' },\n          links: true,\n          remove_similar: true,\n          clear_child_styles: true\n        },\n        fontname: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontFamily: '%value' },\n          clear_child_styles: true\n        },\n        fontsize: {\n          inline: 'span',\n          toggle: false,\n          styles: { fontSize: '%value' },\n          clear_child_styles: true\n        },\n        lineheight: {\n          selector: 'h1,h2,h3,h4,h5,h6,p,li,td,th,div',\n          defaultBlock: 'p',\n          styles: { lineHeight: '%value' }\n        },\n        fontsize_class: {\n          inline: 'span',\n          attributes: { class: '%value' }\n        },\n        blockquote: {\n          block: 'blockquote',\n          wrapper: true,\n          remove: 'all'\n        },\n        subscript: { inline: 'sub' },\n        superscript: { inline: 'sup' },\n        code: { inline: 'code' },\n        link: {\n          inline: 'a',\n          selector: 'a',\n          remove: 'all',\n          split: true,\n          deep: true,\n          onmatch: function (node, _fmt, _itemName) {\n            return isElement$5(node) && node.hasAttribute('href');\n          },\n          onformat: function (elm, _fmt, vars) {\n            Tools.each(vars, function (value, key) {\n              dom.setAttrib(elm, key, value);\n            });\n          }\n        },\n        lang: {\n          inline: 'span',\n          clear_child_styles: true,\n          remove_similar: true,\n          attributes: {\n            'lang': '%value',\n            'data-mce-lang': function (vars) {\n              var _a;\n              return (_a = vars === null || vars === void 0 ? void 0 : vars.customValue) !== null && _a !== void 0 ? _a : null;\n            }\n          }\n        },\n        removeformat: [\n          {\n            selector: 'b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small',\n            remove: 'all',\n            split: true,\n            expand: false,\n            block_expand: true,\n            deep: true\n          },\n          {\n            selector: 'span',\n            attributes: [\n              'style',\n              'class'\n            ],\n            remove: 'empty',\n            split: true,\n            expand: false,\n            deep: true\n          },\n          {\n            selector: '*',\n            attributes: [\n              'style',\n              'class'\n            ],\n            split: false,\n            expand: false,\n            deep: true\n          }\n        ]\n      };\n      Tools.each('p h1 h2 h3 h4 h5 h6 div address pre dt dd samp'.split(/\\s/), function (name) {\n        formats[name] = {\n          block: name,\n          remove: 'all'\n        };\n      });\n      return formats;\n    };\n\n    var FormatRegistry = function (editor) {\n      var formats = {};\n      var get$1 = function (name) {\n        return isNonNullable(name) ? formats[name] : formats;\n      };\n      var has = function (name) {\n        return has$2(formats, name);\n      };\n      var register = function (name, format) {\n        if (name) {\n          if (!isString$1(name)) {\n            each$j(name, function (format, name) {\n              register(name, format);\n            });\n          } else {\n            if (!isArray$1(format)) {\n              format = [format];\n            }\n            each$k(format, function (format) {\n              if (isUndefined(format.deep)) {\n                format.deep = !isSelectorFormat(format);\n              }\n              if (isUndefined(format.split)) {\n                format.split = !isSelectorFormat(format) || isInlineFormat(format);\n              }\n              if (isUndefined(format.remove) && isSelectorFormat(format) && !isInlineFormat(format)) {\n                format.remove = 'none';\n              }\n              if (isSelectorFormat(format) && isInlineFormat(format)) {\n                format.mixed = true;\n                format.block_expand = true;\n              }\n              if (isString$1(format.classes)) {\n                format.classes = format.classes.split(/\\s+/);\n              }\n            });\n            formats[name] = format;\n          }\n        }\n      };\n      var unregister = function (name) {\n        if (name && formats[name]) {\n          delete formats[name];\n        }\n        return formats;\n      };\n      register(get(editor.dom));\n      register(getFormats(editor));\n      return {\n        get: get$1,\n        has: has,\n        register: register,\n        unregister: unregister\n      };\n    };\n\n    var each$5 = Tools.each;\n    var dom = DOMUtils.DOM;\n    var parsedSelectorToHtml = function (ancestry, editor) {\n      var elm, item, fragment;\n      var schema = editor && editor.schema || Schema({});\n      var decorate = function (elm, item) {\n        if (item.classes.length) {\n          dom.addClass(elm, item.classes.join(' '));\n        }\n        dom.setAttribs(elm, item.attrs);\n      };\n      var createElement = function (sItem) {\n        item = typeof sItem === 'string' ? {\n          name: sItem,\n          classes: [],\n          attrs: {}\n        } : sItem;\n        var elm = dom.create(item.name);\n        decorate(elm, item);\n        return elm;\n      };\n      var getRequiredParent = function (elm, candidate) {\n        var name = typeof elm !== 'string' ? elm.nodeName.toLowerCase() : elm;\n        var elmRule = schema.getElementRule(name);\n        var parentsRequired = elmRule && elmRule.parentsRequired;\n        if (parentsRequired && parentsRequired.length) {\n          return candidate && Tools.inArray(parentsRequired, candidate) !== -1 ? candidate : parentsRequired[0];\n        } else {\n          return false;\n        }\n      };\n      var wrapInHtml = function (elm, ancestry, siblings) {\n        var parent, parentCandidate;\n        var ancestor = ancestry.length > 0 && ancestry[0];\n        var ancestorName = ancestor && ancestor.name;\n        var parentRequired = getRequiredParent(elm, ancestorName);\n        if (parentRequired) {\n          if (ancestorName === parentRequired) {\n            parentCandidate = ancestry[0];\n            ancestry = ancestry.slice(1);\n          } else {\n            parentCandidate = parentRequired;\n          }\n        } else if (ancestor) {\n          parentCandidate = ancestry[0];\n          ancestry = ancestry.slice(1);\n        } else if (!siblings) {\n          return elm;\n        }\n        if (parentCandidate) {\n          parent = createElement(parentCandidate);\n          parent.appendChild(elm);\n        }\n        if (siblings) {\n          if (!parent) {\n            parent = dom.create('div');\n            parent.appendChild(elm);\n          }\n          Tools.each(siblings, function (sibling) {\n            var siblingElm = createElement(sibling);\n            parent.insertBefore(siblingElm, elm);\n          });\n        }\n        return wrapInHtml(parent, ancestry, parentCandidate && parentCandidate.siblings);\n      };\n      if (ancestry && ancestry.length) {\n        item = ancestry[0];\n        elm = createElement(item);\n        fragment = dom.create('div');\n        fragment.appendChild(wrapInHtml(elm, ancestry.slice(1), item.siblings));\n        return fragment;\n      } else {\n        return '';\n      }\n    };\n    var parseSelectorItem = function (item) {\n      var tagName;\n      var obj = {\n        classes: [],\n        attrs: {}\n      };\n      item = obj.selector = Tools.trim(item);\n      if (item !== '*') {\n        tagName = item.replace(/(?:([#\\.]|::?)([\\w\\-]+)|(\\[)([^\\]]+)\\]?)/g, function ($0, $1, $2, $3, $4) {\n          switch ($1) {\n          case '#':\n            obj.attrs.id = $2;\n            break;\n          case '.':\n            obj.classes.push($2);\n            break;\n          case ':':\n            if (Tools.inArray('checked disabled enabled read-only required'.split(' '), $2) !== -1) {\n              obj.attrs[$2] = $2;\n            }\n            break;\n          }\n          if ($3 === '[') {\n            var m = $4.match(/([\\w\\-]+)(?:\\=\\\"([^\\\"]+))?/);\n            if (m) {\n              obj.attrs[m[1]] = m[2];\n            }\n          }\n          return '';\n        });\n      }\n      obj.name = tagName || 'div';\n      return obj;\n    };\n    var parseSelector = function (selector) {\n      if (!selector || typeof selector !== 'string') {\n        return [];\n      }\n      selector = selector.split(/\\s*,\\s*/)[0];\n      selector = selector.replace(/\\s*(~\\+|~|\\+|>)\\s*/g, '$1');\n      return Tools.map(selector.split(/(?:>|\\s+(?![^\\[\\]]+\\]))/), function (item) {\n        var siblings = Tools.map(item.split(/(?:~\\+|~|\\+)/), parseSelectorItem);\n        var obj = siblings.pop();\n        if (siblings.length) {\n          obj.siblings = siblings;\n        }\n        return obj;\n      }).reverse();\n    };\n    var getCssText = function (editor, format) {\n      var name, previewFrag;\n      var previewCss = '', parentFontSize;\n      var previewStyles = getPreviewStyles(editor);\n      if (previewStyles === '') {\n        return '';\n      }\n      var removeVars = function (val) {\n        return val.replace(/%(\\w+)/g, '');\n      };\n      if (typeof format === 'string') {\n        format = editor.formatter.get(format);\n        if (!format) {\n          return;\n        }\n        format = format[0];\n      }\n      if ('preview' in format) {\n        var previewOpt = get$9(format, 'preview');\n        if (is$1(previewOpt, false)) {\n          return '';\n        } else {\n          previewStyles = previewOpt.getOr(previewStyles);\n        }\n      }\n      name = format.block || format.inline || 'span';\n      var items = parseSelector(format.selector);\n      if (items.length) {\n        if (!items[0].name) {\n          items[0].name = name;\n        }\n        name = format.selector;\n        previewFrag = parsedSelectorToHtml(items, editor);\n      } else {\n        previewFrag = parsedSelectorToHtml([name], editor);\n      }\n      var previewElm = dom.select(name, previewFrag)[0] || previewFrag.firstChild;\n      each$5(format.styles, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setStyle(previewElm, name, newValue);\n        }\n      });\n      each$5(format.attributes, function (value, name) {\n        var newValue = removeVars(value);\n        if (newValue) {\n          dom.setAttrib(previewElm, name, newValue);\n        }\n      });\n      each$5(format.classes, function (value) {\n        var newValue = removeVars(value);\n        if (!dom.hasClass(previewElm, newValue)) {\n          dom.addClass(previewElm, newValue);\n        }\n      });\n      editor.fire('PreviewFormats');\n      dom.setStyles(previewFrag, {\n        position: 'absolute',\n        left: -65535\n      });\n      editor.getBody().appendChild(previewFrag);\n      parentFontSize = dom.getStyle(editor.getBody(), 'fontSize', true);\n      parentFontSize = /px$/.test(parentFontSize) ? parseInt(parentFontSize, 10) : 0;\n      each$5(previewStyles.split(' '), function (name) {\n        var value = dom.getStyle(previewElm, name, true);\n        if (name === 'background-color' && /transparent|rgba\\s*\\([^)]+,\\s*0\\)/.test(value)) {\n          value = dom.getStyle(editor.getBody(), name, true);\n          if (dom.toHex(value).toLowerCase() === '#ffffff') {\n            return;\n          }\n        }\n        if (name === 'color') {\n          if (dom.toHex(value).toLowerCase() === '#000000') {\n            return;\n          }\n        }\n        if (name === 'font-size') {\n          if (/em|%$/.test(value)) {\n            if (parentFontSize === 0) {\n              return;\n            }\n            var numValue = parseFloat(value) / (/%$/.test(value) ? 100 : 1);\n            value = numValue * parentFontSize + 'px';\n          }\n        }\n        if (name === 'border' && value) {\n          previewCss += 'padding:0 2px;';\n        }\n        previewCss += name + ':' + value + ';';\n      });\n      editor.fire('AfterPreviewFormats');\n      dom.remove(previewFrag);\n      return previewCss;\n    };\n\n    var setup$h = function (editor) {\n      editor.addShortcut('meta+b', '', 'Bold');\n      editor.addShortcut('meta+i', '', 'Italic');\n      editor.addShortcut('meta+u', '', 'Underline');\n      for (var i = 1; i <= 6; i++) {\n        editor.addShortcut('access+' + i, '', [\n          'FormatBlock',\n          false,\n          'h' + i\n        ]);\n      }\n      editor.addShortcut('access+7', '', [\n        'FormatBlock',\n        false,\n        'p'\n      ]);\n      editor.addShortcut('access+8', '', [\n        'FormatBlock',\n        false,\n        'div'\n      ]);\n      editor.addShortcut('access+9', '', [\n        'FormatBlock',\n        false,\n        'address'\n      ]);\n    };\n\n    var Formatter = function (editor) {\n      var formats = FormatRegistry(editor);\n      var formatChangeState = Cell(null);\n      setup$h(editor);\n      setup$k(editor);\n      return {\n        get: formats.get,\n        has: formats.has,\n        register: formats.register,\n        unregister: formats.unregister,\n        apply: function (name, vars, node) {\n          applyFormat(editor, name, vars, node);\n        },\n        remove: function (name, vars, node, similar) {\n          removeFormat(editor, name, vars, node, similar);\n        },\n        toggle: function (name, vars, node) {\n          toggleFormat(editor, name, vars, node);\n        },\n        match: function (name, vars, node, similar) {\n          return matchFormat(editor, name, vars, node, similar);\n        },\n        closest: function (names) {\n          return closestFormat(editor, names);\n        },\n        matchAll: function (names, vars) {\n          return matchAllFormats(editor, names, vars);\n        },\n        matchNode: function (node, name, vars, similar) {\n          return matchNodeFormat(editor, node, name, vars, similar);\n        },\n        canApply: function (name) {\n          return canApplyFormat(editor, name);\n        },\n        formatChanged: function (formats, callback, similar, vars) {\n          return formatChanged(editor, formatChangeState, formats, callback, similar, vars);\n        },\n        getCssText: curry(getCssText, editor)\n      };\n    };\n\n    var shouldIgnoreCommand = function (cmd) {\n      switch (cmd.toLowerCase()) {\n      case 'undo':\n      case 'redo':\n      case 'mcerepaint':\n      case 'mcefocus':\n        return true;\n      default:\n        return false;\n      }\n    };\n    var registerEvents = function (editor, undoManager, locks) {\n      var isFirstTypedCharacter = Cell(false);\n      var addNonTypingUndoLevel = function (e) {\n        setTyping(undoManager, false, locks);\n        undoManager.add({}, e);\n      };\n      editor.on('init', function () {\n        undoManager.add();\n      });\n      editor.on('BeforeExecCommand', function (e) {\n        var cmd = e.command;\n        if (!shouldIgnoreCommand(cmd)) {\n          endTyping(undoManager, locks);\n          undoManager.beforeChange();\n        }\n      });\n      editor.on('ExecCommand', function (e) {\n        var cmd = e.command;\n        if (!shouldIgnoreCommand(cmd)) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('ObjectResizeStart cut', function () {\n        undoManager.beforeChange();\n      });\n      editor.on('SaveContent ObjectResized blur', addNonTypingUndoLevel);\n      editor.on('dragend', addNonTypingUndoLevel);\n      editor.on('keyup', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45 || e.ctrlKey) {\n          addNonTypingUndoLevel();\n          editor.nodeChanged();\n        }\n        if (keyCode === 46 || keyCode === 8) {\n          editor.nodeChanged();\n        }\n        if (isFirstTypedCharacter.get() && undoManager.typing && isEq$1(createFromEditor(editor), undoManager.data[0]) === false) {\n          if (editor.isDirty() === false) {\n            editor.setDirty(true);\n            editor.fire('change', {\n              level: undoManager.data[0],\n              lastLevel: null\n            });\n          }\n          editor.fire('TypingUndo');\n          isFirstTypedCharacter.set(false);\n          editor.nodeChanged();\n        }\n      });\n      editor.on('keydown', function (e) {\n        var keyCode = e.keyCode;\n        if (e.isDefaultPrevented()) {\n          return;\n        }\n        if (keyCode >= 33 && keyCode <= 36 || keyCode >= 37 && keyCode <= 40 || keyCode === 45) {\n          if (undoManager.typing) {\n            addNonTypingUndoLevel(e);\n          }\n          return;\n        }\n        var modKey = e.ctrlKey && !e.altKey || e.metaKey;\n        if ((keyCode < 16 || keyCode > 20) && keyCode !== 224 && keyCode !== 91 && !undoManager.typing && !modKey) {\n          undoManager.beforeChange();\n          setTyping(undoManager, true, locks);\n          undoManager.add({}, e);\n          isFirstTypedCharacter.set(true);\n        }\n      });\n      editor.on('mousedown', function (e) {\n        if (undoManager.typing) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      var isInsertReplacementText = function (event) {\n        return event.inputType === 'insertReplacementText';\n      };\n      var isInsertTextDataNull = function (event) {\n        return event.inputType === 'insertText' && event.data === null;\n      };\n      var isInsertFromPasteOrDrop = function (event) {\n        return event.inputType === 'insertFromPaste' || event.inputType === 'insertFromDrop';\n      };\n      editor.on('input', function (e) {\n        if (e.inputType && (isInsertReplacementText(e) || isInsertTextDataNull(e) || isInsertFromPasteOrDrop(e))) {\n          addNonTypingUndoLevel(e);\n        }\n      });\n      editor.on('AddUndo Undo Redo ClearUndos', function (e) {\n        if (!e.isDefaultPrevented()) {\n          editor.nodeChanged();\n        }\n      });\n    };\n    var addKeyboardShortcuts = function (editor) {\n      editor.addShortcut('meta+z', '', 'Undo');\n      editor.addShortcut('meta+y,meta+shift+z', '', 'Redo');\n    };\n\n    var UndoManager = function (editor) {\n      var beforeBookmark = value();\n      var locks = Cell(0);\n      var index = Cell(0);\n      var undoManager = {\n        data: [],\n        typing: false,\n        beforeChange: function () {\n          beforeChange(editor, locks, beforeBookmark);\n        },\n        add: function (level, event) {\n          return addUndoLevel(editor, undoManager, index, locks, beforeBookmark, level, event);\n        },\n        undo: function () {\n          return undo(editor, undoManager, locks, index);\n        },\n        redo: function () {\n          return redo(editor, index, undoManager.data);\n        },\n        clear: function () {\n          clear(editor, undoManager, index);\n        },\n        reset: function () {\n          reset(editor, undoManager);\n        },\n        hasUndo: function () {\n          return hasUndo(editor, undoManager, index);\n        },\n        hasRedo: function () {\n          return hasRedo(editor, undoManager, index);\n        },\n        transact: function (callback) {\n          return transact(editor, undoManager, locks, callback);\n        },\n        ignore: function (callback) {\n          ignore(editor, locks, callback);\n        },\n        extra: function (callback1, callback2) {\n          extra(editor, undoManager, index, callback1, callback2);\n        }\n      };\n      if (!isRtc(editor)) {\n        registerEvents(editor, undoManager, locks);\n      }\n      addKeyboardShortcuts(editor);\n      return undoManager;\n    };\n\n    var nonTypingKeycodes = [\n      9,\n      27,\n      VK.HOME,\n      VK.END,\n      19,\n      20,\n      44,\n      144,\n      145,\n      33,\n      34,\n      45,\n      16,\n      17,\n      18,\n      91,\n      92,\n      93,\n      VK.DOWN,\n      VK.UP,\n      VK.LEFT,\n      VK.RIGHT\n    ].concat(Env.browser.isFirefox() ? [224] : []);\n    var placeholderAttr = 'data-mce-placeholder';\n    var isKeyboardEvent = function (e) {\n      return e.type === 'keydown' || e.type === 'keyup';\n    };\n    var isDeleteEvent = function (e) {\n      var keyCode = e.keyCode;\n      return keyCode === VK.BACKSPACE || keyCode === VK.DELETE;\n    };\n    var isNonTypingKeyboardEvent = function (e) {\n      if (isKeyboardEvent(e)) {\n        var keyCode = e.keyCode;\n        return !isDeleteEvent(e) && (VK.metaKeyPressed(e) || e.altKey || keyCode >= 112 && keyCode <= 123 || contains$3(nonTypingKeycodes, keyCode));\n      } else {\n        return false;\n      }\n    };\n    var isTypingKeyboardEvent = function (e) {\n      return isKeyboardEvent(e) && !(isDeleteEvent(e) || e.type === 'keyup' && e.keyCode === 229);\n    };\n    var isVisuallyEmpty = function (dom, rootElm, forcedRootBlock) {\n      if (isEmpty$2(SugarElement.fromDom(rootElm), false)) {\n        var isForcedRootBlockFalse = forcedRootBlock === '';\n        var firstElement = rootElm.firstElementChild;\n        if (!firstElement) {\n          return true;\n        } else if (dom.getStyle(rootElm.firstElementChild, 'padding-left') || dom.getStyle(rootElm.firstElementChild, 'padding-right')) {\n          return false;\n        } else {\n          return isForcedRootBlockFalse ? !dom.isBlock(firstElement) : forcedRootBlock === firstElement.nodeName.toLowerCase();\n        }\n      } else {\n        return false;\n      }\n    };\n    var setup$g = function (editor) {\n      var dom = editor.dom;\n      var rootBlock = getForcedRootBlock(editor);\n      var placeholder = getPlaceholder(editor);\n      var updatePlaceholder = function (e, initial) {\n        if (isNonTypingKeyboardEvent(e)) {\n          return;\n        }\n        var body = editor.getBody();\n        var showPlaceholder = isTypingKeyboardEvent(e) ? false : isVisuallyEmpty(dom, body, rootBlock);\n        var isPlaceholderShown = dom.getAttrib(body, placeholderAttr) !== '';\n        if (isPlaceholderShown !== showPlaceholder || initial) {\n          dom.setAttrib(body, placeholderAttr, showPlaceholder ? placeholder : null);\n          dom.setAttrib(body, 'aria-placeholder', showPlaceholder ? placeholder : null);\n          firePlaceholderToggle(editor, showPlaceholder);\n          editor.on(showPlaceholder ? 'keydown' : 'keyup', updatePlaceholder);\n          editor.off(showPlaceholder ? 'keyup' : 'keydown', updatePlaceholder);\n        }\n      };\n      if (placeholder) {\n        editor.on('init', function (e) {\n          updatePlaceholder(e, true);\n          editor.on('change SetContent ExecCommand', updatePlaceholder);\n          editor.on('paste', function (e) {\n            return Delay.setEditorTimeout(editor, function () {\n              return updatePlaceholder(e);\n            });\n          });\n        });\n      }\n    };\n\n    var strongRtl = /[\\u0591-\\u07FF\\uFB1D-\\uFDFF\\uFE70-\\uFEFC]/;\n    var hasStrongRtl = function (text) {\n      return strongRtl.test(text);\n    };\n\n    var isInlineTarget = function (editor, elm) {\n      return is$2(SugarElement.fromDom(elm), getInlineBoundarySelector(editor));\n    };\n    var isRtl = function (element) {\n      return DOMUtils.DOM.getStyle(element, 'direction', true) === 'rtl' || hasStrongRtl(element.textContent);\n    };\n    var findInlineParents = function (isInlineTarget, rootNode, pos) {\n      return filter$4(DOMUtils.DOM.getParents(pos.container(), '*', rootNode), isInlineTarget);\n    };\n    var findRootInline = function (isInlineTarget, rootNode, pos) {\n      var parents = findInlineParents(isInlineTarget, rootNode, pos);\n      return Optional.from(parents[parents.length - 1]);\n    };\n    var hasSameParentBlock = function (rootNode, node1, node2) {\n      var block1 = getParentBlock$2(node1, rootNode);\n      var block2 = getParentBlock$2(node2, rootNode);\n      return block1 && block1 === block2;\n    };\n    var isAtZwsp = function (pos) {\n      return isBeforeInline(pos) || isAfterInline(pos);\n    };\n    var normalizePosition = function (forward, pos) {\n      if (!pos) {\n        return pos;\n      }\n      var container = pos.container(), offset = pos.offset();\n      if (forward) {\n        if (isCaretContainerInline(container)) {\n          if (isText$7(container.nextSibling)) {\n            return CaretPosition(container.nextSibling, 0);\n          } else {\n            return CaretPosition.after(container);\n          }\n        } else {\n          return isBeforeInline(pos) ? CaretPosition(container, offset + 1) : pos;\n        }\n      } else {\n        if (isCaretContainerInline(container)) {\n          if (isText$7(container.previousSibling)) {\n            return CaretPosition(container.previousSibling, container.previousSibling.data.length);\n          } else {\n            return CaretPosition.before(container);\n          }\n        } else {\n          return isAfterInline(pos) ? CaretPosition(container, offset - 1) : pos;\n        }\n      }\n    };\n    var normalizeForwards = curry(normalizePosition, true);\n    var normalizeBackwards = curry(normalizePosition, false);\n\n    var isBeforeRoot = function (rootNode) {\n      return function (elm) {\n        return eq(rootNode, SugarElement.fromDom(elm.dom.parentNode));\n      };\n    };\n    var isTextBlockOrListItem = function (element) {\n      return isTextBlock$2(element) || isListItem(element);\n    };\n    var getParentBlock$1 = function (rootNode, elm) {\n      if (contains$1(rootNode, elm)) {\n        return closest$3(elm, isTextBlockOrListItem, isBeforeRoot(rootNode));\n      } else {\n        return Optional.none();\n      }\n    };\n    var placeCaretInEmptyBody = function (editor) {\n      var body = editor.getBody();\n      var node = body.firstChild && editor.dom.isBlock(body.firstChild) ? body.firstChild : body;\n      editor.selection.setCursorLocation(node, 0);\n    };\n    var paddEmptyBody = function (editor) {\n      if (editor.dom.isEmpty(editor.getBody())) {\n        editor.setContent('');\n        placeCaretInEmptyBody(editor);\n      }\n    };\n    var willDeleteLastPositionInElement = function (forward, fromPos, elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        var normalizedFromPos = normalizePosition(false, fromPos);\n        if (forward) {\n          return nextPosition(elm, normalizedFromPos).exists(function (nextPos) {\n            return nextPos.isEqual(normalizedLastPos) && fromPos.isEqual(normalizedFirstPos);\n          });\n        } else {\n          return prevPosition(elm, normalizedFromPos).exists(function (prevPos) {\n            return prevPos.isEqual(normalizedFirstPos) && fromPos.isEqual(normalizedLastPos);\n          });\n        }\n      }).getOr(true);\n    };\n\n    var blockPosition = function (block, position) {\n      return {\n        block: block,\n        position: position\n      };\n    };\n    var blockBoundary = function (from, to) {\n      return {\n        from: from,\n        to: to\n      };\n    };\n    var getBlockPosition = function (rootNode, pos) {\n      var rootElm = SugarElement.fromDom(rootNode);\n      var containerElm = SugarElement.fromDom(pos.container());\n      return getParentBlock$1(rootElm, containerElm).map(function (block) {\n        return blockPosition(block, pos);\n      });\n    };\n    var isDifferentBlocks = function (blockBoundary) {\n      return eq(blockBoundary.from.block, blockBoundary.to.block) === false;\n    };\n    var hasSameParent = function (blockBoundary) {\n      return parent(blockBoundary.from.block).bind(function (parent1) {\n        return parent(blockBoundary.to.block).filter(function (parent2) {\n          return eq(parent1, parent2);\n        });\n      }).isSome();\n    };\n    var isEditable$1 = function (blockBoundary) {\n      return isContentEditableFalse$b(blockBoundary.from.block.dom) === false && isContentEditableFalse$b(blockBoundary.to.block.dom) === false;\n    };\n    var skipLastBr = function (rootNode, forward, blockPosition) {\n      if (isBr$5(blockPosition.position.getNode()) && isEmpty$2(blockPosition.block) === false) {\n        return positionIn(false, blockPosition.block.dom).bind(function (lastPositionInBlock) {\n          if (lastPositionInBlock.isEqual(blockPosition.position)) {\n            return fromPosition(forward, rootNode, lastPositionInBlock).bind(function (to) {\n              return getBlockPosition(rootNode, to);\n            });\n          } else {\n            return Optional.some(blockPosition);\n          }\n        }).getOr(blockPosition);\n      } else {\n        return blockPosition;\n      }\n    };\n    var readFromRange = function (rootNode, forward, rng) {\n      var fromBlockPos = getBlockPosition(rootNode, CaretPosition.fromRangeStart(rng));\n      var toBlockPos = fromBlockPos.bind(function (blockPos) {\n        return fromPosition(forward, rootNode, blockPos.position).bind(function (to) {\n          return getBlockPosition(rootNode, to).map(function (blockPos) {\n            return skipLastBr(rootNode, forward, blockPos);\n          });\n        });\n      });\n      return lift2(fromBlockPos, toBlockPos, blockBoundary).filter(function (blockBoundary) {\n        return isDifferentBlocks(blockBoundary) && hasSameParent(blockBoundary) && isEditable$1(blockBoundary);\n      });\n    };\n    var read$1 = function (rootNode, forward, rng) {\n      return rng.collapsed ? readFromRange(rootNode, forward, rng) : Optional.none();\n    };\n\n    var getChildrenUntilBlockBoundary = function (block) {\n      var children$1 = children(block);\n      return findIndex$2(children$1, isBlock$2).fold(constant(children$1), function (index) {\n        return children$1.slice(0, index);\n      });\n    };\n    var extractChildren = function (block) {\n      var children = getChildrenUntilBlockBoundary(block);\n      each$k(children, remove$7);\n      return children;\n    };\n    var removeEmptyRoot = function (rootNode, block) {\n      var parents = parentsAndSelf(block, rootNode);\n      return find$3(parents.reverse(), function (element) {\n        return isEmpty$2(element);\n      }).each(remove$7);\n    };\n    var isEmptyBefore = function (el) {\n      return filter$4(prevSiblings(el), function (el) {\n        return !isEmpty$2(el);\n      }).length === 0;\n    };\n    var nestedBlockMerge = function (rootNode, fromBlock, toBlock, insertionPoint) {\n      if (isEmpty$2(toBlock)) {\n        fillWithPaddingBr(toBlock);\n        return firstPositionIn(toBlock.dom);\n      }\n      if (isEmptyBefore(insertionPoint) && isEmpty$2(fromBlock)) {\n        before$4(insertionPoint, SugarElement.fromTag('br'));\n      }\n      var position = prevPosition(toBlock.dom, CaretPosition.before(insertionPoint.dom));\n      each$k(extractChildren(fromBlock), function (child) {\n        before$4(insertionPoint, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var sidelongBlockMerge = function (rootNode, fromBlock, toBlock) {\n      if (isEmpty$2(toBlock)) {\n        remove$7(toBlock);\n        if (isEmpty$2(fromBlock)) {\n          fillWithPaddingBr(fromBlock);\n        }\n        return firstPositionIn(fromBlock.dom);\n      }\n      var position = lastPositionIn(toBlock.dom);\n      each$k(extractChildren(fromBlock), function (child) {\n        append$1(toBlock, child);\n      });\n      removeEmptyRoot(rootNode, fromBlock);\n      return position;\n    };\n    var findInsertionPoint = function (toBlock, block) {\n      var parentsAndSelf$1 = parentsAndSelf(block, toBlock);\n      return Optional.from(parentsAndSelf$1[parentsAndSelf$1.length - 1]);\n    };\n    var getInsertionPoint = function (fromBlock, toBlock) {\n      return contains$1(toBlock, fromBlock) ? findInsertionPoint(toBlock, fromBlock) : Optional.none();\n    };\n    var trimBr = function (first, block) {\n      positionIn(first, block.dom).map(function (position) {\n        return position.getNode();\n      }).map(SugarElement.fromDom).filter(isBr$4).each(remove$7);\n    };\n    var mergeBlockInto = function (rootNode, fromBlock, toBlock) {\n      trimBr(true, fromBlock);\n      trimBr(false, toBlock);\n      return getInsertionPoint(fromBlock, toBlock).fold(curry(sidelongBlockMerge, rootNode, fromBlock, toBlock), curry(nestedBlockMerge, rootNode, fromBlock, toBlock));\n    };\n    var mergeBlocks = function (rootNode, forward, block1, block2) {\n      return forward ? mergeBlockInto(rootNode, block2, block1) : mergeBlockInto(rootNode, block1, block2);\n    };\n\n    var backspaceDelete$8 = function (editor, forward) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var position = read$1(rootNode.dom, forward, editor.selection.getRng()).bind(function (blockBoundary) {\n        return mergeBlocks(rootNode, forward, blockBoundary.from.block, blockBoundary.to.block);\n      });\n      position.each(function (pos) {\n        editor.selection.setRng(pos.toRange());\n      });\n      return position.isSome();\n    };\n\n    var deleteRangeMergeBlocks = function (rootNode, selection) {\n      var rng = selection.getRng();\n      return lift2(getParentBlock$1(rootNode, SugarElement.fromDom(rng.startContainer)), getParentBlock$1(rootNode, SugarElement.fromDom(rng.endContainer)), function (block1, block2) {\n        if (eq(block1, block2) === false) {\n          rng.deleteContents();\n          mergeBlocks(rootNode, true, block1, block2).each(function (pos) {\n            selection.setRng(pos.toRange());\n          });\n          return true;\n        } else {\n          return false;\n        }\n      }).getOr(false);\n    };\n    var isRawNodeInTable = function (root, rawNode) {\n      var node = SugarElement.fromDom(rawNode);\n      var isRoot = curry(eq, root);\n      return ancestor$3(node, isTableCell$4, isRoot).isSome();\n    };\n    var isSelectionInTable = function (root, rng) {\n      return isRawNodeInTable(root, rng.startContainer) || isRawNodeInTable(root, rng.endContainer);\n    };\n    var isEverythingSelected = function (root, rng) {\n      var noPrevious = prevPosition(root.dom, CaretPosition.fromRangeStart(rng)).isNone();\n      var noNext = nextPosition(root.dom, CaretPosition.fromRangeEnd(rng)).isNone();\n      return !isSelectionInTable(root, rng) && noPrevious && noNext;\n    };\n    var emptyEditor = function (editor) {\n      editor.setContent('');\n      editor.selection.setCursorLocation();\n      return true;\n    };\n    var deleteRange$1 = function (editor) {\n      var rootNode = SugarElement.fromDom(editor.getBody());\n      var rng = editor.selection.getRng();\n      return isEverythingSelected(rootNode, rng) ? emptyEditor(editor) : deleteRangeMergeBlocks(rootNode, editor.selection);\n    };\n    var backspaceDelete$7 = function (editor, _forward) {\n      return editor.selection.isCollapsed() ? false : deleteRange$1(editor);\n    };\n\n    var isContentEditableTrue$2 = isContentEditableTrue$4;\n    var isContentEditableFalse$4 = isContentEditableFalse$b;\n    var showCaret = function (direction, editor, node, before, scrollIntoView) {\n      return Optional.from(editor._selectionOverrides.showCaret(direction, node, before, scrollIntoView));\n    };\n    var getNodeRange = function (node) {\n      var rng = node.ownerDocument.createRange();\n      rng.selectNode(node);\n      return rng;\n    };\n    var selectNode = function (editor, node) {\n      var e = editor.fire('BeforeObjectSelected', { target: node });\n      if (e.isDefaultPrevented()) {\n        return Optional.none();\n      }\n      return Optional.some(getNodeRange(node));\n    };\n    var renderCaretAtRange = function (editor, range, scrollIntoView) {\n      var normalizedRange = normalizeRange(1, editor.getBody(), range);\n      var caretPosition = CaretPosition.fromRangeStart(normalizedRange);\n      var caretPositionNode = caretPosition.getNode();\n      if (isInlineFakeCaretTarget(caretPositionNode)) {\n        return showCaret(1, editor, caretPositionNode, !caretPosition.isAtEnd(), false);\n      }\n      var caretPositionBeforeNode = caretPosition.getNode(true);\n      if (isInlineFakeCaretTarget(caretPositionBeforeNode)) {\n        return showCaret(1, editor, caretPositionBeforeNode, false, false);\n      }\n      var ceRoot = editor.dom.getParent(caretPosition.getNode(), function (node) {\n        return isContentEditableFalse$4(node) || isContentEditableTrue$2(node);\n      });\n      if (isInlineFakeCaretTarget(ceRoot)) {\n        return showCaret(1, editor, ceRoot, false, scrollIntoView);\n      }\n      return Optional.none();\n    };\n    var renderRangeCaret = function (editor, range, scrollIntoView) {\n      return range.collapsed ? renderCaretAtRange(editor, range, scrollIntoView).getOr(range) : range;\n    };\n\n    var isBeforeBoundary = function (pos) {\n      return isBeforeContentEditableFalse(pos) || isBeforeMedia(pos);\n    };\n    var isAfterBoundary = function (pos) {\n      return isAfterContentEditableFalse(pos) || isAfterMedia(pos);\n    };\n    var trimEmptyTextNode = function (dom, node) {\n      if (isText$7(node) && node.data.length === 0) {\n        dom.remove(node);\n      }\n    };\n    var deleteContentAndShowCaret = function (editor, range, node, direction, forward, peekCaretPosition) {\n      showCaret(direction, editor, peekCaretPosition.getNode(!forward), forward, true).each(function (caretRange) {\n        if (range.collapsed) {\n          var deleteRange = range.cloneRange();\n          if (forward) {\n            deleteRange.setEnd(caretRange.startContainer, caretRange.startOffset);\n          } else {\n            deleteRange.setStart(caretRange.endContainer, caretRange.endOffset);\n          }\n          deleteRange.deleteContents();\n        } else {\n          range.deleteContents();\n        }\n        editor.selection.setRng(caretRange);\n      });\n      trimEmptyTextNode(editor.dom, node);\n      return true;\n    };\n    var deleteBoundaryText = function (editor, forward) {\n      var range = editor.selection.getRng();\n      if (!isText$7(range.commonAncestorContainer)) {\n        return false;\n      }\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forward ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forward ? isBeforeBoundary : isAfterBoundary;\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var nextCaretPosition = normalizePosition(forward, getNextPosFn(caretPosition));\n      if (!nextCaretPosition || !isMoveInsideSameBlock(caretPosition, nextCaretPosition)) {\n        return false;\n      } else if (isBeforeFn(nextCaretPosition)) {\n        return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, nextCaretPosition);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return deleteContentAndShowCaret(editor, range, caretPosition.getNode(), direction, forward, peekCaretPosition);\n        }\n      }\n      return false;\n    };\n    var backspaceDelete$6 = function (editor, forward) {\n      return deleteBoundaryText(editor, forward);\n    };\n\n    var isCompoundElement = function (node) {\n      return isTableCell$4(SugarElement.fromDom(node)) || isListItem(SugarElement.fromDom(node));\n    };\n    var DeleteAction = Adt.generate([\n      { remove: ['element'] },\n      { moveToElement: ['element'] },\n      { moveToPosition: ['position'] }\n    ]);\n    var isAtContentEditableBlockCaret = function (forward, from) {\n      var elm = from.getNode(forward === false);\n      var caretLocation = forward ? 'after' : 'before';\n      return isElement$5(elm) && elm.getAttribute('data-mce-caret') === caretLocation;\n    };\n    var isDeleteFromCefDifferentBlocks = function (root, forward, from, to) {\n      var inSameBlock = function (elm) {\n        return isInline$1(SugarElement.fromDom(elm)) && !isInSameBlock(from, to, root);\n      };\n      return getRelativeCefElm(!forward, from).fold(function () {\n        return getRelativeCefElm(forward, to).fold(never, inSameBlock);\n      }, inSameBlock);\n    };\n    var deleteEmptyBlockOrMoveToCef = function (root, forward, from, to) {\n      var toCefElm = to.getNode(forward === false);\n      return getParentBlock$1(SugarElement.fromDom(root), SugarElement.fromDom(from.getNode())).map(function (blockElm) {\n        return isEmpty$2(blockElm) ? DeleteAction.remove(blockElm.dom) : DeleteAction.moveToElement(toCefElm);\n      }).orThunk(function () {\n        return Optional.some(DeleteAction.moveToElement(toCefElm));\n      });\n    };\n    var findCefPosition = function (root, forward, from) {\n      return fromPosition(forward, root, from).bind(function (to) {\n        if (isCompoundElement(to.getNode())) {\n          return Optional.none();\n        } else if (isDeleteFromCefDifferentBlocks(root, forward, from, to)) {\n          return Optional.none();\n        } else if (forward && isContentEditableFalse$b(to.getNode())) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward === false && isContentEditableFalse$b(to.getNode(true))) {\n          return deleteEmptyBlockOrMoveToCef(root, forward, from, to);\n        } else if (forward && isAfterContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else if (forward === false && isBeforeContentEditableFalse(from)) {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        } else {\n          return Optional.none();\n        }\n      });\n    };\n    var getContentEditableBlockAction = function (forward, elm) {\n      if (forward && isContentEditableFalse$b(elm.nextSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.nextSibling));\n      } else if (forward === false && isContentEditableFalse$b(elm.previousSibling)) {\n        return Optional.some(DeleteAction.moveToElement(elm.previousSibling));\n      } else {\n        return Optional.none();\n      }\n    };\n    var skipMoveToActionFromInlineCefToContent = function (root, from, deleteAction) {\n      return deleteAction.fold(function (elm) {\n        return Optional.some(DeleteAction.remove(elm));\n      }, function (elm) {\n        return Optional.some(DeleteAction.moveToElement(elm));\n      }, function (to) {\n        if (isInSameBlock(from, to, root)) {\n          return Optional.none();\n        } else {\n          return Optional.some(DeleteAction.moveToPosition(to));\n        }\n      });\n    };\n    var getContentEditableAction = function (root, forward, from) {\n      if (isAtContentEditableBlockCaret(forward, from)) {\n        return getContentEditableBlockAction(forward, from.getNode(forward === false)).fold(function () {\n          return findCefPosition(root, forward, from);\n        }, Optional.some);\n      } else {\n        return findCefPosition(root, forward, from).bind(function (deleteAction) {\n          return skipMoveToActionFromInlineCefToContent(root, from, deleteAction);\n        });\n      }\n    };\n    var read = function (root, forward, rng) {\n      var normalizedRange = normalizeRange(forward ? 1 : -1, root, rng);\n      var from = CaretPosition.fromRangeStart(normalizedRange);\n      var rootElement = SugarElement.fromDom(root);\n      if (forward === false && isAfterContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode(true)));\n      } else if (forward && isBeforeContentEditableFalse(from)) {\n        return Optional.some(DeleteAction.remove(from.getNode()));\n      } else if (forward === false && isBeforeContentEditableFalse(from) && isAfterBr(rootElement, from)) {\n        return findPreviousBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else if (forward && isAfterContentEditableFalse(from) && isBeforeBr$1(rootElement, from)) {\n        return findNextBr(rootElement, from).map(function (br) {\n          return DeleteAction.remove(br.getNode());\n        });\n      } else {\n        return getContentEditableAction(root, forward, from);\n      }\n    };\n\n    var deleteElement$1 = function (editor, forward) {\n      return function (element) {\n        editor._selectionOverrides.hideFakeCaret();\n        deleteElement$2(editor, forward, SugarElement.fromDom(element));\n        return true;\n      };\n    };\n    var moveToElement = function (editor, forward) {\n      return function (element) {\n        var pos = forward ? CaretPosition.before(element) : CaretPosition.after(element);\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var moveToPosition = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      };\n    };\n    var getAncestorCe = function (editor, node) {\n      return Optional.from(getContentEditableRoot$1(editor.getBody(), node));\n    };\n    var backspaceDeleteCaret = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return getAncestorCe(editor, selectedNode).filter(isContentEditableFalse$b).fold(function () {\n        return read(editor.getBody(), forward, editor.selection.getRng()).exists(function (deleteAction) {\n          return deleteAction.fold(deleteElement$1(editor, forward), moveToElement(editor, forward), moveToPosition(editor));\n        });\n      }, always);\n    };\n    var deleteOffscreenSelection = function (rootElement) {\n      each$k(descendants(rootElement, '.mce-offscreen-selection'), remove$7);\n    };\n    var backspaceDeleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      if (isContentEditableFalse$b(selectedNode) && !isTableCell$5(selectedNode)) {\n        var hasCefAncestor = getAncestorCe(editor, selectedNode.parentNode).filter(isContentEditableFalse$b);\n        return hasCefAncestor.fold(function () {\n          deleteOffscreenSelection(SugarElement.fromDom(editor.getBody()));\n          deleteElement$2(editor, forward, SugarElement.fromDom(editor.selection.getNode()));\n          paddEmptyBody(editor);\n          return true;\n        }, always);\n      }\n      return false;\n    };\n    var paddEmptyElement = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var ceRoot = getContentEditableRoot$1(editor.getBody(), selection.getNode());\n      if (isContentEditableTrue$4(ceRoot) && dom.isBlock(ceRoot) && dom.isEmpty(ceRoot)) {\n        var br = dom.create('br', { 'data-mce-bogus': '1' });\n        dom.setHTML(ceRoot, '');\n        ceRoot.appendChild(br);\n        selection.setRng(CaretPosition.before(br).toRange());\n      }\n      return true;\n    };\n    var backspaceDelete$5 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return backspaceDeleteCaret(editor, forward);\n      } else {\n        return backspaceDeleteRange(editor, forward);\n      }\n    };\n\n    var deleteCaret$2 = function (editor, forward) {\n      var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return fromPosition(forward, editor.getBody(), fromPos).filter(function (pos) {\n        return forward ? isBeforeImageBlock(pos) : isAfterImageBlock(pos);\n      }).bind(function (pos) {\n        return Optional.from(getChildNodeAtRelativeOffset(forward ? 0 : -1, pos));\n      }).exists(function (elm) {\n        editor.selection.select(elm);\n        return true;\n      });\n    };\n    var backspaceDelete$4 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$2(editor, forward) : false;\n    };\n\n    var isText = isText$7;\n    var startsWithCaretContainer = function (node) {\n      return isText(node) && node.data[0] === ZWSP$1;\n    };\n    var endsWithCaretContainer = function (node) {\n      return isText(node) && node.data[node.data.length - 1] === ZWSP$1;\n    };\n    var createZwsp = function (node) {\n      return node.ownerDocument.createTextNode(ZWSP$1);\n    };\n    var insertBefore = function (node) {\n      if (isText(node.previousSibling)) {\n        if (endsWithCaretContainer(node.previousSibling)) {\n          return node.previousSibling;\n        } else {\n          node.previousSibling.appendData(ZWSP$1);\n          return node.previousSibling;\n        }\n      } else if (isText(node)) {\n        if (startsWithCaretContainer(node)) {\n          return node;\n        } else {\n          node.insertData(0, ZWSP$1);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        node.parentNode.insertBefore(newNode, node);\n        return newNode;\n      }\n    };\n    var insertAfter = function (node) {\n      if (isText(node.nextSibling)) {\n        if (startsWithCaretContainer(node.nextSibling)) {\n          return node.nextSibling;\n        } else {\n          node.nextSibling.insertData(0, ZWSP$1);\n          return node.nextSibling;\n        }\n      } else if (isText(node)) {\n        if (endsWithCaretContainer(node)) {\n          return node;\n        } else {\n          node.appendData(ZWSP$1);\n          return node;\n        }\n      } else {\n        var newNode = createZwsp(node);\n        if (node.nextSibling) {\n          node.parentNode.insertBefore(newNode, node.nextSibling);\n        } else {\n          node.parentNode.appendChild(newNode);\n        }\n        return newNode;\n      }\n    };\n    var insertInline = function (before, node) {\n      return before ? insertBefore(node) : insertAfter(node);\n    };\n    var insertInlineBefore = curry(insertInline, true);\n    var insertInlineAfter = curry(insertInline, false);\n\n    var insertInlinePos = function (pos, before) {\n      if (isText$7(pos.container())) {\n        return insertInline(before, pos.container());\n      } else {\n        return insertInline(before, pos.getNode());\n      }\n    };\n    var isPosCaretContainer = function (pos, caret) {\n      var caretNode = caret.get();\n      return caretNode && pos.container() === caretNode && isCaretContainerInline(caretNode);\n    };\n    var renderCaret = function (caret, location) {\n      return location.fold(function (element) {\n        remove$2(caret.get());\n        var text = insertInlineBefore(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, text.length - 1));\n      }, function (element) {\n        return firstPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$2(caret.get());\n            var text = insertInlinePos(pos, true);\n            caret.set(text);\n            return CaretPosition(text, 1);\n          } else {\n            return CaretPosition(caret.get(), 1);\n          }\n        });\n      }, function (element) {\n        return lastPositionIn(element).map(function (pos) {\n          if (!isPosCaretContainer(pos, caret)) {\n            remove$2(caret.get());\n            var text = insertInlinePos(pos, false);\n            caret.set(text);\n            return CaretPosition(text, text.length - 1);\n          } else {\n            return CaretPosition(caret.get(), caret.get().length - 1);\n          }\n        });\n      }, function (element) {\n        remove$2(caret.get());\n        var text = insertInlineAfter(element);\n        caret.set(text);\n        return Optional.some(CaretPosition(text, 1));\n      });\n    };\n\n    var evaluateUntil = function (fns, args) {\n      for (var i = 0; i < fns.length; i++) {\n        var result = fns[i].apply(null, args);\n        if (result.isSome()) {\n          return result;\n        }\n      }\n      return Optional.none();\n    };\n\n    var Location = Adt.generate([\n      { before: ['element'] },\n      { start: ['element'] },\n      { end: ['element'] },\n      { after: ['element'] }\n    ]);\n    var rescope$1 = function (rootNode, node) {\n      var parentBlock = getParentBlock$2(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var before = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      var scope = rescope$1(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return nextPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.before(inline);\n        });\n      }, Optional.none);\n    };\n    var isNotInsideFormatCaretContainer = function (rootNode, elm) {\n      return getParentCaretContainer(rootNode, elm) === null;\n    };\n    var findInsideRootInline = function (isInlineTarget, rootNode, pos) {\n      return findRootInline(isInlineTarget, rootNode, pos).filter(curry(isNotInsideFormatCaretContainer, rootNode));\n    };\n    var start$1 = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var prevPos = prevPosition(inline, nPos);\n        return prevPos.isNone() ? Optional.some(Location.start(inline)) : Optional.none();\n      });\n    };\n    var end = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeForwards(pos);\n      return findInsideRootInline(isInlineTarget, rootNode, nPos).bind(function (inline) {\n        var nextPos = nextPosition(inline, nPos);\n        return nextPos.isNone() ? Optional.some(Location.end(inline)) : Optional.none();\n      });\n    };\n    var after = function (isInlineTarget, rootNode, pos) {\n      var nPos = normalizeBackwards(pos);\n      var scope = rescope$1(rootNode, nPos.container());\n      return findRootInline(isInlineTarget, scope, nPos).fold(function () {\n        return prevPosition(scope, nPos).bind(curry(findRootInline, isInlineTarget, scope)).map(function (inline) {\n          return Location.after(inline);\n        });\n      }, Optional.none);\n    };\n    var isValidLocation = function (location) {\n      return isRtl(getElement(location)) === false;\n    };\n    var readLocation = function (isInlineTarget, rootNode, pos) {\n      var location = evaluateUntil([\n        before,\n        start$1,\n        end,\n        after\n      ], [\n        isInlineTarget,\n        rootNode,\n        pos\n      ]);\n      return location.filter(isValidLocation);\n    };\n    var getElement = function (location) {\n      return location.fold(identity, identity, identity, identity);\n    };\n    var getName = function (location) {\n      return location.fold(constant('before'), constant('start'), constant('end'), constant('after'));\n    };\n    var outside = function (location) {\n      return location.fold(Location.before, Location.before, Location.after, Location.after);\n    };\n    var inside = function (location) {\n      return location.fold(Location.start, Location.start, Location.end, Location.end);\n    };\n    var isEq = function (location1, location2) {\n      return getName(location1) === getName(location2) && getElement(location1) === getElement(location2);\n    };\n    var betweenInlines = function (forward, isInlineTarget, rootNode, from, to, location) {\n      return lift2(findRootInline(isInlineTarget, rootNode, from), findRootInline(isInlineTarget, rootNode, to), function (fromInline, toInline) {\n        if (fromInline !== toInline && hasSameParentBlock(rootNode, fromInline, toInline)) {\n          return Location.after(forward ? fromInline : toInline);\n        } else {\n          return location;\n        }\n      }).getOr(location);\n    };\n    var skipNoMovement = function (fromLocation, toLocation) {\n      return fromLocation.fold(always, function (fromLocation) {\n        return !isEq(fromLocation, toLocation);\n      });\n    };\n    var findLocationTraverse = function (forward, isInlineTarget, rootNode, fromLocation, pos) {\n      var from = normalizePosition(forward, pos);\n      var to = fromPosition(forward, rootNode, from).map(curry(normalizePosition, forward));\n      var location = to.fold(function () {\n        return fromLocation.map(outside);\n      }, function (to) {\n        return readLocation(isInlineTarget, rootNode, to).map(curry(betweenInlines, forward, isInlineTarget, rootNode, from, to)).filter(curry(skipNoMovement, fromLocation));\n      });\n      return location.filter(isValidLocation);\n    };\n    var findLocationSimple = function (forward, location) {\n      if (forward) {\n        return location.fold(compose(Optional.some, Location.start), Optional.none, compose(Optional.some, Location.after), Optional.none);\n      } else {\n        return location.fold(Optional.none, compose(Optional.some, Location.before), Optional.none, compose(Optional.some, Location.end));\n      }\n    };\n    var findLocation$1 = function (forward, isInlineTarget, rootNode, pos) {\n      var from = normalizePosition(forward, pos);\n      var fromLocation = readLocation(isInlineTarget, rootNode, from);\n      return readLocation(isInlineTarget, rootNode, from).bind(curry(findLocationSimple, forward)).orThunk(function () {\n        return findLocationTraverse(forward, isInlineTarget, rootNode, fromLocation, pos);\n      });\n    };\n    curry(findLocation$1, false);\n    curry(findLocation$1, true);\n\n    var hasSelectionModifyApi = function (editor) {\n      return isFunction(editor.selection.getSel().modify);\n    };\n    var moveRel = function (forward, selection, pos) {\n      var delta = forward ? 1 : -1;\n      selection.setRng(CaretPosition(pos.container(), pos.offset() + delta).toRange());\n      selection.getSel().modify('move', forward ? 'forward' : 'backward', 'word');\n      return true;\n    };\n    var moveByWord = function (forward, editor) {\n      var rng = editor.selection.getRng();\n      var pos = forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n      if (!hasSelectionModifyApi(editor)) {\n        return false;\n      } else if (forward && isBeforeInline(pos)) {\n        return moveRel(true, editor.selection, pos);\n      } else if (!forward && isAfterInline(pos)) {\n        return moveRel(false, editor.selection, pos);\n      } else {\n        return false;\n      }\n    };\n\n    var BreakType;\n    (function (BreakType) {\n      BreakType[BreakType['Br'] = 0] = 'Br';\n      BreakType[BreakType['Block'] = 1] = 'Block';\n      BreakType[BreakType['Wrap'] = 2] = 'Wrap';\n      BreakType[BreakType['Eol'] = 3] = 'Eol';\n    }(BreakType || (BreakType = {})));\n    var flip = function (direction, positions) {\n      return direction === HDirection.Backwards ? reverse(positions) : positions;\n    };\n    var walk = function (direction, caretWalker, pos) {\n      return direction === HDirection.Forwards ? caretWalker.next(pos) : caretWalker.prev(pos);\n    };\n    var getBreakType = function (scope, direction, currentPos, nextPos) {\n      if (isBr$5(nextPos.getNode(direction === HDirection.Forwards))) {\n        return BreakType.Br;\n      } else if (isInSameBlock(currentPos, nextPos) === false) {\n        return BreakType.Block;\n      } else {\n        return BreakType.Wrap;\n      }\n    };\n    var getPositionsUntil = function (predicate, direction, scope, start) {\n      var caretWalker = CaretWalker(scope);\n      var currentPos = start;\n      var positions = [];\n      while (currentPos) {\n        var nextPos = walk(direction, caretWalker, currentPos);\n        if (!nextPos) {\n          break;\n        }\n        if (isBr$5(nextPos.getNode(false))) {\n          if (direction === HDirection.Forwards) {\n            return {\n              positions: flip(direction, positions).concat([nextPos]),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          } else {\n            return {\n              positions: flip(direction, positions),\n              breakType: BreakType.Br,\n              breakAt: Optional.some(nextPos)\n            };\n          }\n        }\n        if (!nextPos.isVisible()) {\n          currentPos = nextPos;\n          continue;\n        }\n        if (predicate(currentPos, nextPos)) {\n          var breakType = getBreakType(scope, direction, currentPos, nextPos);\n          return {\n            positions: flip(direction, positions),\n            breakType: breakType,\n            breakAt: Optional.some(nextPos)\n          };\n        }\n        positions.push(nextPos);\n        currentPos = nextPos;\n      }\n      return {\n        positions: flip(direction, positions),\n        breakType: BreakType.Eol,\n        breakAt: Optional.none()\n      };\n    };\n    var getAdjacentLinePositions = function (direction, getPositionsUntilBreak, scope, start) {\n      return getPositionsUntilBreak(scope, start).breakAt.map(function (pos) {\n        var positions = getPositionsUntilBreak(scope, pos).positions;\n        return direction === HDirection.Backwards ? positions.concat(pos) : [pos].concat(positions);\n      }).getOr([]);\n    };\n    var findClosestHorizontalPositionFromPoint = function (positions, x) {\n      return foldl(positions, function (acc, newPos) {\n        return acc.fold(function () {\n          return Optional.some(newPos);\n        }, function (lastPos) {\n          return lift2(head(lastPos.getClientRects()), head(newPos.getClientRects()), function (lastRect, newRect) {\n            var lastDist = Math.abs(x - lastRect.left);\n            var newDist = Math.abs(x - newRect.left);\n            return newDist <= lastDist ? newPos : lastPos;\n          }).or(acc);\n        });\n      }, Optional.none());\n    };\n    var findClosestHorizontalPosition = function (positions, pos) {\n      return head(pos.getClientRects()).bind(function (targetRect) {\n        return findClosestHorizontalPositionFromPoint(positions, targetRect.left);\n      });\n    };\n    var getPositionsUntilPreviousLine = curry(getPositionsUntil, CaretPosition.isAbove, -1);\n    var getPositionsUntilNextLine = curry(getPositionsUntil, CaretPosition.isBelow, 1);\n    var getPositionsAbove = curry(getAdjacentLinePositions, -1, getPositionsUntilPreviousLine);\n    var getPositionsBelow = curry(getAdjacentLinePositions, 1, getPositionsUntilNextLine);\n    var isAtFirstLine = function (scope, pos) {\n      return getPositionsUntilPreviousLine(scope, pos).breakAt.isNone();\n    };\n    var isAtLastLine = function (scope, pos) {\n      return getPositionsUntilNextLine(scope, pos).breakAt.isNone();\n    };\n    var getFirstLinePositions = function (scope) {\n      return firstPositionIn(scope).map(function (pos) {\n        return [pos].concat(getPositionsUntilNextLine(scope, pos).positions);\n      }).getOr([]);\n    };\n    var getLastLinePositions = function (scope) {\n      return lastPositionIn(scope).map(function (pos) {\n        return getPositionsUntilPreviousLine(scope, pos).positions.concat(pos);\n      }).getOr([]);\n    };\n\n    var getNodeClientRects = function (node) {\n      var toArrayWithNode = function (clientRects) {\n        return map$3(clientRects, function (rect) {\n          var clientRect = clone(rect);\n          clientRect.node = node;\n          return clientRect;\n        });\n      };\n      if (isElement$5(node)) {\n        return toArrayWithNode(node.getClientRects());\n      }\n      if (isText$7(node)) {\n        var rng = node.ownerDocument.createRange();\n        rng.setStart(node, 0);\n        rng.setEnd(node, node.data.length);\n        return toArrayWithNode(rng.getClientRects());\n      }\n    };\n    var getClientRects = function (nodes) {\n      return bind(nodes, getNodeClientRects);\n    };\n\n    var VDirection;\n    (function (VDirection) {\n      VDirection[VDirection['Up'] = -1] = 'Up';\n      VDirection[VDirection['Down'] = 1] = 'Down';\n    }(VDirection || (VDirection = {})));\n    var findUntil = function (direction, root, predicateFn, node) {\n      while (node = findNode$1(node, direction, isEditableCaretCandidate$1, root)) {\n        if (predicateFn(node)) {\n          return;\n        }\n      }\n    };\n    var walkUntil$1 = function (direction, isAboveFn, isBeflowFn, root, predicateFn, caretPosition) {\n      var line = 0;\n      var result = [];\n      var add = function (node) {\n        var clientRects = getClientRects([node]);\n        if (direction === -1) {\n          clientRects = clientRects.reverse();\n        }\n        for (var i = 0; i < clientRects.length; i++) {\n          var clientRect = clientRects[i];\n          if (isBeflowFn(clientRect, targetClientRect)) {\n            continue;\n          }\n          if (result.length > 0 && isAboveFn(clientRect, last$1(result))) {\n            line++;\n          }\n          clientRect.line = line;\n          if (predicateFn(clientRect)) {\n            return true;\n          }\n          result.push(clientRect);\n        }\n      };\n      var targetClientRect = last$1(caretPosition.getClientRects());\n      if (!targetClientRect) {\n        return result;\n      }\n      var node = caretPosition.getNode();\n      add(node);\n      findUntil(direction, root, add, node);\n      return result;\n    };\n    var aboveLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line > lineNumber;\n    };\n    var isLineNumber = function (lineNumber, clientRect) {\n      return clientRect.line === lineNumber;\n    };\n    var upUntil = curry(walkUntil$1, VDirection.Up, isAbove$1, isBelow$1);\n    var downUntil = curry(walkUntil$1, VDirection.Down, isBelow$1, isAbove$1);\n    var positionsUntil = function (direction, root, predicateFn, node) {\n      var caretWalker = CaretWalker(root);\n      var walkFn;\n      var isBelowFn;\n      var isAboveFn;\n      var caretPosition;\n      var result = [];\n      var line = 0;\n      var getClientRect = function (caretPosition) {\n        if (direction === 1) {\n          return last$1(caretPosition.getClientRects());\n        }\n        return last$1(caretPosition.getClientRects());\n      };\n      if (direction === 1) {\n        walkFn = caretWalker.next;\n        isBelowFn = isBelow$1;\n        isAboveFn = isAbove$1;\n        caretPosition = CaretPosition.after(node);\n      } else {\n        walkFn = caretWalker.prev;\n        isBelowFn = isAbove$1;\n        isAboveFn = isBelow$1;\n        caretPosition = CaretPosition.before(node);\n      }\n      var targetClientRect = getClientRect(caretPosition);\n      do {\n        if (!caretPosition.isVisible()) {\n          continue;\n        }\n        var rect = getClientRect(caretPosition);\n        if (isAboveFn(rect, targetClientRect)) {\n          continue;\n        }\n        if (result.length > 0 && isBelowFn(rect, last$1(result))) {\n          line++;\n        }\n        var clientRect = clone(rect);\n        clientRect.position = caretPosition;\n        clientRect.line = line;\n        if (predicateFn(clientRect)) {\n          return result;\n        }\n        result.push(clientRect);\n      } while (caretPosition = walkFn(caretPosition));\n      return result;\n    };\n    var isAboveLine = function (lineNumber) {\n      return function (clientRect) {\n        return aboveLineNumber(lineNumber, clientRect);\n      };\n    };\n    var isLine = function (lineNumber) {\n      return function (clientRect) {\n        return isLineNumber(lineNumber, clientRect);\n      };\n    };\n\n    var isContentEditableFalse$3 = isContentEditableFalse$b;\n    var findNode = findNode$1;\n    var distanceToRectLeft = function (clientRect, clientX) {\n      return Math.abs(clientRect.left - clientX);\n    };\n    var distanceToRectRight = function (clientRect, clientX) {\n      return Math.abs(clientRect.right - clientX);\n    };\n    var isInsideX = function (clientX, clientRect) {\n      return clientX >= clientRect.left && clientX <= clientRect.right;\n    };\n    var isInsideY = function (clientY, clientRect) {\n      return clientY >= clientRect.top && clientY <= clientRect.bottom;\n    };\n    var isNodeClientRect = function (rect) {\n      return hasNonNullableKey(rect, 'node');\n    };\n    var findClosestClientRect = function (clientRects, clientX, allowInside) {\n      if (allowInside === void 0) {\n        allowInside = always;\n      }\n      return reduce(clientRects, function (oldClientRect, clientRect) {\n        if (isInsideX(clientX, clientRect)) {\n          return allowInside(clientRect) ? clientRect : oldClientRect;\n        }\n        if (isInsideX(clientX, oldClientRect)) {\n          return allowInside(oldClientRect) ? oldClientRect : clientRect;\n        }\n        var oldDistance = Math.min(distanceToRectLeft(oldClientRect, clientX), distanceToRectRight(oldClientRect, clientX));\n        var newDistance = Math.min(distanceToRectLeft(clientRect, clientX), distanceToRectRight(clientRect, clientX));\n        if (newDistance === oldDistance && isNodeClientRect(clientRect) && isContentEditableFalse$3(clientRect.node)) {\n          return clientRect;\n        }\n        if (newDistance < oldDistance) {\n          return clientRect;\n        }\n        return oldClientRect;\n      });\n    };\n    var walkUntil = function (direction, root, predicateFn, startNode, includeChildren) {\n      var node = findNode(startNode, direction, isEditableCaretCandidate$1, root, !includeChildren);\n      do {\n        if (!node || predicateFn(node)) {\n          return;\n        }\n      } while (node = findNode(node, direction, isEditableCaretCandidate$1, root));\n    };\n    var findLineNodeRects = function (root, targetNodeRect, includeChildren) {\n      if (includeChildren === void 0) {\n        includeChildren = true;\n      }\n      var clientRects = [];\n      var collect = function (checkPosFn, node) {\n        var lineRects = filter$4(getClientRects([node]), function (clientRect) {\n          return !checkPosFn(clientRect, targetNodeRect);\n        });\n        clientRects = clientRects.concat(lineRects);\n        return lineRects.length === 0;\n      };\n      clientRects.push(targetNodeRect);\n      walkUntil(VDirection.Up, root, curry(collect, isAbove$1), targetNodeRect.node, includeChildren);\n      walkUntil(VDirection.Down, root, curry(collect, isBelow$1), targetNodeRect.node, includeChildren);\n      return clientRects;\n    };\n    var getFakeCaretTargets = function (root) {\n      return filter$4(from(root.getElementsByTagName('*')), isFakeCaretTarget);\n    };\n    var caretInfo = function (clientRect, clientX) {\n      return {\n        node: clientRect.node,\n        before: distanceToRectLeft(clientRect, clientX) < distanceToRectRight(clientRect, clientX)\n      };\n    };\n    var closestFakeCaret = function (root, clientX, clientY) {\n      var fakeTargetNodeRects = getClientRects(getFakeCaretTargets(root));\n      var targetNodeRects = filter$4(fakeTargetNodeRects, curry(isInsideY, clientY));\n      var checkInside = function (clientRect) {\n        return !isTable$3(clientRect.node) && !isMedia$2(clientRect.node);\n      };\n      var closestNodeRect = findClosestClientRect(targetNodeRects, clientX, checkInside);\n      if (closestNodeRect) {\n        var includeChildren = checkInside(closestNodeRect);\n        closestNodeRect = findClosestClientRect(findLineNodeRects(root, closestNodeRect, includeChildren), clientX, checkInside);\n        if (closestNodeRect && isFakeCaretTarget(closestNodeRect.node)) {\n          return caretInfo(closestNodeRect, clientX);\n        }\n      }\n      return null;\n    };\n\n    var moveToRange = function (editor, rng) {\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, editor.selection.getRng());\n    };\n    var renderRangeCaretOpt = function (editor, range, scrollIntoView) {\n      return Optional.some(renderRangeCaret(editor, range, scrollIntoView));\n    };\n    var moveHorizontally = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var forwards = direction === HDirection.Forwards;\n      var caretWalker = CaretWalker(editor.getBody());\n      var getNextPosFn = curry(getVisualCaretPosition, forwards ? caretWalker.next : caretWalker.prev);\n      var isBeforeFn = forwards ? isBefore : isAfter;\n      if (!range.collapsed) {\n        var node = getSelectedNode(range);\n        if (isElement(node)) {\n          return showCaret(direction, editor, node, direction === HDirection.Backwards, false);\n        }\n      }\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      if (isBeforeFn(caretPosition)) {\n        return selectNode(editor, caretPosition.getNode(!forwards));\n      }\n      var nextCaretPosition = normalizePosition(forwards, getNextPosFn(caretPosition));\n      var rangeIsInContainerBlock = isRangeInCaretContainerBlock(range);\n      if (!nextCaretPosition) {\n        return rangeIsInContainerBlock ? Optional.some(range) : Optional.none();\n      }\n      if (isBeforeFn(nextCaretPosition)) {\n        return showCaret(direction, editor, nextCaretPosition.getNode(!forwards), forwards, false);\n      }\n      var peekCaretPosition = getNextPosFn(nextCaretPosition);\n      if (peekCaretPosition && isBeforeFn(peekCaretPosition)) {\n        if (isMoveInsideSameBlock(nextCaretPosition, peekCaretPosition)) {\n          return showCaret(direction, editor, peekCaretPosition.getNode(!forwards), forwards, false);\n        }\n      }\n      if (rangeIsInContainerBlock) {\n        return renderRangeCaretOpt(editor, nextCaretPosition.toRange(), false);\n      }\n      return Optional.none();\n    };\n    var moveVertically = function (editor, direction, range, isBefore, isAfter, isElement) {\n      var caretPosition = getNormalizedRangeEndPoint(direction, editor.getBody(), range);\n      var caretClientRect = last$1(caretPosition.getClientRects());\n      var forwards = direction === VDirection.Down;\n      if (!caretClientRect) {\n        return Optional.none();\n      }\n      var walkerFn = forwards ? downUntil : upUntil;\n      var linePositions = walkerFn(editor.getBody(), isAboveLine(1), caretPosition);\n      var nextLinePositions = filter$4(linePositions, isLine(1));\n      var clientX = caretClientRect.left;\n      var nextLineRect = findClosestClientRect(nextLinePositions, clientX);\n      if (nextLineRect && isElement(nextLineRect.node)) {\n        var dist1 = Math.abs(clientX - nextLineRect.left);\n        var dist2 = Math.abs(clientX - nextLineRect.right);\n        return showCaret(direction, editor, nextLineRect.node, dist1 < dist2, false);\n      }\n      var currentNode;\n      if (isBefore(caretPosition)) {\n        currentNode = caretPosition.getNode();\n      } else if (isAfter(caretPosition)) {\n        currentNode = caretPosition.getNode(true);\n      } else {\n        currentNode = getSelectedNode(range);\n      }\n      if (currentNode) {\n        var caretPositions = positionsUntil(direction, editor.getBody(), isAboveLine(1), currentNode);\n        var closestNextLineRect = findClosestClientRect(filter$4(caretPositions, isLine(1)), clientX);\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n        closestNextLineRect = last$1(filter$4(caretPositions, isLine(0)));\n        if (closestNextLineRect) {\n          return renderRangeCaretOpt(editor, closestNextLineRect.position.toRange(), false);\n        }\n      }\n      if (nextLinePositions.length === 0) {\n        return getLineEndPoint(editor, forwards).filter(forwards ? isAfter : isBefore).map(function (pos) {\n          return renderRangeCaret(editor, pos.toRange(), false);\n        });\n      }\n      return Optional.none();\n    };\n    var getLineEndPoint = function (editor, forward) {\n      var rng = editor.selection.getRng();\n      var body = editor.getBody();\n      if (forward) {\n        var from = CaretPosition.fromRangeEnd(rng);\n        var result = getPositionsUntilNextLine(body, from);\n        return last$2(result.positions);\n      } else {\n        var from = CaretPosition.fromRangeStart(rng);\n        var result = getPositionsUntilPreviousLine(body, from);\n        return head(result.positions);\n      }\n    };\n    var moveToLineEndPoint$3 = function (editor, forward, isElementPosition) {\n      return getLineEndPoint(editor, forward).filter(isElementPosition).exists(function (pos) {\n        editor.selection.setRng(pos.toRange());\n        return true;\n      });\n    };\n\n    var setCaretPosition = function (editor, pos) {\n      var rng = editor.dom.createRng();\n      rng.setStart(pos.container(), pos.offset());\n      rng.setEnd(pos.container(), pos.offset());\n      editor.selection.setRng(rng);\n    };\n    var setSelected = function (state, elm) {\n      if (state) {\n        elm.setAttribute('data-mce-selected', 'inline-boundary');\n      } else {\n        elm.removeAttribute('data-mce-selected');\n      }\n    };\n    var renderCaretLocation = function (editor, caret, location) {\n      return renderCaret(caret, location).map(function (pos) {\n        setCaretPosition(editor, pos);\n        return location;\n      });\n    };\n    var findLocation = function (editor, caret, forward) {\n      var rootNode = editor.getBody();\n      var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var location = findLocation$1(forward, isInlineTarget$1, rootNode, from);\n      return location.bind(function (location) {\n        return renderCaretLocation(editor, caret, location);\n      });\n    };\n    var toggleInlines = function (isInlineTarget, dom, elms) {\n      var inlineBoundaries = map$3(descendants(SugarElement.fromDom(dom.getRoot()), '*[data-mce-selected=\"inline-boundary\"]'), function (e) {\n        return e.dom;\n      });\n      var selectedInlines = filter$4(inlineBoundaries, isInlineTarget);\n      var targetInlines = filter$4(elms, isInlineTarget);\n      each$k(difference(selectedInlines, targetInlines), curry(setSelected, false));\n      each$k(difference(targetInlines, selectedInlines), curry(setSelected, true));\n    };\n    var safeRemoveCaretContainer = function (editor, caret) {\n      if (editor.selection.isCollapsed() && editor.composing !== true && caret.get()) {\n        var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (CaretPosition.isTextPosition(pos) && isAtZwsp(pos) === false) {\n          setCaretPosition(editor, removeAndReposition(caret.get(), pos));\n          caret.set(null);\n        }\n      }\n    };\n    var renderInsideInlineCaret = function (isInlineTarget, editor, caret, elms) {\n      if (editor.selection.isCollapsed()) {\n        var inlines = filter$4(elms, isInlineTarget);\n        each$k(inlines, function (_inline) {\n          var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n          readLocation(isInlineTarget, editor.getBody(), pos).bind(function (location) {\n            return renderCaretLocation(editor, caret, location);\n          });\n        });\n      }\n    };\n    var move$2 = function (editor, caret, forward) {\n      return isInlineBoundariesEnabled(editor) ? findLocation(editor, caret, forward).isSome() : false;\n    };\n    var moveWord = function (forward, editor, _caret) {\n      return isInlineBoundariesEnabled(editor) ? moveByWord(forward, editor) : false;\n    };\n    var setupSelectedState = function (editor) {\n      var caret = Cell(null);\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.on('NodeChange', function (e) {\n        if (isInlineBoundariesEnabled(editor) && !(Env.browser.isIE() && e.initial)) {\n          toggleInlines(isInlineTarget$1, editor.dom, e.parents);\n          safeRemoveCaretContainer(editor, caret);\n          renderInsideInlineCaret(isInlineTarget$1, editor, caret, e.parents);\n        }\n      });\n      return caret;\n    };\n    var moveNextWord = curry(moveWord, true);\n    var movePrevWord = curry(moveWord, false);\n    var moveToLineEndPoint$2 = function (editor, forward, caret) {\n      if (isInlineBoundariesEnabled(editor)) {\n        var linePoint = getLineEndPoint(editor, forward).getOrThunk(function () {\n          var rng = editor.selection.getRng();\n          return forward ? CaretPosition.fromRangeEnd(rng) : CaretPosition.fromRangeStart(rng);\n        });\n        return readLocation(curry(isInlineTarget, editor), editor.getBody(), linePoint).exists(function (loc) {\n          var outsideLoc = outside(loc);\n          return renderCaret(caret, outsideLoc).exists(function (pos) {\n            setCaretPosition(editor, pos);\n            return true;\n          });\n        });\n      } else {\n        return false;\n      }\n    };\n\n    var rangeFromPositions = function (from, to) {\n      var range = document.createRange();\n      range.setStart(from.container(), from.offset());\n      range.setEnd(to.container(), to.offset());\n      return range;\n    };\n    var hasOnlyTwoOrLessPositionsLeft = function (elm) {\n      return lift2(firstPositionIn(elm), lastPositionIn(elm), function (firstPos, lastPos) {\n        var normalizedFirstPos = normalizePosition(true, firstPos);\n        var normalizedLastPos = normalizePosition(false, lastPos);\n        return nextPosition(elm, normalizedFirstPos).forall(function (pos) {\n          return pos.isEqual(normalizedLastPos);\n        });\n      }).getOr(true);\n    };\n    var setCaretLocation = function (editor, caret) {\n      return function (location) {\n        return renderCaret(caret, location).exists(function (pos) {\n          setCaretPosition(editor, pos);\n          return true;\n        });\n      };\n    };\n    var deleteFromTo = function (editor, caret, from, to) {\n      var rootNode = editor.getBody();\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      editor.undoManager.ignore(function () {\n        editor.selection.setRng(rangeFromPositions(from, to));\n        editor.execCommand('Delete');\n        readLocation(isInlineTarget$1, rootNode, CaretPosition.fromRangeStart(editor.selection.getRng())).map(inside).map(setCaretLocation(editor, caret));\n      });\n      editor.nodeChanged();\n    };\n    var rescope = function (rootNode, node) {\n      var parentBlock = getParentBlock$2(node, rootNode);\n      return parentBlock ? parentBlock : rootNode;\n    };\n    var backspaceDeleteCollapsed = function (editor, caret, forward, from) {\n      var rootNode = rescope(editor.getBody(), from.container());\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var fromLocation = readLocation(isInlineTarget$1, rootNode, from);\n      return fromLocation.bind(function (location) {\n        if (forward) {\n          return location.fold(constant(Optional.some(inside(location))), Optional.none, constant(Optional.some(outside(location))), Optional.none);\n        } else {\n          return location.fold(Optional.none, constant(Optional.some(outside(location))), Optional.none, constant(Optional.some(inside(location))));\n        }\n      }).map(setCaretLocation(editor, caret)).getOrThunk(function () {\n        var toPosition = navigate(forward, rootNode, from);\n        var toLocation = toPosition.bind(function (pos) {\n          return readLocation(isInlineTarget$1, rootNode, pos);\n        });\n        return lift2(fromLocation, toLocation, function () {\n          return findRootInline(isInlineTarget$1, rootNode, from).exists(function (elm) {\n            if (hasOnlyTwoOrLessPositionsLeft(elm)) {\n              deleteElement$2(editor, forward, SugarElement.fromDom(elm));\n              return true;\n            } else {\n              return false;\n            }\n          });\n        }).orThunk(function () {\n          return toLocation.bind(function (_) {\n            return toPosition.map(function (to) {\n              if (forward) {\n                deleteFromTo(editor, caret, from, to);\n              } else {\n                deleteFromTo(editor, caret, to, from);\n              }\n              return true;\n            });\n          });\n        }).getOr(false);\n      });\n    };\n    var backspaceDelete$3 = function (editor, caret, forward) {\n      if (editor.selection.isCollapsed() && isInlineBoundariesEnabled(editor)) {\n        var from = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return backspaceDeleteCollapsed(editor, caret, forward, from);\n      }\n      return false;\n    };\n\n    var getParentInlines = function (rootElm, startElm) {\n      var parents = parentsAndSelf(startElm, rootElm);\n      return findIndex$2(parents, isBlock$2).fold(constant(parents), function (index) {\n        return parents.slice(0, index);\n      });\n    };\n    var hasOnlyOneChild = function (elm) {\n      return childNodesCount(elm) === 1;\n    };\n    var deleteLastPosition = function (forward, editor, target, parentInlines) {\n      var isFormatElement$1 = curry(isFormatElement, editor);\n      var formatNodes = map$3(filter$4(parentInlines, isFormatElement$1), function (elm) {\n        return elm.dom;\n      });\n      if (formatNodes.length === 0) {\n        deleteElement$2(editor, forward, target);\n      } else {\n        var pos = replaceWithCaretFormat(target.dom, formatNodes);\n        editor.selection.setRng(pos.toRange());\n      }\n    };\n    var deleteCaret$1 = function (editor, forward) {\n      var rootElm = SugarElement.fromDom(editor.getBody());\n      var startElm = SugarElement.fromDom(editor.selection.getStart());\n      var parentInlines = filter$4(getParentInlines(rootElm, startElm), hasOnlyOneChild);\n      return last$2(parentInlines).exists(function (target) {\n        var fromPos = CaretPosition.fromRangeStart(editor.selection.getRng());\n        if (willDeleteLastPositionInElement(forward, fromPos, target.dom) && !isEmptyCaretFormatElement(target)) {\n          deleteLastPosition(forward, editor, target, parentInlines);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var backspaceDelete$2 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret$1(editor, forward) : false;\n    };\n\n    var deleteElement = function (editor, forward, element) {\n      editor._selectionOverrides.hideFakeCaret();\n      deleteElement$2(editor, forward, SugarElement.fromDom(element));\n      return true;\n    };\n    var deleteCaret = function (editor, forward) {\n      var isNearMedia = forward ? isBeforeMedia : isAfterMedia;\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var fromPos = getNormalizedRangeEndPoint(direction, editor.getBody(), editor.selection.getRng());\n      if (isNearMedia(fromPos)) {\n        return deleteElement(editor, forward, fromPos.getNode(!forward));\n      } else {\n        return Optional.from(normalizePosition(forward, fromPos)).filter(function (pos) {\n          return isNearMedia(pos) && isMoveInsideSameBlock(fromPos, pos);\n        }).exists(function (pos) {\n          return deleteElement(editor, forward, pos.getNode(!forward));\n        });\n      }\n    };\n    var deleteRange = function (editor, forward) {\n      var selectedNode = editor.selection.getNode();\n      return isMedia$2(selectedNode) ? deleteElement(editor, forward, selectedNode) : false;\n    };\n    var backspaceDelete$1 = function (editor, forward) {\n      return editor.selection.isCollapsed() ? deleteCaret(editor, forward) : deleteRange(editor, forward);\n    };\n\n    var isEditable = function (target) {\n      return closest$3(target, function (elm) {\n        return isContentEditableTrue$4(elm.dom) || isContentEditableFalse$b(elm.dom);\n      }).exists(function (elm) {\n        return isContentEditableTrue$4(elm.dom);\n      });\n    };\n    var parseIndentValue = function (value) {\n      var number = parseInt(value, 10);\n      return isNaN(number) ? 0 : number;\n    };\n    var getIndentStyleName = function (useMargin, element) {\n      var indentStyleName = useMargin || isTable$2(element) ? 'margin' : 'padding';\n      var suffix = get$5(element, 'direction') === 'rtl' ? '-right' : '-left';\n      return indentStyleName + suffix;\n    };\n    var indentElement = function (dom, command, useMargin, value, unit, element) {\n      var indentStyleName = getIndentStyleName(useMargin, SugarElement.fromDom(element));\n      if (command === 'outdent') {\n        var styleValue = Math.max(0, parseIndentValue(element.style[indentStyleName]) - value);\n        dom.setStyle(element, indentStyleName, styleValue ? styleValue + unit : '');\n      } else {\n        var styleValue = parseIndentValue(element.style[indentStyleName]) + value + unit;\n        dom.setStyle(element, indentStyleName, styleValue);\n      }\n    };\n    var validateBlocks = function (editor, blocks) {\n      return forall(blocks, function (block) {\n        var indentStyleName = getIndentStyleName(shouldIndentUseMargin(editor), block);\n        var intentValue = getRaw(block, indentStyleName).map(parseIndentValue).getOr(0);\n        var contentEditable = editor.dom.getContentEditable(block.dom);\n        return contentEditable !== 'false' && intentValue > 0;\n      });\n    };\n    var canOutdent = function (editor) {\n      var blocks = getBlocksToIndent(editor);\n      return !editor.mode.isReadOnly() && (blocks.length > 1 || validateBlocks(editor, blocks));\n    };\n    var isListComponent = function (el) {\n      return isList(el) || isListItem(el);\n    };\n    var parentIsListComponent = function (el) {\n      return parent(el).exists(isListComponent);\n    };\n    var getBlocksToIndent = function (editor) {\n      return filter$4(fromDom$1(editor.selection.getSelectedBlocks()), function (el) {\n        return !isListComponent(el) && !parentIsListComponent(el) && isEditable(el);\n      });\n    };\n    var handle = function (editor, command) {\n      var dom = editor.dom, selection = editor.selection, formatter = editor.formatter;\n      var indentation = getIndentation(editor);\n      var indentUnit = /[a-z%]+$/i.exec(indentation)[0];\n      var indentValue = parseInt(indentation, 10);\n      var useMargin = shouldIndentUseMargin(editor);\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!editor.queryCommandState('InsertUnorderedList') && !editor.queryCommandState('InsertOrderedList')) {\n        if (forcedRootBlock === '' && !dom.getParent(selection.getNode(), dom.isBlock)) {\n          formatter.apply('div');\n        }\n      }\n      each$k(getBlocksToIndent(editor), function (block) {\n        indentElement(dom, command, useMargin, indentValue, indentUnit, block.dom);\n      });\n    };\n\n    var backspaceDelete = function (editor, _forward) {\n      if (editor.selection.isCollapsed() && canOutdent(editor)) {\n        var dom = editor.dom;\n        var rng = editor.selection.getRng();\n        var pos = CaretPosition.fromRangeStart(rng);\n        var block = dom.getParent(rng.startContainer, dom.isBlock);\n        if (block !== null && isAtStartOfBlock(SugarElement.fromDom(block), pos)) {\n          handle(editor, 'outdent');\n          return true;\n        }\n      }\n      return false;\n    };\n\n    var nativeCommand = function (editor, command) {\n      editor.getDoc().execCommand(command, false, null);\n    };\n    var deleteCommand = function (editor, caret) {\n      if (backspaceDelete(editor)) {\n        return;\n      } else if (backspaceDelete$5(editor, false)) {\n        return;\n      } else if (backspaceDelete$6(editor, false)) {\n        return;\n      } else if (backspaceDelete$3(editor, caret, false)) {\n        return;\n      } else if (backspaceDelete$8(editor, false)) {\n        return;\n      } else if (backspaceDelete$9(editor)) {\n        return;\n      } else if (backspaceDelete$4(editor, false)) {\n        return;\n      } else if (backspaceDelete$1(editor, false)) {\n        return;\n      } else if (backspaceDelete$7(editor)) {\n        return;\n      } else if (backspaceDelete$2(editor, false)) {\n        return;\n      } else {\n        nativeCommand(editor, 'Delete');\n        paddEmptyBody(editor);\n      }\n    };\n    var forwardDeleteCommand = function (editor, caret) {\n      if (backspaceDelete$5(editor, true)) {\n        return;\n      } else if (backspaceDelete$6(editor, true)) {\n        return;\n      } else if (backspaceDelete$3(editor, caret, true)) {\n        return;\n      } else if (backspaceDelete$8(editor, true)) {\n        return;\n      } else if (backspaceDelete$9(editor)) {\n        return;\n      } else if (backspaceDelete$4(editor, true)) {\n        return;\n      } else if (backspaceDelete$1(editor, true)) {\n        return;\n      } else if (backspaceDelete$7(editor)) {\n        return;\n      } else if (backspaceDelete$2(editor, true)) {\n        return;\n      } else {\n        nativeCommand(editor, 'ForwardDelete');\n      }\n    };\n    var setup$f = function (editor, caret) {\n      editor.addCommand('delete', function () {\n        deleteCommand(editor, caret);\n      });\n      editor.addCommand('forwardDelete', function () {\n        forwardDeleteCommand(editor, caret);\n      });\n    };\n\n    var SIGNIFICANT_MOVE = 5;\n    var LONGPRESS_DELAY = 400;\n    var getTouch = function (event) {\n      if (event.touches === undefined || event.touches.length !== 1) {\n        return Optional.none();\n      }\n      return Optional.some(event.touches[0]);\n    };\n    var isFarEnough = function (touch, data) {\n      var distX = Math.abs(touch.clientX - data.x);\n      var distY = Math.abs(touch.clientY - data.y);\n      return distX > SIGNIFICANT_MOVE || distY > SIGNIFICANT_MOVE;\n    };\n    var setup$e = function (editor) {\n      var startData = value();\n      var longpressFired = Cell(false);\n      var debounceLongpress = last(function (e) {\n        editor.fire('longpress', __assign(__assign({}, e), { type: 'longpress' }));\n        longpressFired.set(true);\n      }, LONGPRESS_DELAY);\n      editor.on('touchstart', function (e) {\n        getTouch(e).each(function (touch) {\n          debounceLongpress.cancel();\n          var data = {\n            x: touch.clientX,\n            y: touch.clientY,\n            target: e.target\n          };\n          debounceLongpress.throttle(e);\n          longpressFired.set(false);\n          startData.set(data);\n        });\n      }, true);\n      editor.on('touchmove', function (e) {\n        debounceLongpress.cancel();\n        getTouch(e).each(function (touch) {\n          startData.on(function (data) {\n            if (isFarEnough(touch, data)) {\n              startData.clear();\n              longpressFired.set(false);\n              editor.fire('longpresscancel');\n            }\n          });\n        });\n      }, true);\n      editor.on('touchend touchcancel', function (e) {\n        debounceLongpress.cancel();\n        if (e.type === 'touchcancel') {\n          return;\n        }\n        startData.get().filter(function (data) {\n          return data.target.isEqualNode(e.target);\n        }).each(function () {\n          if (longpressFired.get()) {\n            e.preventDefault();\n          } else {\n            editor.fire('tap', __assign(__assign({}, e), { type: 'tap' }));\n          }\n        });\n      }, true);\n    };\n\n    var isBlockElement = function (blockElements, node) {\n      return has$2(blockElements, node.nodeName);\n    };\n    var isValidTarget = function (blockElements, node) {\n      if (isText$7(node)) {\n        return true;\n      } else if (isElement$5(node)) {\n        return !isBlockElement(blockElements, node) && !isBookmarkNode$1(node);\n      } else {\n        return false;\n      }\n    };\n    var hasBlockParent = function (blockElements, root, node) {\n      return exists(parents(SugarElement.fromDom(node), SugarElement.fromDom(root)), function (elm) {\n        return isBlockElement(blockElements, elm.dom);\n      });\n    };\n    var shouldRemoveTextNode = function (blockElements, node) {\n      if (isText$7(node)) {\n        if (node.nodeValue.length === 0) {\n          return true;\n        } else if (/^\\s+$/.test(node.nodeValue) && (!node.nextSibling || isBlockElement(blockElements, node.nextSibling))) {\n          return true;\n        }\n      }\n      return false;\n    };\n    var addRootBlocks = function (editor) {\n      var dom = editor.dom, selection = editor.selection;\n      var schema = editor.schema, blockElements = schema.getBlockElements();\n      var node = selection.getStart();\n      var rootNode = editor.getBody();\n      var rootBlockNode, tempNode, wrapped;\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (!node || !isElement$5(node) || !forcedRootBlock) {\n        return;\n      }\n      var rootNodeName = rootNode.nodeName.toLowerCase();\n      if (!schema.isValidChild(rootNodeName, forcedRootBlock.toLowerCase()) || hasBlockParent(blockElements, rootNode, node)) {\n        return;\n      }\n      var rng = selection.getRng();\n      var startContainer = rng.startContainer;\n      var startOffset = rng.startOffset;\n      var endContainer = rng.endContainer;\n      var endOffset = rng.endOffset;\n      var restoreSelection = hasFocus(editor);\n      node = rootNode.firstChild;\n      while (node) {\n        if (isValidTarget(blockElements, node)) {\n          if (shouldRemoveTextNode(blockElements, node)) {\n            tempNode = node;\n            node = node.nextSibling;\n            dom.remove(tempNode);\n            continue;\n          }\n          if (!rootBlockNode) {\n            rootBlockNode = dom.create(forcedRootBlock, getForcedRootBlockAttrs(editor));\n            node.parentNode.insertBefore(rootBlockNode, node);\n            wrapped = true;\n          }\n          tempNode = node;\n          node = node.nextSibling;\n          rootBlockNode.appendChild(tempNode);\n        } else {\n          rootBlockNode = null;\n          node = node.nextSibling;\n        }\n      }\n      if (wrapped && restoreSelection) {\n        rng.setStart(startContainer, startOffset);\n        rng.setEnd(endContainer, endOffset);\n        selection.setRng(rng);\n        editor.nodeChanged();\n      }\n    };\n    var setup$d = function (editor) {\n      if (getForcedRootBlock(editor)) {\n        editor.on('NodeChange', curry(addRootBlocks, editor));\n      }\n    };\n\n    var findBlockCaretContainer = function (editor) {\n      return descendant(SugarElement.fromDom(editor.getBody()), '*[data-mce-caret]').map(function (elm) {\n        return elm.dom;\n      }).getOrNull();\n    };\n    var removeIeControlRect = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var showBlockCaretContainer = function (editor, blockCaretContainer) {\n      if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n        showCaretContainerBlock(blockCaretContainer);\n        removeIeControlRect(editor);\n        editor.selection.scrollIntoView(blockCaretContainer);\n      }\n    };\n    var handleBlockContainer = function (editor, e) {\n      var blockCaretContainer = findBlockCaretContainer(editor);\n      if (!blockCaretContainer) {\n        return;\n      }\n      if (e.type === 'compositionstart') {\n        e.preventDefault();\n        e.stopPropagation();\n        showBlockCaretContainer(editor, blockCaretContainer);\n        return;\n      }\n      if (hasContent(blockCaretContainer)) {\n        showBlockCaretContainer(editor, blockCaretContainer);\n        editor.undoManager.add();\n      }\n    };\n    var setup$c = function (editor) {\n      editor.on('keyup compositionstart', curry(handleBlockContainer, editor));\n    };\n\n    var isContentEditableFalse$2 = isContentEditableFalse$b;\n    var moveToCeFalseHorizontally = function (direction, editor, range) {\n      return moveHorizontally(editor, direction, range, isBeforeContentEditableFalse, isAfterContentEditableFalse, isContentEditableFalse$2);\n    };\n    var moveToCeFalseVertically = function (direction, editor, range) {\n      var isBefore = function (caretPosition) {\n        return isBeforeContentEditableFalse(caretPosition) || isBeforeTable(caretPosition);\n      };\n      var isAfter = function (caretPosition) {\n        return isAfterContentEditableFalse(caretPosition) || isAfterTable(caretPosition);\n      };\n      return moveVertically(editor, direction, range, isBefore, isAfter, isContentEditableFalse$2);\n    };\n    var createTextBlock = function (editor) {\n      var textBlock = editor.dom.create(getForcedRootBlock(editor));\n      if (!Env.ie || Env.ie >= 11) {\n        textBlock.innerHTML = '<br data-mce-bogus=\"1\">';\n      }\n      return textBlock;\n    };\n    var exitPreBlock = function (editor, direction, range) {\n      var caretWalker = CaretWalker(editor.getBody());\n      var getVisualCaretPosition$1 = curry(getVisualCaretPosition, direction === 1 ? caretWalker.next : caretWalker.prev);\n      if (range.collapsed && hasForcedRootBlock(editor)) {\n        var pre = editor.dom.getParent(range.startContainer, 'PRE');\n        if (!pre) {\n          return;\n        }\n        var caretPos = getVisualCaretPosition$1(CaretPosition.fromRangeStart(range));\n        if (!caretPos) {\n          var newBlock = createTextBlock(editor);\n          if (direction === 1) {\n            editor.$(pre).after(newBlock);\n          } else {\n            editor.$(pre).before(newBlock);\n          }\n          editor.selection.select(newBlock, true);\n          editor.selection.collapse();\n        }\n      }\n    };\n    var getHorizontalRange = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveToCeFalseHorizontally(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var getVerticalRange = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveToCeFalseVertically(direction, editor, range).orThunk(function () {\n        exitPreBlock(editor, direction, range);\n        return Optional.none();\n      });\n    };\n    var moveH$2 = function (editor, forward) {\n      return getHorizontalRange(editor, forward).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV$3 = function (editor, down) {\n      return getVerticalRange(editor, down).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint$1 = function (editor, forward) {\n      var isCefPosition = forward ? isAfterContentEditableFalse : isBeforeContentEditableFalse;\n      return moveToLineEndPoint$3(editor, forward, isCefPosition);\n    };\n\n    var isTarget = function (node) {\n      return contains$3(['figcaption'], name(node));\n    };\n    var rangeBefore = function (target) {\n      var rng = document.createRange();\n      rng.setStartBefore(target.dom);\n      rng.setEndBefore(target.dom);\n      return rng;\n    };\n    var insertElement = function (root, elm, forward) {\n      if (forward) {\n        append$1(root, elm);\n      } else {\n        prepend(root, elm);\n      }\n    };\n    var insertBr = function (root, forward) {\n      var br = SugarElement.fromTag('br');\n      insertElement(root, br, forward);\n      return rangeBefore(br);\n    };\n    var insertBlock = function (root, forward, blockName, attrs) {\n      var block = SugarElement.fromTag(blockName);\n      var br = SugarElement.fromTag('br');\n      setAll$1(block, attrs);\n      append$1(block, br);\n      insertElement(root, block, forward);\n      return rangeBefore(br);\n    };\n    var insertEmptyLine = function (root, rootBlockName, attrs, forward) {\n      if (rootBlockName === '') {\n        return insertBr(root, forward);\n      } else {\n        return insertBlock(root, forward, rootBlockName, attrs);\n      }\n    };\n    var getClosestTargetBlock = function (pos, root) {\n      var isRoot = curry(eq, root);\n      return closest$3(SugarElement.fromDom(pos.container()), isBlock$2, isRoot).filter(isTarget);\n    };\n    var isAtFirstOrLastLine = function (root, forward, pos) {\n      return forward ? isAtLastLine(root.dom, pos) : isAtFirstLine(root.dom, pos);\n    };\n    var moveCaretToNewEmptyLine = function (editor, forward) {\n      var root = SugarElement.fromDom(editor.getBody());\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var rootBlock = getForcedRootBlock(editor);\n      var rootBlockAttrs = getForcedRootBlockAttrs(editor);\n      return getClosestTargetBlock(pos, root).exists(function () {\n        if (isAtFirstOrLastLine(root, forward, pos)) {\n          var rng = insertEmptyLine(root, rootBlock, rootBlockAttrs, forward);\n          editor.selection.setRng(rng);\n          return true;\n        } else {\n          return false;\n        }\n      });\n    };\n    var moveV$2 = function (editor, forward) {\n      if (editor.selection.isCollapsed()) {\n        return moveCaretToNewEmptyLine(editor, forward);\n      } else {\n        return false;\n      }\n    };\n\n    var defaultPatterns = function (patterns) {\n      return map$3(patterns, function (pattern) {\n        return __assign({\n          shiftKey: false,\n          altKey: false,\n          ctrlKey: false,\n          metaKey: false,\n          keyCode: 0,\n          action: noop\n        }, pattern);\n      });\n    };\n    var matchesEvent = function (pattern, evt) {\n      return evt.keyCode === pattern.keyCode && evt.shiftKey === pattern.shiftKey && evt.altKey === pattern.altKey && evt.ctrlKey === pattern.ctrlKey && evt.metaKey === pattern.metaKey;\n    };\n    var match$1 = function (patterns, evt) {\n      return bind(defaultPatterns(patterns), function (pattern) {\n        return matchesEvent(pattern, evt) ? [pattern] : [];\n      });\n    };\n    var action = function (f) {\n      var x = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        x[_i - 1] = arguments[_i];\n      }\n      return function () {\n        return f.apply(null, x);\n      };\n    };\n    var execute = function (patterns, evt) {\n      return find$3(match$1(patterns, evt), function (pattern) {\n        return pattern.action();\n      });\n    };\n\n    var moveH$1 = function (editor, forward) {\n      var direction = forward ? HDirection.Forwards : HDirection.Backwards;\n      var range = editor.selection.getRng();\n      return moveHorizontally(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia$2).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveV$1 = function (editor, down) {\n      var direction = down ? 1 : -1;\n      var range = editor.selection.getRng();\n      return moveVertically(editor, direction, range, isBeforeMedia, isAfterMedia, isMedia$2).exists(function (newRange) {\n        moveToRange(editor, newRange);\n        return true;\n      });\n    };\n    var moveToLineEndPoint = function (editor, forward) {\n      var isNearMedia = forward ? isAfterMedia : isBeforeMedia;\n      return moveToLineEndPoint$3(editor, forward, isNearMedia);\n    };\n\n    var deflate = function (rect, delta) {\n      return {\n        left: rect.left - delta,\n        top: rect.top - delta,\n        right: rect.right + delta * 2,\n        bottom: rect.bottom + delta * 2,\n        width: rect.width + delta,\n        height: rect.height + delta\n      };\n    };\n    var getCorners = function (getYAxisValue, tds) {\n      return bind(tds, function (td) {\n        var rect = deflate(clone(td.getBoundingClientRect()), -1);\n        return [\n          {\n            x: rect.left,\n            y: getYAxisValue(rect),\n            cell: td\n          },\n          {\n            x: rect.right,\n            y: getYAxisValue(rect),\n            cell: td\n          }\n        ];\n      });\n    };\n    var findClosestCorner = function (corners, x, y) {\n      return foldl(corners, function (acc, newCorner) {\n        return acc.fold(function () {\n          return Optional.some(newCorner);\n        }, function (oldCorner) {\n          var oldDist = Math.sqrt(Math.abs(oldCorner.x - x) + Math.abs(oldCorner.y - y));\n          var newDist = Math.sqrt(Math.abs(newCorner.x - x) + Math.abs(newCorner.y - y));\n          return Optional.some(newDist < oldDist ? newCorner : oldCorner);\n        });\n      }, Optional.none());\n    };\n    var getClosestCell = function (getYAxisValue, isTargetCorner, table, x, y) {\n      var cells = descendants(SugarElement.fromDom(table), 'td,th,caption').map(function (e) {\n        return e.dom;\n      });\n      var corners = filter$4(getCorners(getYAxisValue, cells), function (corner) {\n        return isTargetCorner(corner, y);\n      });\n      return findClosestCorner(corners, x, y).map(function (corner) {\n        return corner.cell;\n      });\n    };\n    var getBottomValue = function (rect) {\n      return rect.bottom;\n    };\n    var getTopValue = function (rect) {\n      return rect.top;\n    };\n    var isAbove = function (corner, y) {\n      return corner.y < y;\n    };\n    var isBelow = function (corner, y) {\n      return corner.y > y;\n    };\n    var getClosestCellAbove = curry(getClosestCell, getBottomValue, isAbove);\n    var getClosestCellBelow = curry(getClosestCell, getTopValue, isBelow);\n    var findClosestPositionInAboveCell = function (table, pos) {\n      return head(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellAbove(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getLastLinePositions(cell), pos);\n      });\n    };\n    var findClosestPositionInBelowCell = function (table, pos) {\n      return last$2(pos.getClientRects()).bind(function (rect) {\n        return getClosestCellBelow(table, rect.left, rect.top);\n      }).bind(function (cell) {\n        return findClosestHorizontalPosition(getFirstLinePositions(cell), pos);\n      });\n    };\n\n    var hasNextBreak = function (getPositionsUntil, scope, lineInfo) {\n      return lineInfo.breakAt.exists(function (breakPos) {\n        return getPositionsUntil(scope, breakPos).breakAt.isSome();\n      });\n    };\n    var startsWithWrapBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Wrap && lineInfo.positions.length === 0;\n    };\n    var startsWithBrBreak = function (lineInfo) {\n      return lineInfo.breakType === BreakType.Br && lineInfo.positions.length === 1;\n    };\n    var isAtTableCellLine = function (getPositionsUntil, scope, pos) {\n      var lineInfo = getPositionsUntil(scope, pos);\n      if (startsWithWrapBreak(lineInfo) || !isBr$5(pos.getNode()) && startsWithBrBreak(lineInfo)) {\n        return !hasNextBreak(getPositionsUntil, scope, lineInfo);\n      } else {\n        return lineInfo.breakAt.isNone();\n      }\n    };\n    var isAtFirstTableCellLine = curry(isAtTableCellLine, getPositionsUntilPreviousLine);\n    var isAtLastTableCellLine = curry(isAtTableCellLine, getPositionsUntilNextLine);\n    var isCaretAtStartOrEndOfTable = function (forward, rng, table) {\n      var caretPos = CaretPosition.fromRangeStart(rng);\n      return positionIn(!forward, table).exists(function (pos) {\n        return pos.isEqual(caretPos);\n      });\n    };\n    var navigateHorizontally = function (editor, forward, table, _td) {\n      var rng = editor.selection.getRng();\n      var direction = forward ? 1 : -1;\n      if (isFakeCaretTableBrowser() && isCaretAtStartOrEndOfTable(forward, rng, table)) {\n        showCaret(direction, editor, table, !forward, false).each(function (newRng) {\n          moveToRange(editor, newRng);\n        });\n        return true;\n      }\n      return false;\n    };\n    var getClosestAbovePosition = function (root, table, start) {\n      return findClosestPositionInAboveCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsAbove(root, CaretPosition.before(table)), rect.left);\n        });\n      }).getOr(CaretPosition.before(table));\n    };\n    var getClosestBelowPosition = function (root, table, start) {\n      return findClosestPositionInBelowCell(table, start).orThunk(function () {\n        return head(start.getClientRects()).bind(function (rect) {\n          return findClosestHorizontalPositionFromPoint(getPositionsBelow(root, CaretPosition.after(table)), rect.left);\n        });\n      }).getOr(CaretPosition.after(table));\n    };\n    var getTable = function (previous, pos) {\n      var node = pos.getNode(previous);\n      return isElement$5(node) && node.nodeName === 'TABLE' ? Optional.some(node) : Optional.none();\n    };\n    var renderBlock = function (down, editor, table, pos) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      if (forcedRootBlock) {\n        editor.undoManager.transact(function () {\n          var element = SugarElement.fromTag(forcedRootBlock);\n          setAll$1(element, getForcedRootBlockAttrs(editor));\n          append$1(element, SugarElement.fromTag('br'));\n          if (down) {\n            after$3(SugarElement.fromDom(table), element);\n          } else {\n            before$4(SugarElement.fromDom(table), element);\n          }\n          var rng = editor.dom.createRng();\n          rng.setStart(element.dom, 0);\n          rng.setEnd(element.dom, 0);\n          moveToRange(editor, rng);\n        });\n      } else {\n        moveToRange(editor, pos.toRange());\n      }\n    };\n    var moveCaret = function (editor, down, pos) {\n      var table = down ? getTable(true, pos) : getTable(false, pos);\n      var last = down === false;\n      table.fold(function () {\n        return moveToRange(editor, pos.toRange());\n      }, function (table) {\n        return positionIn(last, editor.getBody()).filter(function (lastPos) {\n          return lastPos.isEqual(pos);\n        }).fold(function () {\n          return moveToRange(editor, pos.toRange());\n        }, function (_) {\n          return renderBlock(down, editor, table, pos);\n        });\n      });\n    };\n    var navigateVertically = function (editor, down, table, td) {\n      var rng = editor.selection.getRng();\n      var pos = CaretPosition.fromRangeStart(rng);\n      var root = editor.getBody();\n      if (!down && isAtFirstTableCellLine(td, pos)) {\n        var newPos = getClosestAbovePosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else if (down && isAtLastTableCellLine(td, pos)) {\n        var newPos = getClosestBelowPosition(root, table, pos);\n        moveCaret(editor, down, newPos);\n        return true;\n      } else {\n        return false;\n      }\n    };\n    var move$1 = function (editor, forward, mover) {\n      return Optional.from(editor.dom.getParent(editor.selection.getNode(), 'td,th')).bind(function (td) {\n        return Optional.from(editor.dom.getParent(td, 'table')).map(function (table) {\n          return mover(editor, forward, table, td);\n        });\n      }).getOr(false);\n    };\n    var moveH = function (editor, forward) {\n      return move$1(editor, forward, navigateHorizontally);\n    };\n    var moveV = function (editor, forward) {\n      return move$1(editor, forward, navigateVertically);\n    };\n\n    var executeKeydownOverride$3 = function (editor, caret, evt) {\n      var os = detect().os;\n      execute([\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$2, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$2, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$3, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$3, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(moveH$1, editor, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(moveH$1, editor, false)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$1, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$1, editor, true)\n        },\n        {\n          keyCode: VK.RIGHT,\n          action: action(move$2, editor, caret, true)\n        },\n        {\n          keyCode: VK.LEFT,\n          action: action(move$2, editor, caret, false)\n        },\n        {\n          keyCode: VK.RIGHT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(moveNextWord, editor, caret)\n        },\n        {\n          keyCode: VK.LEFT,\n          ctrlKey: !os.isOSX(),\n          altKey: os.isOSX(),\n          action: action(movePrevWord, editor, caret)\n        },\n        {\n          keyCode: VK.UP,\n          action: action(moveV$2, editor, false)\n        },\n        {\n          keyCode: VK.DOWN,\n          action: action(moveV$2, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$b = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$3(editor, caret, evt);\n        }\n      });\n    };\n\n    var executeKeydownOverride$2 = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete, editor, false)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$5, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$5, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$6, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$6, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$3, editor, caret, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$3, editor, caret, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$9, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$9, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$4, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$4, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$1, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$1, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$7, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$7, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$8, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$8, editor, true)\n        },\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(backspaceDelete$2, editor, false)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(backspaceDelete$2, editor, true)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var executeKeyupOverride = function (editor, evt) {\n      execute([\n        {\n          keyCode: VK.BACKSPACE,\n          action: action(paddEmptyElement, editor)\n        },\n        {\n          keyCode: VK.DELETE,\n          action: action(paddEmptyElement, editor)\n        }\n      ], evt);\n    };\n    var setup$a = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$2(editor, caret, evt);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupOverride(editor, evt);\n        }\n      });\n    };\n\n    var firstNonWhiteSpaceNodeSibling = function (node) {\n      while (node) {\n        if (node.nodeType === 1 || node.nodeType === 3 && node.data && /[\\r\\n\\s]/.test(node.data)) {\n          return node;\n        }\n        node = node.nextSibling;\n      }\n    };\n    var moveToCaretPosition = function (editor, root) {\n      var node, lastNode = root;\n      var dom = editor.dom;\n      var moveCaretBeforeOnEnterElementsMap = editor.schema.getMoveCaretBeforeOnEnterElements();\n      if (!root) {\n        return;\n      }\n      if (/^(LI|DT|DD)$/.test(root.nodeName)) {\n        var firstChild = firstNonWhiteSpaceNodeSibling(root.firstChild);\n        if (firstChild && /^(UL|OL|DL)$/.test(firstChild.nodeName)) {\n          root.insertBefore(dom.doc.createTextNode(nbsp), root.firstChild);\n        }\n      }\n      var rng = dom.createRng();\n      root.normalize();\n      if (root.hasChildNodes()) {\n        var walker = new DomTreeWalker(root, root);\n        while (node = walker.current()) {\n          if (isText$7(node)) {\n            rng.setStart(node, 0);\n            rng.setEnd(node, 0);\n            break;\n          }\n          if (moveCaretBeforeOnEnterElementsMap[node.nodeName.toLowerCase()]) {\n            rng.setStartBefore(node);\n            rng.setEndBefore(node);\n            break;\n          }\n          lastNode = node;\n          node = walker.next();\n        }\n        if (!node) {\n          rng.setStart(lastNode, 0);\n          rng.setEnd(lastNode, 0);\n        }\n      } else {\n        if (isBr$5(root)) {\n          if (root.nextSibling && dom.isBlock(root.nextSibling)) {\n            rng.setStartBefore(root);\n            rng.setEndBefore(root);\n          } else {\n            rng.setStartAfter(root);\n            rng.setEndAfter(root);\n          }\n        } else {\n          rng.setStart(root, 0);\n          rng.setEnd(root, 0);\n        }\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var getEditableRoot$1 = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var getParentBlock = function (editor) {\n      return Optional.from(editor.dom.getParent(editor.selection.getStart(true), editor.dom.isBlock));\n    };\n    var getParentBlockName = function (editor) {\n      return getParentBlock(editor).fold(constant(''), function (parentBlock) {\n        return parentBlock.nodeName.toUpperCase();\n      });\n    };\n    var isListItemParentBlock = function (editor) {\n      return getParentBlock(editor).filter(function (elm) {\n        return isListItem(SugarElement.fromDom(elm));\n      }).isSome();\n    };\n\n    var hasFirstChild = function (elm, name) {\n      return elm.firstChild && elm.firstChild.nodeName === name;\n    };\n    var isFirstChild = function (elm) {\n      var _a;\n      return ((_a = elm.parentNode) === null || _a === void 0 ? void 0 : _a.firstChild) === elm;\n    };\n    var hasParent = function (elm, parentName) {\n      return elm && elm.parentNode && elm.parentNode.nodeName === parentName;\n    };\n    var isListBlock = function (elm) {\n      return elm && /^(OL|UL|LI)$/.test(elm.nodeName);\n    };\n    var isNestedList = function (elm) {\n      return isListBlock(elm) && isListBlock(elm.parentNode);\n    };\n    var getContainerBlock = function (containerBlock) {\n      var containerBlockParent = containerBlock.parentNode;\n      if (/^(LI|DT|DD)$/.test(containerBlockParent.nodeName)) {\n        return containerBlockParent;\n      }\n      return containerBlock;\n    };\n    var isFirstOrLastLi = function (containerBlock, parentBlock, first) {\n      var node = containerBlock[first ? 'firstChild' : 'lastChild'];\n      while (node) {\n        if (isElement$5(node)) {\n          break;\n        }\n        node = node[first ? 'nextSibling' : 'previousSibling'];\n      }\n      return node === parentBlock;\n    };\n    var insert$3 = function (editor, createNewBlock, containerBlock, parentBlock, newBlockName) {\n      var dom = editor.dom;\n      var rng = editor.selection.getRng();\n      if (containerBlock === editor.getBody()) {\n        return;\n      }\n      if (isNestedList(containerBlock)) {\n        newBlockName = 'LI';\n      }\n      var newBlock = newBlockName ? createNewBlock(newBlockName) : dom.create('BR');\n      if (isFirstOrLastLi(containerBlock, parentBlock, true) && isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        if (hasParent(containerBlock, 'LI')) {\n          var containerBlockParent = getContainerBlock(containerBlock);\n          dom.insertAfter(newBlock, containerBlockParent);\n          if (isFirstChild(containerBlock)) {\n            dom.remove(containerBlockParent);\n          } else {\n            dom.remove(containerBlock);\n          }\n        } else {\n          dom.replace(newBlock, containerBlock);\n        }\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, true)) {\n        if (hasParent(containerBlock, 'LI')) {\n          dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n          newBlock.appendChild(dom.doc.createTextNode(' '));\n          newBlock.appendChild(containerBlock);\n        } else {\n          containerBlock.parentNode.insertBefore(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      } else if (isFirstOrLastLi(containerBlock, parentBlock, false)) {\n        dom.insertAfter(newBlock, getContainerBlock(containerBlock));\n        dom.remove(parentBlock);\n      } else {\n        containerBlock = getContainerBlock(containerBlock);\n        var tmpRng = rng.cloneRange();\n        tmpRng.setStartAfter(parentBlock);\n        tmpRng.setEndAfter(containerBlock);\n        var fragment = tmpRng.extractContents();\n        if (newBlockName === 'LI' && hasFirstChild(fragment, 'LI')) {\n          newBlock = fragment.firstChild;\n          dom.insertAfter(fragment, containerBlock);\n        } else {\n          dom.insertAfter(fragment, containerBlock);\n          dom.insertAfter(newBlock, containerBlock);\n        }\n        dom.remove(parentBlock);\n      }\n      moveToCaretPosition(editor, newBlock);\n    };\n\n    var trimZwsp = function (fragment) {\n      each$k(descendants$1(SugarElement.fromDom(fragment), isText$8), function (text) {\n        var rawNode = text.dom;\n        rawNode.nodeValue = trim$2(rawNode.nodeValue);\n      });\n    };\n    var isEmptyAnchor = function (dom, elm) {\n      return elm && elm.nodeName === 'A' && dom.isEmpty(elm);\n    };\n    var isTableCell = function (node) {\n      return node && /^(TD|TH|CAPTION)$/.test(node.nodeName);\n    };\n    var emptyBlock = function (elm) {\n      elm.innerHTML = '<br data-mce-bogus=\"1\">';\n    };\n    var containerAndSiblingName = function (container, nodeName) {\n      return container.nodeName === nodeName || container.previousSibling && container.previousSibling.nodeName === nodeName;\n    };\n    var canSplitBlock = function (dom, node) {\n      return node && dom.isBlock(node) && !/^(TD|TH|CAPTION|FORM)$/.test(node.nodeName) && !/^(fixed|absolute)/i.test(node.style.position) && dom.getContentEditable(node) !== 'true';\n    };\n    var trimInlineElementsOnLeftSideOfBlock = function (dom, nonEmptyElementsMap, block) {\n      var node = block;\n      var firstChilds = [];\n      var i;\n      if (!node) {\n        return;\n      }\n      while (node = node.firstChild) {\n        if (dom.isBlock(node)) {\n          return;\n        }\n        if (isElement$5(node) && !nonEmptyElementsMap[node.nodeName.toLowerCase()]) {\n          firstChilds.push(node);\n        }\n      }\n      i = firstChilds.length;\n      while (i--) {\n        node = firstChilds[i];\n        if (!node.hasChildNodes() || node.firstChild === node.lastChild && node.firstChild.nodeValue === '') {\n          dom.remove(node);\n        } else {\n          if (isEmptyAnchor(dom, node)) {\n            dom.remove(node);\n          }\n        }\n      }\n    };\n    var normalizeZwspOffset = function (start, container, offset) {\n      if (isText$7(container) === false) {\n        return offset;\n      } else if (start) {\n        return offset === 1 && container.data.charAt(offset - 1) === ZWSP$1 ? 0 : offset;\n      } else {\n        return offset === container.data.length - 1 && container.data.charAt(offset) === ZWSP$1 ? container.data.length : offset;\n      }\n    };\n    var includeZwspInRange = function (rng) {\n      var newRng = rng.cloneRange();\n      newRng.setStart(rng.startContainer, normalizeZwspOffset(true, rng.startContainer, rng.startOffset));\n      newRng.setEnd(rng.endContainer, normalizeZwspOffset(false, rng.endContainer, rng.endOffset));\n      return newRng;\n    };\n    var trimLeadingLineBreaks = function (node) {\n      do {\n        if (isText$7(node)) {\n          node.nodeValue = node.nodeValue.replace(/^[\\r\\n]+/, '');\n        }\n        node = node.firstChild;\n      } while (node);\n    };\n    var getEditableRoot = function (dom, node) {\n      var root = dom.getRoot();\n      var parent, editableRoot;\n      parent = node;\n      while (parent !== root && dom.getContentEditable(parent) !== 'false') {\n        if (dom.getContentEditable(parent) === 'true') {\n          editableRoot = parent;\n        }\n        parent = parent.parentNode;\n      }\n      return parent !== root ? editableRoot : root;\n    };\n    var applyAttributes = function (editor, node, forcedRootBlockAttrs) {\n      var dom = editor.dom;\n      Optional.from(forcedRootBlockAttrs.style).map(dom.parseStyle).each(function (attrStyles) {\n        var currentStyles = getAllRaw(SugarElement.fromDom(node));\n        var newStyles = __assign(__assign({}, currentStyles), attrStyles);\n        dom.setStyles(node, newStyles);\n      });\n      var attrClassesOpt = Optional.from(forcedRootBlockAttrs.class).map(function (attrClasses) {\n        return attrClasses.split(/\\s+/);\n      });\n      var currentClassesOpt = Optional.from(node.className).map(function (currentClasses) {\n        return filter$4(currentClasses.split(/\\s+/), function (clazz) {\n          return clazz !== '';\n        });\n      });\n      lift2(attrClassesOpt, currentClassesOpt, function (attrClasses, currentClasses) {\n        var filteredClasses = filter$4(currentClasses, function (clazz) {\n          return !contains$3(attrClasses, clazz);\n        });\n        var newClasses = __spreadArray(__spreadArray([], attrClasses, true), filteredClasses, true);\n        dom.setAttrib(node, 'class', newClasses.join(' '));\n      });\n      var appliedAttrs = [\n        'style',\n        'class'\n      ];\n      var remainingAttrs = filter$3(forcedRootBlockAttrs, function (_, attrs) {\n        return !contains$3(appliedAttrs, attrs);\n      });\n      dom.setAttribs(node, remainingAttrs);\n    };\n    var setForcedBlockAttrs = function (editor, node) {\n      var forcedRootBlockName = getForcedRootBlock(editor);\n      if (forcedRootBlockName && forcedRootBlockName.toLowerCase() === node.tagName.toLowerCase()) {\n        var forcedRootBlockAttrs = getForcedRootBlockAttrs(editor);\n        applyAttributes(editor, node, forcedRootBlockAttrs);\n      }\n    };\n    var wrapSelfAndSiblingsInDefaultBlock = function (editor, newBlockName, rng, container, offset) {\n      var newBlock, parentBlock, startNode, node, next, rootBlockName;\n      var blockName = newBlockName || 'P';\n      var dom = editor.dom, editableRoot = getEditableRoot(dom, container);\n      parentBlock = dom.getParent(container, dom.isBlock);\n      if (!parentBlock || !canSplitBlock(dom, parentBlock)) {\n        parentBlock = parentBlock || editableRoot;\n        if (parentBlock === editor.getBody() || isTableCell(parentBlock)) {\n          rootBlockName = parentBlock.nodeName.toLowerCase();\n        } else {\n          rootBlockName = parentBlock.parentNode.nodeName.toLowerCase();\n        }\n        if (!parentBlock.hasChildNodes()) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          parentBlock.appendChild(newBlock);\n          rng.setStart(newBlock, 0);\n          rng.setEnd(newBlock, 0);\n          return newBlock;\n        }\n        node = container;\n        while (node.parentNode !== parentBlock) {\n          node = node.parentNode;\n        }\n        while (node && !dom.isBlock(node)) {\n          startNode = node;\n          node = node.previousSibling;\n        }\n        if (startNode && editor.schema.isValidChild(rootBlockName, blockName.toLowerCase())) {\n          newBlock = dom.create(blockName);\n          setForcedBlockAttrs(editor, newBlock);\n          startNode.parentNode.insertBefore(newBlock, startNode);\n          node = startNode;\n          while (node && !dom.isBlock(node)) {\n            next = node.nextSibling;\n            newBlock.appendChild(node);\n            node = next;\n          }\n          rng.setStart(container, offset);\n          rng.setEnd(container, offset);\n        }\n      }\n      return container;\n    };\n    var addBrToBlockIfNeeded = function (dom, block) {\n      block.normalize();\n      var lastChild = block.lastChild;\n      if (!lastChild || /^(left|right)$/gi.test(dom.getStyle(lastChild, 'float', true))) {\n        dom.add(block, 'br');\n      }\n    };\n    var insert$2 = function (editor, evt) {\n      var tmpRng, container, offset, parentBlock;\n      var newBlock, fragment, containerBlock, parentBlockName, newBlockName, isAfterLastNodeInContainer;\n      var dom = editor.dom;\n      var schema = editor.schema, nonEmptyElementsMap = schema.getNonEmptyElements();\n      var rng = editor.selection.getRng();\n      var createNewBlock = function (name) {\n        var node = container, block, clonedNode, caretNode;\n        var textInlineElements = schema.getTextInlineElements();\n        if (name || parentBlockName === 'TABLE' || parentBlockName === 'HR') {\n          block = dom.create(name || newBlockName);\n        } else {\n          block = parentBlock.cloneNode(false);\n        }\n        caretNode = block;\n        if (shouldKeepStyles(editor) === false) {\n          dom.setAttrib(block, 'style', null);\n          dom.setAttrib(block, 'class', null);\n        } else {\n          do {\n            if (textInlineElements[node.nodeName]) {\n              if (isCaretNode(node) || isBookmarkNode$1(node)) {\n                continue;\n              }\n              clonedNode = node.cloneNode(false);\n              dom.setAttrib(clonedNode, 'id', '');\n              if (block.hasChildNodes()) {\n                clonedNode.appendChild(block.firstChild);\n                block.appendChild(clonedNode);\n              } else {\n                caretNode = clonedNode;\n                block.appendChild(clonedNode);\n              }\n            }\n          } while ((node = node.parentNode) && node !== editableRoot);\n        }\n        setForcedBlockAttrs(editor, block);\n        emptyBlock(caretNode);\n        return block;\n      };\n      var isCaretAtStartOrEndOfBlock = function (start) {\n        var node, name;\n        var normalizedOffset = normalizeZwspOffset(start, container, offset);\n        if (isText$7(container) && (start ? normalizedOffset > 0 : normalizedOffset < container.nodeValue.length)) {\n          return false;\n        }\n        if (container.parentNode === parentBlock && isAfterLastNodeInContainer && !start) {\n          return true;\n        }\n        if (start && isElement$5(container) && container === parentBlock.firstChild) {\n          return true;\n        }\n        if (containerAndSiblingName(container, 'TABLE') || containerAndSiblingName(container, 'HR')) {\n          return isAfterLastNodeInContainer && !start || !isAfterLastNodeInContainer && start;\n        }\n        var walker = new DomTreeWalker(container, parentBlock);\n        if (isText$7(container)) {\n          if (start && normalizedOffset === 0) {\n            walker.prev();\n          } else if (!start && normalizedOffset === container.nodeValue.length) {\n            walker.next();\n          }\n        }\n        while (node = walker.current()) {\n          if (isElement$5(node)) {\n            if (!node.getAttribute('data-mce-bogus')) {\n              name = node.nodeName.toLowerCase();\n              if (nonEmptyElementsMap[name] && name !== 'br') {\n                return false;\n              }\n            }\n          } else if (isText$7(node) && !isWhitespaceText(node.nodeValue)) {\n            return false;\n          }\n          if (start) {\n            walker.prev();\n          } else {\n            walker.next();\n          }\n        }\n        return true;\n      };\n      var insertNewBlockAfter = function () {\n        if (/^(H[1-6]|PRE|FIGURE)$/.test(parentBlockName) && containerBlockName !== 'HGROUP') {\n          newBlock = createNewBlock(newBlockName);\n        } else {\n          newBlock = createNewBlock();\n        }\n        if (shouldEndContainerOnEmptyBlock(editor) && canSplitBlock(dom, containerBlock) && dom.isEmpty(parentBlock)) {\n          newBlock = dom.split(containerBlock, parentBlock);\n        } else {\n          dom.insertAfter(newBlock, parentBlock);\n        }\n        moveToCaretPosition(editor, newBlock);\n      };\n      normalize$2(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      container = rng.startContainer;\n      offset = rng.startOffset;\n      newBlockName = getForcedRootBlock(editor);\n      var shiftKey = !!(evt && evt.shiftKey);\n      var ctrlKey = !!(evt && evt.ctrlKey);\n      if (isElement$5(container) && container.hasChildNodes()) {\n        isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && isText$7(container)) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var editableRoot = getEditableRoot(dom, container);\n      if (!editableRoot) {\n        return;\n      }\n      if (newBlockName && !shiftKey || !newBlockName && shiftKey) {\n        container = wrapSelfAndSiblingsInDefaultBlock(editor, newBlockName, rng, container, offset);\n      }\n      parentBlock = dom.getParent(container, dom.isBlock);\n      containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      parentBlockName = parentBlock ? parentBlock.nodeName.toUpperCase() : '';\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      if (containerBlockName === 'LI' && !ctrlKey) {\n        parentBlock = containerBlock;\n        containerBlock = containerBlock.parentNode;\n        parentBlockName = containerBlockName;\n      }\n      if (/^(LI|DT|DD)$/.test(parentBlockName)) {\n        if (dom.isEmpty(parentBlock)) {\n          insert$3(editor, createNewBlock, containerBlock, parentBlock, newBlockName);\n          return;\n        }\n      }\n      if (newBlockName && parentBlock === editor.getBody()) {\n        return;\n      }\n      newBlockName = newBlockName || 'P';\n      if (isCaretContainerBlock$1(parentBlock)) {\n        newBlock = showCaretContainerBlock(parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        setForcedBlockAttrs(editor, newBlock);\n        moveToCaretPosition(editor, newBlock);\n      } else if (isCaretAtStartOrEndOfBlock()) {\n        insertNewBlockAfter();\n      } else if (isCaretAtStartOrEndOfBlock(true)) {\n        newBlock = parentBlock.parentNode.insertBefore(createNewBlock(), parentBlock);\n        moveToCaretPosition(editor, containerAndSiblingName(parentBlock, 'HR') ? newBlock : parentBlock);\n      } else {\n        tmpRng = includeZwspInRange(rng).cloneRange();\n        tmpRng.setEndAfter(parentBlock);\n        fragment = tmpRng.extractContents();\n        trimZwsp(fragment);\n        trimLeadingLineBreaks(fragment);\n        newBlock = fragment.firstChild;\n        dom.insertAfter(fragment, parentBlock);\n        trimInlineElementsOnLeftSideOfBlock(dom, nonEmptyElementsMap, newBlock);\n        addBrToBlockIfNeeded(dom, parentBlock);\n        if (dom.isEmpty(parentBlock)) {\n          emptyBlock(parentBlock);\n        }\n        newBlock.normalize();\n        if (dom.isEmpty(newBlock)) {\n          dom.remove(newBlock);\n          insertNewBlockAfter();\n        } else {\n          setForcedBlockAttrs(editor, newBlock);\n          moveToCaretPosition(editor, newBlock);\n        }\n      }\n      dom.setAttrib(newBlock, 'id', '');\n      editor.fire('NewBlock', { newBlock: newBlock });\n    };\n\n    var hasRightSideContent = function (schema, container, parentBlock) {\n      var walker = new DomTreeWalker(container, parentBlock);\n      var node;\n      var nonEmptyElementsMap = schema.getNonEmptyElements();\n      while (node = walker.next()) {\n        if (nonEmptyElementsMap[node.nodeName.toLowerCase()] || node.length > 0) {\n          return true;\n        }\n      }\n    };\n    var moveSelectionToBr = function (editor, brElm, extraBr) {\n      var rng = editor.dom.createRng();\n      if (!extraBr) {\n        rng.setStartAfter(brElm);\n        rng.setEndAfter(brElm);\n      } else {\n        rng.setStartBefore(brElm);\n        rng.setEndBefore(brElm);\n      }\n      editor.selection.setRng(rng);\n      scrollRangeIntoView(editor, rng);\n    };\n    var insertBrAtCaret = function (editor, evt) {\n      var selection = editor.selection;\n      var dom = editor.dom;\n      var rng = selection.getRng();\n      var brElm;\n      var extraBr;\n      normalize$2(dom, rng).each(function (normRng) {\n        rng.setStart(normRng.startContainer, normRng.startOffset);\n        rng.setEnd(normRng.endContainer, normRng.endOffset);\n      });\n      var offset = rng.startOffset;\n      var container = rng.startContainer;\n      if (container.nodeType === 1 && container.hasChildNodes()) {\n        var isAfterLastNodeInContainer = offset > container.childNodes.length - 1;\n        container = container.childNodes[Math.min(offset, container.childNodes.length - 1)] || container;\n        if (isAfterLastNodeInContainer && container.nodeType === 3) {\n          offset = container.nodeValue.length;\n        } else {\n          offset = 0;\n        }\n      }\n      var parentBlock = dom.getParent(container, dom.isBlock);\n      var containerBlock = parentBlock ? dom.getParent(parentBlock.parentNode, dom.isBlock) : null;\n      var containerBlockName = containerBlock ? containerBlock.nodeName.toUpperCase() : '';\n      var isControlKey = !!(evt && evt.ctrlKey);\n      if (containerBlockName === 'LI' && !isControlKey) {\n        parentBlock = containerBlock;\n      }\n      if (container && container.nodeType === 3 && offset >= container.nodeValue.length) {\n        if (!hasRightSideContent(editor.schema, container, parentBlock)) {\n          brElm = dom.create('br');\n          rng.insertNode(brElm);\n          rng.setStartAfter(brElm);\n          rng.setEndAfter(brElm);\n          extraBr = true;\n        }\n      }\n      brElm = dom.create('br');\n      rangeInsertNode(dom, rng, brElm);\n      moveSelectionToBr(editor, brElm, extraBr);\n      editor.undoManager.add();\n    };\n    var insertBrBefore = function (editor, inline) {\n      var br = SugarElement.fromTag('br');\n      before$4(SugarElement.fromDom(inline), br);\n      editor.undoManager.add();\n    };\n    var insertBrAfter = function (editor, inline) {\n      if (!hasBrAfter(editor.getBody(), inline)) {\n        after$3(SugarElement.fromDom(inline), SugarElement.fromTag('br'));\n      }\n      var br = SugarElement.fromTag('br');\n      after$3(SugarElement.fromDom(inline), br);\n      moveSelectionToBr(editor, br.dom, false);\n      editor.undoManager.add();\n    };\n    var isBeforeBr = function (pos) {\n      return isBr$5(pos.getNode());\n    };\n    var hasBrAfter = function (rootNode, startNode) {\n      if (isBeforeBr(CaretPosition.after(startNode))) {\n        return true;\n      } else {\n        return nextPosition(rootNode, CaretPosition.after(startNode)).map(function (pos) {\n          return isBr$5(pos.getNode());\n        }).getOr(false);\n      }\n    };\n    var isAnchorLink = function (elm) {\n      return elm && elm.nodeName === 'A' && 'href' in elm;\n    };\n    var isInsideAnchor = function (location) {\n      return location.fold(never, isAnchorLink, isAnchorLink, never);\n    };\n    var readInlineAnchorLocation = function (editor) {\n      var isInlineTarget$1 = curry(isInlineTarget, editor);\n      var position = CaretPosition.fromRangeStart(editor.selection.getRng());\n      return readLocation(isInlineTarget$1, editor.getBody(), position).filter(isInsideAnchor);\n    };\n    var insertBrOutsideAnchor = function (editor, location) {\n      location.fold(noop, curry(insertBrBefore, editor), curry(insertBrAfter, editor), noop);\n    };\n    var insert$1 = function (editor, evt) {\n      var anchorLocation = readInlineAnchorLocation(editor);\n      if (anchorLocation.isSome()) {\n        anchorLocation.each(curry(insertBrOutsideAnchor, editor));\n      } else {\n        insertBrAtCaret(editor, evt);\n      }\n    };\n\n    var matchesSelector = function (editor, selector) {\n      return getParentBlock(editor).filter(function (parentBlock) {\n        return selector.length > 0 && is$2(SugarElement.fromDom(parentBlock), selector);\n      }).isSome();\n    };\n    var shouldInsertBr = function (editor) {\n      return matchesSelector(editor, getBrNewLineSelector(editor));\n    };\n    var shouldBlockNewLine$1 = function (editor) {\n      return matchesSelector(editor, getNoNewLineSelector(editor));\n    };\n\n    var newLineAction = Adt.generate([\n      { br: [] },\n      { block: [] },\n      { none: [] }\n    ]);\n    var shouldBlockNewLine = function (editor, _shiftKey) {\n      return shouldBlockNewLine$1(editor);\n    };\n    var isBrMode = function (requiredState) {\n      return function (editor, _shiftKey) {\n        var brMode = getForcedRootBlock(editor) === '';\n        return brMode === requiredState;\n      };\n    };\n    var inListBlock = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return isListItemParentBlock(editor) === requiredState;\n      };\n    };\n    var inBlock = function (blockName, requiredState) {\n      return function (editor, _shiftKey) {\n        var state = getParentBlockName(editor) === blockName.toUpperCase();\n        return state === requiredState;\n      };\n    };\n    var inPreBlock = function (requiredState) {\n      return inBlock('pre', requiredState);\n    };\n    var inSummaryBlock = function () {\n      return inBlock('summary', true);\n    };\n    var shouldPutBrInPre = function (requiredState) {\n      return function (editor, _shiftKey) {\n        return shouldPutBrInPre$1(editor) === requiredState;\n      };\n    };\n    var inBrContext = function (editor, _shiftKey) {\n      return shouldInsertBr(editor);\n    };\n    var hasShiftKey = function (_editor, shiftKey) {\n      return shiftKey;\n    };\n    var canInsertIntoEditableRoot = function (editor) {\n      var forcedRootBlock = getForcedRootBlock(editor);\n      var rootEditable = getEditableRoot$1(editor.dom, editor.selection.getStart());\n      return rootEditable && editor.schema.isValidChild(rootEditable.nodeName, forcedRootBlock ? forcedRootBlock : 'P');\n    };\n    var match = function (predicates, action) {\n      return function (editor, shiftKey) {\n        var isMatch = foldl(predicates, function (res, p) {\n          return res && p(editor, shiftKey);\n        }, true);\n        return isMatch ? Optional.some(action) : Optional.none();\n      };\n    };\n    var getAction = function (editor, evt) {\n      return evaluateUntil([\n        match([shouldBlockNewLine], newLineAction.none()),\n        match([inSummaryBlock()], newLineAction.br()),\n        match([\n          inPreBlock(true),\n          shouldPutBrInPre(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match([\n          inPreBlock(true),\n          shouldPutBrInPre(false)\n        ], newLineAction.block()),\n        match([\n          inPreBlock(true),\n          shouldPutBrInPre(true),\n          hasShiftKey\n        ], newLineAction.block()),\n        match([\n          inPreBlock(true),\n          shouldPutBrInPre(true)\n        ], newLineAction.br()),\n        match([\n          inListBlock(true),\n          hasShiftKey\n        ], newLineAction.br()),\n        match([inListBlock(true)], newLineAction.block()),\n        match([\n          isBrMode(true),\n          hasShiftKey,\n          canInsertIntoEditableRoot\n        ], newLineAction.block()),\n        match([isBrMode(true)], newLineAction.br()),\n        match([inBrContext], newLineAction.br()),\n        match([\n          isBrMode(false),\n          hasShiftKey\n        ], newLineAction.br()),\n        match([canInsertIntoEditableRoot], newLineAction.block())\n      ], [\n        editor,\n        !!(evt && evt.shiftKey)\n      ]).getOr(newLineAction.none());\n    };\n\n    var insert = function (editor, evt) {\n      getAction(editor, evt).fold(function () {\n        insert$1(editor, evt);\n      }, function () {\n        insert$2(editor, evt);\n      }, noop);\n    };\n\n    var handleEnterKeyEvent = function (editor, event) {\n      if (event.isDefaultPrevented()) {\n        return;\n      }\n      event.preventDefault();\n      endTypingLevelIgnoreLocks(editor.undoManager);\n      editor.undoManager.transact(function () {\n        if (editor.selection.isCollapsed() === false) {\n          editor.execCommand('Delete');\n        }\n        insert(editor, event);\n      });\n    };\n    var setup$9 = function (editor) {\n      editor.on('keydown', function (event) {\n        if (event.keyCode === VK.ENTER) {\n          handleEnterKeyEvent(editor, event);\n        }\n      });\n    };\n\n    var executeKeydownOverride$1 = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$1, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$1, editor, false)\n        },\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint, editor, true)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint, editor, false)\n        },\n        {\n          keyCode: VK.END,\n          action: action(moveToLineEndPoint$2, editor, true, caret)\n        },\n        {\n          keyCode: VK.HOME,\n          action: action(moveToLineEndPoint$2, editor, false, caret)\n        }\n      ], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$8 = function (editor, caret) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride$1(editor, caret, evt);\n        }\n      });\n    };\n\n    var browser = detect().browser;\n    var setupIeInput = function (editor) {\n      var keypressThrotter = first(function () {\n        if (!editor.composing) {\n          normalizeNbspsInEditor(editor);\n        }\n      }, 0);\n      if (browser.isIE()) {\n        editor.on('keypress', function (_e) {\n          keypressThrotter.throttle();\n        });\n        editor.on('remove', function (_e) {\n          keypressThrotter.cancel();\n        });\n      }\n    };\n    var setup$7 = function (editor) {\n      setupIeInput(editor);\n      editor.on('input', function (e) {\n        if (e.isComposing === false) {\n          normalizeNbspsInEditor(editor);\n        }\n      });\n    };\n\n    var platform = detect();\n    var executeKeyupAction = function (editor, caret, evt) {\n      execute([\n        {\n          keyCode: VK.PAGE_UP,\n          action: action(moveToLineEndPoint$2, editor, false, caret)\n        },\n        {\n          keyCode: VK.PAGE_DOWN,\n          action: action(moveToLineEndPoint$2, editor, true, caret)\n        }\n      ], evt);\n    };\n    var stopImmediatePropagation = function (e) {\n      return e.stopImmediatePropagation();\n    };\n    var isPageUpDown = function (evt) {\n      return evt.keyCode === VK.PAGE_UP || evt.keyCode === VK.PAGE_DOWN;\n    };\n    var setNodeChangeBlocker = function (blocked, editor, block) {\n      if (block && !blocked.get()) {\n        editor.on('NodeChange', stopImmediatePropagation, true);\n      } else if (!block && blocked.get()) {\n        editor.off('NodeChange', stopImmediatePropagation);\n      }\n      blocked.set(block);\n    };\n    var setup$6 = function (editor, caret) {\n      if (platform.os.isOSX()) {\n        return;\n      }\n      var blocked = Cell(false);\n      editor.on('keydown', function (evt) {\n        if (isPageUpDown(evt)) {\n          setNodeChangeBlocker(blocked, editor, true);\n        }\n      });\n      editor.on('keyup', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeyupAction(editor, caret, evt);\n        }\n        if (isPageUpDown(evt) && blocked.get()) {\n          setNodeChangeBlocker(blocked, editor, false);\n          editor.nodeChanged();\n        }\n      });\n    };\n\n    var insertTextAtPosition = function (text, pos) {\n      var container = pos.container();\n      var offset = pos.offset();\n      if (isText$7(container)) {\n        container.insertData(offset, text);\n        return Optional.some(CaretPosition(container, offset + text.length));\n      } else {\n        return getElementFromPosition(pos).map(function (elm) {\n          var textNode = SugarElement.fromText(text);\n          if (pos.isAtEnd()) {\n            after$3(elm, textNode);\n          } else {\n            before$4(elm, textNode);\n          }\n          return CaretPosition(textNode.dom, text.length);\n        });\n      }\n    };\n    var insertNbspAtPosition = curry(insertTextAtPosition, nbsp);\n    var insertSpaceAtPosition = curry(insertTextAtPosition, ' ');\n\n    var locationToCaretPosition = function (root) {\n      return function (location) {\n        return location.fold(function (element) {\n          return prevPosition(root.dom, CaretPosition.before(element));\n        }, function (element) {\n          return firstPositionIn(element);\n        }, function (element) {\n          return lastPositionIn(element);\n        }, function (element) {\n          return nextPosition(root.dom, CaretPosition.after(element));\n        });\n      };\n    };\n    var insertInlineBoundarySpaceOrNbsp = function (root, pos) {\n      return function (checkPos) {\n        return needsToHaveNbsp(root, checkPos) ? insertNbspAtPosition(pos) : insertSpaceAtPosition(pos);\n      };\n    };\n    var setSelection = function (editor) {\n      return function (pos) {\n        editor.selection.setRng(pos.toRange());\n        editor.nodeChanged();\n        return true;\n      };\n    };\n    var insertSpaceOrNbspAtSelection = function (editor) {\n      var pos = CaretPosition.fromRangeStart(editor.selection.getRng());\n      var root = SugarElement.fromDom(editor.getBody());\n      if (editor.selection.isCollapsed()) {\n        var isInlineTarget$1 = curry(isInlineTarget, editor);\n        var caretPosition = CaretPosition.fromRangeStart(editor.selection.getRng());\n        return readLocation(isInlineTarget$1, editor.getBody(), caretPosition).bind(locationToCaretPosition(root)).bind(insertInlineBoundarySpaceOrNbsp(root, pos)).exists(setSelection(editor));\n      } else {\n        return false;\n      }\n    };\n\n    var executeKeydownOverride = function (editor, evt) {\n      execute([{\n          keyCode: VK.SPACEBAR,\n          action: action(insertSpaceOrNbspAtSelection, editor)\n        }], evt).each(function (_) {\n        evt.preventDefault();\n      });\n    };\n    var setup$5 = function (editor) {\n      editor.on('keydown', function (evt) {\n        if (evt.isDefaultPrevented() === false) {\n          executeKeydownOverride(editor, evt);\n        }\n      });\n    };\n\n    var registerKeyboardOverrides = function (editor) {\n      var caret = setupSelectedState(editor);\n      setup$c(editor);\n      setup$b(editor, caret);\n      setup$a(editor, caret);\n      setup$9(editor);\n      setup$5(editor);\n      setup$7(editor);\n      setup$8(editor, caret);\n      setup$6(editor, caret);\n      return caret;\n    };\n    var setup$4 = function (editor) {\n      if (!isRtc(editor)) {\n        return registerKeyboardOverrides(editor);\n      } else {\n        return Cell(null);\n      }\n    };\n\n    var NodeChange = function () {\n      function NodeChange(editor) {\n        this.lastPath = [];\n        this.editor = editor;\n        var lastRng;\n        var self = this;\n        if (!('onselectionchange' in editor.getDoc())) {\n          editor.on('NodeChange click mouseup keyup focus', function (e) {\n            var nativeRng = editor.selection.getRng();\n            var fakeRng = {\n              startContainer: nativeRng.startContainer,\n              startOffset: nativeRng.startOffset,\n              endContainer: nativeRng.endContainer,\n              endOffset: nativeRng.endOffset\n            };\n            if (e.type === 'nodechange' || !isEq$4(fakeRng, lastRng)) {\n              editor.fire('SelectionChange');\n            }\n            lastRng = fakeRng;\n          });\n        }\n        editor.on('contextmenu', function () {\n          editor.fire('SelectionChange');\n        });\n        editor.on('SelectionChange', function () {\n          var startElm = editor.selection.getStart(true);\n          if (!startElm || !Env.range && editor.selection.isCollapsed()) {\n            return;\n          }\n          if (hasAnyRanges(editor) && !self.isSameElementPath(startElm) && editor.dom.isChildOf(startElm, editor.getBody())) {\n            editor.nodeChanged({ selectionChange: true });\n          }\n        });\n        editor.on('mouseup', function (e) {\n          if (!e.isDefaultPrevented() && hasAnyRanges(editor)) {\n            if (editor.selection.getNode().nodeName === 'IMG') {\n              Delay.setEditorTimeout(editor, function () {\n                editor.nodeChanged();\n              });\n            } else {\n              editor.nodeChanged();\n            }\n          }\n        });\n      }\n      NodeChange.prototype.nodeChanged = function (args) {\n        var selection = this.editor.selection;\n        var node, parents, root;\n        if (this.editor.initialized && selection && !shouldDisableNodeChange(this.editor) && !this.editor.mode.isReadOnly()) {\n          root = this.editor.getBody();\n          node = selection.getStart(true) || root;\n          if (node.ownerDocument !== this.editor.getDoc() || !this.editor.dom.isChildOf(node, root)) {\n            node = root;\n          }\n          parents = [];\n          this.editor.dom.getParent(node, function (node) {\n            if (node === root) {\n              return true;\n            }\n            parents.push(node);\n          });\n          args = args || {};\n          args.element = node;\n          args.parents = parents;\n          this.editor.fire('NodeChange', args);\n        }\n      };\n      NodeChange.prototype.isSameElementPath = function (startElm) {\n        var i;\n        var currentPath = this.editor.$(startElm).parentsUntil(this.editor.getBody()).add(startElm);\n        if (currentPath.length === this.lastPath.length) {\n          for (i = currentPath.length; i >= 0; i--) {\n            if (currentPath[i] !== this.lastPath[i]) {\n              break;\n            }\n          }\n          if (i === -1) {\n            this.lastPath = currentPath;\n            return true;\n          }\n        }\n        this.lastPath = currentPath;\n        return false;\n      };\n      return NodeChange;\n    }();\n\n    var preventSummaryToggle = function (editor) {\n      editor.on('click', function (e) {\n        if (editor.dom.getParent(e.target, 'details')) {\n          e.preventDefault();\n        }\n      });\n    };\n    var filterDetails = function (editor) {\n      editor.parser.addNodeFilter('details', function (elms) {\n        each$k(elms, function (details) {\n          details.attr('data-mce-open', details.attr('open'));\n          details.attr('open', 'open');\n        });\n      });\n      editor.serializer.addNodeFilter('details', function (elms) {\n        each$k(elms, function (details) {\n          var open = details.attr('data-mce-open');\n          details.attr('open', isString$1(open) ? open : null);\n          details.attr('data-mce-open', null);\n        });\n      });\n    };\n    var setup$3 = function (editor) {\n      preventSummaryToggle(editor);\n      filterDetails(editor);\n    };\n\n    var isTextBlockNode = function (node) {\n      return isElement$5(node) && isTextBlock$2(SugarElement.fromDom(node));\n    };\n    var normalizeSelection = function (editor) {\n      var rng = editor.selection.getRng();\n      var startPos = CaretPosition.fromRangeStart(rng);\n      var endPos = CaretPosition.fromRangeEnd(rng);\n      if (CaretPosition.isElementPosition(startPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          firstPositionIn(container).each(function (pos) {\n            return rng.setStart(pos.container(), pos.offset());\n          });\n        }\n      }\n      if (CaretPosition.isElementPosition(endPos)) {\n        var container = startPos.container();\n        if (isTextBlockNode(container)) {\n          lastPositionIn(container).each(function (pos) {\n            return rng.setEnd(pos.container(), pos.offset());\n          });\n        }\n      }\n      editor.selection.setRng(normalize(rng));\n    };\n    var setup$2 = function (editor) {\n      editor.on('click', function (e) {\n        if (e.detail >= 3) {\n          normalizeSelection(editor);\n        }\n      });\n    };\n\n    var getAbsolutePosition = function (elm) {\n      var clientRect = elm.getBoundingClientRect();\n      var doc = elm.ownerDocument;\n      var docElem = doc.documentElement;\n      var win = doc.defaultView;\n      return {\n        top: clientRect.top + win.pageYOffset - docElem.clientTop,\n        left: clientRect.left + win.pageXOffset - docElem.clientLeft\n      };\n    };\n    var getBodyPosition = function (editor) {\n      return editor.inline ? getAbsolutePosition(editor.getBody()) : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getScrollPosition = function (editor) {\n      var body = editor.getBody();\n      return editor.inline ? {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      } : {\n        left: 0,\n        top: 0\n      };\n    };\n    var getBodyScroll = function (editor) {\n      var body = editor.getBody(), docElm = editor.getDoc().documentElement;\n      var inlineScroll = {\n        left: body.scrollLeft,\n        top: body.scrollTop\n      };\n      var iframeScroll = {\n        left: body.scrollLeft || docElm.scrollLeft,\n        top: body.scrollTop || docElm.scrollTop\n      };\n      return editor.inline ? inlineScroll : iframeScroll;\n    };\n    var getMousePosition = function (editor, event) {\n      if (event.target.ownerDocument !== editor.getDoc()) {\n        var iframePosition = getAbsolutePosition(editor.getContentAreaContainer());\n        var scrollPosition = getBodyScroll(editor);\n        return {\n          left: event.pageX - iframePosition.left + scrollPosition.left,\n          top: event.pageY - iframePosition.top + scrollPosition.top\n        };\n      }\n      return {\n        left: event.pageX,\n        top: event.pageY\n      };\n    };\n    var calculatePosition = function (bodyPosition, scrollPosition, mousePosition) {\n      return {\n        pageX: mousePosition.left - bodyPosition.left + scrollPosition.left,\n        pageY: mousePosition.top - bodyPosition.top + scrollPosition.top\n      };\n    };\n    var calc = function (editor, event) {\n      return calculatePosition(getBodyPosition(editor), getScrollPosition(editor), getMousePosition(editor, event));\n    };\n\n    var isContentEditableFalse$1 = isContentEditableFalse$b, isContentEditableTrue$1 = isContentEditableTrue$4;\n    var isDraggable = function (rootElm, elm) {\n      return isContentEditableFalse$1(elm) && elm !== rootElm;\n    };\n    var isValidDropTarget = function (editor, targetElement, dragElement) {\n      if (targetElement === dragElement || editor.dom.isChildOf(targetElement, dragElement)) {\n        return false;\n      }\n      return !isContentEditableFalse$1(targetElement);\n    };\n    var cloneElement = function (elm) {\n      var cloneElm = elm.cloneNode(true);\n      cloneElm.removeAttribute('data-mce-selected');\n      return cloneElm;\n    };\n    var createGhost = function (editor, elm, width, height) {\n      var dom = editor.dom;\n      var clonedElm = elm.cloneNode(true);\n      dom.setStyles(clonedElm, {\n        width: width,\n        height: height\n      });\n      dom.setAttrib(clonedElm, 'data-mce-selected', null);\n      var ghostElm = dom.create('div', {\n        'class': 'mce-drag-container',\n        'data-mce-bogus': 'all',\n        'unselectable': 'on',\n        'contenteditable': 'false'\n      });\n      dom.setStyles(ghostElm, {\n        position: 'absolute',\n        opacity: 0.5,\n        overflow: 'hidden',\n        border: 0,\n        padding: 0,\n        margin: 0,\n        width: width,\n        height: height\n      });\n      dom.setStyles(clonedElm, {\n        margin: 0,\n        boxSizing: 'border-box'\n      });\n      ghostElm.appendChild(clonedElm);\n      return ghostElm;\n    };\n    var appendGhostToBody = function (ghostElm, bodyElm) {\n      if (ghostElm.parentNode !== bodyElm) {\n        bodyElm.appendChild(ghostElm);\n      }\n    };\n    var moveGhost = function (ghostElm, position, width, height, maxX, maxY) {\n      var overflowX = 0, overflowY = 0;\n      ghostElm.style.left = position.pageX + 'px';\n      ghostElm.style.top = position.pageY + 'px';\n      if (position.pageX + width > maxX) {\n        overflowX = position.pageX + width - maxX;\n      }\n      if (position.pageY + height > maxY) {\n        overflowY = position.pageY + height - maxY;\n      }\n      ghostElm.style.width = width - overflowX + 'px';\n      ghostElm.style.height = height - overflowY + 'px';\n    };\n    var removeElement = function (elm) {\n      if (elm && elm.parentNode) {\n        elm.parentNode.removeChild(elm);\n      }\n    };\n    var isLeftMouseButtonPressed = function (e) {\n      return e.button === 0;\n    };\n    var applyRelPos = function (state, position) {\n      return {\n        pageX: position.pageX - state.relX,\n        pageY: position.pageY + 5\n      };\n    };\n    var start = function (state, editor) {\n      return function (e) {\n        if (isLeftMouseButtonPressed(e)) {\n          var ceElm = find$3(editor.dom.getParents(e.target), or(isContentEditableFalse$1, isContentEditableTrue$1)).getOr(null);\n          if (isDraggable(editor.getBody(), ceElm)) {\n            var elmPos = editor.dom.getPos(ceElm);\n            var bodyElm = editor.getBody();\n            var docElm = editor.getDoc().documentElement;\n            state.set({\n              element: ceElm,\n              dragging: false,\n              screenX: e.screenX,\n              screenY: e.screenY,\n              maxX: (editor.inline ? bodyElm.scrollWidth : docElm.offsetWidth) - 2,\n              maxY: (editor.inline ? bodyElm.scrollHeight : docElm.offsetHeight) - 2,\n              relX: e.pageX - elmPos.x,\n              relY: e.pageY - elmPos.y,\n              width: ceElm.offsetWidth,\n              height: ceElm.offsetHeight,\n              ghost: createGhost(editor, ceElm, ceElm.offsetWidth, ceElm.offsetHeight)\n            });\n          }\n        }\n      };\n    };\n    var move = function (state, editor) {\n      var throttledPlaceCaretAt = Delay.throttle(function (clientX, clientY) {\n        editor._selectionOverrides.hideFakeCaret();\n        editor.selection.placeCaretAt(clientX, clientY);\n      }, 0);\n      editor.on('remove', throttledPlaceCaretAt.stop);\n      return function (e) {\n        return state.on(function (state) {\n          var movement = Math.max(Math.abs(e.screenX - state.screenX), Math.abs(e.screenY - state.screenY));\n          if (!state.dragging && movement > 10) {\n            var args = editor.fire('dragstart', { target: state.element });\n            if (args.isDefaultPrevented()) {\n              return;\n            }\n            state.dragging = true;\n            editor.focus();\n          }\n          if (state.dragging) {\n            var targetPos = applyRelPos(state, calc(editor, e));\n            appendGhostToBody(state.ghost, editor.getBody());\n            moveGhost(state.ghost, targetPos, state.width, state.height, state.maxX, state.maxY);\n            throttledPlaceCaretAt(e.clientX, e.clientY);\n          }\n        });\n      };\n    };\n    var getRawTarget = function (selection) {\n      var rng = selection.getSel().getRangeAt(0);\n      var startContainer = rng.startContainer;\n      return startContainer.nodeType === 3 ? startContainer.parentNode : startContainer;\n    };\n    var drop = function (state, editor) {\n      return function (e) {\n        state.on(function (state) {\n          if (state.dragging) {\n            if (isValidDropTarget(editor, getRawTarget(editor.selection), state.element)) {\n              var targetClone_1 = cloneElement(state.element);\n              var args = editor.fire('drop', {\n                clientX: e.clientX,\n                clientY: e.clientY\n              });\n              if (!args.isDefaultPrevented()) {\n                editor.undoManager.transact(function () {\n                  removeElement(state.element);\n                  editor.insertContent(editor.dom.getOuterHTML(targetClone_1));\n                  editor._selectionOverrides.hideFakeCaret();\n                });\n              }\n            }\n            editor.fire('dragend');\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var stop = function (state, editor) {\n      return function () {\n        state.on(function (state) {\n          if (state.dragging) {\n            editor.fire('dragend');\n          }\n        });\n        removeDragState(state);\n      };\n    };\n    var removeDragState = function (state) {\n      state.on(function (state) {\n        removeElement(state.ghost);\n      });\n      state.clear();\n    };\n    var bindFakeDragEvents = function (editor) {\n      var state = value();\n      var pageDom = DOMUtils.DOM;\n      var rootDocument = document;\n      var dragStartHandler = start(state, editor);\n      var dragHandler = move(state, editor);\n      var dropHandler = drop(state, editor);\n      var dragEndHandler = stop(state, editor);\n      editor.on('mousedown', dragStartHandler);\n      editor.on('mousemove', dragHandler);\n      editor.on('mouseup', dropHandler);\n      pageDom.bind(rootDocument, 'mousemove', dragHandler);\n      pageDom.bind(rootDocument, 'mouseup', dragEndHandler);\n      editor.on('remove', function () {\n        pageDom.unbind(rootDocument, 'mousemove', dragHandler);\n        pageDom.unbind(rootDocument, 'mouseup', dragEndHandler);\n      });\n      editor.on('keydown', function (e) {\n        if (e.keyCode === VK.ESC) {\n          dragEndHandler();\n        }\n      });\n    };\n    var blockIeDrop = function (editor) {\n      editor.on('drop', function (e) {\n        var realTarget = typeof e.clientX !== 'undefined' ? editor.getDoc().elementFromPoint(e.clientX, e.clientY) : null;\n        if (isContentEditableFalse$1(realTarget) || editor.dom.getContentEditableParent(realTarget) === 'false') {\n          e.preventDefault();\n        }\n      });\n    };\n    var blockUnsupportedFileDrop = function (editor) {\n      var preventFileDrop = function (e) {\n        if (!e.isDefaultPrevented()) {\n          var dataTransfer = e.dataTransfer;\n          if (dataTransfer && (contains$3(dataTransfer.types, 'Files') || dataTransfer.files.length > 0)) {\n            e.preventDefault();\n            if (e.type === 'drop') {\n              displayError(editor, 'Dropped file type is not supported');\n            }\n          }\n        }\n      };\n      var preventFileDropIfUIElement = function (e) {\n        if (isUIElement(editor, e.target)) {\n          preventFileDrop(e);\n        }\n      };\n      var setup = function () {\n        var pageDom = DOMUtils.DOM;\n        var dom = editor.dom;\n        var doc = document;\n        var editorRoot = editor.inline ? editor.getBody() : editor.getDoc();\n        var eventNames = [\n          'drop',\n          'dragover'\n        ];\n        each$k(eventNames, function (name) {\n          pageDom.bind(doc, name, preventFileDropIfUIElement);\n          dom.bind(editorRoot, name, preventFileDrop);\n        });\n        editor.on('remove', function () {\n          each$k(eventNames, function (name) {\n            pageDom.unbind(doc, name, preventFileDropIfUIElement);\n            dom.unbind(editorRoot, name, preventFileDrop);\n          });\n        });\n      };\n      editor.on('init', function () {\n        Delay.setEditorTimeout(editor, setup, 0);\n      });\n    };\n    var init$2 = function (editor) {\n      bindFakeDragEvents(editor);\n      blockIeDrop(editor);\n      if (shouldBlockUnsupportedDrop(editor)) {\n        blockUnsupportedFileDrop(editor);\n      }\n    };\n\n    var setup$1 = function (editor) {\n      var renderFocusCaret = first(function () {\n        if (!editor.removed && editor.getBody().contains(document.activeElement)) {\n          var rng = editor.selection.getRng();\n          if (rng.collapsed) {\n            var caretRange = renderRangeCaret(editor, rng, false);\n            editor.selection.setRng(caretRange);\n          }\n        }\n      }, 0);\n      editor.on('focus', function () {\n        renderFocusCaret.throttle();\n      });\n      editor.on('blur', function () {\n        renderFocusCaret.cancel();\n      });\n    };\n\n    var setup = function (editor) {\n      editor.on('init', function () {\n        editor.on('focusin', function (e) {\n          var target = e.target;\n          if (isMedia$2(target)) {\n            var ceRoot = getContentEditableRoot$1(editor.getBody(), target);\n            var node = isContentEditableFalse$b(ceRoot) ? ceRoot : target;\n            if (editor.selection.getNode() !== node) {\n              selectNode(editor, node).each(function (rng) {\n                return editor.selection.setRng(rng);\n              });\n            }\n          }\n        });\n      });\n    };\n\n    var isContentEditableTrue = isContentEditableTrue$4;\n    var isContentEditableFalse = isContentEditableFalse$b;\n    var getContentEditableRoot = function (editor, node) {\n      return getContentEditableRoot$1(editor.getBody(), node);\n    };\n    var SelectionOverrides = function (editor) {\n      var selection = editor.selection, dom = editor.dom;\n      var isBlock = dom.isBlock;\n      var rootNode = editor.getBody();\n      var fakeCaret = FakeCaret(editor, rootNode, isBlock, function () {\n        return hasFocus(editor);\n      });\n      var realSelectionId = 'sel-' + dom.uniqueId();\n      var elementSelectionAttr = 'data-mce-selected';\n      var selectedElement;\n      var isFakeSelectionElement = function (node) {\n        return dom.hasClass(node, 'mce-offscreen-selection');\n      };\n      var isFakeSelectionTargetElement = function (node) {\n        return node !== rootNode && (isContentEditableFalse(node) || isMedia$2(node)) && dom.isChildOf(node, rootNode);\n      };\n      var isNearFakeSelectionElement = function (pos) {\n        return isBeforeContentEditableFalse(pos) || isAfterContentEditableFalse(pos) || isBeforeMedia(pos) || isAfterMedia(pos);\n      };\n      var getRealSelectionElement = function () {\n        var container = dom.get(realSelectionId);\n        return container ? container.getElementsByTagName('*')[0] : container;\n      };\n      var setRange = function (range) {\n        if (range) {\n          selection.setRng(range);\n        }\n      };\n      var getRange = selection.getRng;\n      var showCaret = function (direction, node, before, scrollIntoView) {\n        if (scrollIntoView === void 0) {\n          scrollIntoView = true;\n        }\n        var e = editor.fire('ShowCaret', {\n          target: node,\n          direction: direction,\n          before: before\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        if (scrollIntoView) {\n          selection.scrollIntoView(node, direction === -1);\n        }\n        return fakeCaret.show(before, node);\n      };\n      var showBlockCaretContainer = function (blockCaretContainer) {\n        if (blockCaretContainer.hasAttribute('data-mce-caret')) {\n          showCaretContainerBlock(blockCaretContainer);\n          setRange(getRange());\n          selection.scrollIntoView(blockCaretContainer);\n        }\n      };\n      var registerEvents = function () {\n        editor.on('mouseup', function (e) {\n          var range = getRange();\n          if (range.collapsed && isXYInContentArea(editor, e.clientX, e.clientY)) {\n            renderCaretAtRange(editor, range, false).each(setRange);\n          }\n        });\n        editor.on('click', function (e) {\n          var contentEditableRoot = getContentEditableRoot(editor, e.target);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse(contentEditableRoot)) {\n              e.preventDefault();\n              editor.focus();\n            }\n            if (isContentEditableTrue(contentEditableRoot)) {\n              if (dom.isChildOf(contentEditableRoot, selection.getNode())) {\n                removeElementSelection();\n              }\n            }\n          }\n        });\n        editor.on('blur NewBlock', removeElementSelection);\n        editor.on('ResizeWindow FullscreenStateChanged', fakeCaret.reposition);\n        var hasNormalCaretPosition = function (elm) {\n          var start = elm.firstChild;\n          if (isNullable(start)) {\n            return false;\n          }\n          var startPos = CaretPosition.before(start);\n          if (isBr$5(startPos.getNode()) && elm.childNodes.length === 1) {\n            return !isNearFakeSelectionElement(startPos);\n          } else {\n            var caretWalker = CaretWalker(elm);\n            var newPos = caretWalker.next(startPos);\n            return newPos && !isNearFakeSelectionElement(newPos);\n          }\n        };\n        var isInSameBlock = function (node1, node2) {\n          var block1 = dom.getParent(node1, isBlock);\n          var block2 = dom.getParent(node2, isBlock);\n          return block1 === block2;\n        };\n        var hasBetterMouseTarget = function (targetNode, caretNode) {\n          var targetBlock = dom.getParent(targetNode, isBlock);\n          var caretBlock = dom.getParent(caretNode, isBlock);\n          if (isNullable(targetBlock)) {\n            return false;\n          }\n          if (targetNode !== caretBlock && dom.isChildOf(targetBlock, caretBlock) && isContentEditableFalse(getContentEditableRoot(editor, targetBlock)) === false) {\n            return true;\n          }\n          return !dom.isChildOf(caretBlock, targetBlock) && !isInSameBlock(targetBlock, caretBlock) && hasNormalCaretPosition(targetBlock);\n        };\n        editor.on('tap', function (e) {\n          var targetElm = e.target;\n          var contentEditableRoot = getContentEditableRoot(editor, targetElm);\n          if (isContentEditableFalse(contentEditableRoot)) {\n            e.preventDefault();\n            selectNode(editor, contentEditableRoot).each(setElementSelection);\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          }\n        }, true);\n        editor.on('mousedown', function (e) {\n          var targetElm = e.target;\n          if (targetElm !== rootNode && targetElm.nodeName !== 'HTML' && !dom.isChildOf(targetElm, rootNode)) {\n            return;\n          }\n          if (isXYInContentArea(editor, e.clientX, e.clientY) === false) {\n            return;\n          }\n          var contentEditableRoot = getContentEditableRoot(editor, targetElm);\n          if (contentEditableRoot) {\n            if (isContentEditableFalse(contentEditableRoot)) {\n              e.preventDefault();\n              selectNode(editor, contentEditableRoot).each(setElementSelection);\n            } else {\n              removeElementSelection();\n              if (!(isContentEditableTrue(contentEditableRoot) && e.shiftKey) && !isXYWithinRange(e.clientX, e.clientY, selection.getRng())) {\n                hideFakeCaret();\n                selection.placeCaretAt(e.clientX, e.clientY);\n              }\n            }\n          } else if (isFakeSelectionTargetElement(targetElm)) {\n            selectNode(editor, targetElm).each(setElementSelection);\n          } else if (isFakeCaretTarget(targetElm) === false) {\n            removeElementSelection();\n            hideFakeCaret();\n            var fakeCaretInfo = closestFakeCaret(rootNode, e.clientX, e.clientY);\n            if (fakeCaretInfo) {\n              if (!hasBetterMouseTarget(targetElm, fakeCaretInfo.node)) {\n                e.preventDefault();\n                var range = showCaret(1, fakeCaretInfo.node, fakeCaretInfo.before, false);\n                setRange(range);\n                editor.getBody().focus();\n              }\n            }\n          }\n        });\n        editor.on('keypress', function (e) {\n          if (VK.modifierPressed(e)) {\n            return;\n          }\n          if (isContentEditableFalse(selection.getNode())) {\n            e.preventDefault();\n          }\n        });\n        editor.on('GetSelectionRange', function (e) {\n          var rng = e.range;\n          if (selectedElement) {\n            if (!selectedElement.parentNode) {\n              selectedElement = null;\n              return;\n            }\n            rng = rng.cloneRange();\n            rng.selectNode(selectedElement);\n            e.range = rng;\n          }\n        });\n        editor.on('SetSelectionRange', function (e) {\n          e.range = normalizeShortEndedElementSelection(e.range);\n          var rng = setElementSelection(e.range, e.forward);\n          if (rng) {\n            e.range = rng;\n          }\n        });\n        var isPasteBin = function (node) {\n          return node.id === 'mcepastebin';\n        };\n        editor.on('AfterSetSelectionRange', function (e) {\n          var rng = e.range;\n          var parentNode = rng.startContainer.parentNode;\n          if (!isRangeInCaretContainer(rng) && !isPasteBin(parentNode)) {\n            hideFakeCaret();\n          }\n          if (!isFakeSelectionElement(parentNode)) {\n            removeElementSelection();\n          }\n        });\n        editor.on('copy', function (e) {\n          var clipboardData = e.clipboardData;\n          if (!e.isDefaultPrevented() && e.clipboardData && !Env.ie) {\n            var realSelectionElement = getRealSelectionElement();\n            if (realSelectionElement) {\n              e.preventDefault();\n              clipboardData.clearData();\n              clipboardData.setData('text/html', realSelectionElement.outerHTML);\n              clipboardData.setData('text/plain', realSelectionElement.outerText || realSelectionElement.innerText);\n            }\n          }\n        });\n        init$2(editor);\n        setup$1(editor);\n        setup(editor);\n      };\n      var isWithinCaretContainer = function (node) {\n        return isCaretContainer$2(node) || startsWithCaretContainer$1(node) || endsWithCaretContainer$1(node);\n      };\n      var isRangeInCaretContainer = function (rng) {\n        return isWithinCaretContainer(rng.startContainer) || isWithinCaretContainer(rng.endContainer);\n      };\n      var normalizeShortEndedElementSelection = function (rng) {\n        var shortEndedElements = editor.schema.getShortEndedElements();\n        var newRng = dom.createRng();\n        var startContainer = rng.startContainer;\n        var startOffset = rng.startOffset;\n        var endContainer = rng.endContainer;\n        var endOffset = rng.endOffset;\n        if (has$2(shortEndedElements, startContainer.nodeName.toLowerCase())) {\n          if (startOffset === 0) {\n            newRng.setStartBefore(startContainer);\n          } else {\n            newRng.setStartAfter(startContainer);\n          }\n        } else {\n          newRng.setStart(startContainer, startOffset);\n        }\n        if (has$2(shortEndedElements, endContainer.nodeName.toLowerCase())) {\n          if (endOffset === 0) {\n            newRng.setEndBefore(endContainer);\n          } else {\n            newRng.setEndAfter(endContainer);\n          }\n        } else {\n          newRng.setEnd(endContainer, endOffset);\n        }\n        return newRng;\n      };\n      var setupOffscreenSelection = function (node, targetClone, origTargetClone) {\n        var $ = editor.$;\n        var $realSelectionContainer = descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).fold(function () {\n          return $([]);\n        }, function (elm) {\n          return $([elm.dom]);\n        });\n        if ($realSelectionContainer.length === 0) {\n          $realSelectionContainer = $('<div data-mce-bogus=\"all\" class=\"mce-offscreen-selection\"></div>').attr('id', realSelectionId);\n          $realSelectionContainer.appendTo(editor.getBody());\n        }\n        var newRange = dom.createRng();\n        if (targetClone === origTargetClone && Env.ie) {\n          $realSelectionContainer.empty().append('<p style=\"font-size: 0\" data-mce-bogus=\"all\">\\xA0</p>').append(targetClone);\n          newRange.setStartAfter($realSelectionContainer[0].firstChild.firstChild);\n          newRange.setEndAfter(targetClone);\n        } else {\n          $realSelectionContainer.empty().append(nbsp).append(targetClone).append(nbsp);\n          newRange.setStart($realSelectionContainer[0].firstChild, 1);\n          newRange.setEnd($realSelectionContainer[0].lastChild, 0);\n        }\n        $realSelectionContainer.css({ top: dom.getPos(node, editor.getBody()).y });\n        $realSelectionContainer[0].focus();\n        var sel = selection.getSel();\n        sel.removeAllRanges();\n        sel.addRange(newRange);\n        return newRange;\n      };\n      var selectElement = function (elm) {\n        var targetClone = elm.cloneNode(true);\n        var e = editor.fire('ObjectSelected', {\n          target: elm,\n          targetClone: targetClone\n        });\n        if (e.isDefaultPrevented()) {\n          return null;\n        }\n        var range = setupOffscreenSelection(elm, e.targetClone, targetClone);\n        var nodeElm = SugarElement.fromDom(elm);\n        each$k(descendants(SugarElement.fromDom(editor.getBody()), '*[data-mce-selected]'), function (elm) {\n          if (!eq(nodeElm, elm)) {\n            remove$6(elm, elementSelectionAttr);\n          }\n        });\n        if (!dom.getAttrib(elm, elementSelectionAttr)) {\n          elm.setAttribute(elementSelectionAttr, '1');\n        }\n        selectedElement = elm;\n        hideFakeCaret();\n        return range;\n      };\n      var setElementSelection = function (range, forward) {\n        if (!range) {\n          return null;\n        }\n        if (range.collapsed) {\n          if (!isRangeInCaretContainer(range)) {\n            var dir = forward ? 1 : -1;\n            var caretPosition = getNormalizedRangeEndPoint(dir, rootNode, range);\n            var beforeNode = caretPosition.getNode(!forward);\n            if (isFakeCaretTarget(beforeNode)) {\n              return showCaret(dir, beforeNode, forward ? !caretPosition.isAtEnd() : false, false);\n            }\n            var afterNode = caretPosition.getNode(forward);\n            if (isFakeCaretTarget(afterNode)) {\n              return showCaret(dir, afterNode, forward ? false : !caretPosition.isAtEnd(), false);\n            }\n          }\n          return null;\n        }\n        var startContainer = range.startContainer;\n        var startOffset = range.startOffset;\n        var endOffset = range.endOffset;\n        if (startContainer.nodeType === 3 && startOffset === 0 && isContentEditableFalse(startContainer.parentNode)) {\n          startContainer = startContainer.parentNode;\n          startOffset = dom.nodeIndex(startContainer);\n          startContainer = startContainer.parentNode;\n        }\n        if (startContainer.nodeType !== 1) {\n          return null;\n        }\n        if (endOffset === startOffset + 1 && startContainer === range.endContainer) {\n          var node = startContainer.childNodes[startOffset];\n          if (isFakeSelectionTargetElement(node)) {\n            return selectElement(node);\n          }\n        }\n        return null;\n      };\n      var removeElementSelection = function () {\n        if (selectedElement) {\n          selectedElement.removeAttribute(elementSelectionAttr);\n        }\n        descendant(SugarElement.fromDom(editor.getBody()), '#' + realSelectionId).each(remove$7);\n        selectedElement = null;\n      };\n      var destroy = function () {\n        fakeCaret.destroy();\n        selectedElement = null;\n      };\n      var hideFakeCaret = function () {\n        fakeCaret.hide();\n      };\n      if (Env.ceFalse && !isRtc(editor)) {\n        registerEvents();\n      }\n      return {\n        showCaret: showCaret,\n        showBlockCaretContainer: showBlockCaretContainer,\n        hideFakeCaret: hideFakeCaret,\n        destroy: destroy\n      };\n    };\n\n    var Quirks = function (editor) {\n      var each = Tools.each;\n      var BACKSPACE = VK.BACKSPACE, DELETE = VK.DELETE, dom = editor.dom, selection = editor.selection, parser = editor.parser;\n      var isGecko = Env.gecko, isIE = Env.ie, isWebKit = Env.webkit;\n      var mceInternalUrlPrefix = 'data:text/mce-internal,';\n      var mceInternalDataType = isIE ? 'Text' : 'URL';\n      var setEditorCommandState = function (cmd, state) {\n        try {\n          editor.getDoc().execCommand(cmd, false, state);\n        } catch (ex) {\n        }\n      };\n      var isDefaultPrevented = function (e) {\n        return e.isDefaultPrevented();\n      };\n      var setMceInternalContent = function (e) {\n        var selectionHtml, internalContent;\n        if (e.dataTransfer) {\n          if (editor.selection.isCollapsed() && e.target.tagName === 'IMG') {\n            selection.select(e.target);\n          }\n          selectionHtml = editor.selection.getContent();\n          if (selectionHtml.length > 0) {\n            internalContent = mceInternalUrlPrefix + escape(editor.id) + ',' + escape(selectionHtml);\n            e.dataTransfer.setData(mceInternalDataType, internalContent);\n          }\n        }\n      };\n      var getMceInternalContent = function (e) {\n        var internalContent;\n        if (e.dataTransfer) {\n          internalContent = e.dataTransfer.getData(mceInternalDataType);\n          if (internalContent && internalContent.indexOf(mceInternalUrlPrefix) >= 0) {\n            internalContent = internalContent.substr(mceInternalUrlPrefix.length).split(',');\n            return {\n              id: unescape(internalContent[0]),\n              html: unescape(internalContent[1])\n            };\n          }\n        }\n        return null;\n      };\n      var insertClipboardContents = function (content, internal) {\n        if (editor.queryCommandSupported('mceInsertClipboardContent')) {\n          editor.execCommand('mceInsertClipboardContent', false, {\n            content: content,\n            internal: internal\n          });\n        } else {\n          editor.execCommand('mceInsertContent', false, content);\n        }\n      };\n      var emptyEditorWhenDeleting = function () {\n        var serializeRng = function (rng) {\n          var body = dom.create('body');\n          var contents = rng.cloneContents();\n          body.appendChild(contents);\n          return selection.serializer.serialize(body, { format: 'html' });\n        };\n        var allContentsSelected = function (rng) {\n          var selection = serializeRng(rng);\n          var allRng = dom.createRng();\n          allRng.selectNode(editor.getBody());\n          var allSelection = serializeRng(allRng);\n          return selection === allSelection;\n        };\n        editor.on('keydown', function (e) {\n          var keyCode = e.keyCode;\n          var isCollapsed, body;\n          if (!isDefaultPrevented(e) && (keyCode === DELETE || keyCode === BACKSPACE)) {\n            isCollapsed = editor.selection.isCollapsed();\n            body = editor.getBody();\n            if (isCollapsed && !dom.isEmpty(body)) {\n              return;\n            }\n            if (!isCollapsed && !allContentsSelected(editor.selection.getRng())) {\n              return;\n            }\n            e.preventDefault();\n            editor.setContent('');\n            if (body.firstChild && dom.isBlock(body.firstChild)) {\n              editor.selection.setCursorLocation(body.firstChild, 0);\n            } else {\n              editor.selection.setCursorLocation(body, 0);\n            }\n            editor.nodeChanged();\n          }\n        });\n      };\n      var selectAll = function () {\n        editor.shortcuts.add('meta+a', null, 'SelectAll');\n      };\n      var documentElementEditingFocus = function () {\n        if (!editor.inline) {\n          dom.bind(editor.getDoc(), 'mousedown mouseup', function (e) {\n            var rng;\n            if (e.target === editor.getDoc().documentElement) {\n              rng = selection.getRng();\n              editor.getBody().focus();\n              if (e.type === 'mousedown') {\n                if (isCaretContainer$2(rng.startContainer)) {\n                  return;\n                }\n                selection.placeCaretAt(e.clientX, e.clientY);\n              } else {\n                selection.setRng(rng);\n              }\n            }\n          });\n        }\n      };\n      var removeHrOnBackspace = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (!editor.getBody().getElementsByTagName('hr').length) {\n              return;\n            }\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var node = selection.getNode();\n              var previousSibling = node.previousSibling;\n              if (node.nodeName === 'HR') {\n                dom.remove(node);\n                e.preventDefault();\n                return;\n              }\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'hr') {\n                dom.remove(previousSibling);\n                e.preventDefault();\n              }\n            }\n          }\n        });\n      };\n      var focusBody = function () {\n        if (!Range.prototype.getClientRects) {\n          editor.on('mousedown', function (e) {\n            if (!isDefaultPrevented(e) && e.target.nodeName === 'HTML') {\n              var body_1 = editor.getBody();\n              body_1.blur();\n              Delay.setEditorTimeout(editor, function () {\n                body_1.focus();\n              });\n            }\n          });\n        }\n      };\n      var selectControlElements = function () {\n        editor.on('click', function (e) {\n          var target = e.target;\n          if (/^(IMG|HR)$/.test(target.nodeName) && dom.getContentEditableParent(target) !== 'false') {\n            e.preventDefault();\n            editor.selection.select(target);\n            editor.nodeChanged();\n          }\n          if (target.nodeName === 'A' && dom.hasClass(target, 'mce-item-anchor')) {\n            e.preventDefault();\n            selection.select(target);\n          }\n        });\n      };\n      var removeStylesWhenDeletingAcrossBlockElements = function () {\n        var getAttributeApplyFunction = function () {\n          var template = dom.getAttribs(selection.getStart().cloneNode(false));\n          return function () {\n            var target = selection.getStart();\n            if (target !== editor.getBody()) {\n              dom.setAttrib(target, 'style', null);\n              each(template, function (attr) {\n                target.setAttributeNode(attr.cloneNode(true));\n              });\n            }\n          };\n        };\n        var isSelectionAcrossElements = function () {\n          return !selection.isCollapsed() && dom.getParent(selection.getStart(), dom.isBlock) !== dom.getParent(selection.getEnd(), dom.isBlock);\n        };\n        editor.on('keypress', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && (e.keyCode === 8 || e.keyCode === 46) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            editor.getDoc().execCommand('delete', false, null);\n            applyAttributes();\n            e.preventDefault();\n            return false;\n          }\n        });\n        dom.bind(editor.getDoc(), 'cut', function (e) {\n          var applyAttributes;\n          if (!isDefaultPrevented(e) && isSelectionAcrossElements()) {\n            applyAttributes = getAttributeApplyFunction();\n            Delay.setEditorTimeout(editor, function () {\n              applyAttributes();\n            });\n          }\n        });\n      };\n      var disableBackspaceIntoATable = function () {\n        editor.on('keydown', function (e) {\n          if (!isDefaultPrevented(e) && e.keyCode === BACKSPACE) {\n            if (selection.isCollapsed() && selection.getRng().startOffset === 0) {\n              var previousSibling = selection.getNode().previousSibling;\n              if (previousSibling && previousSibling.nodeName && previousSibling.nodeName.toLowerCase() === 'table') {\n                e.preventDefault();\n                return false;\n              }\n            }\n          }\n        });\n      };\n      var removeBlockQuoteOnBackSpace = function () {\n        editor.on('keydown', function (e) {\n          var rng, parent;\n          if (isDefaultPrevented(e) || e.keyCode !== VK.BACKSPACE) {\n            return;\n          }\n          rng = selection.getRng();\n          var container = rng.startContainer;\n          var offset = rng.startOffset;\n          var root = dom.getRoot();\n          parent = container;\n          if (!rng.collapsed || offset !== 0) {\n            return;\n          }\n          while (parent && parent.parentNode && parent.parentNode.firstChild === parent && parent.parentNode !== root) {\n            parent = parent.parentNode;\n          }\n          if (parent.tagName === 'BLOCKQUOTE') {\n            editor.formatter.toggle('blockquote', null, parent);\n            rng = dom.createRng();\n            rng.setStart(container, 0);\n            rng.setEnd(container, 0);\n            selection.setRng(rng);\n          }\n        });\n      };\n      var setGeckoEditingOptions = function () {\n        var setOpts = function () {\n          setEditorCommandState('StyleWithCSS', false);\n          setEditorCommandState('enableInlineTableEditing', false);\n          if (!getObjectResizing(editor)) {\n            setEditorCommandState('enableObjectResizing', false);\n          }\n        };\n        if (!isReadOnly$1(editor)) {\n          editor.on('BeforeExecCommand mousedown', setOpts);\n        }\n      };\n      var addBrAfterLastLinks = function () {\n        var fixLinks = function () {\n          each(dom.select('a'), function (node) {\n            var parentNode = node.parentNode;\n            var root = dom.getRoot();\n            if (parentNode.lastChild === node) {\n              while (parentNode && !dom.isBlock(parentNode)) {\n                if (parentNode.parentNode.lastChild !== parentNode || parentNode === root) {\n                  return;\n                }\n                parentNode = parentNode.parentNode;\n              }\n              dom.add(parentNode, 'br', { 'data-mce-bogus': 1 });\n            }\n          });\n        };\n        editor.on('SetContent ExecCommand', function (e) {\n          if (e.type === 'setcontent' || e.command === 'mceInsertLink') {\n            fixLinks();\n          }\n        });\n      };\n      var setDefaultBlockType = function () {\n        if (getForcedRootBlock(editor)) {\n          editor.on('init', function () {\n            setEditorCommandState('DefaultParagraphSeparator', getForcedRootBlock(editor));\n          });\n        }\n      };\n      var normalizeSelection = function () {\n        editor.on('keyup focusin mouseup', function (e) {\n          if (!VK.modifierPressed(e)) {\n            selection.normalize();\n          }\n        }, true);\n      };\n      var showBrokenImageIcon = function () {\n        editor.contentStyles.push('img:-moz-broken {' + '-moz-force-broken-image-icon:1;' + 'min-width:24px;' + 'min-height:24px' + '}');\n      };\n      var restoreFocusOnKeyDown = function () {\n        if (!editor.inline) {\n          editor.on('keydown', function () {\n            if (document.activeElement === document.body) {\n              editor.getWin().focus();\n            }\n          });\n        }\n      };\n      var bodyHeight = function () {\n        if (!editor.inline) {\n          editor.contentStyles.push('body {min-height: 150px}');\n          editor.on('click', function (e) {\n            var rng;\n            if (e.target.nodeName === 'HTML') {\n              if (Env.ie > 11) {\n                editor.getBody().focus();\n                return;\n              }\n              rng = editor.selection.getRng();\n              editor.getBody().focus();\n              editor.selection.setRng(rng);\n              editor.selection.normalize();\n              editor.nodeChanged();\n            }\n          });\n        }\n      };\n      var blockCmdArrowNavigation = function () {\n        if (Env.mac) {\n          editor.on('keydown', function (e) {\n            if (VK.metaKeyPressed(e) && !e.shiftKey && (e.keyCode === 37 || e.keyCode === 39)) {\n              e.preventDefault();\n              var selection_1 = editor.selection.getSel();\n              selection_1.modify('move', e.keyCode === 37 ? 'backward' : 'forward', 'lineboundary');\n            }\n          });\n        }\n      };\n      var disableAutoUrlDetect = function () {\n        setEditorCommandState('AutoUrlDetect', false);\n      };\n      var tapLinksAndImages = function () {\n        editor.on('click', function (e) {\n          var elm = e.target;\n          do {\n            if (elm.tagName === 'A') {\n              e.preventDefault();\n              return;\n            }\n          } while (elm = elm.parentNode);\n        });\n        editor.contentStyles.push('.mce-content-body {-webkit-touch-callout: none}');\n      };\n      var blockFormSubmitInsideEditor = function () {\n        editor.on('init', function () {\n          editor.dom.bind(editor.getBody(), 'submit', function (e) {\n            e.preventDefault();\n          });\n        });\n      };\n      var removeAppleInterchangeBrs = function () {\n        parser.addNodeFilter('br', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            if (nodes[i].attr('class') === 'Apple-interchange-newline') {\n              nodes[i].remove();\n            }\n          }\n        });\n      };\n      var ieInternalDragAndDrop = function () {\n        editor.on('dragstart', function (e) {\n          setMceInternalContent(e);\n        });\n        editor.on('drop', function (e) {\n          if (!isDefaultPrevented(e)) {\n            var internalContent = getMceInternalContent(e);\n            if (internalContent && internalContent.id !== editor.id) {\n              e.preventDefault();\n              var rng = fromPoint(e.x, e.y, editor.getDoc());\n              selection.setRng(rng);\n              insertClipboardContents(internalContent.html, true);\n            }\n          }\n        });\n      };\n      var refreshContentEditable = noop;\n      var isHidden = function () {\n        if (!isGecko || editor.removed) {\n          return false;\n        }\n        var sel = editor.selection.getSel();\n        return !sel || !sel.rangeCount || sel.rangeCount === 0;\n      };\n      var setupRtc = function () {\n        if (isWebKit) {\n          documentElementEditingFocus();\n          selectControlElements();\n          blockFormSubmitInsideEditor();\n          selectAll();\n          if (Env.iOS) {\n            restoreFocusOnKeyDown();\n            bodyHeight();\n            tapLinksAndImages();\n          }\n        }\n        if (isGecko) {\n          focusBody();\n          setGeckoEditingOptions();\n          showBrokenImageIcon();\n          blockCmdArrowNavigation();\n        }\n      };\n      var setup = function () {\n        removeBlockQuoteOnBackSpace();\n        emptyEditorWhenDeleting();\n        if (!Env.windowsPhone) {\n          normalizeSelection();\n        }\n        if (isWebKit) {\n          documentElementEditingFocus();\n          selectControlElements();\n          setDefaultBlockType();\n          blockFormSubmitInsideEditor();\n          disableBackspaceIntoATable();\n          removeAppleInterchangeBrs();\n          if (Env.iOS) {\n            restoreFocusOnKeyDown();\n            bodyHeight();\n            tapLinksAndImages();\n          } else {\n            selectAll();\n          }\n        }\n        if (Env.ie >= 11) {\n          bodyHeight();\n          disableBackspaceIntoATable();\n        }\n        if (Env.ie) {\n          selectAll();\n          disableAutoUrlDetect();\n          ieInternalDragAndDrop();\n        }\n        if (isGecko) {\n          removeHrOnBackspace();\n          focusBody();\n          removeStylesWhenDeletingAcrossBlockElements();\n          setGeckoEditingOptions();\n          addBrAfterLastLinks();\n          showBrokenImageIcon();\n          blockCmdArrowNavigation();\n          disableBackspaceIntoATable();\n        }\n      };\n      if (isRtc(editor)) {\n        setupRtc();\n      } else {\n        setup();\n      }\n      return {\n        refreshContentEditable: refreshContentEditable,\n        isHidden: isHidden\n      };\n    };\n\n    var DOM$6 = DOMUtils.DOM;\n    var appendStyle = function (editor, text) {\n      var body = SugarElement.fromDom(editor.getBody());\n      var container = getStyleContainer(getRootNode(body));\n      var style = SugarElement.fromTag('style');\n      set$1(style, 'type', 'text/css');\n      append$1(style, SugarElement.fromText(text));\n      append$1(container, style);\n      editor.on('remove', function () {\n        remove$7(style);\n      });\n    };\n    var getRootName = function (editor) {\n      return editor.inline ? editor.getElement().nodeName.toLowerCase() : undefined;\n    };\n    var removeUndefined = function (obj) {\n      return filter$3(obj, function (v) {\n        return isUndefined(v) === false;\n      });\n    };\n    var mkParserSettings = function (editor) {\n      var settings = editor.settings;\n      var blobCache = editor.editorUpload.blobCache;\n      return removeUndefined({\n        allow_conditional_comments: settings.allow_conditional_comments,\n        allow_html_data_urls: settings.allow_html_data_urls,\n        allow_svg_data_urls: settings.allow_svg_data_urls,\n        allow_html_in_named_anchor: settings.allow_html_in_named_anchor,\n        allow_script_urls: settings.allow_script_urls,\n        allow_unsafe_link_target: settings.allow_unsafe_link_target,\n        convert_fonts_to_spans: settings.convert_fonts_to_spans,\n        fix_list_elements: settings.fix_list_elements,\n        font_size_legacy_values: settings.font_size_legacy_values,\n        forced_root_block: settings.forced_root_block,\n        forced_root_block_attrs: settings.forced_root_block_attrs,\n        padd_empty_with_br: settings.padd_empty_with_br,\n        preserve_cdata: settings.preserve_cdata,\n        remove_trailing_brs: settings.remove_trailing_brs,\n        inline_styles: settings.inline_styles,\n        root_name: getRootName(editor),\n        validate: true,\n        blob_cache: blobCache,\n        document: editor.getDoc(),\n        images_dataimg_filter: settings.images_dataimg_filter\n      });\n    };\n    var mkSerializerSettings = function (editor) {\n      var settings = editor.settings;\n      return __assign(__assign({}, mkParserSettings(editor)), removeUndefined({\n        url_converter: settings.url_converter,\n        url_converter_scope: settings.url_converter_scope,\n        element_format: settings.element_format,\n        entities: settings.entities,\n        entity_encoding: settings.entity_encoding,\n        indent: settings.indent,\n        indent_after: settings.indent_after,\n        indent_before: settings.indent_before,\n        block_elements: settings.block_elements,\n        boolean_attributes: settings.boolean_attributes,\n        custom_elements: settings.custom_elements,\n        extended_valid_elements: settings.extended_valid_elements,\n        invalid_elements: settings.invalid_elements,\n        invalid_styles: settings.invalid_styles,\n        move_caret_before_on_enter_elements: settings.move_caret_before_on_enter_elements,\n        non_empty_elements: settings.non_empty_elements,\n        schema: settings.schema,\n        self_closing_elements: settings.self_closing_elements,\n        short_ended_elements: settings.short_ended_elements,\n        special: settings.special,\n        text_block_elements: settings.text_block_elements,\n        text_inline_elements: settings.text_inline_elements,\n        valid_children: settings.valid_children,\n        valid_classes: settings.valid_classes,\n        valid_elements: settings.valid_elements,\n        valid_styles: settings.valid_styles,\n        verify_html: settings.verify_html,\n        whitespace_elements: settings.whitespace_elements\n      }));\n    };\n    var createParser = function (editor) {\n      var parser = DomParser(mkParserSettings(editor), editor.schema);\n      parser.addAttributeFilter('src,href,style,tabindex', function (nodes, name) {\n        var i = nodes.length, node, value;\n        var dom = editor.dom;\n        var internalName = 'data-mce-' + name;\n        while (i--) {\n          node = nodes[i];\n          value = node.attr(name);\n          if (value && !node.attr(internalName)) {\n            if (value.indexOf('data:') === 0 || value.indexOf('blob:') === 0) {\n              continue;\n            }\n            if (name === 'style') {\n              value = dom.serializeStyle(dom.parseStyle(value), node.name);\n              if (!value.length) {\n                value = null;\n              }\n              node.attr(internalName, value);\n              node.attr(name, value);\n            } else if (name === 'tabindex') {\n              node.attr(internalName, value);\n              node.attr(name, null);\n            } else {\n              node.attr(internalName, editor.convertURL(value, name, node.name));\n            }\n          }\n        }\n      });\n      parser.addNodeFilter('script', function (nodes) {\n        var i = nodes.length;\n        while (i--) {\n          var node = nodes[i];\n          var type = node.attr('type') || 'no/type';\n          if (type.indexOf('mce-') !== 0) {\n            node.attr('type', 'mce-' + type);\n          }\n        }\n      });\n      if (editor.settings.preserve_cdata) {\n        parser.addNodeFilter('#cdata', function (nodes) {\n          var i = nodes.length;\n          while (i--) {\n            var node = nodes[i];\n            node.type = 8;\n            node.name = '#comment';\n            node.value = '[CDATA[' + editor.dom.encode(node.value) + ']]';\n          }\n        });\n      }\n      parser.addNodeFilter('p,h1,h2,h3,h4,h5,h6,div', function (nodes) {\n        var i = nodes.length;\n        var nonEmptyElements = editor.schema.getNonEmptyElements();\n        while (i--) {\n          var node = nodes[i];\n          if (node.isEmpty(nonEmptyElements) && node.getAll('br').length === 0) {\n            node.append(new AstNode('br', 1)).shortEnded = true;\n          }\n        }\n      });\n      return parser;\n    };\n    var autoFocus = function (editor) {\n      if (editor.settings.auto_focus) {\n        Delay.setEditorTimeout(editor, function () {\n          var focusEditor;\n          if (editor.settings.auto_focus === true) {\n            focusEditor = editor;\n          } else {\n            focusEditor = editor.editorManager.get(editor.settings.auto_focus);\n          }\n          if (!focusEditor.destroyed) {\n            focusEditor.focus();\n          }\n        }, 100);\n      }\n    };\n    var moveSelectionToFirstCaretPosition = function (editor) {\n      var root = editor.dom.getRoot();\n      if (!editor.inline && (!hasAnyRanges(editor) || editor.selection.getStart(true) === root)) {\n        firstPositionIn(root).each(function (pos) {\n          var node = pos.getNode();\n          var caretPos = isTable$3(node) ? firstPositionIn(node).getOr(pos) : pos;\n          if (Env.browser.isIE()) {\n            storeNative(editor, caretPos.toRange());\n          } else {\n            editor.selection.setRng(caretPos.toRange());\n          }\n        });\n      }\n    };\n    var initEditor = function (editor) {\n      editor.bindPendingEventDelegates();\n      editor.initialized = true;\n      fireInit(editor);\n      editor.focus(true);\n      moveSelectionToFirstCaretPosition(editor);\n      editor.nodeChanged({ initial: true });\n      editor.execCallback('init_instance_callback', editor);\n      autoFocus(editor);\n    };\n    var getStyleSheetLoader$1 = function (editor) {\n      return editor.inline ? editor.ui.styleSheetLoader : editor.dom.styleSheetLoader;\n    };\n    var makeStylesheetLoadingPromises = function (editor, css, framedFonts) {\n      var promises = [new promiseObj(function (resolve, reject) {\n          return getStyleSheetLoader$1(editor).loadAll(css, resolve, reject);\n        })];\n      if (editor.inline) {\n        return promises;\n      } else {\n        return promises.concat([new promiseObj(function (resolve, reject) {\n            return editor.ui.styleSheetLoader.loadAll(framedFonts, resolve, reject);\n          })]);\n      }\n    };\n    var loadContentCss = function (editor) {\n      var styleSheetLoader = getStyleSheetLoader$1(editor);\n      var fontCss = getFontCss(editor);\n      var css = editor.contentCSS;\n      var removeCss = function () {\n        styleSheetLoader.unloadAll(css);\n        if (!editor.inline) {\n          editor.ui.styleSheetLoader.unloadAll(fontCss);\n        }\n      };\n      var loaded = function () {\n        if (editor.removed) {\n          removeCss();\n        } else {\n          editor.on('remove', removeCss);\n        }\n      };\n      if (editor.contentStyles.length > 0) {\n        var contentCssText_1 = '';\n        Tools.each(editor.contentStyles, function (style) {\n          contentCssText_1 += style + '\\r\\n';\n        });\n        editor.dom.addStyle(contentCssText_1);\n      }\n      var allStylesheets = promiseObj.all(makeStylesheetLoadingPromises(editor, css, fontCss)).then(loaded).catch(loaded);\n      if (editor.settings.content_style) {\n        appendStyle(editor, editor.settings.content_style);\n      }\n      return allStylesheets;\n    };\n    var preInit = function (editor) {\n      var settings = editor.settings, doc = editor.getDoc(), body = editor.getBody();\n      firePreInit(editor);\n      if (!settings.browser_spellcheck && !settings.gecko_spellcheck) {\n        doc.body.spellcheck = false;\n        DOM$6.setAttrib(body, 'spellcheck', 'false');\n      }\n      editor.quirks = Quirks(editor);\n      firePostRender(editor);\n      var directionality = getDirectionality(editor);\n      if (directionality !== undefined) {\n        body.dir = directionality;\n      }\n      if (settings.protect) {\n        editor.on('BeforeSetContent', function (e) {\n          Tools.each(settings.protect, function (pattern) {\n            e.content = e.content.replace(pattern, function (str) {\n              return '<!--mce:protected ' + escape(str) + '-->';\n            });\n          });\n        });\n      }\n      editor.on('SetContent', function () {\n        editor.addVisual(editor.getBody());\n      });\n      editor.on('compositionstart compositionend', function (e) {\n        editor.composing = e.type === 'compositionstart';\n      });\n    };\n    var loadInitialContent = function (editor) {\n      if (!isRtc(editor)) {\n        editor.load({\n          initial: true,\n          format: 'html'\n        });\n      }\n      editor.startContent = editor.getContent({ format: 'raw' });\n    };\n    var initEditorWithInitialContent = function (editor) {\n      if (editor.removed !== true) {\n        loadInitialContent(editor);\n        initEditor(editor);\n      }\n    };\n    var initContentBody = function (editor, skipWrite) {\n      var settings = editor.settings;\n      var targetElm = editor.getElement();\n      var doc = editor.getDoc();\n      if (!settings.inline) {\n        editor.getElement().style.visibility = editor.orgVisibility;\n      }\n      if (!skipWrite && !editor.inline) {\n        doc.open();\n        doc.write(editor.iframeHTML);\n        doc.close();\n      }\n      if (editor.inline) {\n        DOM$6.addClass(targetElm, 'mce-content-body');\n        editor.contentDocument = doc = document;\n        editor.contentWindow = window;\n        editor.bodyElement = targetElm;\n        editor.contentAreaContainer = targetElm;\n      }\n      var body = editor.getBody();\n      body.disabled = true;\n      editor.readonly = !!settings.readonly;\n      if (!editor.readonly) {\n        if (editor.inline && DOM$6.getStyle(body, 'position', true) === 'static') {\n          body.style.position = 'relative';\n        }\n        body.contentEditable = editor.getParam('content_editable_state', true);\n      }\n      body.disabled = false;\n      editor.editorUpload = EditorUpload(editor);\n      editor.schema = Schema(settings);\n      editor.dom = DOMUtils(doc, {\n        keep_values: true,\n        url_converter: editor.convertURL,\n        url_converter_scope: editor,\n        hex_colors: settings.force_hex_style_colors,\n        update_styles: true,\n        root_element: editor.inline ? editor.getBody() : null,\n        collect: function () {\n          return editor.inline;\n        },\n        schema: editor.schema,\n        contentCssCors: shouldUseContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor),\n        onSetAttrib: function (e) {\n          editor.fire('SetAttrib', e);\n        }\n      });\n      editor.parser = createParser(editor);\n      editor.serializer = DomSerializer(mkSerializerSettings(editor), editor);\n      editor.selection = EditorSelection(editor.dom, editor.getWin(), editor.serializer, editor);\n      editor.annotator = Annotator(editor);\n      editor.formatter = Formatter(editor);\n      editor.undoManager = UndoManager(editor);\n      editor._nodeChangeDispatcher = new NodeChange(editor);\n      editor._selectionOverrides = SelectionOverrides(editor);\n      setup$e(editor);\n      setup$3(editor);\n      if (!isRtc(editor)) {\n        setup$2(editor);\n      }\n      var caret = setup$4(editor);\n      setup$f(editor, caret);\n      setup$d(editor);\n      setup$g(editor);\n      var setupRtcThunk = setup$i(editor);\n      preInit(editor);\n      setupRtcThunk.fold(function () {\n        loadContentCss(editor).then(function () {\n          return initEditorWithInitialContent(editor);\n        });\n      }, function (setupRtc) {\n        editor.setProgressState(true);\n        loadContentCss(editor).then(function () {\n          setupRtc().then(function (_rtcMode) {\n            editor.setProgressState(false);\n            initEditorWithInitialContent(editor);\n          }, function (err) {\n            editor.notificationManager.open({\n              type: 'error',\n              text: String(err)\n            });\n            initEditorWithInitialContent(editor);\n          });\n        });\n      });\n    };\n\n    var DOM$5 = DOMUtils.DOM;\n    var relaxDomain = function (editor, ifr) {\n      if (document.domain !== window.location.hostname && Env.browser.isIE()) {\n        var bodyUuid = uuid('mce');\n        editor[bodyUuid] = function () {\n          initContentBody(editor);\n        };\n        var domainRelaxUrl = 'javascript:(function(){' + 'document.open();document.domain=\"' + document.domain + '\";' + 'var ed = window.parent.tinymce.get(\"' + editor.id + '\");document.write(ed.iframeHTML);' + 'document.close();ed.' + bodyUuid + '(true);})()';\n        DOM$5.setAttrib(ifr, 'src', domainRelaxUrl);\n        return true;\n      }\n      return false;\n    };\n    var createIframeElement = function (id, title, height, customAttrs) {\n      var iframe = SugarElement.fromTag('iframe');\n      setAll$1(iframe, customAttrs);\n      setAll$1(iframe, {\n        id: id + '_ifr',\n        frameBorder: '0',\n        allowTransparency: 'true',\n        title: title\n      });\n      add$1(iframe, 'tox-edit-area__iframe');\n      return iframe;\n    };\n    var getIframeHtml = function (editor) {\n      var iframeHTML = getDocType(editor) + '<html><head>';\n      if (getDocumentBaseUrl(editor) !== editor.documentBaseUrl) {\n        iframeHTML += '<base href=\"' + editor.documentBaseURI.getURI() + '\" />';\n      }\n      iframeHTML += '<meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\" />';\n      var bodyId = getBodyId(editor);\n      var bodyClass = getBodyClass(editor);\n      var translatedAriaText = editor.translate(getIframeAriaText(editor));\n      if (getContentSecurityPolicy(editor)) {\n        iframeHTML += '<meta http-equiv=\"Content-Security-Policy\" content=\"' + getContentSecurityPolicy(editor) + '\" />';\n      }\n      iframeHTML += '</head>' + ('<body id=\"' + bodyId + '\" class=\"mce-content-body ' + bodyClass + '\" data-id=\"' + editor.id + '\" aria-label=\"' + translatedAriaText + '\">') + '<br>' + '</body></html>';\n      return iframeHTML;\n    };\n    var createIframe = function (editor, o) {\n      var iframeTitle = editor.translate('Rich Text Area');\n      var ifr = createIframeElement(editor.id, iframeTitle, o.height, getIframeAttrs(editor)).dom;\n      ifr.onload = function () {\n        ifr.onload = null;\n        editor.fire('load');\n      };\n      var isDomainRelaxed = relaxDomain(editor, ifr);\n      editor.contentAreaContainer = o.iframeContainer;\n      editor.iframeElement = ifr;\n      editor.iframeHTML = getIframeHtml(editor);\n      DOM$5.add(o.iframeContainer, ifr);\n      return isDomainRelaxed;\n    };\n    var init$1 = function (editor, boxInfo) {\n      var isDomainRelaxed = createIframe(editor, boxInfo);\n      if (boxInfo.editorContainer) {\n        DOM$5.get(boxInfo.editorContainer).style.display = editor.orgDisplay;\n        editor.hidden = DOM$5.isHidden(boxInfo.editorContainer);\n      }\n      editor.getElement().style.display = 'none';\n      DOM$5.setAttrib(editor.id, 'aria-hidden', 'true');\n      if (!isDomainRelaxed) {\n        initContentBody(editor);\n      }\n    };\n\n    var DOM$4 = DOMUtils.DOM;\n    var initPlugin = function (editor, initializedPlugins, plugin) {\n      var Plugin = PluginManager.get(plugin);\n      var pluginUrl = PluginManager.urls[plugin] || editor.documentBaseUrl.replace(/\\/$/, '');\n      plugin = Tools.trim(plugin);\n      if (Plugin && Tools.inArray(initializedPlugins, plugin) === -1) {\n        Tools.each(PluginManager.dependencies(plugin), function (dep) {\n          initPlugin(editor, initializedPlugins, dep);\n        });\n        if (editor.plugins[plugin]) {\n          return;\n        }\n        try {\n          var pluginInstance = new Plugin(editor, pluginUrl, editor.$);\n          editor.plugins[plugin] = pluginInstance;\n          if (pluginInstance.init) {\n            pluginInstance.init(editor, pluginUrl);\n            initializedPlugins.push(plugin);\n          }\n        } catch (e) {\n          pluginInitError(editor, plugin, e);\n        }\n      }\n    };\n    var trimLegacyPrefix = function (name) {\n      return name.replace(/^\\-/, '');\n    };\n    var initPlugins = function (editor) {\n      var initializedPlugins = [];\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (name) {\n        initPlugin(editor, initializedPlugins, trimLegacyPrefix(name));\n      });\n    };\n    var initIcons = function (editor) {\n      var iconPackName = Tools.trim(getIconPackName(editor));\n      var currentIcons = editor.ui.registry.getAll().icons;\n      var loadIcons = __assign(__assign({}, IconManager.get('default').icons), IconManager.get(iconPackName).icons);\n      each$j(loadIcons, function (svgData, icon) {\n        if (!has$2(currentIcons, icon)) {\n          editor.ui.registry.addIcon(icon, svgData);\n        }\n      });\n    };\n    var initTheme = function (editor) {\n      var theme = getTheme(editor);\n      if (isString$1(theme)) {\n        editor.settings.theme = trimLegacyPrefix(theme);\n        var Theme = ThemeManager.get(theme);\n        editor.theme = new Theme(editor, ThemeManager.urls[theme]);\n        if (editor.theme.init) {\n          editor.theme.init(editor, ThemeManager.urls[theme] || editor.documentBaseUrl.replace(/\\/$/, ''), editor.$);\n        }\n      } else {\n        editor.theme = {};\n      }\n    };\n    var renderFromLoadedTheme = function (editor) {\n      return editor.theme.renderUI();\n    };\n    var renderFromThemeFunc = function (editor) {\n      var elm = editor.getElement();\n      var theme = getTheme(editor);\n      var info = theme(editor, elm);\n      if (info.editorContainer.nodeType) {\n        info.editorContainer.id = info.editorContainer.id || editor.id + '_parent';\n      }\n      if (info.iframeContainer && info.iframeContainer.nodeType) {\n        info.iframeContainer.id = info.iframeContainer.id || editor.id + '_iframecontainer';\n      }\n      info.height = info.iframeHeight ? info.iframeHeight : elm.offsetHeight;\n      return info;\n    };\n    var createThemeFalseResult = function (element) {\n      return {\n        editorContainer: element,\n        iframeContainer: element,\n        api: {}\n      };\n    };\n    var renderThemeFalseIframe = function (targetElement) {\n      var iframeContainer = DOM$4.create('div');\n      DOM$4.insertAfter(iframeContainer, targetElement);\n      return createThemeFalseResult(iframeContainer);\n    };\n    var renderThemeFalse = function (editor) {\n      var targetElement = editor.getElement();\n      return editor.inline ? createThemeFalseResult(null) : renderThemeFalseIframe(targetElement);\n    };\n    var renderThemeUi = function (editor) {\n      var elm = editor.getElement();\n      editor.orgDisplay = elm.style.display;\n      if (isString$1(getTheme(editor))) {\n        return renderFromLoadedTheme(editor);\n      } else if (isFunction(getTheme(editor))) {\n        return renderFromThemeFunc(editor);\n      } else {\n        return renderThemeFalse(editor);\n      }\n    };\n    var augmentEditorUiApi = function (editor, api) {\n      var uiApiFacade = {\n        show: Optional.from(api.show).getOr(noop),\n        hide: Optional.from(api.hide).getOr(noop),\n        disable: Optional.from(api.disable).getOr(noop),\n        isDisabled: Optional.from(api.isDisabled).getOr(never),\n        enable: function () {\n          if (!editor.mode.isReadOnly()) {\n            Optional.from(api.enable).map(call);\n          }\n        }\n      };\n      editor.ui = __assign(__assign({}, editor.ui), uiApiFacade);\n    };\n    var init = function (editor) {\n      editor.fire('ScriptsLoaded');\n      initIcons(editor);\n      initTheme(editor);\n      initPlugins(editor);\n      var renderInfo = renderThemeUi(editor);\n      augmentEditorUiApi(editor, Optional.from(renderInfo.api).getOr({}));\n      var boxInfo = {\n        editorContainer: renderInfo.editorContainer,\n        iframeContainer: renderInfo.iframeContainer\n      };\n      editor.editorContainer = boxInfo.editorContainer ? boxInfo.editorContainer : null;\n      appendContentCssFromSettings(editor);\n      if (editor.inline) {\n        return initContentBody(editor);\n      } else {\n        return init$1(editor, boxInfo);\n      }\n    };\n\n    var DOM$3 = DOMUtils.DOM;\n    var hasSkipLoadPrefix = function (name) {\n      return name.charAt(0) === '-';\n    };\n    var loadLanguage = function (scriptLoader, editor) {\n      var languageCode = getLanguageCode(editor);\n      var languageUrl = getLanguageUrl(editor);\n      if (I18n.hasCode(languageCode) === false && languageCode !== 'en') {\n        var url_1 = languageUrl !== '' ? languageUrl : editor.editorManager.baseURL + '/langs/' + languageCode + '.js';\n        scriptLoader.add(url_1, noop, undefined, function () {\n          languageLoadError(editor, url_1, languageCode);\n        });\n      }\n    };\n    var loadTheme = function (scriptLoader, editor, suffix, callback) {\n      var theme = getTheme(editor);\n      if (isString$1(theme)) {\n        if (!hasSkipLoadPrefix(theme) && !has$2(ThemeManager.urls, theme)) {\n          var themeUrl = getThemeUrl(editor);\n          if (themeUrl) {\n            ThemeManager.load(theme, editor.documentBaseURI.toAbsolute(themeUrl));\n          } else {\n            ThemeManager.load(theme, 'themes/' + theme + '/theme' + suffix + '.js');\n          }\n        }\n        scriptLoader.loadQueue(function () {\n          ThemeManager.waitFor(theme, callback);\n        });\n      } else {\n        callback();\n      }\n    };\n    var getIconsUrlMetaFromUrl = function (editor) {\n      return Optional.from(getIconsUrl(editor)).filter(function (url) {\n        return url.length > 0;\n      }).map(function (url) {\n        return {\n          url: url,\n          name: Optional.none()\n        };\n      });\n    };\n    var getIconsUrlMetaFromName = function (editor, name, suffix) {\n      return Optional.from(name).filter(function (name) {\n        return name.length > 0 && !IconManager.has(name);\n      }).map(function (name) {\n        return {\n          url: editor.editorManager.baseURL + '/icons/' + name + '/icons' + suffix + '.js',\n          name: Optional.some(name)\n        };\n      });\n    };\n    var loadIcons = function (scriptLoader, editor, suffix) {\n      var defaultIconsUrl = getIconsUrlMetaFromName(editor, 'default', suffix);\n      var customIconsUrl = getIconsUrlMetaFromUrl(editor).orThunk(function () {\n        return getIconsUrlMetaFromName(editor, getIconPackName(editor), '');\n      });\n      each$k(cat([\n        defaultIconsUrl,\n        customIconsUrl\n      ]), function (urlMeta) {\n        scriptLoader.add(urlMeta.url, noop, undefined, function () {\n          iconsLoadError(editor, urlMeta.url, urlMeta.name.getOrUndefined());\n        });\n      });\n    };\n    var loadPlugins = function (editor, suffix) {\n      Tools.each(getExternalPlugins$1(editor), function (url, name) {\n        PluginManager.load(name, url, noop, undefined, function () {\n          pluginLoadError(editor, url, name);\n        });\n        editor.settings.plugins += ' ' + name;\n      });\n      Tools.each(getPlugins(editor).split(/[ ,]/), function (plugin) {\n        plugin = Tools.trim(plugin);\n        if (plugin && !PluginManager.urls[plugin]) {\n          if (hasSkipLoadPrefix(plugin)) {\n            plugin = plugin.substr(1, plugin.length);\n            var dependencies = PluginManager.dependencies(plugin);\n            Tools.each(dependencies, function (depPlugin) {\n              var defaultSettings = {\n                prefix: 'plugins/',\n                resource: depPlugin,\n                suffix: '/plugin' + suffix + '.js'\n              };\n              var dep = PluginManager.createUrl(defaultSettings, depPlugin);\n              PluginManager.load(dep.resource, dep, noop, undefined, function () {\n                pluginLoadError(editor, dep.prefix + dep.resource + dep.suffix, dep.resource);\n              });\n            });\n          } else {\n            var url_2 = {\n              prefix: 'plugins/',\n              resource: plugin,\n              suffix: '/plugin' + suffix + '.js'\n            };\n            PluginManager.load(plugin, url_2, noop, undefined, function () {\n              pluginLoadError(editor, url_2.prefix + url_2.resource + url_2.suffix, plugin);\n            });\n          }\n        }\n      });\n    };\n    var loadScripts = function (editor, suffix) {\n      var scriptLoader = ScriptLoader.ScriptLoader;\n      loadTheme(scriptLoader, editor, suffix, function () {\n        loadLanguage(scriptLoader, editor);\n        loadIcons(scriptLoader, editor, suffix);\n        loadPlugins(editor, suffix);\n        scriptLoader.loadQueue(function () {\n          if (!editor.removed) {\n            init(editor);\n          }\n        }, editor, function () {\n          if (!editor.removed) {\n            init(editor);\n          }\n        });\n      });\n    };\n    var getStyleSheetLoader = function (element, editor) {\n      return instance.forElement(element, {\n        contentCssCors: hasContentCssCors(editor),\n        referrerPolicy: getReferrerPolicy(editor)\n      });\n    };\n    var render = function (editor) {\n      var id = editor.id;\n      I18n.setCode(getLanguageCode(editor));\n      var readyHandler = function () {\n        DOM$3.unbind(window, 'ready', readyHandler);\n        editor.render();\n      };\n      if (!EventUtils.Event.domLoaded) {\n        DOM$3.bind(window, 'ready', readyHandler);\n        return;\n      }\n      if (!editor.getElement()) {\n        return;\n      }\n      if (!Env.contentEditable) {\n        return;\n      }\n      var element = SugarElement.fromDom(editor.getElement());\n      var snapshot = clone$3(element);\n      editor.on('remove', function () {\n        eachr(element.dom.attributes, function (attr) {\n          return remove$6(element, attr.name);\n        });\n        setAll$1(element, snapshot);\n      });\n      editor.ui.styleSheetLoader = getStyleSheetLoader(element, editor);\n      if (!isInline(editor)) {\n        editor.orgVisibility = editor.getElement().style.visibility;\n        editor.getElement().style.visibility = 'hidden';\n      } else {\n        editor.inline = true;\n      }\n      var form = editor.getElement().form || DOM$3.getParent(id, 'form');\n      if (form) {\n        editor.formElement = form;\n        if (hasHiddenInput(editor) && !isTextareaOrInput(editor.getElement())) {\n          DOM$3.insertAfter(DOM$3.create('input', {\n            type: 'hidden',\n            name: id\n          }), id);\n          editor.hasHiddenInput = true;\n        }\n        editor.formEventDelegate = function (e) {\n          editor.fire(e.type, e);\n        };\n        DOM$3.bind(form, 'submit reset', editor.formEventDelegate);\n        editor.on('reset', function () {\n          editor.resetContent();\n        });\n        if (shouldPatchSubmit(editor) && !form.submit.nodeType && !form.submit.length && !form._mceOldSubmit) {\n          form._mceOldSubmit = form.submit;\n          form.submit = function () {\n            editor.editorManager.triggerSave();\n            editor.setDirty(false);\n            return form._mceOldSubmit(form);\n          };\n        }\n      }\n      editor.windowManager = WindowManager(editor);\n      editor.notificationManager = NotificationManager(editor);\n      if (isEncodingXml(editor)) {\n        editor.on('GetContent', function (e) {\n          if (e.save) {\n            e.content = DOM$3.encode(e.content);\n          }\n        });\n      }\n      if (shouldAddFormSubmitTrigger(editor)) {\n        editor.on('submit', function () {\n          if (editor.initialized) {\n            editor.save();\n          }\n        });\n      }\n      if (shouldAddUnloadTrigger(editor)) {\n        editor._beforeUnload = function () {\n          if (editor.initialized && !editor.destroyed && !editor.isHidden()) {\n            editor.save({\n              format: 'raw',\n              no_events: true,\n              set_dirty: false\n            });\n          }\n        };\n        editor.editorManager.on('BeforeUnload', editor._beforeUnload);\n      }\n      editor.editorManager.add(editor);\n      loadScripts(editor, editor.suffix);\n    };\n\n    var addVisual = function (editor, elm) {\n      return addVisual$1(editor, elm);\n    };\n\n    var legacyPropNames = {\n      'font-size': 'size',\n      'font-family': 'face'\n    };\n    var getSpecifiedFontProp = function (propName, rootElm, elm) {\n      var getProperty = function (elm) {\n        return getRaw(elm, propName).orThunk(function () {\n          if (name(elm) === 'font') {\n            return get$9(legacyPropNames, propName).bind(function (legacyPropName) {\n              return getOpt(elm, legacyPropName);\n            });\n          } else {\n            return Optional.none();\n          }\n        });\n      };\n      var isRoot = function (elm) {\n        return eq(SugarElement.fromDom(rootElm), elm);\n      };\n      return closest$1(SugarElement.fromDom(elm), function (elm) {\n        return getProperty(elm);\n      }, isRoot);\n    };\n    var normalizeFontFamily = function (fontFamily) {\n      return fontFamily.replace(/[\\'\\\"\\\\]/g, '').replace(/,\\s+/g, ',');\n    };\n    var getComputedFontProp = function (propName, elm) {\n      return Optional.from(DOMUtils.DOM.getStyle(elm, propName, true));\n    };\n    var getFontProp = function (propName) {\n      return function (rootElm, elm) {\n        return Optional.from(elm).map(SugarElement.fromDom).filter(isElement$6).bind(function (element) {\n          return getSpecifiedFontProp(propName, rootElm, element.dom).or(getComputedFontProp(propName, element.dom));\n        }).getOr('');\n      };\n    };\n    var getFontSize = getFontProp('font-size');\n    var getFontFamily = compose(normalizeFontFamily, getFontProp('font-family'));\n\n    var findFirstCaretElement = function (editor) {\n      return firstPositionIn(editor.getBody()).map(function (caret) {\n        var container = caret.container();\n        return isText$7(container) ? container.parentNode : container;\n      });\n    };\n    var getCaretElement = function (editor) {\n      return Optional.from(editor.selection.getRng()).bind(function (rng) {\n        var root = editor.getBody();\n        var atStartOfNode = rng.startContainer === root && rng.startOffset === 0;\n        return atStartOfNode ? Optional.none() : Optional.from(editor.selection.getStart(true));\n      });\n    };\n    var bindRange = function (editor, binder) {\n      return getCaretElement(editor).orThunk(curry(findFirstCaretElement, editor)).map(SugarElement.fromDom).filter(isElement$6).bind(binder);\n    };\n    var mapRange = function (editor, mapper) {\n      return bindRange(editor, compose1(Optional.some, mapper));\n    };\n\n    var fromFontSizeNumber = function (editor, value) {\n      if (/^[0-9.]+$/.test(value)) {\n        var fontSizeNumber = parseInt(value, 10);\n        if (fontSizeNumber >= 1 && fontSizeNumber <= 7) {\n          var fontSizes = getFontStyleValues(editor);\n          var fontClasses = getFontSizeClasses(editor);\n          if (fontClasses) {\n            return fontClasses[fontSizeNumber - 1] || value;\n          } else {\n            return fontSizes[fontSizeNumber - 1] || value;\n          }\n        } else {\n          return value;\n        }\n      } else {\n        return value;\n      }\n    };\n    var normalizeFontNames = function (font) {\n      var fonts = font.split(/\\s*,\\s*/);\n      return map$3(fonts, function (font) {\n        if (font.indexOf(' ') !== -1 && !(startsWith(font, '\"') || startsWith(font, '\\''))) {\n          return '\\'' + font + '\\'';\n        } else {\n          return font;\n        }\n      }).join(',');\n    };\n    var fontNameAction = function (editor, value) {\n      var font = fromFontSizeNumber(editor, value);\n      editor.formatter.toggle('fontname', { value: normalizeFontNames(font) });\n      editor.nodeChanged();\n    };\n    var fontNameQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontFamily(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n    var fontSizeAction = function (editor, value) {\n      editor.formatter.toggle('fontsize', { value: fromFontSizeNumber(editor, value) });\n      editor.nodeChanged();\n    };\n    var fontSizeQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        return getFontSize(editor.getBody(), elm.dom);\n      }).getOr('');\n    };\n\n    var lineHeightQuery = function (editor) {\n      return mapRange(editor, function (elm) {\n        var root = SugarElement.fromDom(editor.getBody());\n        var specifiedStyle = closest$1(elm, function (elm) {\n          return getRaw(elm, 'line-height');\n        }, curry(eq, root));\n        var computedStyle = function () {\n          var lineHeight = parseFloat(get$5(elm, 'line-height'));\n          var fontSize = parseFloat(get$5(elm, 'font-size'));\n          return String(lineHeight / fontSize);\n        };\n        return specifiedStyle.getOrThunk(computedStyle);\n      }).getOr('');\n    };\n    var lineHeightAction = function (editor, lineHeight) {\n      editor.formatter.toggle('lineheight', { value: String(lineHeight) });\n      editor.nodeChanged();\n    };\n\n    var processValue = function (value) {\n      if (typeof value !== 'string') {\n        var details = Tools.extend({\n          paste: value.paste,\n          data: { paste: value.paste }\n        }, value);\n        return {\n          content: value.content,\n          details: details\n        };\n      }\n      return {\n        content: value,\n        details: {}\n      };\n    };\n    var insertAtCaret = function (editor, value) {\n      var result = processValue(value);\n      insertContent(editor, result.content, result.details);\n    };\n\n    var each$4 = Tools.each;\n    var map = Tools.map, inArray = Tools.inArray;\n    var EditorCommands = function () {\n      function EditorCommands(editor) {\n        this.commands = {\n          state: {},\n          exec: {},\n          value: {}\n        };\n        this.editor = editor;\n        this.setupCommands(editor);\n      }\n      EditorCommands.prototype.execCommand = function (command, ui, value, args) {\n        var func, state = false;\n        var self = this;\n        if (self.editor.removed) {\n          return;\n        }\n        if (command.toLowerCase() !== 'mcefocus') {\n          if (!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint)$/.test(command) && (!args || !args.skip_focus)) {\n            self.editor.focus();\n          } else {\n            restore(self.editor);\n          }\n        }\n        args = self.editor.fire('BeforeExecCommand', {\n          command: command,\n          ui: ui,\n          value: value\n        });\n        if (args.isDefaultPrevented()) {\n          return false;\n        }\n        var customCommand = command.toLowerCase();\n        if (func = self.commands.exec[customCommand]) {\n          func(customCommand, ui, value);\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        each$4(this.editor.plugins, function (p) {\n          if (p.execCommand && p.execCommand(command, ui, value)) {\n            self.editor.fire('ExecCommand', {\n              command: command,\n              ui: ui,\n              value: value\n            });\n            state = true;\n            return false;\n          }\n        });\n        if (state) {\n          return state;\n        }\n        if (self.editor.theme && self.editor.theme.execCommand && self.editor.theme.execCommand(command, ui, value)) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        try {\n          state = self.editor.getDoc().execCommand(command, ui, value);\n        } catch (ex) {\n        }\n        if (state) {\n          self.editor.fire('ExecCommand', {\n            command: command,\n            ui: ui,\n            value: value\n          });\n          return true;\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandState = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.state[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandState(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.queryCommandValue = function (command) {\n        var func;\n        if (this.editor.quirks.isHidden() || this.editor.removed) {\n          return;\n        }\n        command = command.toLowerCase();\n        if (func = this.commands.value[command]) {\n          return func(command);\n        }\n        try {\n          return this.editor.getDoc().queryCommandValue(command);\n        } catch (ex) {\n        }\n      };\n      EditorCommands.prototype.addCommands = function (commandList, type) {\n        if (type === void 0) {\n          type = 'exec';\n        }\n        var self = this;\n        each$4(commandList, function (callback, command) {\n          each$4(command.toLowerCase().split(','), function (command) {\n            self.commands[type][command] = callback;\n          });\n        });\n      };\n      EditorCommands.prototype.addCommand = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.exec[command] = function (command, ui, value, args) {\n          return callback.call(scope || _this.editor, ui, value, args);\n        };\n      };\n      EditorCommands.prototype.queryCommandSupported = function (command) {\n        command = command.toLowerCase();\n        if (this.commands.exec[command]) {\n          return true;\n        }\n        try {\n          return this.editor.getDoc().queryCommandSupported(command);\n        } catch (ex) {\n        }\n        return false;\n      };\n      EditorCommands.prototype.addQueryStateHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.state[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.addQueryValueHandler = function (command, callback, scope) {\n        var _this = this;\n        command = command.toLowerCase();\n        this.commands.value[command] = function () {\n          return callback.call(scope || _this.editor);\n        };\n      };\n      EditorCommands.prototype.hasCustomCommand = function (command) {\n        command = command.toLowerCase();\n        return !!this.commands.exec[command];\n      };\n      EditorCommands.prototype.execNativeCommand = function (command, ui, value) {\n        if (ui === undefined) {\n          ui = false;\n        }\n        if (value === undefined) {\n          value = null;\n        }\n        return this.editor.getDoc().execCommand(command, ui, value);\n      };\n      EditorCommands.prototype.isFormatMatch = function (name) {\n        return this.editor.formatter.match(name);\n      };\n      EditorCommands.prototype.toggleFormat = function (name, value) {\n        this.editor.formatter.toggle(name, value);\n        this.editor.nodeChanged();\n      };\n      EditorCommands.prototype.storeSelection = function (type) {\n        this.selectionBookmark = this.editor.selection.getBookmark(type);\n      };\n      EditorCommands.prototype.restoreSelection = function () {\n        this.editor.selection.moveToBookmark(this.selectionBookmark);\n      };\n      EditorCommands.prototype.setupCommands = function (editor) {\n        var self = this;\n        this.addCommands({\n          'mceResetDesignMode,mceBeginUndoLevel': noop,\n          'mceEndUndoLevel,mceAddUndoLevel': function () {\n            editor.undoManager.add();\n          },\n          'mceFocus': function (_command, _ui, value) {\n            focus(editor, value);\n          },\n          'Cut,Copy,Paste': function (command) {\n            var doc = editor.getDoc();\n            var failed;\n            try {\n              self.execNativeCommand(command);\n            } catch (ex) {\n              failed = true;\n            }\n            if (command === 'paste' && !doc.queryCommandEnabled(command)) {\n              failed = true;\n            }\n            if (failed || !doc.queryCommandSupported(command)) {\n              var msg = editor.translate('Your browser doesn\\'t support direct access to the clipboard. ' + 'Please use the Ctrl+X/C/V keyboard shortcuts instead.');\n              if (Env.mac) {\n                msg = msg.replace(/Ctrl\\+/g, '\\u2318+');\n              }\n              editor.notificationManager.open({\n                text: msg,\n                type: 'error'\n              });\n            }\n          },\n          'unlink': function () {\n            if (editor.selection.isCollapsed()) {\n              var elm = editor.dom.getParent(editor.selection.getStart(), 'a');\n              if (elm) {\n                editor.dom.remove(elm, true);\n              }\n              return;\n            }\n            editor.formatter.remove('link');\n          },\n          'JustifyLeft,JustifyCenter,JustifyRight,JustifyFull,JustifyNone': function (command) {\n            var align = command.substring(7);\n            if (align === 'full') {\n              align = 'justify';\n            }\n            each$4('left,center,right,justify'.split(','), function (name) {\n              if (align !== name) {\n                editor.formatter.remove('align' + name);\n              }\n            });\n            if (align !== 'none') {\n              self.toggleFormat('align' + align);\n            }\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var listParent;\n            self.execNativeCommand(command);\n            var listElm = editor.dom.getParent(editor.selection.getNode(), 'ol,ul');\n            if (listElm) {\n              listParent = listElm.parentNode;\n              if (/^(H[1-6]|P|ADDRESS|PRE)$/.test(listParent.nodeName)) {\n                self.storeSelection();\n                editor.dom.split(listParent, listElm);\n                self.restoreSelection();\n              }\n            }\n          },\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            self.toggleFormat(command);\n          },\n          'ForeColor,HiliteColor': function (command, ui, value) {\n            self.toggleFormat(command, { value: value });\n          },\n          'FontName': function (command, ui, value) {\n            fontNameAction(editor, value);\n          },\n          'FontSize': function (command, ui, value) {\n            fontSizeAction(editor, value);\n          },\n          'LineHeight': function (command, ui, value) {\n            lineHeightAction(editor, value);\n          },\n          'Lang': function (command, ui, lang) {\n            self.toggleFormat(command, {\n              value: lang.code,\n              customValue: lang.customCode\n            });\n          },\n          'RemoveFormat': function (command) {\n            editor.formatter.remove(command);\n          },\n          'mceBlockQuote': function () {\n            self.toggleFormat('blockquote');\n          },\n          'FormatBlock': function (command, ui, value) {\n            return self.toggleFormat(value || 'p');\n          },\n          'mceCleanup': function () {\n            var bookmark = editor.selection.getBookmark();\n            editor.setContent(editor.getContent());\n            editor.selection.moveToBookmark(bookmark);\n          },\n          'mceRemoveNode': function (command, ui, value) {\n            var node = value || editor.selection.getNode();\n            if (node !== editor.getBody()) {\n              self.storeSelection();\n              editor.dom.remove(node, true);\n              self.restoreSelection();\n            }\n          },\n          'mceSelectNodeDepth': function (command, ui, value) {\n            var counter = 0;\n            editor.dom.getParent(editor.selection.getNode(), function (node) {\n              if (node.nodeType === 1 && counter++ === value) {\n                editor.selection.select(node);\n                return false;\n              }\n            }, editor.getBody());\n          },\n          'mceSelectNode': function (command, ui, value) {\n            editor.selection.select(value);\n          },\n          'mceInsertContent': function (command, ui, value) {\n            insertAtCaret(editor, value);\n          },\n          'mceInsertRawHTML': function (command, ui, value) {\n            editor.selection.setContent('tiny_mce_marker');\n            var content = editor.getContent();\n            editor.setContent(content.replace(/tiny_mce_marker/g, function () {\n              return value;\n            }));\n          },\n          'mceInsertNewLine': function (command, ui, value) {\n            insert(editor, value);\n          },\n          'mceToggleFormat': function (command, ui, value) {\n            self.toggleFormat(value);\n          },\n          'mceSetContent': function (command, ui, value) {\n            editor.setContent(value);\n          },\n          'Indent,Outdent': function (command) {\n            handle(editor, command);\n          },\n          'mceRepaint': noop,\n          'InsertHorizontalRule': function () {\n            editor.execCommand('mceInsertContent', false, '<hr />');\n          },\n          'mceToggleVisualAid': function () {\n            editor.hasVisual = !editor.hasVisual;\n            editor.addVisual();\n          },\n          'mceReplaceContent': function (command, ui, value) {\n            editor.execCommand('mceInsertContent', false, value.replace(/\\{\\$selection\\}/g, editor.selection.getContent({ format: 'text' })));\n          },\n          'mceInsertLink': function (command, ui, value) {\n            if (typeof value === 'string') {\n              value = { href: value };\n            }\n            var anchor = editor.dom.getParent(editor.selection.getNode(), 'a');\n            value.href = value.href.replace(/ /g, '%20');\n            if (!anchor || !value.href) {\n              editor.formatter.remove('link');\n            }\n            if (value.href) {\n              editor.formatter.apply('link', value, anchor);\n            }\n          },\n          'selectAll': function () {\n            var editingHost = editor.dom.getParent(editor.selection.getStart(), isContentEditableTrue$4);\n            if (editingHost) {\n              var rng = editor.dom.createRng();\n              rng.selectNodeContents(editingHost);\n              editor.selection.setRng(rng);\n            }\n          },\n          'mceNewDocument': function () {\n            editor.setContent('');\n          },\n          'InsertLineBreak': function (command, ui, value) {\n            insert$1(editor, value);\n            return true;\n          }\n        });\n        var alignStates = function (name) {\n          return function () {\n            var selection = editor.selection;\n            var nodes = selection.isCollapsed() ? [editor.dom.getParent(selection.getNode(), editor.dom.isBlock)] : selection.getSelectedBlocks();\n            var matches = map(nodes, function (node) {\n              return !!editor.formatter.matchNode(node, name);\n            });\n            return inArray(matches, true) !== -1;\n          };\n        };\n        self.addCommands({\n          'JustifyLeft': alignStates('alignleft'),\n          'JustifyCenter': alignStates('aligncenter'),\n          'JustifyRight': alignStates('alignright'),\n          'JustifyFull': alignStates('alignjustify'),\n          'Bold,Italic,Underline,Strikethrough,Superscript,Subscript': function (command) {\n            return self.isFormatMatch(command);\n          },\n          'mceBlockQuote': function () {\n            return self.isFormatMatch('blockquote');\n          },\n          'Outdent': function () {\n            return canOutdent(editor);\n          },\n          'InsertUnorderedList,InsertOrderedList': function (command) {\n            var list = editor.dom.getParent(editor.selection.getNode(), 'ul,ol');\n            return list && (command === 'insertunorderedlist' && list.tagName === 'UL' || command === 'insertorderedlist' && list.tagName === 'OL');\n          }\n        }, 'state');\n        self.addCommands({\n          Undo: function () {\n            editor.undoManager.undo();\n          },\n          Redo: function () {\n            editor.undoManager.redo();\n          }\n        });\n        self.addQueryValueHandler('FontName', function () {\n          return fontNameQuery(editor);\n        }, this);\n        self.addQueryValueHandler('FontSize', function () {\n          return fontSizeQuery(editor);\n        }, this);\n        self.addQueryValueHandler('LineHeight', function () {\n          return lineHeightQuery(editor);\n        }, this);\n      };\n      return EditorCommands;\n    }();\n\n    var internalContentEditableAttr = 'data-mce-contenteditable';\n    var toggleClass = function (elm, cls, state) {\n      if (has(elm, cls) && state === false) {\n        remove$3(elm, cls);\n      } else if (state) {\n        add$1(elm, cls);\n      }\n    };\n    var setEditorCommandState = function (editor, cmd, state) {\n      try {\n        editor.getDoc().execCommand(cmd, false, String(state));\n      } catch (ex) {\n      }\n    };\n    var setContentEditable = function (elm, state) {\n      elm.dom.contentEditable = state ? 'true' : 'false';\n    };\n    var switchOffContentEditableTrue = function (elm) {\n      each$k(descendants(elm, '*[contenteditable=\"true\"]'), function (elm) {\n        set$1(elm, internalContentEditableAttr, 'true');\n        setContentEditable(elm, false);\n      });\n    };\n    var switchOnContentEditableTrue = function (elm) {\n      each$k(descendants(elm, '*[' + internalContentEditableAttr + '=\"true\"]'), function (elm) {\n        remove$6(elm, internalContentEditableAttr);\n        setContentEditable(elm, true);\n      });\n    };\n    var removeFakeSelection = function (editor) {\n      Optional.from(editor.selection.getNode()).each(function (elm) {\n        elm.removeAttribute('data-mce-selected');\n      });\n    };\n    var restoreFakeSelection = function (editor) {\n      editor.selection.setRng(editor.selection.getRng());\n    };\n    var toggleReadOnly = function (editor, state) {\n      var body = SugarElement.fromDom(editor.getBody());\n      toggleClass(body, 'mce-content-readonly', state);\n      if (state) {\n        editor.selection.controlSelection.hideResizeRect();\n        editor._selectionOverrides.hideFakeCaret();\n        removeFakeSelection(editor);\n        editor.readonly = true;\n        setContentEditable(body, false);\n        switchOffContentEditableTrue(body);\n      } else {\n        editor.readonly = false;\n        setContentEditable(body, true);\n        switchOnContentEditableTrue(body);\n        setEditorCommandState(editor, 'StyleWithCSS', false);\n        setEditorCommandState(editor, 'enableInlineTableEditing', false);\n        setEditorCommandState(editor, 'enableObjectResizing', false);\n        if (hasEditorOrUiFocus(editor)) {\n          editor.focus();\n        }\n        restoreFakeSelection(editor);\n        editor.nodeChanged();\n      }\n    };\n    var isReadOnly = function (editor) {\n      return editor.readonly;\n    };\n    var registerFilters = function (editor) {\n      editor.parser.addAttributeFilter('contenteditable', function (nodes) {\n        if (isReadOnly(editor)) {\n          each$k(nodes, function (node) {\n            node.attr(internalContentEditableAttr, node.attr('contenteditable'));\n            node.attr('contenteditable', 'false');\n          });\n        }\n      });\n      editor.serializer.addAttributeFilter(internalContentEditableAttr, function (nodes) {\n        if (isReadOnly(editor)) {\n          each$k(nodes, function (node) {\n            node.attr('contenteditable', node.attr(internalContentEditableAttr));\n          });\n        }\n      });\n      editor.serializer.addTempAttr(internalContentEditableAttr);\n    };\n    var registerReadOnlyContentFilters = function (editor) {\n      if (editor.serializer) {\n        registerFilters(editor);\n      } else {\n        editor.on('PreInit', function () {\n          registerFilters(editor);\n        });\n      }\n    };\n    var isClickEvent = function (e) {\n      return e.type === 'click';\n    };\n    var getAnchorHrefOpt = function (editor, elm) {\n      var isRoot = function (elm) {\n        return eq(elm, SugarElement.fromDom(editor.getBody()));\n      };\n      return closest$2(elm, 'a', isRoot).bind(function (a) {\n        return getOpt(a, 'href');\n      });\n    };\n    var processReadonlyEvents = function (editor, e) {\n      if (isClickEvent(e) && !VK.metaKeyPressed(e)) {\n        var elm = SugarElement.fromDom(e.target);\n        getAnchorHrefOpt(editor, elm).each(function (href) {\n          e.preventDefault();\n          if (/^#/.test(href)) {\n            var targetEl = editor.dom.select(href + ',[name=\"' + removeLeading(href, '#') + '\"]');\n            if (targetEl.length) {\n              editor.selection.scrollIntoView(targetEl[0], true);\n            }\n          } else {\n            window.open(href, '_blank', 'rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes');\n          }\n        });\n      }\n    };\n    var registerReadOnlySelectionBlockers = function (editor) {\n      editor.on('ShowCaret', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n      editor.on('ObjectSelected', function (e) {\n        if (isReadOnly(editor)) {\n          e.preventDefault();\n        }\n      });\n    };\n\n    var nativeEvents = Tools.makeMap('focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange ' + 'mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover ' + 'draggesture dragdrop drop drag submit ' + 'compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel', ' ');\n    var EventDispatcher = function () {\n      function EventDispatcher(settings) {\n        this.bindings = {};\n        this.settings = settings || {};\n        this.scope = this.settings.scope || this;\n        this.toggleEvent = this.settings.toggleEvent || never;\n      }\n      EventDispatcher.isNative = function (name) {\n        return !!nativeEvents[name.toLowerCase()];\n      };\n      EventDispatcher.prototype.fire = function (name, args) {\n        var lcName = name.toLowerCase();\n        var event = normalize$3(lcName, args || {}, this.scope);\n        if (this.settings.beforeFire) {\n          this.settings.beforeFire(event);\n        }\n        var handlers = this.bindings[lcName];\n        if (handlers) {\n          for (var i = 0, l = handlers.length; i < l; i++) {\n            var callback = handlers[i];\n            if (callback.removed) {\n              continue;\n            }\n            if (callback.once) {\n              this.off(lcName, callback.func);\n            }\n            if (event.isImmediatePropagationStopped()) {\n              return event;\n            }\n            if (callback.func.call(this.scope, event) === false) {\n              event.preventDefault();\n              return event;\n            }\n          }\n        }\n        return event;\n      };\n      EventDispatcher.prototype.on = function (name, callback, prepend, extra) {\n        if (callback === false) {\n          callback = never;\n        }\n        if (callback) {\n          var wrappedCallback = {\n            func: callback,\n            removed: false\n          };\n          if (extra) {\n            Tools.extend(wrappedCallback, extra);\n          }\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!handlers) {\n              handlers = [];\n              this.toggleEvent(currentName, true);\n            }\n            if (prepend) {\n              handlers = __spreadArray([wrappedCallback], handlers, true);\n            } else {\n              handlers = __spreadArray(__spreadArray([], handlers, true), [wrappedCallback], false);\n            }\n            this.bindings[currentName] = handlers;\n          }\n        }\n        return this;\n      };\n      EventDispatcher.prototype.off = function (name, callback) {\n        var _this = this;\n        if (name) {\n          var names = name.toLowerCase().split(' ');\n          var i = names.length;\n          while (i--) {\n            var currentName = names[i];\n            var handlers = this.bindings[currentName];\n            if (!currentName) {\n              each$j(this.bindings, function (_value, bindingName) {\n                _this.toggleEvent(bindingName, false);\n                delete _this.bindings[bindingName];\n              });\n              return this;\n            }\n            if (handlers) {\n              if (!callback) {\n                handlers.length = 0;\n              } else {\n                var filteredHandlers = partition(handlers, function (handler) {\n                  return handler.func === callback;\n                });\n                handlers = filteredHandlers.fail;\n                this.bindings[currentName] = handlers;\n                each$k(filteredHandlers.pass, function (handler) {\n                  handler.removed = true;\n                });\n              }\n              if (!handlers.length) {\n                this.toggleEvent(name, false);\n                delete this.bindings[currentName];\n              }\n            }\n          }\n        } else {\n          each$j(this.bindings, function (_value, name) {\n            _this.toggleEvent(name, false);\n          });\n          this.bindings = {};\n        }\n        return this;\n      };\n      EventDispatcher.prototype.once = function (name, callback, prepend) {\n        return this.on(name, callback, prepend, { once: true });\n      };\n      EventDispatcher.prototype.has = function (name) {\n        name = name.toLowerCase();\n        return !(!this.bindings[name] || this.bindings[name].length === 0);\n      };\n      return EventDispatcher;\n    }();\n\n    var getEventDispatcher = function (obj) {\n      if (!obj._eventDispatcher) {\n        obj._eventDispatcher = new EventDispatcher({\n          scope: obj,\n          toggleEvent: function (name, state) {\n            if (EventDispatcher.isNative(name) && obj.toggleNativeEvent) {\n              obj.toggleNativeEvent(name, state);\n            }\n          }\n        });\n      }\n      return obj._eventDispatcher;\n    };\n    var Observable = {\n      fire: function (name, args, bubble) {\n        var self = this;\n        if (self.removed && name !== 'remove' && name !== 'detach') {\n          return args;\n        }\n        var dispatcherArgs = getEventDispatcher(self).fire(name, args);\n        if (bubble !== false && self.parent) {\n          var parent_1 = self.parent();\n          while (parent_1 && !dispatcherArgs.isPropagationStopped()) {\n            parent_1.fire(name, dispatcherArgs, false);\n            parent_1 = parent_1.parent();\n          }\n        }\n        return dispatcherArgs;\n      },\n      on: function (name, callback, prepend) {\n        return getEventDispatcher(this).on(name, callback, prepend);\n      },\n      off: function (name, callback) {\n        return getEventDispatcher(this).off(name, callback);\n      },\n      once: function (name, callback) {\n        return getEventDispatcher(this).once(name, callback);\n      },\n      hasEventListeners: function (name) {\n        return getEventDispatcher(this).has(name);\n      }\n    };\n\n    var DOM$2 = DOMUtils.DOM;\n    var customEventRootDelegates;\n    var getEventTarget = function (editor, eventName) {\n      if (eventName === 'selectionchange') {\n        return editor.getDoc();\n      }\n      if (!editor.inline && /^mouse|touch|click|contextmenu|drop|dragover|dragend/.test(eventName)) {\n        return editor.getDoc().documentElement;\n      }\n      var eventRoot = getEventRoot(editor);\n      if (eventRoot) {\n        if (!editor.eventRoot) {\n          editor.eventRoot = DOM$2.select(eventRoot)[0];\n        }\n        return editor.eventRoot;\n      }\n      return editor.getBody();\n    };\n    var isListening = function (editor) {\n      return !editor.hidden && !isReadOnly(editor);\n    };\n    var fireEvent = function (editor, eventName, e) {\n      if (isListening(editor)) {\n        editor.fire(eventName, e);\n      } else if (isReadOnly(editor)) {\n        processReadonlyEvents(editor, e);\n      }\n    };\n    var bindEventDelegate = function (editor, eventName) {\n      var delegate;\n      if (!editor.delegates) {\n        editor.delegates = {};\n      }\n      if (editor.delegates[eventName] || editor.removed) {\n        return;\n      }\n      var eventRootElm = getEventTarget(editor, eventName);\n      if (getEventRoot(editor)) {\n        if (!customEventRootDelegates) {\n          customEventRootDelegates = {};\n          editor.editorManager.on('removeEditor', function () {\n            if (!editor.editorManager.activeEditor) {\n              if (customEventRootDelegates) {\n                each$j(customEventRootDelegates, function (_value, name) {\n                  editor.dom.unbind(getEventTarget(editor, name));\n                });\n                customEventRootDelegates = null;\n              }\n            }\n          });\n        }\n        if (customEventRootDelegates[eventName]) {\n          return;\n        }\n        delegate = function (e) {\n          var target = e.target;\n          var editors = editor.editorManager.get();\n          var i = editors.length;\n          while (i--) {\n            var body = editors[i].getBody();\n            if (body === target || DOM$2.isChildOf(target, body)) {\n              fireEvent(editors[i], eventName, e);\n            }\n          }\n        };\n        customEventRootDelegates[eventName] = delegate;\n        DOM$2.bind(eventRootElm, eventName, delegate);\n      } else {\n        delegate = function (e) {\n          fireEvent(editor, eventName, e);\n        };\n        DOM$2.bind(eventRootElm, eventName, delegate);\n        editor.delegates[eventName] = delegate;\n      }\n    };\n    var EditorObservable = __assign(__assign({}, Observable), {\n      bindPendingEventDelegates: function () {\n        var self = this;\n        Tools.each(self._pendingNativeEvents, function (name) {\n          bindEventDelegate(self, name);\n        });\n      },\n      toggleNativeEvent: function (name, state) {\n        var self = this;\n        if (name === 'focus' || name === 'blur') {\n          return;\n        }\n        if (self.removed) {\n          return;\n        }\n        if (state) {\n          if (self.initialized) {\n            bindEventDelegate(self, name);\n          } else {\n            if (!self._pendingNativeEvents) {\n              self._pendingNativeEvents = [name];\n            } else {\n              self._pendingNativeEvents.push(name);\n            }\n          }\n        } else if (self.initialized) {\n          self.dom.unbind(getEventTarget(self, name), name, self.delegates[name]);\n          delete self.delegates[name];\n        }\n      },\n      unbindAllNativeEvents: function () {\n        var self = this;\n        var body = self.getBody();\n        var dom = self.dom;\n        if (self.delegates) {\n          each$j(self.delegates, function (value, name) {\n            self.dom.unbind(getEventTarget(self, name), name, value);\n          });\n          delete self.delegates;\n        }\n        if (!self.inline && body && dom) {\n          body.onload = null;\n          dom.unbind(self.getWin());\n          dom.unbind(self.getDoc());\n        }\n        if (dom) {\n          dom.unbind(body);\n          dom.unbind(self.getContainer());\n        }\n      }\n    });\n\n    var defaultModes = [\n      'design',\n      'readonly'\n    ];\n    var switchToMode = function (editor, activeMode, availableModes, mode) {\n      var oldMode = availableModes[activeMode.get()];\n      var newMode = availableModes[mode];\n      try {\n        newMode.activate();\n      } catch (e) {\n        console.error('problem while activating editor mode ' + mode + ':', e);\n        return;\n      }\n      oldMode.deactivate();\n      if (oldMode.editorReadOnly !== newMode.editorReadOnly) {\n        toggleReadOnly(editor, newMode.editorReadOnly);\n      }\n      activeMode.set(mode);\n      fireSwitchMode(editor, mode);\n    };\n    var setMode = function (editor, availableModes, activeMode, mode) {\n      if (mode === activeMode.get()) {\n        return;\n      } else if (!has$2(availableModes, mode)) {\n        throw new Error('Editor mode \\'' + mode + '\\' is invalid');\n      }\n      if (editor.initialized) {\n        switchToMode(editor, activeMode, availableModes, mode);\n      } else {\n        editor.on('init', function () {\n          return switchToMode(editor, activeMode, availableModes, mode);\n        });\n      }\n    };\n    var registerMode = function (availableModes, mode, api) {\n      var _a;\n      if (contains$3(defaultModes, mode)) {\n        throw new Error('Cannot override default mode ' + mode);\n      }\n      return __assign(__assign({}, availableModes), (_a = {}, _a[mode] = __assign(__assign({}, api), {\n        deactivate: function () {\n          try {\n            api.deactivate();\n          } catch (e) {\n            console.error('problem while deactivating editor mode ' + mode + ':', e);\n          }\n        }\n      }), _a));\n    };\n\n    var create$4 = function (editor) {\n      var activeMode = Cell('design');\n      var availableModes = Cell({\n        design: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: false\n        },\n        readonly: {\n          activate: noop,\n          deactivate: noop,\n          editorReadOnly: true\n        }\n      });\n      registerReadOnlyContentFilters(editor);\n      registerReadOnlySelectionBlockers(editor);\n      return {\n        isReadOnly: function () {\n          return isReadOnly(editor);\n        },\n        set: function (mode) {\n          return setMode(editor, availableModes.get(), activeMode, mode);\n        },\n        get: function () {\n          return activeMode.get();\n        },\n        register: function (mode, api) {\n          availableModes.set(registerMode(availableModes.get(), mode, api));\n        }\n      };\n    };\n\n    var each$3 = Tools.each, explode$1 = Tools.explode;\n    var keyCodeLookup = {\n      f1: 112,\n      f2: 113,\n      f3: 114,\n      f4: 115,\n      f5: 116,\n      f6: 117,\n      f7: 118,\n      f8: 119,\n      f9: 120,\n      f10: 121,\n      f11: 122,\n      f12: 123\n    };\n    var modifierNames = Tools.makeMap('alt,ctrl,shift,meta,access');\n    var parseShortcut = function (pattern) {\n      var key;\n      var shortcut = {};\n      each$3(explode$1(pattern.toLowerCase(), '+'), function (value) {\n        if (value in modifierNames) {\n          shortcut[value] = true;\n        } else {\n          if (/^[0-9]{2,}$/.test(value)) {\n            shortcut.keyCode = parseInt(value, 10);\n          } else {\n            shortcut.charCode = value.charCodeAt(0);\n            shortcut.keyCode = keyCodeLookup[value] || value.toUpperCase().charCodeAt(0);\n          }\n        }\n      });\n      var id = [shortcut.keyCode];\n      for (key in modifierNames) {\n        if (shortcut[key]) {\n          id.push(key);\n        } else {\n          shortcut[key] = false;\n        }\n      }\n      shortcut.id = id.join(',');\n      if (shortcut.access) {\n        shortcut.alt = true;\n        if (Env.mac) {\n          shortcut.ctrl = true;\n        } else {\n          shortcut.shift = true;\n        }\n      }\n      if (shortcut.meta) {\n        if (Env.mac) {\n          shortcut.meta = true;\n        } else {\n          shortcut.ctrl = true;\n          shortcut.meta = false;\n        }\n      }\n      return shortcut;\n    };\n    var Shortcuts = function () {\n      function Shortcuts(editor) {\n        this.shortcuts = {};\n        this.pendingPatterns = [];\n        this.editor = editor;\n        var self = this;\n        editor.on('keyup keypress keydown', function (e) {\n          if ((self.hasModifier(e) || self.isFunctionKey(e)) && !e.isDefaultPrevented()) {\n            each$3(self.shortcuts, function (shortcut) {\n              if (self.matchShortcut(e, shortcut)) {\n                self.pendingPatterns = shortcut.subpatterns.slice(0);\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(shortcut);\n                }\n                return true;\n              }\n            });\n            if (self.matchShortcut(e, self.pendingPatterns[0])) {\n              if (self.pendingPatterns.length === 1) {\n                if (e.type === 'keydown') {\n                  self.executeShortcutAction(self.pendingPatterns[0]);\n                }\n              }\n              self.pendingPatterns.shift();\n            }\n          }\n        });\n      }\n      Shortcuts.prototype.add = function (pattern, desc, cmdFunc, scope) {\n        var self = this;\n        var func = self.normalizeCommandFunc(cmdFunc);\n        each$3(explode$1(Tools.trim(pattern)), function (pattern) {\n          var shortcut = self.createShortcut(pattern, desc, func, scope);\n          self.shortcuts[shortcut.id] = shortcut;\n        });\n        return true;\n      };\n      Shortcuts.prototype.remove = function (pattern) {\n        var shortcut = this.createShortcut(pattern);\n        if (this.shortcuts[shortcut.id]) {\n          delete this.shortcuts[shortcut.id];\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.normalizeCommandFunc = function (cmdFunc) {\n        var self = this;\n        var cmd = cmdFunc;\n        if (typeof cmd === 'string') {\n          return function () {\n            self.editor.execCommand(cmd, false, null);\n          };\n        } else if (Tools.isArray(cmd)) {\n          return function () {\n            self.editor.execCommand(cmd[0], cmd[1], cmd[2]);\n          };\n        } else {\n          return cmd;\n        }\n      };\n      Shortcuts.prototype.createShortcut = function (pattern, desc, cmdFunc, scope) {\n        var shortcuts = Tools.map(explode$1(pattern, '>'), parseShortcut);\n        shortcuts[shortcuts.length - 1] = Tools.extend(shortcuts[shortcuts.length - 1], {\n          func: cmdFunc,\n          scope: scope || this.editor\n        });\n        return Tools.extend(shortcuts[0], {\n          desc: this.editor.translate(desc),\n          subpatterns: shortcuts.slice(1)\n        });\n      };\n      Shortcuts.prototype.hasModifier = function (e) {\n        return e.altKey || e.ctrlKey || e.metaKey;\n      };\n      Shortcuts.prototype.isFunctionKey = function (e) {\n        return e.type === 'keydown' && e.keyCode >= 112 && e.keyCode <= 123;\n      };\n      Shortcuts.prototype.matchShortcut = function (e, shortcut) {\n        if (!shortcut) {\n          return false;\n        }\n        if (shortcut.ctrl !== e.ctrlKey || shortcut.meta !== e.metaKey) {\n          return false;\n        }\n        if (shortcut.alt !== e.altKey || shortcut.shift !== e.shiftKey) {\n          return false;\n        }\n        if (e.keyCode === shortcut.keyCode || e.charCode && e.charCode === shortcut.charCode) {\n          e.preventDefault();\n          return true;\n        }\n        return false;\n      };\n      Shortcuts.prototype.executeShortcutAction = function (shortcut) {\n        return shortcut.func ? shortcut.func.call(shortcut.scope) : null;\n      };\n      return Shortcuts;\n    }();\n\n    var create$3 = function () {\n      var buttons = {};\n      var menuItems = {};\n      var popups = {};\n      var icons = {};\n      var contextMenus = {};\n      var contextToolbars = {};\n      var sidebars = {};\n      var add = function (collection, type) {\n        return function (name, spec) {\n          return collection[name.toLowerCase()] = __assign(__assign({}, spec), { type: type });\n        };\n      };\n      var addIcon = function (name, svgData) {\n        return icons[name.toLowerCase()] = svgData;\n      };\n      return {\n        addButton: add(buttons, 'button'),\n        addGroupToolbarButton: add(buttons, 'grouptoolbarbutton'),\n        addToggleButton: add(buttons, 'togglebutton'),\n        addMenuButton: add(buttons, 'menubutton'),\n        addSplitButton: add(buttons, 'splitbutton'),\n        addMenuItem: add(menuItems, 'menuitem'),\n        addNestedMenuItem: add(menuItems, 'nestedmenuitem'),\n        addToggleMenuItem: add(menuItems, 'togglemenuitem'),\n        addAutocompleter: add(popups, 'autocompleter'),\n        addContextMenu: add(contextMenus, 'contextmenu'),\n        addContextToolbar: add(contextToolbars, 'contexttoolbar'),\n        addContextForm: add(contextToolbars, 'contextform'),\n        addSidebar: add(sidebars, 'sidebar'),\n        addIcon: addIcon,\n        getAll: function () {\n          return {\n            buttons: buttons,\n            menuItems: menuItems,\n            icons: icons,\n            popups: popups,\n            contextMenus: contextMenus,\n            contextToolbars: contextToolbars,\n            sidebars: sidebars\n          };\n        }\n      };\n    };\n\n    var registry = function () {\n      var bridge = create$3();\n      return {\n        addAutocompleter: bridge.addAutocompleter,\n        addButton: bridge.addButton,\n        addContextForm: bridge.addContextForm,\n        addContextMenu: bridge.addContextMenu,\n        addContextToolbar: bridge.addContextToolbar,\n        addIcon: bridge.addIcon,\n        addMenuButton: bridge.addMenuButton,\n        addMenuItem: bridge.addMenuItem,\n        addNestedMenuItem: bridge.addNestedMenuItem,\n        addSidebar: bridge.addSidebar,\n        addSplitButton: bridge.addSplitButton,\n        addToggleButton: bridge.addToggleButton,\n        addGroupToolbarButton: bridge.addGroupToolbarButton,\n        addToggleMenuItem: bridge.addToggleMenuItem,\n        getAll: bridge.getAll\n      };\n    };\n\n    var DOM$1 = DOMUtils.DOM;\n    var extend$3 = Tools.extend, each$2 = Tools.each;\n    var resolve = Tools.resolve;\n    var ie = Env.ie;\n    var Editor = function () {\n      function Editor(id, settings, editorManager) {\n        var _this = this;\n        this.plugins = {};\n        this.contentCSS = [];\n        this.contentStyles = [];\n        this.loadedCSS = {};\n        this.isNotDirty = false;\n        this.editorManager = editorManager;\n        this.documentBaseUrl = editorManager.documentBaseURL;\n        extend$3(this, EditorObservable);\n        this.settings = getEditorSettings(this, id, this.documentBaseUrl, editorManager.defaultSettings, settings);\n        if (this.settings.suffix) {\n          editorManager.suffix = this.settings.suffix;\n        }\n        this.suffix = editorManager.suffix;\n        if (this.settings.base_url) {\n          editorManager._setBaseUrl(this.settings.base_url);\n        }\n        this.baseUri = editorManager.baseURI;\n        if (this.settings.referrer_policy) {\n          ScriptLoader.ScriptLoader._setReferrerPolicy(this.settings.referrer_policy);\n          DOMUtils.DOM.styleSheetLoader._setReferrerPolicy(this.settings.referrer_policy);\n        }\n        AddOnManager.languageLoad = this.settings.language_load;\n        AddOnManager.baseURL = editorManager.baseURL;\n        this.id = id;\n        this.setDirty(false);\n        this.documentBaseURI = new URI(this.settings.document_base_url, { base_uri: this.baseUri });\n        this.baseURI = this.baseUri;\n        this.inline = !!this.settings.inline;\n        this.shortcuts = new Shortcuts(this);\n        this.editorCommands = new EditorCommands(this);\n        if (this.settings.cache_suffix) {\n          Env.cacheSuffix = this.settings.cache_suffix.replace(/^[\\?\\&]+/, '');\n        }\n        this.ui = {\n          registry: registry(),\n          styleSheetLoader: undefined,\n          show: noop,\n          hide: noop,\n          enable: noop,\n          disable: noop,\n          isDisabled: never\n        };\n        var self = this;\n        var modeInstance = create$4(self);\n        this.mode = modeInstance;\n        this.setMode = modeInstance.set;\n        editorManager.fire('SetupEditor', { editor: this });\n        this.execCallback('setup', this);\n        this.$ = DomQuery.overrideDefaults(function () {\n          return {\n            context: _this.inline ? _this.getBody() : _this.getDoc(),\n            element: _this.getBody()\n          };\n        });\n      }\n      Editor.prototype.render = function () {\n        render(this);\n      };\n      Editor.prototype.focus = function (skipFocus) {\n        this.execCommand('mceFocus', false, skipFocus);\n      };\n      Editor.prototype.hasFocus = function () {\n        return hasFocus(this);\n      };\n      Editor.prototype.execCallback = function (name) {\n        var x = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n          x[_i - 1] = arguments[_i];\n        }\n        var self = this;\n        var callback = self.settings[name], scope;\n        if (!callback) {\n          return;\n        }\n        if (self.callbackLookup && (scope = self.callbackLookup[name])) {\n          callback = scope.func;\n          scope = scope.scope;\n        }\n        if (typeof callback === 'string') {\n          scope = callback.replace(/\\.\\w+$/, '');\n          scope = scope ? resolve(scope) : 0;\n          callback = resolve(callback);\n          self.callbackLookup = self.callbackLookup || {};\n          self.callbackLookup[name] = {\n            func: callback,\n            scope: scope\n          };\n        }\n        return callback.apply(scope || self, x);\n      };\n      Editor.prototype.translate = function (text) {\n        return I18n.translate(text);\n      };\n      Editor.prototype.getParam = function (name, defaultVal, type) {\n        return getParam(this, name, defaultVal, type);\n      };\n      Editor.prototype.hasPlugin = function (name, loaded) {\n        var hasPlugin = contains$3(getPlugins(this).split(/[ ,]/), name);\n        if (hasPlugin) {\n          return loaded ? PluginManager.get(name) !== undefined : true;\n        } else {\n          return false;\n        }\n      };\n      Editor.prototype.nodeChanged = function (args) {\n        this._nodeChangeDispatcher.nodeChanged(args);\n      };\n      Editor.prototype.addCommand = function (name, callback, scope) {\n        this.editorCommands.addCommand(name, callback, scope);\n      };\n      Editor.prototype.addQueryStateHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryStateHandler(name, callback, scope);\n      };\n      Editor.prototype.addQueryValueHandler = function (name, callback, scope) {\n        this.editorCommands.addQueryValueHandler(name, callback, scope);\n      };\n      Editor.prototype.addShortcut = function (pattern, desc, cmdFunc, scope) {\n        this.shortcuts.add(pattern, desc, cmdFunc, scope);\n      };\n      Editor.prototype.execCommand = function (cmd, ui, value, args) {\n        return this.editorCommands.execCommand(cmd, ui, value, args);\n      };\n      Editor.prototype.queryCommandState = function (cmd) {\n        return this.editorCommands.queryCommandState(cmd);\n      };\n      Editor.prototype.queryCommandValue = function (cmd) {\n        return this.editorCommands.queryCommandValue(cmd);\n      };\n      Editor.prototype.queryCommandSupported = function (cmd) {\n        return this.editorCommands.queryCommandSupported(cmd);\n      };\n      Editor.prototype.show = function () {\n        var self = this;\n        if (self.hidden) {\n          self.hidden = false;\n          if (self.inline) {\n            self.getBody().contentEditable = 'true';\n          } else {\n            DOM$1.show(self.getContainer());\n            DOM$1.hide(self.id);\n          }\n          self.load();\n          self.fire('show');\n        }\n      };\n      Editor.prototype.hide = function () {\n        var self = this, doc = self.getDoc();\n        if (!self.hidden) {\n          if (ie && doc && !self.inline) {\n            doc.execCommand('SelectAll');\n          }\n          self.save();\n          if (self.inline) {\n            self.getBody().contentEditable = 'false';\n            if (self === self.editorManager.focusedEditor) {\n              self.editorManager.focusedEditor = null;\n            }\n          } else {\n            DOM$1.hide(self.getContainer());\n            DOM$1.setStyle(self.id, 'display', self.orgDisplay);\n          }\n          self.hidden = true;\n          self.fire('hide');\n        }\n      };\n      Editor.prototype.isHidden = function () {\n        return !!this.hidden;\n      };\n      Editor.prototype.setProgressState = function (state, time) {\n        this.fire('ProgressState', {\n          state: state,\n          time: time\n        });\n      };\n      Editor.prototype.load = function (args) {\n        var self = this;\n        var elm = self.getElement(), html;\n        if (self.removed) {\n          return '';\n        }\n        if (elm) {\n          args = args || {};\n          args.load = true;\n          var value = isTextareaOrInput(elm) ? elm.value : elm.innerHTML;\n          html = self.setContent(value, args);\n          args.element = elm;\n          if (!args.no_events) {\n            self.fire('LoadContent', args);\n          }\n          args.element = elm = null;\n          return html;\n        }\n      };\n      Editor.prototype.save = function (args) {\n        var self = this;\n        var elm = self.getElement(), html, form;\n        if (!elm || !self.initialized || self.removed) {\n          return;\n        }\n        args = args || {};\n        args.save = true;\n        args.element = elm;\n        html = args.content = self.getContent(args);\n        if (!args.no_events) {\n          self.fire('SaveContent', args);\n        }\n        if (args.format === 'raw') {\n          self.fire('RawSaveContent', args);\n        }\n        html = args.content;\n        if (!isTextareaOrInput(elm)) {\n          if (args.is_removing || !self.inline) {\n            elm.innerHTML = html;\n          }\n          if (form = DOM$1.getParent(self.id, 'form')) {\n            each$2(form.elements, function (elm) {\n              if (elm.name === self.id) {\n                elm.value = html;\n                return false;\n              }\n            });\n          }\n        } else {\n          elm.value = html;\n        }\n        args.element = elm = null;\n        if (args.set_dirty !== false) {\n          self.setDirty(false);\n        }\n        return html;\n      };\n      Editor.prototype.setContent = function (content, args) {\n        return setContent(this, content, args);\n      };\n      Editor.prototype.getContent = function (args) {\n        return getContent(this, args);\n      };\n      Editor.prototype.insertContent = function (content, args) {\n        if (args) {\n          content = extend$3({ content: content }, args);\n        }\n        this.execCommand('mceInsertContent', false, content);\n      };\n      Editor.prototype.resetContent = function (initialContent) {\n        if (initialContent === undefined) {\n          setContent(this, this.startContent, { format: 'raw' });\n        } else {\n          setContent(this, initialContent);\n        }\n        this.undoManager.reset();\n        this.setDirty(false);\n        this.nodeChanged();\n      };\n      Editor.prototype.isDirty = function () {\n        return !this.isNotDirty;\n      };\n      Editor.prototype.setDirty = function (state) {\n        var oldState = !this.isNotDirty;\n        this.isNotDirty = !state;\n        if (state && state !== oldState) {\n          this.fire('dirty');\n        }\n      };\n      Editor.prototype.getContainer = function () {\n        var self = this;\n        if (!self.container) {\n          self.container = DOM$1.get(self.editorContainer || self.id + '_parent');\n        }\n        return self.container;\n      };\n      Editor.prototype.getContentAreaContainer = function () {\n        return this.contentAreaContainer;\n      };\n      Editor.prototype.getElement = function () {\n        if (!this.targetElm) {\n          this.targetElm = DOM$1.get(this.id);\n        }\n        return this.targetElm;\n      };\n      Editor.prototype.getWin = function () {\n        var self = this;\n        var elm;\n        if (!self.contentWindow) {\n          elm = self.iframeElement;\n          if (elm) {\n            self.contentWindow = elm.contentWindow;\n          }\n        }\n        return self.contentWindow;\n      };\n      Editor.prototype.getDoc = function () {\n        var self = this;\n        var win;\n        if (!self.contentDocument) {\n          win = self.getWin();\n          if (win) {\n            self.contentDocument = win.document;\n          }\n        }\n        return self.contentDocument;\n      };\n      Editor.prototype.getBody = function () {\n        var doc = this.getDoc();\n        return this.bodyElement || (doc ? doc.body : null);\n      };\n      Editor.prototype.convertURL = function (url, name, elm) {\n        var self = this, settings = self.settings;\n        if (settings.urlconverter_callback) {\n          return self.execCallback('urlconverter_callback', url, elm, true, name);\n        }\n        if (!settings.convert_urls || elm && elm.nodeName === 'LINK' || url.indexOf('file:') === 0 || url.length === 0) {\n          return url;\n        }\n        if (settings.relative_urls) {\n          return self.documentBaseURI.toRelative(url);\n        }\n        url = self.documentBaseURI.toAbsolute(url, settings.remove_script_host);\n        return url;\n      };\n      Editor.prototype.addVisual = function (elm) {\n        addVisual(this, elm);\n      };\n      Editor.prototype.remove = function () {\n        remove(this);\n      };\n      Editor.prototype.destroy = function (automatic) {\n        destroy(this, automatic);\n      };\n      Editor.prototype.uploadImages = function (callback) {\n        return this.editorUpload.uploadImages(callback);\n      };\n      Editor.prototype._scanForImages = function () {\n        return this.editorUpload.scanForImages();\n      };\n      Editor.prototype.addButton = function () {\n        throw new Error('editor.addButton has been removed in tinymce 5x, use editor.ui.registry.addButton or editor.ui.registry.addToggleButton or editor.ui.registry.addSplitButton instead');\n      };\n      Editor.prototype.addSidebar = function () {\n        throw new Error('editor.addSidebar has been removed in tinymce 5x, use editor.ui.registry.addSidebar instead');\n      };\n      Editor.prototype.addMenuItem = function () {\n        throw new Error('editor.addMenuItem has been removed in tinymce 5x, use editor.ui.registry.addMenuItem instead');\n      };\n      Editor.prototype.addContextToolbar = function () {\n        throw new Error('editor.addContextToolbar has been removed in tinymce 5x, use editor.ui.registry.addContextToolbar instead');\n      };\n      return Editor;\n    }();\n\n    var DOM = DOMUtils.DOM;\n    var explode = Tools.explode, each$1 = Tools.each, extend$2 = Tools.extend;\n    var instanceCounter = 0, boundGlobalEvents = false;\n    var beforeUnloadDelegate;\n    var legacyEditors = [];\n    var editors = [];\n    var isValidLegacyKey = function (id) {\n      return id !== 'length';\n    };\n    var globalEventDelegate = function (e) {\n      var type = e.type;\n      each$1(EditorManager.get(), function (editor) {\n        switch (type) {\n        case 'scroll':\n          editor.fire('ScrollWindow', e);\n          break;\n        case 'resize':\n          editor.fire('ResizeWindow', e);\n          break;\n        }\n      });\n    };\n    var toggleGlobalEvents = function (state) {\n      if (state !== boundGlobalEvents) {\n        if (state) {\n          DomQuery(window).on('resize scroll', globalEventDelegate);\n        } else {\n          DomQuery(window).off('resize scroll', globalEventDelegate);\n        }\n        boundGlobalEvents = state;\n      }\n    };\n    var removeEditorFromList = function (targetEditor) {\n      var oldEditors = editors;\n      delete legacyEditors[targetEditor.id];\n      for (var i = 0; i < legacyEditors.length; i++) {\n        if (legacyEditors[i] === targetEditor) {\n          legacyEditors.splice(i, 1);\n          break;\n        }\n      }\n      editors = filter$4(editors, function (editor) {\n        return targetEditor !== editor;\n      });\n      if (EditorManager.activeEditor === targetEditor) {\n        EditorManager.activeEditor = editors.length > 0 ? editors[0] : null;\n      }\n      if (EditorManager.focusedEditor === targetEditor) {\n        EditorManager.focusedEditor = null;\n      }\n      return oldEditors.length !== editors.length;\n    };\n    var purgeDestroyedEditor = function (editor) {\n      if (editor && editor.initialized && !(editor.getContainer() || editor.getBody()).parentNode) {\n        removeEditorFromList(editor);\n        editor.unbindAllNativeEvents();\n        editor.destroy(true);\n        editor.removed = true;\n        editor = null;\n      }\n      return editor;\n    };\n    var isQuirksMode = document.compatMode !== 'CSS1Compat';\n    var EditorManager = __assign(__assign({}, Observable), {\n      baseURI: null,\n      baseURL: null,\n      defaultSettings: {},\n      documentBaseURL: null,\n      suffix: null,\n      $: DomQuery,\n      majorVersion: '5',\n      minorVersion: '10.3',\n      releaseDate: '2022-02-09',\n      editors: legacyEditors,\n      i18n: I18n,\n      activeEditor: null,\n      focusedEditor: null,\n      settings: {},\n      setup: function () {\n        var self = this;\n        var baseURL, documentBaseURL, suffix = '';\n        documentBaseURL = URI.getDocumentBaseUrl(document.location);\n        if (/^[^:]+:\\/\\/\\/?[^\\/]+\\//.test(documentBaseURL)) {\n          documentBaseURL = documentBaseURL.replace(/[\\?#].*$/, '').replace(/[\\/\\\\][^\\/]+$/, '');\n          if (!/[\\/\\\\]$/.test(documentBaseURL)) {\n            documentBaseURL += '/';\n          }\n        }\n        var preInit = window.tinymce || window.tinyMCEPreInit;\n        if (preInit) {\n          baseURL = preInit.base || preInit.baseURL;\n          suffix = preInit.suffix;\n        } else {\n          var scripts = document.getElementsByTagName('script');\n          for (var i = 0; i < scripts.length; i++) {\n            var src = scripts[i].src || '';\n            if (src === '') {\n              continue;\n            }\n            var srcScript = src.substring(src.lastIndexOf('/'));\n            if (/tinymce(\\.full|\\.jquery|)(\\.min|\\.dev|)\\.js/.test(src)) {\n              if (srcScript.indexOf('.min') !== -1) {\n                suffix = '.min';\n              }\n              baseURL = src.substring(0, src.lastIndexOf('/'));\n              break;\n            }\n          }\n          if (!baseURL && document.currentScript) {\n            var src = document.currentScript.src;\n            if (src.indexOf('.min') !== -1) {\n              suffix = '.min';\n            }\n            baseURL = src.substring(0, src.lastIndexOf('/'));\n          }\n        }\n        self.baseURL = new URI(documentBaseURL).toAbsolute(baseURL);\n        self.documentBaseURL = documentBaseURL;\n        self.baseURI = new URI(self.baseURL);\n        self.suffix = suffix;\n        setup$l(self);\n      },\n      overrideDefaults: function (defaultSettings) {\n        var baseUrl = defaultSettings.base_url;\n        if (baseUrl) {\n          this._setBaseUrl(baseUrl);\n        }\n        var suffix = defaultSettings.suffix;\n        if (defaultSettings.suffix) {\n          this.suffix = suffix;\n        }\n        this.defaultSettings = defaultSettings;\n        var pluginBaseUrls = defaultSettings.plugin_base_urls;\n        if (pluginBaseUrls !== undefined) {\n          each$j(pluginBaseUrls, function (pluginBaseUrl, pluginName) {\n            AddOnManager.PluginManager.urls[pluginName] = pluginBaseUrl;\n          });\n        }\n      },\n      init: function (settings) {\n        var self = this;\n        var result;\n        var invalidInlineTargets = Tools.makeMap('area base basefont br col frame hr img input isindex link meta param embed source wbr track ' + 'colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu', ' ');\n        var isInvalidInlineTarget = function (settings, elm) {\n          return settings.inline && elm.tagName.toLowerCase() in invalidInlineTargets;\n        };\n        var createId = function (elm) {\n          var id = elm.id;\n          if (!id) {\n            id = get$9(elm, 'name').filter(function (name) {\n              return !DOM.get(name);\n            }).getOrThunk(DOM.uniqueId);\n            elm.setAttribute('id', id);\n          }\n          return id;\n        };\n        var execCallback = function (name) {\n          var callback = settings[name];\n          if (!callback) {\n            return;\n          }\n          return callback.apply(self, []);\n        };\n        var hasClass = function (elm, className) {\n          return className.constructor === RegExp ? className.test(elm.className) : DOM.hasClass(elm, className);\n        };\n        var findTargets = function (settings) {\n          var targets = [];\n          if (Env.browser.isIE() && Env.browser.version.major < 11) {\n            initError('TinyMCE does not support the browser you are using. For a list of supported' + ' browsers please see: https://www.tinymce.com/docs/get-started/system-requirements/');\n            return [];\n          } else if (isQuirksMode) {\n            initError('Failed to initialize the editor as the document is not in standards mode. ' + 'TinyMCE requires standards mode.');\n            return [];\n          }\n          if (settings.types) {\n            each$1(settings.types, function (type) {\n              targets = targets.concat(DOM.select(type.selector));\n            });\n            return targets;\n          } else if (settings.selector) {\n            return DOM.select(settings.selector);\n          } else if (settings.target) {\n            return [settings.target];\n          }\n          switch (settings.mode) {\n          case 'exact':\n            var l = settings.elements || '';\n            if (l.length > 0) {\n              each$1(explode(l), function (id) {\n                var elm = DOM.get(id);\n                if (elm) {\n                  targets.push(elm);\n                } else {\n                  each$1(document.forms, function (f) {\n                    each$1(f.elements, function (e) {\n                      if (e.name === id) {\n                        id = 'mce_editor_' + instanceCounter++;\n                        DOM.setAttrib(e, 'id', id);\n                        targets.push(e);\n                      }\n                    });\n                  });\n                }\n              });\n            }\n            break;\n          case 'textareas':\n          case 'specific_textareas':\n            each$1(DOM.select('textarea'), function (elm) {\n              if (settings.editor_deselector && hasClass(elm, settings.editor_deselector)) {\n                return;\n              }\n              if (!settings.editor_selector || hasClass(elm, settings.editor_selector)) {\n                targets.push(elm);\n              }\n            });\n            break;\n          }\n          return targets;\n        };\n        var provideResults = function (editors) {\n          result = editors;\n        };\n        var initEditors = function () {\n          var initCount = 0;\n          var editors = [];\n          var targets;\n          var createEditor = function (id, settings, targetElm) {\n            var editor = new Editor(id, settings, self);\n            editors.push(editor);\n            editor.on('init', function () {\n              if (++initCount === targets.length) {\n                provideResults(editors);\n              }\n            });\n            editor.targetElm = editor.targetElm || targetElm;\n            editor.render();\n          };\n          DOM.unbind(window, 'ready', initEditors);\n          execCallback('onpageload');\n          targets = DomQuery.unique(findTargets(settings));\n          if (settings.types) {\n            each$1(settings.types, function (type) {\n              Tools.each(targets, function (elm) {\n                if (DOM.is(elm, type.selector)) {\n                  createEditor(createId(elm), extend$2({}, settings, type), elm);\n                  return false;\n                }\n                return true;\n              });\n            });\n            return;\n          }\n          Tools.each(targets, function (elm) {\n            purgeDestroyedEditor(self.get(elm.id));\n          });\n          targets = Tools.grep(targets, function (elm) {\n            return !self.get(elm.id);\n          });\n          if (targets.length === 0) {\n            provideResults([]);\n          } else {\n            each$1(targets, function (elm) {\n              if (isInvalidInlineTarget(settings, elm)) {\n                initError('Could not initialize inline editor on invalid inline target element', elm);\n              } else {\n                createEditor(createId(elm), settings, elm);\n              }\n            });\n          }\n        };\n        self.settings = settings;\n        DOM.bind(window, 'ready', initEditors);\n        return new promiseObj(function (resolve) {\n          if (result) {\n            resolve(result);\n          } else {\n            provideResults = function (editors) {\n              resolve(editors);\n            };\n          }\n        });\n      },\n      get: function (id) {\n        if (arguments.length === 0) {\n          return editors.slice(0);\n        } else if (isString$1(id)) {\n          return find$3(editors, function (editor) {\n            return editor.id === id;\n          }).getOr(null);\n        } else if (isNumber(id)) {\n          return editors[id] ? editors[id] : null;\n        } else {\n          return null;\n        }\n      },\n      add: function (editor) {\n        var self = this;\n        var existingEditor = legacyEditors[editor.id];\n        if (existingEditor === editor) {\n          return editor;\n        }\n        if (self.get(editor.id) === null) {\n          if (isValidLegacyKey(editor.id)) {\n            legacyEditors[editor.id] = editor;\n          }\n          legacyEditors.push(editor);\n          editors.push(editor);\n        }\n        toggleGlobalEvents(true);\n        self.activeEditor = editor;\n        self.fire('AddEditor', { editor: editor });\n        if (!beforeUnloadDelegate) {\n          beforeUnloadDelegate = function (e) {\n            var event = self.fire('BeforeUnload');\n            if (event.returnValue) {\n              e.preventDefault();\n              e.returnValue = event.returnValue;\n              return event.returnValue;\n            }\n          };\n          window.addEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        return editor;\n      },\n      createEditor: function (id, settings) {\n        return this.add(new Editor(id, settings, this));\n      },\n      remove: function (selector) {\n        var self = this;\n        var i, editor;\n        if (!selector) {\n          for (i = editors.length - 1; i >= 0; i--) {\n            self.remove(editors[i]);\n          }\n          return;\n        }\n        if (isString$1(selector)) {\n          each$1(DOM.select(selector), function (elm) {\n            editor = self.get(elm.id);\n            if (editor) {\n              self.remove(editor);\n            }\n          });\n          return;\n        }\n        editor = selector;\n        if (isNull(self.get(editor.id))) {\n          return null;\n        }\n        if (removeEditorFromList(editor)) {\n          self.fire('RemoveEditor', { editor: editor });\n        }\n        if (editors.length === 0) {\n          window.removeEventListener('beforeunload', beforeUnloadDelegate);\n        }\n        editor.remove();\n        toggleGlobalEvents(editors.length > 0);\n        return editor;\n      },\n      execCommand: function (cmd, ui, value) {\n        var self = this, editor = self.get(value);\n        switch (cmd) {\n        case 'mceAddEditor':\n          if (!self.get(value)) {\n            new Editor(value, self.settings, self).render();\n          }\n          return true;\n        case 'mceRemoveEditor':\n          if (editor) {\n            editor.remove();\n          }\n          return true;\n        case 'mceToggleEditor':\n          if (!editor) {\n            self.execCommand('mceAddEditor', false, value);\n            return true;\n          }\n          if (editor.isHidden()) {\n            editor.show();\n          } else {\n            editor.hide();\n          }\n          return true;\n        }\n        if (self.activeEditor) {\n          return self.activeEditor.execCommand(cmd, ui, value);\n        }\n        return false;\n      },\n      triggerSave: function () {\n        each$1(editors, function (editor) {\n          editor.save();\n        });\n      },\n      addI18n: function (code, items) {\n        I18n.add(code, items);\n      },\n      translate: function (text) {\n        return I18n.translate(text);\n      },\n      setActive: function (editor) {\n        var activeEditor = this.activeEditor;\n        if (this.activeEditor !== editor) {\n          if (activeEditor) {\n            activeEditor.fire('deactivate', { relatedTarget: editor });\n          }\n          editor.fire('activate', { relatedTarget: activeEditor });\n        }\n        this.activeEditor = editor;\n      },\n      _setBaseUrl: function (baseUrl) {\n        this.baseURL = new URI(this.documentBaseURL).toAbsolute(baseUrl.replace(/\\/+$/, ''));\n        this.baseURI = new URI(this.baseURL);\n      }\n    });\n    EditorManager.setup();\n\n    var min$1 = Math.min, max$1 = Math.max, round$1 = Math.round;\n    var relativePosition = function (rect, targetRect, rel) {\n      var x = targetRect.x;\n      var y = targetRect.y;\n      var w = rect.w;\n      var h = rect.h;\n      var targetW = targetRect.w;\n      var targetH = targetRect.h;\n      var relChars = (rel || '').split('');\n      if (relChars[0] === 'b') {\n        y += targetH;\n      }\n      if (relChars[1] === 'r') {\n        x += targetW;\n      }\n      if (relChars[0] === 'c') {\n        y += round$1(targetH / 2);\n      }\n      if (relChars[1] === 'c') {\n        x += round$1(targetW / 2);\n      }\n      if (relChars[3] === 'b') {\n        y -= h;\n      }\n      if (relChars[4] === 'r') {\n        x -= w;\n      }\n      if (relChars[3] === 'c') {\n        y -= round$1(h / 2);\n      }\n      if (relChars[4] === 'c') {\n        x -= round$1(w / 2);\n      }\n      return create$2(x, y, w, h);\n    };\n    var findBestRelativePosition = function (rect, targetRect, constrainRect, rels) {\n      var pos, i;\n      for (i = 0; i < rels.length; i++) {\n        pos = relativePosition(rect, targetRect, rels[i]);\n        if (pos.x >= constrainRect.x && pos.x + pos.w <= constrainRect.w + constrainRect.x && pos.y >= constrainRect.y && pos.y + pos.h <= constrainRect.h + constrainRect.y) {\n          return rels[i];\n        }\n      }\n      return null;\n    };\n    var inflate = function (rect, w, h) {\n      return create$2(rect.x - w, rect.y - h, rect.w + w * 2, rect.h + h * 2);\n    };\n    var intersect = function (rect, cropRect) {\n      var x1 = max$1(rect.x, cropRect.x);\n      var y1 = max$1(rect.y, cropRect.y);\n      var x2 = min$1(rect.x + rect.w, cropRect.x + cropRect.w);\n      var y2 = min$1(rect.y + rect.h, cropRect.y + cropRect.h);\n      if (x2 - x1 < 0 || y2 - y1 < 0) {\n        return null;\n      }\n      return create$2(x1, y1, x2 - x1, y2 - y1);\n    };\n    var clamp = function (rect, clampRect, fixedSize) {\n      var x1 = rect.x;\n      var y1 = rect.y;\n      var x2 = rect.x + rect.w;\n      var y2 = rect.y + rect.h;\n      var cx2 = clampRect.x + clampRect.w;\n      var cy2 = clampRect.y + clampRect.h;\n      var underflowX1 = max$1(0, clampRect.x - x1);\n      var underflowY1 = max$1(0, clampRect.y - y1);\n      var overflowX2 = max$1(0, x2 - cx2);\n      var overflowY2 = max$1(0, y2 - cy2);\n      x1 += underflowX1;\n      y1 += underflowY1;\n      if (fixedSize) {\n        x2 += underflowX1;\n        y2 += underflowY1;\n        x1 -= overflowX2;\n        y1 -= overflowY2;\n      }\n      x2 -= overflowX2;\n      y2 -= overflowY2;\n      return create$2(x1, y1, x2 - x1, y2 - y1);\n    };\n    var create$2 = function (x, y, w, h) {\n      return {\n        x: x,\n        y: y,\n        w: w,\n        h: h\n      };\n    };\n    var fromClientRect = function (clientRect) {\n      return create$2(clientRect.left, clientRect.top, clientRect.width, clientRect.height);\n    };\n    var Rect = {\n      inflate: inflate,\n      relativePosition: relativePosition,\n      findBestRelativePosition: findBestRelativePosition,\n      intersect: intersect,\n      clamp: clamp,\n      create: create$2,\n      fromClientRect: fromClientRect\n    };\n\n    var awaiter = function (resolveCb, rejectCb, timeout) {\n      if (timeout === void 0) {\n        timeout = 1000;\n      }\n      var done = false;\n      var timer = null;\n      var complete = function (completer) {\n        return function () {\n          var args = [];\n          for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n          }\n          if (!done) {\n            done = true;\n            if (timer !== null) {\n              clearTimeout(timer);\n              timer = null;\n            }\n            completer.apply(null, args);\n          }\n        };\n      };\n      var resolve = complete(resolveCb);\n      var reject = complete(rejectCb);\n      var start = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n          args[_i] = arguments[_i];\n        }\n        if (!done && timer === null) {\n          timer = setTimeout(function () {\n            return reject.apply(null, args);\n          }, timeout);\n        }\n      };\n      return {\n        start: start,\n        resolve: resolve,\n        reject: reject\n      };\n    };\n    var create$1 = function () {\n      var tasks = {};\n      var resultFns = {};\n      var load = function (id, url) {\n        var loadErrMsg = 'Script at URL \"' + url + '\" failed to load';\n        var runErrMsg = 'Script at URL \"' + url + '\" did not call `tinymce.Resource.add(\\'' + id + '\\', data)` within 1 second';\n        if (tasks[id] !== undefined) {\n          return tasks[id];\n        } else {\n          var task = new promiseObj(function (resolve, reject) {\n            var waiter = awaiter(resolve, reject);\n            resultFns[id] = waiter.resolve;\n            ScriptLoader.ScriptLoader.loadScript(url, function () {\n              return waiter.start(runErrMsg);\n            }, function () {\n              return waiter.reject(loadErrMsg);\n            });\n          });\n          tasks[id] = task;\n          return task;\n        }\n      };\n      var add = function (id, data) {\n        if (resultFns[id] !== undefined) {\n          resultFns[id](data);\n          delete resultFns[id];\n        }\n        tasks[id] = promiseObj.resolve(data);\n      };\n      return {\n        load: load,\n        add: add\n      };\n    };\n    var Resource = create$1();\n\n    var each = Tools.each, extend$1 = Tools.extend;\n    var extendClass, initializing;\n    var Class = function () {\n    };\n    Class.extend = extendClass = function (props) {\n      var self = this;\n      var _super = self.prototype;\n      var Class = function () {\n        var i, mixins, mixin;\n        var self = this;\n        if (!initializing) {\n          if (self.init) {\n            self.init.apply(self, arguments);\n          }\n          mixins = self.Mixins;\n          if (mixins) {\n            i = mixins.length;\n            while (i--) {\n              mixin = mixins[i];\n              if (mixin.init) {\n                mixin.init.apply(self, arguments);\n              }\n            }\n          }\n        }\n      };\n      var dummy = function () {\n        return this;\n      };\n      var createMethod = function (name, fn) {\n        return function () {\n          var self = this;\n          var tmp = self._super;\n          self._super = _super[name];\n          var ret = fn.apply(self, arguments);\n          self._super = tmp;\n          return ret;\n        };\n      };\n      initializing = true;\n      var prototype = new self();\n      initializing = false;\n      if (props.Mixins) {\n        each(props.Mixins, function (mixin) {\n          for (var name_1 in mixin) {\n            if (name_1 !== 'init') {\n              props[name_1] = mixin[name_1];\n            }\n          }\n        });\n        if (_super.Mixins) {\n          props.Mixins = _super.Mixins.concat(props.Mixins);\n        }\n      }\n      if (props.Methods) {\n        each(props.Methods.split(','), function (name) {\n          props[name] = dummy;\n        });\n      }\n      if (props.Properties) {\n        each(props.Properties.split(','), function (name) {\n          var fieldName = '_' + name;\n          props[name] = function (value) {\n            var self = this;\n            if (value !== undefined) {\n              self[fieldName] = value;\n              return self;\n            }\n            return self[fieldName];\n          };\n        });\n      }\n      if (props.Statics) {\n        each(props.Statics, function (func, name) {\n          Class[name] = func;\n        });\n      }\n      if (props.Defaults && _super.Defaults) {\n        props.Defaults = extend$1({}, _super.Defaults, props.Defaults);\n      }\n      each$j(props, function (member, name) {\n        if (typeof member === 'function' && _super[name]) {\n          prototype[name] = createMethod(name, member);\n        } else {\n          prototype[name] = member;\n        }\n      });\n      Class.prototype = prototype;\n      Class.constructor = Class;\n      Class.extend = extendClass;\n      return Class;\n    };\n\n    var min = Math.min, max = Math.max, round = Math.round;\n    var Color = function (value) {\n      var self = {};\n      var r = 0, g = 0, b = 0;\n      var rgb2hsv = function (r, g, b) {\n        var h, s, v;\n        h = 0;\n        s = 0;\n        v = 0;\n        r = r / 255;\n        g = g / 255;\n        b = b / 255;\n        var minRGB = min(r, min(g, b));\n        var maxRGB = max(r, max(g, b));\n        if (minRGB === maxRGB) {\n          v = minRGB;\n          return {\n            h: 0,\n            s: 0,\n            v: v * 100\n          };\n        }\n        var d = r === minRGB ? g - b : b === minRGB ? r - g : b - r;\n        h = r === minRGB ? 3 : b === minRGB ? 1 : 5;\n        h = 60 * (h - d / (maxRGB - minRGB));\n        s = (maxRGB - minRGB) / maxRGB;\n        v = maxRGB;\n        return {\n          h: round(h),\n          s: round(s * 100),\n          v: round(v * 100)\n        };\n      };\n      var hsvToRgb = function (hue, saturation, brightness) {\n        hue = (parseInt(hue, 10) || 0) % 360;\n        saturation = parseInt(saturation, 10) / 100;\n        brightness = parseInt(brightness, 10) / 100;\n        saturation = max(0, min(saturation, 1));\n        brightness = max(0, min(brightness, 1));\n        if (saturation === 0) {\n          r = g = b = round(255 * brightness);\n          return;\n        }\n        var side = hue / 60;\n        var chroma = brightness * saturation;\n        var x = chroma * (1 - Math.abs(side % 2 - 1));\n        var match = brightness - chroma;\n        switch (Math.floor(side)) {\n        case 0:\n          r = chroma;\n          g = x;\n          b = 0;\n          break;\n        case 1:\n          r = x;\n          g = chroma;\n          b = 0;\n          break;\n        case 2:\n          r = 0;\n          g = chroma;\n          b = x;\n          break;\n        case 3:\n          r = 0;\n          g = x;\n          b = chroma;\n          break;\n        case 4:\n          r = x;\n          g = 0;\n          b = chroma;\n          break;\n        case 5:\n          r = chroma;\n          g = 0;\n          b = x;\n          break;\n        default:\n          r = g = b = 0;\n        }\n        r = round(255 * (r + match));\n        g = round(255 * (g + match));\n        b = round(255 * (b + match));\n      };\n      var toHex = function () {\n        var hex = function (val) {\n          val = parseInt(val, 10).toString(16);\n          return val.length > 1 ? val : '0' + val;\n        };\n        return '#' + hex(r) + hex(g) + hex(b);\n      };\n      var toRgb = function () {\n        return {\n          r: r,\n          g: g,\n          b: b\n        };\n      };\n      var toHsv = function () {\n        return rgb2hsv(r, g, b);\n      };\n      var parse = function (value) {\n        var matches;\n        if (typeof value === 'object') {\n          if ('r' in value) {\n            r = value.r;\n            g = value.g;\n            b = value.b;\n          } else if ('v' in value) {\n            hsvToRgb(value.h, value.s, value.v);\n          }\n        } else {\n          if (matches = /rgb\\s*\\(\\s*([0-9]+)\\s*,\\s*([0-9]+)\\s*,\\s*([0-9]+)[^\\)]*\\)/gi.exec(value)) {\n            r = parseInt(matches[1], 10);\n            g = parseInt(matches[2], 10);\n            b = parseInt(matches[3], 10);\n          } else if (matches = /#([0-F]{2})([0-F]{2})([0-F]{2})/gi.exec(value)) {\n            r = parseInt(matches[1], 16);\n            g = parseInt(matches[2], 16);\n            b = parseInt(matches[3], 16);\n          } else if (matches = /#([0-F])([0-F])([0-F])/gi.exec(value)) {\n            r = parseInt(matches[1] + matches[1], 16);\n            g = parseInt(matches[2] + matches[2], 16);\n            b = parseInt(matches[3] + matches[3], 16);\n          }\n        }\n        r = r < 0 ? 0 : r > 255 ? 255 : r;\n        g = g < 0 ? 0 : g > 255 ? 255 : g;\n        b = b < 0 ? 0 : b > 255 ? 255 : b;\n        return self;\n      };\n      if (value) {\n        parse(value);\n      }\n      self.toRgb = toRgb;\n      self.toHsv = toHsv;\n      self.toHex = toHex;\n      self.parse = parse;\n      return self;\n    };\n\n    var serialize = function (obj) {\n      var data = JSON.stringify(obj);\n      if (!isString$1(data)) {\n        return data;\n      }\n      return data.replace(/[\\u0080-\\uFFFF]/g, function (match) {\n        var hexCode = match.charCodeAt(0).toString(16);\n        return '\\\\u' + '0000'.substring(hexCode.length) + hexCode;\n      });\n    };\n    var JSONUtils = {\n      serialize: serialize,\n      parse: function (text) {\n        try {\n          return JSON.parse(text);\n        } catch (ex) {\n        }\n      }\n    };\n\n    var JSONP = {\n      callbacks: {},\n      count: 0,\n      send: function (settings) {\n        var self = this, dom = DOMUtils.DOM, count = settings.count !== undefined ? settings.count : self.count;\n        var id = 'tinymce_jsonp_' + count;\n        self.callbacks[count] = function (json) {\n          dom.remove(id);\n          delete self.callbacks[count];\n          settings.callback(json);\n        };\n        dom.add(dom.doc.body, 'script', {\n          id: id,\n          src: settings.url,\n          type: 'text/javascript'\n        });\n        self.count++;\n      }\n    };\n\n    var XHR = __assign(__assign({}, Observable), {\n      send: function (settings) {\n        var xhr, count = 0;\n        var ready = function () {\n          if (!settings.async || xhr.readyState === 4 || count++ > 10000) {\n            if (settings.success && count < 10000 && xhr.status === 200) {\n              settings.success.call(settings.success_scope, '' + xhr.responseText, xhr, settings);\n            } else if (settings.error) {\n              settings.error.call(settings.error_scope, count > 10000 ? 'TIMED_OUT' : 'GENERAL', xhr, settings);\n            }\n            xhr = null;\n          } else {\n            Delay.setTimeout(ready, 10);\n          }\n        };\n        settings.scope = settings.scope || this;\n        settings.success_scope = settings.success_scope || settings.scope;\n        settings.error_scope = settings.error_scope || settings.scope;\n        settings.async = settings.async !== false;\n        settings.data = settings.data || '';\n        XHR.fire('beforeInitialize', { settings: settings });\n        xhr = new XMLHttpRequest();\n        if (xhr.overrideMimeType) {\n          xhr.overrideMimeType(settings.content_type);\n        }\n        xhr.open(settings.type || (settings.data ? 'POST' : 'GET'), settings.url, settings.async);\n        if (settings.crossDomain) {\n          xhr.withCredentials = true;\n        }\n        if (settings.content_type) {\n          xhr.setRequestHeader('Content-Type', settings.content_type);\n        }\n        if (settings.requestheaders) {\n          Tools.each(settings.requestheaders, function (header) {\n            xhr.setRequestHeader(header.key, header.value);\n          });\n        }\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        xhr = XHR.fire('beforeSend', {\n          xhr: xhr,\n          settings: settings\n        }).xhr;\n        xhr.send(settings.data);\n        if (!settings.async) {\n          return ready();\n        }\n        Delay.setTimeout(ready, 10);\n      }\n    });\n\n    var extend = Tools.extend;\n    var JSONRequest = function () {\n      function JSONRequest(settings) {\n        this.settings = extend({}, settings);\n        this.count = 0;\n      }\n      JSONRequest.sendRPC = function (o) {\n        return new JSONRequest().send(o);\n      };\n      JSONRequest.prototype.send = function (args) {\n        var ecb = args.error, scb = args.success;\n        var xhrArgs = extend(this.settings, args);\n        xhrArgs.success = function (c, x) {\n          c = JSONUtils.parse(c);\n          if (typeof c === 'undefined') {\n            c = { error: 'JSON Parse error.' };\n          }\n          if (c.error) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, c.error, x);\n          } else {\n            scb.call(xhrArgs.success_scope || xhrArgs.scope, c.result);\n          }\n        };\n        xhrArgs.error = function (ty, x) {\n          if (ecb) {\n            ecb.call(xhrArgs.error_scope || xhrArgs.scope, ty, x);\n          }\n        };\n        xhrArgs.data = JSONUtils.serialize({\n          id: args.id || 'c' + this.count++,\n          method: args.method,\n          params: args.params\n        });\n        xhrArgs.content_type = 'application/json';\n        XHR.send(xhrArgs);\n      };\n      return JSONRequest;\n    }();\n\n    var create = function () {\n      return function () {\n        var data = {};\n        var keys = [];\n        var storage = {\n          getItem: function (key) {\n            var item = data[key];\n            return item ? item : null;\n          },\n          setItem: function (key, value) {\n            keys.push(key);\n            data[key] = String(value);\n          },\n          key: function (index) {\n            return keys[index];\n          },\n          removeItem: function (key) {\n            keys = keys.filter(function (k) {\n              return k === key;\n            });\n            delete data[key];\n          },\n          clear: function () {\n            keys = [];\n            data = {};\n          },\n          length: 0\n        };\n        Object.defineProperty(storage, 'length', {\n          get: function () {\n            return keys.length;\n          },\n          configurable: false,\n          enumerable: false\n        });\n        return storage;\n      }();\n    };\n\n    var localStorage;\n    try {\n      var test = '__storage_test__';\n      localStorage = window.localStorage;\n      localStorage.setItem(test, test);\n      localStorage.removeItem(test);\n    } catch (e) {\n      localStorage = create();\n    }\n    var LocalStorage = localStorage;\n\n    var publicApi = {\n      geom: { Rect: Rect },\n      util: {\n        Promise: promiseObj,\n        Delay: Delay,\n        Tools: Tools,\n        VK: VK,\n        URI: URI,\n        Class: Class,\n        EventDispatcher: EventDispatcher,\n        Observable: Observable,\n        I18n: I18n,\n        XHR: XHR,\n        JSON: JSONUtils,\n        JSONRequest: JSONRequest,\n        JSONP: JSONP,\n        LocalStorage: LocalStorage,\n        Color: Color,\n        ImageUploader: ImageUploader\n      },\n      dom: {\n        EventUtils: EventUtils,\n        Sizzle: Sizzle,\n        DomQuery: DomQuery,\n        TreeWalker: DomTreeWalker,\n        TextSeeker: TextSeeker,\n        DOMUtils: DOMUtils,\n        ScriptLoader: ScriptLoader,\n        RangeUtils: RangeUtils,\n        Serializer: DomSerializer,\n        StyleSheetLoader: StyleSheetLoader,\n        ControlSelection: ControlSelection,\n        BookmarkManager: BookmarkManager,\n        Selection: EditorSelection,\n        Event: EventUtils.Event\n      },\n      html: {\n        Styles: Styles,\n        Entities: Entities,\n        Node: AstNode,\n        Schema: Schema,\n        SaxParser: SaxParser,\n        DomParser: DomParser,\n        Writer: Writer,\n        Serializer: HtmlSerializer\n      },\n      Env: Env,\n      AddOnManager: AddOnManager,\n      Annotator: Annotator,\n      Formatter: Formatter,\n      UndoManager: UndoManager,\n      EditorCommands: EditorCommands,\n      WindowManager: WindowManager,\n      NotificationManager: NotificationManager,\n      EditorObservable: EditorObservable,\n      Shortcuts: Shortcuts,\n      Editor: Editor,\n      FocusManager: FocusManager,\n      EditorManager: EditorManager,\n      DOM: DOMUtils.DOM,\n      ScriptLoader: ScriptLoader.ScriptLoader,\n      PluginManager: PluginManager,\n      ThemeManager: ThemeManager,\n      IconManager: IconManager,\n      Resource: Resource,\n      trim: Tools.trim,\n      isArray: Tools.isArray,\n      is: Tools.is,\n      toArray: Tools.toArray,\n      makeMap: Tools.makeMap,\n      each: Tools.each,\n      map: Tools.map,\n      grep: Tools.grep,\n      inArray: Tools.inArray,\n      extend: Tools.extend,\n      create: Tools.create,\n      walk: Tools.walk,\n      createNS: Tools.createNS,\n      resolve: Tools.resolve,\n      explode: Tools.explode,\n      _addCacheSuffix: Tools._addCacheSuffix,\n      isOpera: Env.opera,\n      isWebKit: Env.webkit,\n      isIE: Env.ie,\n      isGecko: Env.gecko,\n      isMac: Env.mac\n    };\n    var tinymce = Tools.extend(EditorManager, publicApi);\n\n    var exportToModuleLoaders = function (tinymce) {\n      if (typeof module === 'object') {\n        try {\n          module.exports = tinymce;\n        } catch (_) {\n        }\n      }\n    };\n    var exportToWindowGlobal = function (tinymce) {\n      window.tinymce = tinymce;\n      window.tinyMCE = tinymce;\n    };\n    exportToWindowGlobal(tinymce);\n    exportToModuleLoaders(tinymce);\n\n}());\n"]},"metadata":{},"sourceType":"script"}